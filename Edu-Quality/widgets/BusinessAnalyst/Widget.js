// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/BusinessAnalyst/BAWizard":function(){define("dojo/_base/array dojo/_base/declare dojo/on dojo/when esri/dijit/geoenrichment/_Wizard esri/geometry/webMercatorUtils ./CreateBuffersPage ./ErrorPage ./RunReportsPage ./SelectPointPolygonPage ./utils/GEUtil ./utils/GeocodeUtil".split(" "),function(r,p,m,h,f,e,b,c,d,a,g,l){return p([f],{selectedPoint:{tradeAreas:[]},selectedPolygon:{},selectedCountryID:"",availableCountries:[],drawnPolygonGraphic:null,name:"BusinessAnalystWizard",
baseClass:"jimu-widget-business-analyst-wizard",postCreate:function(){this.inherited(arguments);var k=this;h(g.checkCapabilities(this.appConfig),function(n){n.hasPrivilege&&n.geServiceConfigured&&n.dirRoutingServiceConfigured?(k.pages.SELECT_POINT_POLYGON=new a({map:k.map,nls:k.nls,wizard:k,config:k.config,onNext:function(){k._loadCreateBuffersPage()}}),k.pages.CREATE_BUFFERS=new b({map:k.map,nls:k.nls,wizard:k,config:k.config,onBack:function(){k._loadSelectPointPolygonPage()},onNext:function(){k._loadRunReportsPage()}}),
k.pages.CREATE_BUFFERS.startup(),k.pages.RUN_REPORTS=new d({map:k.map,nls:k.nls,wizard:k,appConfig:k.appConfig,config:k.config,onBack:function(){k.selectedPoint.geometry?k._loadCreateBuffersPage():k._loadSelectPointPolygonPage()}}),k.loadPage("SELECT_POINT_POLYGON"),k.own(m(k.map.infoWindow,"Show",function(){k._featureSelected()})),k.own(m(k.map.infoWindow,"Hide",function(){k._featureUnselected()})),k.own(m(k.map.infoWindow,"set-features",function(){k._featureSelected()})),k.own(m(k.map.infoWindow,
"selection-change",function(){k._featureSelected()})),k.selectedCountryID=k.config.defaultCountryID,h(g.getAvailableCountries(),function(q){k.availableCountries=q.countries;k.setSelectedCountry(k.selectedCountryID)}),k.map.infoWindow&&k.map.infoWindow.features&&0<k.map.infoWindow.features.length&&k._featureSelected()):(k.pages.ERROR_PAGE=new c({nls:k.nls,displayErrors:{gePrivilege:!n.hasPrivilege,geServiceNotConfigured:!n.geServiceConfigured,dirRoutingServiceNotConfigured:!n.dirRoutingServiceConfigured}}),
k.pages.ERROR_PAGE.startup(),k.loadPage("ERROR_PAGE"))})},startup:function(){},resize:function(){this.pages.SELECT_POINT_POLYGON&&this.pages.SELECT_POINT_POLYGON.resize()},clearSelectedPointBuffers:function(){var k=this;r.forEach(this.selectedPoint.tradeAreas,function(n){n&&n.graphic&&k.map.graphics.remove(n.graphic)});this.selectedPoint.tradeAreas=[]},clearSelectedPoint:function(){this.clearSelectedPointBuffers();this.map.graphics.remove(this.selectedPoint.pointGraphic);this.selectedPoint={tradeAreas:[]}},
clearSelectedPolygon:function(){this.selectedPolygon={};this.drawnPolygonGraphic&&(this.map.infoWindow.clearFeatures(),this.map.graphics.remove(this.drawnPolygonGraphic),this.drawnPolygonGraphic=null)},setSelectedCountry:function(k){var n=this;3==k.length?r.forEach(this.availableCountries,function(q){q.abbr3==k&&(n.selectedCountryID=q.id)}):2==k.length&&(this.selectedCountryID=k);this.pages.RUN_REPORTS.loadReportsInfographicsForCountry(this.selectedCountryID)},_loadSelectPointPolygonPage:function(){this.clearSelectedPoint();
this.clearSelectedPolygon();this.loadPage("SELECT_POINT_POLYGON");this.resize()},_loadCreateBuffersPage:function(){this.loadPage("CREATE_BUFFERS");this.pages.CREATE_BUFFERS.refresh()},_loadRunReportsPage:function(){this.loadPage("RUN_REPORTS");this.pages.RUN_REPORTS.refresh()},refreshPage:function(){this.currentPage&&this.currentPage.refresh&&this.currentPage.refresh()},_featureSelected:function(){var k=this,n=-1<this.map.infoWindow.selectedIndex&&this.map.infoWindow.features&&this.map.infoWindow.features[this.map.infoWindow.selectedIndex];
if(!n)this.clearSelectedPoint(),this.clearSelectedPolygon();else if((this.selectedPoint.geometry?this.selectedPoint.geometry:this.selectedPolygon.geometry)!==n.geometry)if(this.clearSelectedPoint(),this.clearSelectedPolygon(),"point"===n.geometry.type){this.selectedPoint.geometry=n.geometry;this.selectedPoint.locationName=this._getFeatureName(n);this.selectedPoint.attributes=n.attributes?n.attributes:{};var q=e.xyToLngLat(n.geometry.x,n.geometry.y);this.selectedPoint.long=q[0].toFixed(5);this.selectedPoint.lat=
q[1].toFixed(5);h(l.reverseGeocode({x:q[0],y:q[1]}),function(u){k.setSelectedCountry(u.address.CountryCode);k._loadCreateBuffersPage()})}else"polygon"==n.geometry.type?(this.selectedPolygon.geometry=n.geometry,this.selectedPolygon.locationName=this._getFeatureName(n),this.selectedPolygon.feature=n,q=n.geometry.getCentroid(),q=e.xyToLngLat(q.x,q.y),h(g.getCountryForPolygon(n.geometry,this.config,this.selectedCountryID),function(u){k.setSelectedCountry(u);k._loadRunReportsPage()})):k._loadSelectPointPolygonPage()},
_featureUnselected:function(){this.clearSelectedPoint();this.clearSelectedPolygon();this.pages.SELECT_POINT_POLYGON.search&&this.pages.SELECT_POINT_POLYGON.search.clear();this._loadSelectPointPolygonPage()},_getFeatureName:function(k){return k.getTitle()?k.getTitle():k._layer.displayField&&k.attributes[k._layer.displayField]?k.attributes[k._layer.displayField]:""}})})},"esri/dijit/geoenrichment/_Wizard":function(){define(["esri/declare","dojo/_base/lang","dojo/dom-construct","dijit/_WidgetBase","./utils/animation/AnimationHelper"],
function(r,p,m,h,f){return r("esri.dijit.geoenrichment._Wizard",h,{currentPage:null,currentPageId:null,_anim:null,pages:null,stacking:"stretch",constructor:function(){this.pages={};this._anim=new f},buildRendering:function(){this.domNode=m.create("div",{"class":"_Wizard_Root"})},loadPage:function(e){var b=this.pages[e],c=this.currentPage;b!==c&&(this._anim.finish(),c&&this._animPage("Anim_FadeOut").then(p.hitch(this.domNode,"removeChild",c.domNode)),this.currentPage=b,this.currentPageId=e,m.place(this.currentPage.domNode,
this.domNode,"first"),c&&this._animPage("Anim_FadeIn"),b._started||(b.set("stacking",this.stacking),b.startup()),b.resize())},_animPage:function(e){return this._anim.start([{node:this.currentPage.domNode,classes:[e,"Wizard_FadeAnim"]}])},resize:function(){this.currentPage&&this.currentPage.resize()},destroy:function(){for(var e in this.pages)this.hasOwnProperty(e)&&this.pages[e].destroyRecursive();this.pages={};this.inherited(arguments)}})})},"esri/declare":function(){define(["dojo/_base/declare",
"dojo/_base/lang","./extend"],function(r,p,m){return function(h,f,e){var b=p.isString(h);b?e.declaredClass=h:(e=f,f=h);f=r(f,e);b&&m(h,f);return f}})},"esri/extend":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(r,p,m){return function(h,f){p("extend-esri")&&(h=h.substring(h.indexOf(".")+1),r.setObject(h,f,m))}})},"esri/dijit/geoenrichment/utils/animation/AnimationHelper":function(){define("esri/declare dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/sniff dojo/on esri/dijit/geoenrichment/Deferred".split(" "),
function(r,p,m,h,f,e,b,c,d){var a=!(29>b("chrome")||23>b("ff")||6>b("safari")||10>b("ie"));var g=function(k,n){for(var q=function(y){var B=y.type;g=B;for(var D in u)D!==B&&(u[D].remove(),delete u[D]);n.apply(this,arguments)},u={},t=["animationend","webkitAnimationEnd"],v=0;v<t.length;v++)u[t[v]]=c(k,t[v],q);return{remove:function(){for(var y in u)u.hasOwnProperty(y)&&u[y].remove()}}};var l=r(null,{_oldNode:null,_targets:null,_deferred:null,start:function(k,n){this._oldNode=n;this._deferred=new d;
if(!a||!k.length||!k[0].node)return this.finish(),this._deferred.promise;this._targets=k;c.once(k[0].node,g,m.hitch(this,this.finish));for(n=0;n<k.length;n++){var q=k[n];h.add(q.node,q.classes);h.add(q.node,"Anim_Common")}return this._deferred.promise},finish:function(){if(this._targets){for(var k=0;k<this._targets.length;k++){var n=this._targets[k];n.node&&(h.remove(n.node,n.classes),h.remove(n.node,"Anim_Common"))}this._targets=null}this._oldNode&&(this.onNodePreDestroy(this._oldNode),f.destroy(this._oldNode),
this._oldNode=null);this._deferred.resolve()},onNodePreDestroy:function(k){}});return r(null,{progress:null,_items:null,_flySurfaceNode:null,_ltr:e.isBodyLtr(),constructor:function(k){this._flySurfaceNode=k;this._items=[]},start:function(k,n){var q=this,u=new l;u.onNodePreDestroy=function(t){q.onNodePreDestroy(t)};this._items.push(u);this.progress||(this.progress=new d);return u.start(k,n).then(m.hitch(this,this._onItemFinished,u))},_onItemFinished:function(k){k=p.indexOf(this._items,k);0<=k&&(this._items.splice(k,
1),0===this._items.length&&this.progress&&(this.progress.resolve(),this.progress=null))},finish:function(){for(var k=this._items;0<k.length;)k.pop().finish()},fly:function(k,n,q,u){u=u||k.cloneNode(!0);q||(q=["top",this._ltr?"left":"right"]);if(!a)return u;k=k.getBoundingClientRect();var t=this._flySurfaceNode.getBoundingClientRect();h.add(u,"Anim_FlyingObj");for(var v,y,B=0;B<q.length;B++){var D=q[B],E=k[D]-t[D];if("right"===D||"bottom"===D)E=-E;if("left"===D&&!this._ltr||"right"===D&&this._ltr)v=
D,y=E;u.style[D]=E+"px"}this._flySurfaceNode.appendChild(u);v&&(y+=k.width-u.getBoundingClientRect().width,u.style[v]=y+"px");this.start([{node:u,classes:[n]}],u);return u},onNodePreDestroy:function(k){}})})},"esri/dijit/geoenrichment/Deferred":function(){define(["dojo/Deferred"],function(r){return r})},"widgets/BusinessAnalyst/CreateBuffersPage":function(){define("dojo/_base/declare dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin esri/dijit/geoenrichment/_WizardPage esri/geometry/Polygon esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/Color esri/graphic ./utils/GEUtil ./utils/TravelModeUtil ./utils/ValidationUtil ./utils/SiteUtil dojo/text!./CreateBuffersPage.html jimu/dijit/TabContainer3 dijit/form/TextBox".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u){return r([m,p,f,h],{templateString:q,postCreate:function(){this.inherited(arguments);this.tab=new u({tabs:[{title:this.nls.rings,content:this.ringsContentPane},{title:this.nls.driveTime,content:this.driveTimeContentPane},{title:this.nls.walkTime,content:this.walkTimeContentPane}],selected:this.nls.rings});this.tab.placeAt(this.ringDtWtTabContainer);this.tab.startup();this._setConfigDefaults()},startup:function(){this.inherited(arguments)},refresh:function(){this._showHideTabs()},
_setConfigDefaults:function(){this._setRadii(this.config.ringDefaults,this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3);this.ringsBufferUnits.set("value",this.config.ringUnitDefault);this._setRadii(this.config.driveTimeDefaults,this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3);this.driveTimeBufferUnits.set("value",this.config.driveTimeUnitDefault);this._setRadii(this.config.walkTimeDefaults,this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3);
this.walkTimeBufferUnits.set("value",this.config.walkTimeUnitDefault)},_showHideTabs:function(){this.config.ringDisabled&&this.tab.removeTab(this.nls.rings);this.config.driveTimeDisabled&&this.tab.removeTab(this.nls.driveTime);this.config.walkTimeDisabled&&this.tab.removeTab(this.nls.walkTime);this.tab.getSelectedTitle()===this.nls.rings&&this.config.ringDisabled&&this.tab.selectTab(this.nls.driveTime);this.tab.getSelectedTitle()===this.nls.driveTime&&this.config.driveTimeDisabled&&this.tab.selectTab(this.nls.walkTime);
this.tab.getSelectedTitle()===this.nls.walkTime&&this.config.walkTimeDisabled&&this.tab.selectTab(this.nls.driveTime)},applyBuffer:function(){if(this._validateInput()){this.shelter.show();var t=this,v=[[16,59,143,1],[0,204,51,1],[204,51,0,1]],y=0,B={},D="",E="",F="",z=10,w;this.tab.getSelectedTitle()===this.nls.rings?(B.areaType="RingBuffer",B.bufferUnits=this.ringsBufferUnits.get("value"),F=this.ringsBufferUnits._getDisplayedValueAttr(),B.bufferRadii=this._getRadii(this.ringsBufferRadii1,this.ringsBufferRadii2,
this.ringsBufferRadii3),D=this.nls.ring):this.tab.getSelectedTitle()===this.nls.driveTime?(B.areaType="NetworkServiceArea",B.bufferUnits=this.driveTimeBufferUnits.get("value"),F=this.driveTimeBufferUnits._getDisplayedValueAttr(),B.bufferRadii=this._getRadii(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3),D=this.nls.driveTime,E="Driving "+("Minutes"===B.bufferUnits?"Time":"Distance"),z=(w=B.bufferRadii?n.getMaxRadiusInKilometers(B,!1):0)&&Math.max(1,Math.log(w/8)*
Math.LOG2E),z=w*Math.min(z,5)):(B.areaType="NetworkServiceArea",B.bufferUnits=this.walkTimeBufferUnits.get("value"),F=this.walkTimeBufferUnits._getDisplayedValueAttr(),B.bufferRadii=this._getRadii(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3),D=this.nls.walkTime,E="Walking "+("Minutes"===B.bufferUnits?"Time":"Distance"),z=(w=B.bufferRadii?n.getMaxRadiusInKilometers(B,!0):0)&&Math.max(1,Math.log(w/8)*Math.LOG2E),z=w*Math.min(z,3));var A=[];l.getTravelMode(E,z).then(function(H){H&&
(B.travelMode=H);g.createRingOrDriveTimes({geometry:t.wizard.selectedPoint.geometry,studyAreasOptions:B,sourceCountry:t.wizard.selectedCountryID}).then(function(G){t.wizard.clearSelectedPointBuffers();t.wizard.selectedPoint.areadesc2=D+t.nls.colon+" "+B.bufferRadii.join(", ")+" "+t.nls["headerDescription_"+F]+" "+t.nls.radii;G=G.results[0].value.FeatureSet[0].features.reverse();var I=B.bufferRadii.reverse(),N;for(N in G){var M=new e({rings:G[N].geometry.rings,spatialReference:{wkid:102100}});if(t.tab.getSelectedTitle()==
t.nls.rings)var O=new b(c.STYLE_SOLID,new c(c.STYLE_SOLID,new d(v[y]),2),new d([255,0,15,0]));else O=new d(v[y]),O.a=.5,O=new b(c.STYLE_SOLID,new c(c.STYLE_SOLID,new d(v[y]),2),O);M=new a(M,O);O={};O.graphic=M;O.name=t.wizard.selectedPoint.locationName+" - "+I[y]+" "+F;O.shortName=I[y]+" "+F;O.AREA_DESC=I[y]+" "+F;O.AREA_DESC2=D+t.nls.colon+" "+I[y]+" "+t.nls["headerDescription_"+F]+" "+t.nls.radius_lowercase;t.wizard.selectedPoint.tradeAreas.push(O);t.map.graphics.add(M);A.push(M);y++}t.wizard.selectedPoint.tradeAreas=
t.wizard.selectedPoint.tradeAreas.reverse();t.map.setExtent(t.wizard.selectedPoint.tradeAreas[t.wizard.selectedPoint.tradeAreas.length-1].graphic._extent);t.shelter.hide();t.onNext()},function(G){alert("Error: "+G);t.shelter.hide()})})}},backOnClick:function(){this.onBack()},_getRadii:function(t,v,y){t=t.get("value");v=v.get("value");y=y.get("value");var B=[];""!==t&&B.push(t);""!==v&&B.push(v);""!==y&&B.push(y);return B},_setRadii:function(t,v,y,B){0<t.length?v.set("value",t[0]):v.set("value","");
1<t.length?y.set("value",t[1]):y.set("value","");2<t.length?B.set("value",t[2]):B.set("value","")},_validateInput:function(){var t=!0;t=this.tab.getSelectedTitle()===this.nls.rings?k.validateInvalidValues(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,this.ringValidationErrorMessage,this.nls.thisEntryIsNotValid):this.tab.getSelectedTitle()===this.nls.driveTime?k.validateInvalidValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,this.driveTimeValidationErrorMessage,
this.nls.thisEntryIsNotValid):k.validateInvalidValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,this.walkTimeValidationErrorMessage,this.nls.thisEntryIsNotValid);return t?(t=this.tab.getSelectedTitle()===this.nls.rings?k.validateMinMaxValues(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,k.MIN_RINGS_VALUE,k.MAX_RINGS_VALUE,this.ringValidationErrorMessage,this.nls.invalidValueRing):this.tab.getSelectedTitle()===this.nls.driveTime?k.validateMinMaxValues(this.driveTimeBufferRadii1,
this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,k.MIN_DTWT_VALUE,k.MAX_DTWT_VALUE,this.driveTimeValidationErrorMessage,this.nls.invalidValueDTWT):k.validateMinMaxValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,k.MIN_DTWT_VALUE,k.MAX_DTWT_VALUE,this.walkTimeValidationErrorMessage,this.nls.invalidValueDTWT))?!0:!1:!1}})})},"esri/dijit/geoenrichment/_WizardPage":function(){define("esri/declare dojo/_base/lang dojo/string dojox/mvc/Templated ./Grid ./ProgressHandler dojo/text!./templates/_WizardPage.html".split(" "),
function(r,p,m,h,f,e,b){return r("esri.dijit.geoenrichment._WizardPage",h,{buttonsNode:null,_progressHandler:null,buildRendering:function(){var c=this.templateString;c&&"\ufeff"==c[0]&&(c=c.substr(1));this.templateString=m.substitute(b,{content:c});this.inherited(arguments);this.layoutGrid.rows=[f.AUTO,f.AUTO,f.AUTO]},resize:function(){this.layoutGrid.resize()},_setStackingAttr:function(c){switch(c){case "stretch":this.layoutGrid.rows[1]=f.STRETCH;break;case "stack":this.layoutGrid.rows[1]=f.STACK}},
showProgress:function(c,d){this._progressHandler||(this._progressHandler=new e(this.progressDiv,{queryNode:this.domNode}),this.own(this._progressHandler));c=this._progressHandler.showProgress(c,"string"==typeof d?d:"");d=d?"function"==typeof d?d:this[d]:null;"function"==typeof d&&c.then(p.hitch(this,d));return c},cancelProgress:function(c){this._progressHandler&&this._progressHandler.cancelProgress("string"==typeof c?c:"")}})})},"dojox/mvc/Templated":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./at".split(" "),
function(r,p,m,h,f){return r("dojox.mvc.Templated",[m,h,f],{bindings:null,startup:function(){var e=p.isFunction(this.bindings)&&this.bindings.call(this)||this.bindings,b;for(b in e){var c=this[b],d=e[b];if(c)for(var a in d)c.set(a,d[a]);else console.warn("Widget with the following attach point was not found: "+b)}this.inherited(arguments)}})})},"dojox/mvc/at":function(){define(["dojo/_base/kernel","dojo/_base/lang","./sync","./_atBindingExtension"],function(r,p,m){r.experimental("dojox.mvc");r=function(h,
f){return{atsignature:"dojox.mvc.at",target:h,targetProp:f,bindDirection:m.both,direction:function(e){this.bindDirection=e;return this},transform:function(e){this.converter=e;return this},equals:function(e){this.equalsCallback=e;return this}}};r.from=m.from;r.to=m.to;r.both=m.both;return p.setObject("dojox.mvc.at",r)})},"dojox/mvc/sync":function(){define(["dojo/_base/lang","dojo/_base/config","dojo/_base/array","dojo/has"],function(r,p,m,h){function f(d,a,g,l,k,n,q,u,t,v){if(!(g(t,u)||"*"==k&&0>m.indexOf(l.get("properties")||
[q],q)||"*"==k&&q in(v||{}))){g="*"==k?q:k;if(h("mvc-bindings-log-api"))var y=b(l,g,n,q);try{t=d?d(t,a):t}catch(B){h("mvc-bindings-log-api")&&console.log("Copy from"+y.join(" to ")+" was not done as an error is thrown in the converter.");return}h("mvc-bindings-log-api")&&console.log(y.reverse().join(" is being copied from: ")+" (Value: "+t+" from "+u+")");r.isFunction(l.set)?l.set(g,t):l[g]=t}}var e=r.getObject("dojox.mvc",!0);h.add("mvc-bindings-log-api",(p.mvc||{}).debugBindings);var b=h("mvc-bindings-log-api")?
function(d,a,g,l){return[[g.canConvertToLoggable||!g.declaredClass?g:g.declaredClass,l].join(":"),[d.canConvertToLoggable||!d.declaredClass?d:d.declaredClass,a].join(":")]}:"";p={from:1,to:2,both:3};var c=function(d,a,g,l,k){var n=(k||{}).converter;if(n){var q={source:d,target:g};var u=n.format&&r.hitch(q,n.format);var t=n.parse&&r.hitch(q,n.parse)}var v=[],y=[],B=r.mixin({},d.constraints,g.constraints);n=(k||{}).bindDirection||e.both;var D=(k||{}).equals||c.equals;if(h("mvc-bindings-log-api"))var E=
b(d,a,g,l);if("*"==l){if("*"!=a)throw Error("Unmatched wildcard is specified between source and target.");k=g.get("properties");if(!k){k=[];for(var F in g)g.hasOwnProperty(F)&&"_watchCallbacks"!=F&&k.push(F)}y=g.get("excludes")}else k=[a];n&e.from&&(r.isFunction(d.set)&&r.isFunction(d.watch)?v.push(d.watch.apply(d,("*"!=a?[a]:[]).concat([function(z,w,A){f(u,B,D,g,l,d,z,w,A,y)}]))):h("mvc-bindings-log-api")&&console.log(E.reverse().join(" is not a stateful property. Its change is not reflected to ")+
"."),m.forEach(k,function(z){if("*"!=l||!(z in(y||{}))){var w=r.isFunction(d.get)?d.get(z):d[z];f(u,B,D,g,"*"==l?z:l,d,z,void 0,w)}}));n&e.to&&(n&e.from||m.forEach(k,function(z){if("*"!=l||!(z in(y||{}))){var w=r.isFunction(g.get)?g.get(l):g[l];f(t,B,D,d,z,g,"*"==l?z:l,void 0,w)}}),r.isFunction(g.set)&&r.isFunction(g.watch)?v.push(g.watch.apply(g,("*"!=l?[l]:[]).concat([function(z,w,A){f(t,B,D,d,a,g,z,w,A,y)}]))):h("mvc-bindings-log-api")&&console.log(E.join(" is not a stateful property. Its change is not reflected to ")+
"."));h("mvc-bindings-log-api")&&console.log(E.join(" is bound to: "));F={};F.unwatch=F.remove=function(){for(var z=null;z=v.pop();)z.unwatch();h("mvc-bindings-log-api")&&console.log(E.join(" is unbound from: "))};return F};r.mixin(e,p);return r.setObject("dojox.mvc.sync",r.mixin(c,{equals:function(d,a){return d===a||"number"==typeof d&&isNaN(d)&&"number"==typeof a&&isNaN(a)||r.isFunction((d||{}).getTime)&&r.isFunction((a||{}).getTime)&&d.getTime()==a.getTime()||(r.isFunction((d||{}).equals)?d.equals(a):
r.isFunction((a||{}).equals)?a.equals(d):!1)}},p))})},"dojox/mvc/_atBindingExtension":function(){define(["dojo/_base/config","dojo/has","dijit/_WidgetBase","./atBindingExtension"],function(r,p,m,h){p.add("mvc-extension-per-widget",(r.mvc||{}).extensionPerWidget);p("mvc-extension-per-widget")||h(m.prototype)})},"dojox/mvc/atBindingExtension":function(){define("dojo/aspect dojo/_base/array dojo/_base/lang dijit/_WidgetBase ./_atBindingMixin dijit/registry".split(" "),function(r,p,m,h,f){return function(e){p.forEach(arguments,
function(b){b.dataBindAttr?console.warn("Detected a widget or a widget class that has already been applied data binding extension. Skipping..."):(m._mixin(b,f.mixin),r.before(b,"postscript",function(c,d){this._dbpostscript(c,d)}),r.before(b,"startup",function(){this._started||this._startAtWatchHandles()}),r.before(b,"destroy",function(){this._stopAtWatchHandles()}),r.around(b,"set",function(c){return function(d,a){return d==f.prototype.dataBindAttr?this._setBind(a):"dojox.mvc.at"==(a||{}).atsignature?
this._setAtWatchHandle(d,a):c.apply(this,m._toArray(arguments))}}))});return arguments}})},"dojox/mvc/_atBindingMixin":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/has dojo/Stateful ./resolve ./sync".split(" "),function(r,p,m,h,f,e,b){function c(k){try{var n=require("dijit/registry")}catch(u){return}for(k=k.domNode&&k.domNode.parentNode;k;){if(k=n.getEnclosingWidget(k)){var q=k._relTargetProp||"target";if((p.isFunction(k.get)?k.get(q):k[q])||q in k.constructor.prototype)return k}k=
k&&k.domNode.parentNode}}function d(k,n,q,u,t){function v(){y.Two&&y.Two.unwatch();delete y.Two;var F=B&&(p.isFunction(B.get)?B.get(D):B[D]),z=e(k,F);F=e(q,F);h("mvc-bindings-log-api")&&(!z||/^rel:/.test(k)&&!B)&&g(k,n);h("mvc-bindings-log-api")&&(!F||/^rel:/.test(q)&&!B)&&g(q,u);z&&F&&(!/^rel:/.test(k)&&!/^rel:/.test(q)||B)&&(z.set&&z.watch||"*"!=n?null==n?(p.isFunction(F.set)?F.set(u,z):F[u]=z,h("mvc-bindings-log-api")&&console.log("dojox/mvc/_atBindingMixin set "+z+" to: "+a(F,u))):y.Two=b(z,n,
F,u,t):h("mvc-bindings-log-api")&&g(k,n))}var y={},B=c(q),D=B&&B._relTargetProp||"target";v();if(B&&/^rel:/.test(k)||/^rel:/.test(q)&&p.isFunction(B.set)&&p.isFunction(B.watch))y.rel=B.watch(D,function(F,z,w){z!==w&&(h("mvc-bindings-log-api")&&console.log("Change in relative data binding target: "+B),v())});var E={};E.unwatch=E.remove=function(){for(var F in y)y[F]&&y[F].unwatch(),delete y[F]};return E}var a=h("mvc-bindings-log-api")?function(k,n){return[k._setIdAttr||!k.declaredClass?k:k.declaredClass,
n].join(":")}:"",g=h("mvc-bindings-log-api")?function(k,n){console.warn(n+" could not be resolved"+("string"==typeof k?" with "+k:"")+".")}:"",l={dataBindAttr:"data-mvc-bindings",_dbpostscript:function(k,n){n=this._refs=(k||{}).refs||{};for(var q in k)if("dojox.mvc.at"==(k[q]||{}).atsignature){var u=k[q];delete k[q];n[q]=u}u=new f;var t=this;u.toString=function(){return"[Mixin value of widget "+t.declaredClass+", "+(t.id||"NO ID")+"]"};u.canConvertToLoggable=!0;this._startAtWatchHandles(u);for(q in n)void 0!==
u[q]&&((k=k||{})[q]=u[q]);this._stopAtWatchHandles()},_startAtWatchHandles:function(k){this.canConvertToLoggable=!0;var n=this._refs;if(n){var q=this._atWatchHandles=this._atWatchHandles||{};this._excludes=null;for(var u in n)n[u]&&"*"!=u&&(q[u]=d(n[u].target,n[u].targetProp,k||this,u,{bindDirection:n[u].bindDirection,converter:n[u].converter,equals:n[u].equalsCallback}));"dojox.mvc.at"==(n["*"]||{}).atsignature&&(q["*"]=d(n["*"].target,n["*"].targetProp,k||this,"*",{bindDirection:n["*"].bindDirection,
converter:n["*"].converter,equals:n["*"].equalsCallback}))}},_stopAtWatchHandles:function(){for(var k in this._atWatchHandles)this._atWatchHandles[k].unwatch(),delete this._atWatchHandles[k]},_setAtWatchHandle:function(k,n){if("ref"==k)throw Error(this+": 1.7 ref syntax used in conjunction with 1.8 dojox/mvc/at syntax, which is not supported.");var q=this._atWatchHandles=this._atWatchHandles||{};q[k]&&(q[k].unwatch(),delete q[k]);this._excludes=this[k]=null;this._started?q[k]=d(n.target,n.targetProp,
this,k,{bindDirection:n.bindDirection,converter:n.converter,equals:n.equalsCallback}):this._refs[k]=n},_setBind:function(k){k=eval("({"+k+"})");for(var n in k){var q=k[n];"dojox.mvc.at"!=(q||{}).atsignature?console.warn(n+" in "+dataBindAttr+" is not a data binding handle."):this._setAtWatchHandle(n,q)}},_getExcludesAttr:function(){if(this._excludes)return this._excludes;var k=[],n;for(n in this._atWatchHandles)"*"!=n&&k.push(n);return k},_getPropertiesAttr:function(){if(this.constructor._attribs)return this.constructor._attribs;
var k=["onClick"].concat(this.constructor._setterAttrs);r.forEach(["id","excludes","properties","ref","binding"],function(n){n=r.indexOf(k,n);0<=n&&k.splice(n,1)});return this.constructor._attribs=k}};l[l.dataBindAttr]="";m=m("dojox/mvc/_atBindingMixin",null,l);m.mixin=l;return m})},"dojox/mvc/resolve":function(){define(["dojo/_base/lang","dijit/registry","dojo/Stateful"],function(r,p){return r.setObject("dojox.mvc.resolve",function(m,h){if("string"==typeof m){var f=m.match(/^(expr|rel|widget):(.*)$/)||
[];try{m="rel"==f[1]?r.getObject(f[2]||"",!1,h):"widget"==f[1]?p.byId(f[2]):r.getObject(f[2]||m,!1,h)}catch(e){}}return m})})},"esri/dijit/geoenrichment/Grid":function(){define(["../../declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dijit/layout/_LayoutWidget"],function(r,p,m,h,f){var e=r("esri.dijit.geoenrichment.Grid",[f],{_placeholder:null,layout:function(){var b=this.getChildren(),c=[],d;for(d=0;d<this.rows.length;d++)c.push(0);p.add(this.domNode,"Grid_Measure");var a=[];for(d=
0;d<b.length;d++){var g=b[d];var l=g.row;g=g.domNode;g.style.position="absolute";p.add(g,"GridCell_Measure");var k=g.scrollHeight;p.remove(g,"GridCell_Measure");g=k;a.push(g);g>c[l]&&(c[l]=g)}l=h.getContentBox(this.domNode).h;p.remove(this.domNode,"Grid_Measure");d=this.rows;for(g=a=0;g<c.length;g++)switch(d[g]){case e.AUTO:l-=c[g];break;case e.STRETCH:case e.STACK:a++}if(1<a)throw Error("Multiple rows with flexible heights are not supported");a=[0];for(g=0;g<c.length;g++){switch(d[g]){case e.AUTO:var n=
c[g];break;case e.STRETCH:n=l;break;case e.STACK:n=Math.min(l,c[g])}a.push(a[g]+n)}for(d=0;d<b.length;d++)g=b[d],l=g.row,c=a[l+1]-a[l],n=g.domNode.style,n.top=a[l]+"px",n.height=c+"px";this._placeholder||(this._placeholder=m.create("div",null,this.domNode));this._placeholder.style.height=a[a.length-1]+"px"}});e.AUTO="auto";e.STRETCH="stretch";e.STACK="stack";return e})},"esri/dijit/geoenrichment/ProgressHandler":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/when","dojo/dom-class",
"dojo/query"],function(r,p,m,h){return r(null,{progressNode:null,progressPromises:null,busyClass:null,errorClass:null,_allStates:null,constructor:function(f,e){e=e||{};this.busyClass=e.busyClass||"Wizard_Loading";this.errorClass=e.errorClass||"Wizard_Error";this._allStates=[this.busyClass,this.errorClass];var b=e.progressClass||"Wizard_Progress";f?(this.progressNode=f,m.add(this.progressNode,b)):e.queryNode&&(this.progressNode=h("."+b,e.queryNode)[0]);this.progressPromises={}},showProgress:function(f,
e){function b(){if(c.progressPromises[e]===f)return delete c.progressPromises[e],!0}e=e||"";f=p(f);if(f.isFulfilled())return this.progressPromises[e]&&(delete this.progressPromises[e],this._setState("done")),f;this.progressPromises[e]=f;var c=this;this._setState("busy");f.then(function(){b()&&c._setState("done")},function(d){b()&&("CancelError"==d.name?c._setState("done"):c._setState("error",d.toString()))});return f},cancelProgress:function(f){f=f||"";this.progressPromises[f]&&this.progressPromises[f].cancel()},
_setState:function(f,e){!this.progressNode||"done"==f&&Object.keys(this.progressPromises).length||(this.progressNode.innerHTML=e||"",m.remove(this.progressNode,this._allStates),"done"!=f&&m.add(this.progressNode,this[f+"Class"]))},destroy:function(){for(var f=Object.keys(this.progressPromises),e=0;e<f.length;e++)this.cancelProgress(f[e])}})})},"esri/dijit/geoenrichment/when":function(){define(["dojo/when"],function(r){return r})},"widgets/BusinessAnalyst/utils/GEUtil":function(){define("dojo/_base/array dojo/when esri/request ./GeocodeUtil esri/geometry/webMercatorUtils esri/dijit/geoenrichment/utils/FileUtil jimu/portalUtils".split(" "),
function(r,p,m,h,f,e,b){return{getAvailableCountries:function(){return b.getPortal(portalUrl).loadSelfInfo().then(function(c){return m({url:(c&&c.helperServices&&c.helperServices.geoenrichment&&c.helperServices.geoenrichment.url?c.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Countries",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},handleAs:"json"})})},createRingOrDriveTimes:function(c){return b.getPortal(portalUrl).loadSelfInfo().then(function(d){return m({url:(d&&
d.helperServices&&d.helperServices.geoenrichment&&d.helperServices.geoenrichment.url?d.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",useData:JSON.stringify({sourceCountry:c.sourceCountry}),studyAreasOptions:JSON.stringify(c.studyAreasOptions),dataCollections:JSON.stringify(["GlobalIntersect"]),returnGeometry:!0,outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:c.geometry}]),
token:esri.id.credentials[0].token},handleAs:"json"})})},createReport:function(c){var d={appID:"webappbuilder",langCode:"en-us",report:"string"===typeof c.report?c.report:JSON.stringify(c.report),format:"pdf",f:"bin",token:esri.id.credentials[0].token,useData:JSON.stringify({sourceCountry:c.sourceCountry}),studyAreas:JSON.stringify(c.studyAreas),reportFields:JSON.stringify({locationname:c.locationName,latitude:c.lat,longitude:c.long,subtitle:"Prepared by Esri",areadesc2:c.areadesc2})};return b.getPortal(portalUrl).loadSelfInfo().then(function(a){return m({url:(a&&
a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/createReport",content:d,handleAs:"blob"}).then(function(g){return e.saveAs(g,c.reportDownloadName+".pdf")}).otherwise(function(g){alert("Error: "+g)})})},checkCapabilities:function(c){return b.getPortal(portalUrl).loadSelfInfo().then(function(d){var a=!1,g=!1,l=d&&d.user&&d.user.privileges,
k=d&&d.helperServices;d=k.geoenrichment&&k.geoenrichment.url;k=k.routingUtilities&&k.routingUtilities.url;var n=d?d:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!c.mode&&c.appProxies&&0<c.appProxies.length&&r.some(c.appProxies,function(q){return n.toLowerCase()===q.sourceUrl.toLowerCase()})?g=a=!0:r.forEach(l,function(q){"premium:user:geoenrichment"===q?a=!0:"premium:user:networkanalysis"===q&&(g=!0)});return{hasPrivilege:a&&g,geServiceConfigured:!!d,
dirRoutingServiceConfigured:!!k}})},getCountryForPolygon:function(c,d,a){return b.getPortal(portalUrl).loadSelfInfo().then(function(g){return m({url:(g&&g.helperServices&&g.helperServices.geoenrichment&&g.helperServices.geoenrichment.url?g.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",dataCollections:JSON.stringify(["GlobalIntersect"]),outSR:JSON.stringify({wkid:102100}),
studyAreas:JSON.stringify([{geometry:c.toJson()}]),token:esri.id.credentials[0].token},handleAs:"json"}).then(function(l){if(l&&l.results&&1===l.results.length&&1===l.results[0].value.FeatureSet[0].features.length)return l.results[0].value.FeatureSet[0].features[0].attributes.sourceCountry;if(l&&l.results&&1===l.results.length&&1<l.results[0].value.FeatureSet[0].features.length){var k=c.getCentroid();k=f.xyToLngLat(k.x,k.y);var n=function(q){var u="";r.forEach(q,function(t){t.attributes.sourceCountry==
a&&(u=a)});if(u)return u;r.forEach(q,function(t){t.attributes.sourceCountry==d.defaultCountryID&&(u=defaultCountryID)});return u?u:q[0].attributes.sourceCountry};return p(h.reverseGeocode({x:k[0],y:k[1]})).then(function(q){return q&&q.address&&q.address.CountryCode?q.address.CountryCode:n(l.results[0].value.FeatureSet[0].features)}).otherwise(function(){return n(l.results[0].value.FeatureSet[0].features)})}return d.defaultCountryID})})},getGEProxyUrl:function(c){var d=!1;return b.getPortal(portalUrl).loadSelfInfo().then(function(a){geUrl=
a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!c.mode&&c.appProxies&&0<c.appProxies.length&&r.forEach(c.appProxies,function(g){geUrl.toLowerCase()===g.sourceUrl.toLowerCase()&&(d=g.proxyUrl)});return d})}}})},"widgets/BusinessAnalyst/utils/GeocodeUtil":function(){define(["esri/request","jimu/portalUtils"],function(r,p){return{reverseGeocode:function(m){return p.getPortal(portalUrl).loadSelfInfo().then(function(h){return r({url:(h&&
h.isPortal&&h.helperServices&&h.helperServices.geocode&&0<h.helperServices.geocode.length?h.helperServices.geocode[0].url:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer")+"/reverseGeocode",content:{appID:"webappbuilder",f:"json",langCode:"en-us",location:JSON.stringify({x:m.x,y:m.y}),distance:250},handleAs:"json"})})}}})},"esri/dijit/geoenrichment/utils/FileUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","./DataUtil","./ImageUtil"],
function(r,p,m,h){function f(){return new r.reject(Error("Saving not supported."))}var e=f,b=/[\\/:*?"<>|]/g,c={savingSupported:function(){return void 0!==window.Blob},saveTextFile:function(g,l,k,n){return c.savingSupported()?c.saveAs(new Blob([g],{type:k||"text/plain"}),l||"text.txt",n):f()},saveImageFile:function(g,l){if(c.savingSupported()){if("string"===typeof g){var k=h.base64DataFromDataURL(g);k=m.binaryStringToByteArray(atob(k)).buffer}else g instanceof ArrayBuffer&&(k=g);return c.saveAs(k?
m.arrayBuffersToBlob([k],"image/png"):g,l)}f()},_queue:[],_isSavePendingFlag:!1,_saveTimeoutH:null,saveAs:function(g,l,k){return k&&k.addDownloadIntervals?(k=new r,c._queue.push({blob:g,name:l||"download",dfd:k}),c._trySaveAsNext(),k.promise):e(g,c.validateName(l||"download"))},_trySaveAsNext:function(){if(c._queue.length&&!c._isSavePendingFlag){var g=c._queue.shift();c._isSavePendingFlag=!0;p(e(g.blob,c.validateName(g.name))).then(g.dfd.resolve,g.dfd.reject).always(function(){setTimeout(function(){c._isSavePendingFlag=
!1;c._trySaveAsNext()},100)})}},validateName:function(g){return String(g).trim().replace(b,"")}};if(!c.savingSupported())return c;if(window.navigator&&window.navigator.msSaveOrOpenBlob)return e=function(g,l){var k=new r;window.navigator.msSaveOrOpenBlob(g,l)?k.resolve():k.reject(Error("Failed to save or open downloaded file."));return k.promise},c;var d=window.URL||window.webkitURL;if("download"in window.document.createElement("a")){var a=function(g){if(void 0!==window.MouseEvent)var l=new MouseEvent("click",
{bubbles:!0,cancelable:!1});else l=document.createEvent("MouseEvent"),l.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);g.dispatchEvent(l)};e=function(g,l){var k=new r,n=d.createObjectURL(g),q=window.document.createElement("a");q.href=n;q.download=l;a(q);setTimeout(function(){d.revokeObjectURL(n);q=null;k.resolve();k=null},1E3);return k.promise};return c}e=function(g,l){var k=new r;g=new File([g],l,{type:g.type});var n=d.createObjectURL(g);window.open(n,"_blank");setTimeout(function(){d.revokeObjectURL(n);
k.resolve()},1E3);return k.promise};return c})},"esri/dijit/geoenrichment/utils/DataUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(r,p){function m(b){return"string"==typeof b?{source:b,getLength:function(){return this.source.length},getByte:function(c){return this.source.charCodeAt(c)&255}}:window.ArrayBuffer&&b instanceof ArrayBuffer?{source:new Uint8Array(b),getLength:function(){return this.source.byteLength},getByte:function(c){return this.source[c]}}:
b}function h(b){for(var c=b.length,d=new Uint8Array(b.length),a=0;a<c;a++)d[a]=b.charCodeAt(a);return d}function f(b,c){b=new Uint8Array(b);c=Math.min(c,b.byteLength);for(var d="",a=0;a<c;a++)d+=String.fromCharCode(b[a]);return d}var e={arrayBufferFromBlob:function(b){var c=new r,d=new FileReader;d.onloadend=function(){d.error?c.reject(d.error):c.resolve(d.result)};d.readAsArrayBuffer(b);return c.promise},arrayBuffersToBlob:function(b,c){return new Blob(b,{type:c||"application/octet-stream"})},binaryStringFromByteSource:function(b){if("string"==
typeof b)return b;b=m(b);var c=b.getLength(),d=c%4;c-=d;for(var a="",g=0,l,k,n,q;g<c;)l=b.getByte(g++),k=b.getByte(g++),n=b.getByte(g++),q=b.getByte(g++),a+=String.fromCharCode(l,k,n,q);1==d?a+=String.fromCharCode(b.getByte(g)):2==d?a+=String.fromCharCode(b.getByte(g),b.getByte(g+1)):3==d&&(a+=String.fromCharCode(b.getByte(g),b.getByte(g+1),b.getByte(g+2)));return a},base64FromByteSource:function(b){b=m(b);var c=b.getLength(),d=c%3;c-=d;for(var a,g,l,k,n="",q=0;q<c;q+=3)k=b.getByte(q)<<16|b.getByte(q+
1)<<8|b.getByte(q+2),a=k>>18&63,g=k>>12&63,l=k>>6&63,k&=63,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[l]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k];1==d?(k=b.getByte(q),n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>2&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k<<
4&63]+"\x3d\x3d"):2==d&&(k=b.getByte(q)<<8|b.getByte(q+1),n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>10&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>4&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k<<2&63]+"\x3d");return n},base64FromJson:function(b){return btoa(unescape(encodeURIComponent("string"===typeof b?b:JSON.stringify(b))))}};e.binaryStringToByteArray=h;e.base64ToByteArray=function(b){return h(atob(b))};e.getFirstBytes=
function(b,c){if("string"==typeof b)var d=b.substr(0,c);else if(window.ArrayBuffer&&b instanceof ArrayBuffer)d=f(b,c);else if(window.Blob&&b instanceof Blob){d=new r;var a=new FileReader;a.onloadend=function(){a.error?d.resolve(""):d.resolve(f(a.result,c))};a.readAsArrayBuffer(b.slice(0,c))}return p(d||"")};e.isBase64=function(b){return b&&0==b.length%4&&/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/]+$/.test(b.replace(/={0,2}$/,""))};e.base64ToJson=function(b){return JSON.parse(decodeURIComponent(atob(b)))};
e.getContentType=function(b){b=e.getFileExtension(b);if(null===b)return null;switch(b){case "png":return"image/png";case "jpg":case "jpeg":return"image/jpeg";case "gif":return"image/gif";case "json":return"application/json";case "txt":return"text/plain";case "xml":return"text/xml";default:return null}};e.getFileExtension=function(b){var c=b.lastIndexOf(".")+1;return c?b.substr(c).toLowerCase():null};return e})},"esri/dijit/geoenrichment/utils/ImageUtil":function(){define(["esri/dijit/geoenrichment/Deferred",
"esri/dijit/geoenrichment/when","./UrlUtil"],function(r,p,m){var h={base64DataToDataURL:function(f,e){if(/^data:image/.test(f))return f;e||(e=atob(f.substr(0,16)),e=h.getImageContentType(e));return"data:"+(e||"image/png")+";base64,"+f},getImageContentType:function(f){if("\u00ff\u00d8\u00ff"===f.substr(0,3)&&"JFIF"===f.substr(6,4))return"image/jpeg";if("\u0089PNG\r\n\u001a\n"===f.substr(0,8))return"image/png";if("GIF89a"===f.substr(0,6)||"GIF87a"===f.substr(0,6))return"image/gif"},base64DataFromDataURL:function(f){0==
f.indexOf("data:")&&(f=f.substr(f.indexOf(",")+1));return f},getBase64DataIndex:function(f){f=0==f.indexOf("data:")?f.indexOf(";base64,"):-1;return 0<f?f+8:0},getContentType:function(f){var e=h.getBase64DataIndex(f);return e?f.substring(5,e-8):null},checkBase64FileSize:function(f,e){return h.getBase64FileSize(f)<=e},getBase64FileSize:function(f){return.75*f.length},imageToDataURL:function(f,e){e=e||{};var b=document.createElement("canvas"),c=b.getContext("2d");b.width=e.width||f.width;b.height=e.height||
f.height;var d=e.opacity;null!=d&&!isNaN(d)&&0<=d&&1>d&&(c.globalAlpha=+d,e.format="image/png");(d=e.pos)?c.drawImage(f,d.x||0,d.y||0):c.drawImage(f,0,0,b.width,b.height);return b.toDataURL(e.format)},imageFromUrl:function(f,e){var b=new r,c=new Image;0!==f.indexOf("data:")&&e&&e.crossOrigin&&c.setAttribute("crossOrigin",e.crossOrigin);c.onload=function(){if(c.width&&c.height)b.resolve(c);else{var d=Error("Error of reading an image from URL.");e&&e.ignoreError?b.resolve(null):b.reject(d)}c.onload=
c.onerror=null};c.onerror=function(d){e&&e.ignoreError?b.resolve(null):b.reject(d);c.onload=c.onerror=null};f=require.toUrl(f);/^http:/i.test(f)&&/^https/i.test(window.location.protocol)&&(f=m.toHttpsUrl(f));c.src=f;return b.promise},scaleImage:function(f,e){if("string"===typeof f){var b=h.base64DataToDataURL(f),c=h.getContentType(b);b=h.imageFromUrl(b)}return p(b||f).then(function(d){var a=1,g=d.width,l=d.height;if(e.factor)a=e.factor;else if(e.maxDim)a=e.maxDim/Math.max(g,l);else if(e.imageDim){var k=
e.imageDim.w,n=e.imageDim.h;e.imageDim.preserveRatio?(a=Math.min(k/g,n/l),e.imageDim.reduceOnly&&1<a&&(a=1)):e.imageDim.reduceOnly?(g=Math.min(g,k),l=Math.min(l,n)):(g=k,l=n)}return h.imageToDataURL(d,{width:g*a,height:l*a,format:e.format||c,opacity:e.opacity})})},getImageViewType:function(f,e){return 1E3<=e?(f/=e,.025>=Math.abs(f-2)?"360":2<f?"pano":null):null}};return h})},"esri/dijit/geoenrichment/utils/UrlUtil":function(){define(["dojo/_base/url","esri/config","esri/kernel","esri/urlUtils","esri/arcgis/utils"],
function(r,p,m,h,f){var e={getDomain:function(c){if("string"!==typeof c)return null;c=c.replace(/^(http:\/\/|https:\/\/)/i,"");var d=c.indexOf("/");return 0>d?c:c.substr(0,d)},getPortalUrl:function(c){if("string"!==typeof c)return null;c=c.replace(/\?.*$/,"");var d=c.match(/^(.+)\/sharing(\/|$)/i);return d||(d=c.match(/^(.+)\/home$/i))?d[1]:(d=c.match(/^(.+)\/portal(\/|$)/i))?d[1]+"/portal":c},getProxyUrl:function(c){var d=p.defaults.io.proxyUrl;d&&!/^http/i.test(d)&&(d=h.getAbsoluteUrl(d));d&&c&&
(d=e.toHttpsUrl(d));return d},registerCORS:function(c){(c=e.getDomain(c))&&-1==p.defaults.io.corsEnabledServers.indexOf(c)&&p.defaults.io.corsEnabledServers.push(c);e._fixCORS()},_fixCORS:function(){p.defaults.io.corsEnabledServers=p.defaults.io.corsEnabledServers.filter(function(c){return c.indexOf&&0===c.indexOf("null://")?(console.log("WARNING: incorrect CORS URL detected: "+c),!1):!0})},indexOfQuery:function(c){var d=c.indexOf("?");0<=d&&(c=c.substr(d+1),/^(http:\/\/|https:\/\/)/i.test(c)&&(c=
c.indexOf("?"),d=0<=c?d+1+c:-1));return d},removeQuery:function(c){var d=e.indexOfQuery(c);return 0>d?c:c.substr(0,d)},addQueryPart:function(c,d){var a=0>e.indexOfQuery(c)?"?":"\x26";return c+a+d},getVariableValue:function(c,d){if(c&&"string"===typeof d){var a=h.urlToObject(c);if(a.query){var g={};Object.keys(a.query).forEach(function(l){g[l.toLowerCase()]=a.query[l]});return g[d.toLowerCase()]}}},addUrlVariable:function(c,d,a){d=encodeURIComponent(d);a=encodeURIComponent(a);return e.addQueryPart(c,
d+"\x3d"+a)},securePortsMap:{80:"443",8080:"8443"},toHttpUrl:function(c){return!c||/^http/i.test(c)?c:"http://"+c},toHttpsUrl:function(c){c&&(c=e.toHttpUrl(c));if(!c||!/^http:\/\//i.test(c))return c;var d=new r(c);c=c.replace(/^http/i,"https");var a=e.securePortsMap[d.port];a&&(c=c.replace(":"+d.port,":"+a));return c},combine:function(c,d){"number"===typeof d&&(d+="");if(d){if(/^(http:\/\/|https:\/\/)/i.test(d)||!c)return d;"/"!=d.charAt(0)&&(d="/"+d);if(1==d.length)return c;var a=c.length-1;"/"==
c.charAt(a)&&(c=c.substr(0,a));var g=h.urlToObject(c);c=e.removeQuery(c);a=c.length-d.length;0<=a&&c.substr(a).toLowerCase()==d.toLowerCase()&&(c=c.substr(0,a));c+=d;for(var l in g.query)e.addQueryPart(c,g.query[l])}return c},combineMulti:function(c){for(var d=c[0],a=1;a<c.length;a++)d=e.combine(d,c[a]);return d},openUrl:function(c,d){if(d)return window.open(c,"_blank");d=window.open();d.opener=null;d.referrer=null;d.location=c;return d},isPageRunOnWebService:function(){return/^http/i.test(window.location.protocol)},
getToken:function(c){return(c=c&&m.id.findCredential(c)||m.id.credentials[0])&&c.token}},b;e.getArcgisUrl=function(){return b};e.setArcgisUrl=function(c){c&&(b=c,f.arcgisUrl=e.combine(c,"/sharing/rest/content/items"))};return e})},"widgets/BusinessAnalyst/utils/TravelModeUtil":function(){define(["esri/request","jimu/portalUtils","dojo/_base/array","dojo/Deferred","dojo/when"],function(r,p,m,h,f){var e=null;return{getTravelMode:function(b,c){return f(this._getTravelModes(),function(d){var a="";m.forEach(d.results,
function(g){"supportedTravelModes"===g.paramName&&m.forEach(g.value.features,function(l){l.attributes&&l.attributes.Name===b&&(a=l.attributes.TravelMode)})});if(!a)return a;c=Number(c);if(!c||10>=c)return a;d=JSON.parse(a);d.simplificationTolerance=c;return JSON.stringify(d)})},_getTravelModes:function(){e||(e=new h,p.getPortal(portalUrl).loadSelfInfo().then(function(b){r({url:b.helperServices.routingUtilities.url+"/GetTravelModes/execute",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},
handleAs:"json"}).then(function(c){e.resolve(c)})}));return e}}})},"widgets/BusinessAnalyst/utils/ValidationUtil":function(){define(["dojo/dom-class"],function(r){return{MIN_RINGS_VALUE:0,MAX_RINGS_VALUE:1E3,MIN_DTWT_VALUE:0,MAX_DTWT_VALUE:300,validateInvalidValues:function(p,m,h,f,e){var b=p.get("value"),c=m.get("value"),d=h.get("value"),a=!0;0<b.length&&null===this._tryParseFloat(b)?(a=!1,r.remove(f,"hidden"),f.innerHTML=e,r.add(p.domNode,"invalidValue")):r.remove(p.domNode,"invalidValue");0<c.length&&
null===this._tryParseFloat(c)?(a=!1,r.remove(f,"hidden"),f.innerHTML=e,r.add(m.domNode,"invalidValue")):r.remove(m.domNode,"invalidValue");0<d.length&&null===this._tryParseFloat(d)?(a=!1,r.remove(f,"hidden"),f.innerHTML=e,r.add(h.domNode,"invalidValue")):r.remove(h.domNode,"invalidValue");a&&r.add(f,"hidden");return a},validateMinMaxValues:function(p,m,h,f,e,b,c){var d=p.get("value"),a=m.get("value"),g=h.get("value"),l=!0;0<d.length?(d=parseFloat(d),d<f||d>e?(l=!1,r.remove(b,"hidden"),b.innerHTML=
c,r.add(p.domNode,"invalidValue")):r.remove(p.domNode,"invalidValue")):r.remove(p.domNode,"invalidValue");0<a.length?(d=parseFloat(a),d<f||d>e?(l=!1,r.remove(b,"hidden"),b.innerHTML=c,r.add(m.domNode,"invalidValue")):r.remove(m.domNode,"invalidValue")):r.remove(m.domNode,"invalidValue");0<g.length?(d=parseFloat(g),d<f||d>e?(l=!1,r.remove(b,"hidden"),b.innerHTML=c,r.add(h.domNode,"invalidValue")):r.remove(h.domNode,"invalidValue")):r.remove(h.domNode,"invalidValue");l&&r.add(b,"hidden");return l},
_tryParseFloat:function(p){var m=null;null!==p&&0<p.length&&(isNaN(p)||(m=parseFloat(p)));return m}}})},"widgets/BusinessAnalyst/utils/SiteUtil":function(){define(["esri/units","dojo/_base/array"],function(r,p){var m={testTimeUnits:function(f){return"Hours"===f||"Seconds"===f||"Minutes"===f}},h={};h[r.FEET]=.3048;h[r.YARDS]=.9144;h[r.METERS]=1;h[r.KILOMETERS]=1E3;h[r.MILES]=1609.3472186944373;h[r.NAUTICAL_MILES]=1852;h.Hours=6E4;h.Seconds=16.66666666666667;h.Minutes=1E3;h[r.SQUARE_FEET]=h[r.FEET]*
h[r.FEET];h[r.SQUARE_YARDS]=h[r.YARDS]*h[r.YARDS];h[r.SQUARE_METERS]=1;h[r.SQUARE_KILOMETERS]=h[r.KILOMETERS]*h[r.KILOMETERS];h[r.SQUARE_MILES]=h[r.MILES]*h[r.MILES];h[r.ACRES]=4046.8564224;h[r.HECTARES]=1E4;m.convertUnits=function(f,e,b){return f*(h[e]||0)/(b&&h[b]||1)};m.getMaxRadiusInKilometers=function(f,e){var b=0;f&&f.bufferRadii&&(p.forEach(f.bufferRadii,function(c){c>b&&(b=c)}),b=m.convertUnits(b,f.bufferUnits||r.MILES,r.KILOMETERS),e&&m.testTimeUnits(f.bufferUnits)&&(b/=12));return b};return m})},
"widgets/BusinessAnalyst/ErrorPage":function(){define(["dojo/_base/declare","dijit/_TemplatedMixin","dijit/_WidgetBase","esri/dijit/geoenrichment/_WizardPage","dojo/text!./ErrorPage.html"],function(r,p,m,h,f){return r([m,p,h],{templateString:f,postCreate:function(){this.inherited(arguments);var e=this.displayErrors;e.gePrivilege?this.noPermissionsErrorDiv.innerHTML=this.nls.noPermissions:this.noPermissionsErrorDiv.parentNode.removeChild(this.noPermissionsErrorDiv);e.geServiceNotConfigured||e.dirRoutingServiceNotConfigured?
this.servicesErrorDiv.innerHTML=e.geServiceNotConfigured?e.dirRoutingServiceNotConfigured?this.nls.geAndDirRoutingServicesNotConfigured:this.nls.geServiceNotConfigured:this.nls.dirRoutingServiceNotConfigured:this.servicesErrorDiv.parentNode.removeChild(this.servicesErrorDiv)},startup:function(){this.inherited(arguments)}})})},"widgets/BusinessAnalyst/RunReportsPage":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-style dojo/query dojo/when dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin esri/geometry/webMercatorUtils esri/dijit/geoenrichment/SelectableTree esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GEUtil esri/dijit/geoenrichment/ReportPlayer/ReportPlayer esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes esri/dijit/geoenrichment/ReportPlayer/PlayerThemes esri/dijit/geoenrichment/ReportPlayer/DataProviderGE esri/dijit/geoenrichment/ReportPlayer/PlayerCommands esri/dijit/geoenrichment/_WizardPage esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ReportTemplateTypes ./utils/GEUtil ./utils/ReportUtil ./esriAnalystX/widgets/Selects/FilteringSelectTree dojo/text!./RunReportsPage.html jimu/dijit/TabContainer3 jimu/utils".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y,B,D,E,F,z,w,A,H){return p([a,d,B,g],{templateString:w,infographicsTabHidden:!1,reportsTabHidden:!1,_infograpicReports:null,_configForLightTheme:[{name:"DashboardTheme",style:"light"}],postCreate:function(){this.inherited(arguments);this.tab=new A({tabs:[{title:this.nls.infographics,content:this.infographicsContentPane},{title:this.nls.reports,content:this.reportsContentPane}],selected:this.nls.infographics});this.tab.placeAt(this.runReportTabContainer);
this.tab.startup()},startup:function(){this.inherited(arguments)},loadReportsInfographicsForCountry:function(G){var I=this;c(F.getAvailableClassicReports(G,this.config),function(N){var M=I._getSingleReportID(N),O=I._getCountryConfig(I.config,G);O&&O.defaultReportID&&(M=O.defaultReportID);I.filteredReportDropDown?I.filteredReportDropDown.set("tree",new k(N)):(I.filteredReportDropDown=new z({name:"filteredReportSelect",tree:new k(N),defaultExpand:M?I._getDefaultExpandedTreeForSelectedReport(N,M):I._getDefaultExpandedTree(N),
placeHolder:I.nls.selectReport,onChange:function(S){I._enableDisableButton(I.runReportBtn,S)}},I.reportFilteringSelectDropDownContainer),I.filteredReportDropDown.startup());M&&I.filteredReportDropDown.set("value",M);I.reportsTabHidden=I.config.reportsDisabled||!I._areReportsAvailable(N)});c(F.getAvailableInfographicReports(G,this.config),function(N){var M=I._getSingleReportID(N),O=I._getCountryConfig(I.config,G);O&&O.defaultInfographicID&&(M=O.defaultInfographicID);I.infographicDropDown?I.infographicDropDown.set("tree",
new k(N)):(I.infographicDropDown=new z({name:"filteredInfographicReportSelect",tree:new k(N),defaultExpand:M?I._getDefaultExpandedTreeForSelectedReport(N,M):I._getDefaultExpandedTree(N),placeHolder:I.nls.selectTemplate,onChange:function(S){I._enableDisableButton(I.runInfographicBtn,S)}},I.infographicDropDownContainer),I.infographicDropDown.startup());M&&I.infographicDropDown.set("value",M);I.infographicsTabHidden=I.config.infographicsDisabled||!I._areReportsAvailable(N);I._infograpicReports=N})},
_getCountryConfig:function(G,I){var N=-1;r.forEach(G.countryConfig,function(M,O){M.countryID==I&&(N=O)});return-1!=N?G.countryConfig[N]:null},_areReportsAvailable:function(G){if(0==G.length)return!1;var I=!1;r.forEach(G,function(N){0<N.children.length&&(I=!0)});return I},_getDefaultExpandedTree:function(G){if(0==G.length)return{esriReports:!0};var I={};I[G[0].value]=!0;return I},_getDefaultExpandedTreeForSelectedReport:function(G,I){if(0==G.length)return{esriReports:!0};returnVal={};r.forEach(G,function(N){r.forEach(N.children,
function(M){M.value===I&&(returnVal[N.value]=!0)})});return returnVal},_getSingleReportID:function(G){if(1!=G.length)return!1;var I=!1;r.forEach(G,function(N){1===N.children.length&&(I=N.children[0].value)});return I},refresh:function(){this._hideOrShowTabs()},_hideOrShowTabs:function(){this._hideOrShowTab(this.nls.infographics,this.infographicsTabHidden);this._hideOrShowTab(this.nls.reports,this.reportsTabHidden);this.infographicsTabHidden?this.tab.selectTab(this.nls.reports):this.tab.selectTab(this.nls.infographics)},
_hideOrShowTab:function(G,I){var N=b("td",this.tab.tabTr),M;r.some(N,function(O){if(O.label===G)return M=O,!0})&&e.set(M,"display",I?"none":"")},runInfographic:function(){if(!h.contains(this.runInfographicBtn,"jimu-state-disabled")){var G=this,I=this.infographicDropDown.get("value");this.reportPlayer&&this.reportPlayer.destroy();this.playerDiv&&f.destroy(this.playerDiv);this.playerDiv=f.create("div",null,document.body);var N=new v;this.config.exportInfographicsPrintOption&&N.registerCommand(y.PRINT);
this.config.exportInfographicsPDFOption&&N.registerCommand(y.PDF);this.config.exportInfographicsImageOption&&N.registerCommand(y.IMAGE);this.config.exportInfographicsDynamicHTMLOption&&N.registerCommand(y.DYNAMIC_HTML);var M=H.isMobileUa();this.reportPlayer=(new q({isSlidesView:M?!0:!1,theme:this._useLightTheme()?t.LIGHT:t.DARK,dataProvider:N,resizeMode:u.FIT_WINDOW,showCloseButton:!0,config:{esriDijitCssUrl:"https://js.arcgis.com/3.35/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/3.35/esri/css/esri.css",
playerSourceRootUrl:"https://js.arcgis.com/3.35/"},onClose:function(){G.reportPlayer.destroy();f.destroy(G.playerDiv)}})).placeAt(this.playerDiv);var O=!0;N=new z({name:"filteredInfographicReportSelect",tree:new k(this._infograpicReports),defaultExpand:G._getDefaultExpandedTreeForSelectedReport(this._infograpicReports,I),placeHolder:G.nls.selectTemplate,value:I,onChange:function(R){O?O=!1:(G.infographicDropDown.set("value",R),S(R))}});this._useLightTheme()||h.add(this.reportPlayer.playerToolbar.domNode,
"jimu-main-background");N.startup();N.set("value",I);this.reportPlayer.playerToolbar.addInfographicsSelect(N);var S=function(R){var V=[];if(G.wizard.selectedPoint.long)r.forEach(G.wizard.selectedPoint.tradeAreas,function(da,W){var ea={};ea.name=da.name;ea.shortName=da.shortName;ea.feature=da.graphic;"undefined"===typeof ea.feature.attributes&&(ea.feature.attributes="undefined"!==typeof G.wizard.selectedPoint.attributes?G.wizard.selectedPoint.attributes:{});ea.feature.attributes.STORE_LONG=G.wizard.selectedPoint.long;
ea.feature.attributes.STORE_LAT=G.wizard.selectedPoint.lat;ea.feature.attributes.radiusIndex=W;V.push(ea)});else if(G.wizard.selectedPolygon.geometry){V=[];var Z={};G.isPolygonFIPS(G.wizard.selectedPolygon)?Z=G.GetFIPSAnalysisArea(G.wizard.selectedPolygon):(Z.name=G.wizard.selectedPolygon.locationName,Z.shortName=G.wizard.selectedPolygon.locationName,Z.feature=G.wizard.selectedPolygon.feature);V.push(Z)}G.reportPlayer.playReport({portalUrl:portalUrl,countryID:G.wizard.selectedCountryID,reportID:R,
analysisAreas:V})};c(E.getGEProxyUrl(this.appConfig),function(R){R&&(n.setGeoenrichmentUrl(R),n.getClient());S(I)})}},isPolygonFIPS:function(G){return G&&G.feature&&G.feature.attributes&&G.feature.attributes.FIPS||G&&G.feature&&G.feature.attributes&&G.feature.attributes.STATE_FIPS?!0:!1},GetFIPSAnalysisArea:function(G){var I={geographies:[]},N={sourceCountry:"US"},M="";if(G.feature.attributes.FIPS)switch(G.feature.attributes.FIPS.length){case 2:M="US.States";break;case 5:M="US.Counties";break;case 11:M=
"US.Tracts"}else G.feature.attributes.STATE_FIPS&&(M="US.States");N.levelId=M;N.id=G.feature.attributes.FIPS?G.feature.attributes.FIPS.toString():G.feature.attributes.STATE_FIPS.toString();N.attributes=G.feature.attributes;G=G.geometry.getCentroid();G=l.xyToLngLat(G.x,G.y);N.attributes.STORE_ID="0";N.attributes.STORE_LONG=G[0].toString();N.attributes.STORE_LAT=G[1].toString();I.geographies.push(N);return I},GetFIPSStudyArea:function(G){var I={sourceCountry:"US"},N="";if(G.feature.attributes.FIPS)switch(G.feature.attributes.FIPS.length){case 2:N=
"US.States";break;case 5:N="US.Counties";break;case 11:N="US.Tracts"}else G.feature.attributes.STATE_FIPS&&(N="US.States");I.layer=N;I.ids=[G.feature.attributes.FIPS?G.feature.attributes.FIPS.toString():G.feature.attributes.STATE_FIPS.toString()];I.attributes=G.feature.attributes;return I},_useLightTheme:function(){var G=!1,I=self.getAppConfig();r.forEach(this._configForLightTheme,function(N){I&&I.theme&&I.theme.name==N.name&&I.theme.styles&&0<I.theme.styles.length&&r.forEach(I.theme.styles,function(M){M==
N.style&&(G=!0)})});I&&I.theme&&I.theme.customStyles&&I.theme.customStyles.mainBackgroundColor&&"#FFFFFF"==I.theme.customStyles.mainBackgroundColor.toUpperCase()&&(G=!0);return G},runReport:function(){if(!h.contains(this.runReportBtn,"jimu-state-disabled")){h.add(this.runReportBtn,"jimu-state-disabled");this.shelter.show();var G=this;this.wizard.selectedPoint.long?this.runReportForPoint().then(function(){G.shelter.hide();h.remove(G.runReportBtn,"jimu-state-disabled")}).otherwise(function(){G.shelter.hide();
h.remove(G.runReportBtn,"jimu-state-disabled")}):this.wizard.selectedPolygon.geometry&&this.runReportForPolygon().then(function(){G.shelter.hide();h.remove(G.runReportBtn,"jimu-state-disabled")}).otherwise(function(){G.shelter.hide();h.remove(G.runReportBtn,"jimu-state-disabled")})}},_enableDisableButton:function(G,I){"string"===typeof I&&"None"!==I?h.remove(G,"jimu-state-disabled"):h.add(G,"jimu-state-disabled")},runReportForPoint:function(){var G=this,I={studyAreas:[]},N={featureSet:{fields:[{name:"OBJECTID",
alias:"Object ID",type:"esriFieldTypeOID"},{name:"STORE_ID",alias:"STORE_ID",type:"esriFieldTypeString",length:1,nullable:!0},{name:"STORE_LONG",alias:"STORE_LONG",type:"esriFieldTypeDouble"},{name:"STORE_LAT",alias:"STORE_LAT",type:"esriFieldTypeDouble"},{name:"AREA_DESC",alias:"AREA_DESC",type:"esriFieldTypeString",length:7,nullable:!0},{name:"AREA_DESC2",alias:"AREA_DESC2",type:"esriFieldTypeString",length:19,nullable:!0}],spatialReference:this.map.spatialReference.toJson(),geometryType:"esriGeometryPolygon",
features:[]}};r.forEach(this.wizard.selectedPoint.tradeAreas,function(M){var O={};O.geometry=M.graphic.geometry;M.graphic.attributes?O.attributes=M.graphic.attributes:G.wizard.selectedPoint.attributes&&(O.attributes=m.clone(G.wizard.selectedPoint.attributes));O.attributes||(O.attributes={});O.attributes.OBJECTID=1;O.attributes.STORE_ID="1";O.attributes.STORE_LONG=G.wizard.selectedPoint.long;O.attributes.STORE_LAT=G.wizard.selectedPoint.lat;O.attributes.AREA_DESC=M.AREA_DESC;O.attributes.AREA_DESC2=
M.AREA_DESC2;N.featureSet.features.push(O)});I.studyAreas.push(N);this.filteredReportDropDown.getSelectedItem().reportType!=D.STANDARD&&(I.areadesc2=this.wizard.selectedPoint.areadesc2);I.locationName=this.wizard.selectedPoint.locationName;I.lat=this.wizard.selectedPoint.lat;I.long=this.wizard.selectedPoint.long;I.sourceCountry=this.wizard.selectedCountryID;I.report=this.filteredReportDropDown.getSelectedItem().item?this.filteredReportDropDown.getSelectedItem().item:this.filteredReportDropDown.getSelectedItem().value;
I.reportDownloadName=this.filteredReportDropDown.getSelectedItem().label;return E.createReport(I)},runReportForPolygon:function(){var G={studyAreas:[]},I={};I=this.isPolygonFIPS(this.wizard.selectedPolygon)?this.GetFIPSStudyArea(this.wizard.selectedPolygon):{geometry:this.wizard.selectedPolygon.geometry.toJson()};this.wizard.selectedPolygon.feature&&this.wizard.selectedPolygon.feature.attributes&&(I.attributes=this.wizard.selectedPolygon.feature.attributes);G.studyAreas.push(I);G.locationName=this.wizard.selectedPolygon.locationName;
G.sourceCountry=this.wizard.selectedCountryID;G.report=this.filteredReportDropDown.getSelectedItem().item?this.filteredReportDropDown.getSelectedItem().item:this.filteredReportDropDown.getSelectedItem().value;G.reportDownloadName=this.filteredReportDropDown.getSelectedItem().label;return E.createReport(G)},backOnClick:function(){this.onBack()}})})},"esri/dijit/geoenrichment/SelectableTree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented ./when dojo/store/util/QueryResults dojo/store/util/SimpleQueryEngine dstore/QueryResults".split(" "),
function(r,p,m,h,f,e,b,c){var d=function(a,g){this.storage=a;this.data=g};d.prototype={storage:null,data:null,filter:function(a){return this.storage._filter(this.data,a)},sort:function(a,g){return this.storage._sort(this.data,a,g)},fetch:function(){return this.storage._fetchRange(this.data)},fetchRange:function(a){return this.storage._fetchRange(this.data,a)},mayHaveChildren:function(a){return this.storage.mayHaveChildren(a)},getChildren:function(a){return this.storage.getChildren(a,{returnCollection:!0})}};
return r(h,{idProperty:"id",bindingProperty:null,autoIdentify:!0,queryEngine:b,isDstoreTree:!1,root:null,data:null,_hash:null,_autoId:null,storage:null,constructor:function(a,g){p.mixin(this,g);this.storage=this;this.root={children:a||[]};p.mixin(this._provideBinding(this.root),{deepness:-1,selectCount:0,leafCount:0});this._hash={};this.idProperty&&this.autoIdentify&&(this._autoId=1);this._initializeNode(this.root,0);this.data=this.root.children},_provideBinding:function(a){var g=this._getBinding(a);
g||(a[this.bindingProperty]=g={});return g},_getBinding:function(a){return this.bindingProperty?a[this.bindingProperty]:a},_initializeNode:function(a,g){var l=this._provideBinding(a);l.selected=!!l.selected;a.children?(l.selectCount=0,l.leafCount=0,m.forEach(a.children,function(k){this._registerNode(k);var n=this._provideBinding(k);n.parent=a;n.deepness=g;this._initializeNode(k,g+1);l.selectCount+=n.selectCount;l.leafCount+=n.leafCount},this),l.selectCount)?l.selectCount===l.leafCount&&(l.selected=
!0):l.selected=!1:("number"!==typeof l.leafCount&&(l.leafCount=1),l.selectCount=l.selected?l.leafCount:0)},isOwned:function(a,g){return g||a!==this.root?this.get(this.getIdentity(a))===a:!0},_registerNode:function(a){this._autoId&&void 0===a[this.idProperty]&&(a[this.idProperty]=this._autoId++);this.idProperty&&(this._hash[a[this.idProperty]]=a)},_unregisterNode:function(a){this.isOwned(a,!0)&&delete this._hash[a[this.idProperty]]},clear:function(){this.root.children.length&&(m.forEach(this.root.children,
function(a){this._unbindNode(a)},this),this.data=this.root.children=[])},destroy:function(){this.clear()},_unbindNode:function(a){a.children&&m.forEach(a.children,function(l){delete this._getBinding(l).parent;this._unbindNode(l)},this);this._unregisterNode(a);var g=this._getBinding(a);g.parent&&(this._incrementCounts(g.parent,-g.selectCount,-g.leafCount),delete g.parent);g!==a&&delete a[this.bindingProperty]},removeNodes:function(a,g){m.forEach(a&&a.slice(),function(l){if(this.isOwned(l,!0)){var k=
this._getBinding(l).parent,n=m.indexOf(k.children,l);0<=n&&k.children.splice(n,1);this._unbindNode(l)}},this);!g&&this.emit("updated")},addNodes:function(a,g,l){if(!g)g=this.root;else if(!this.isOwned(g)||!g.children)return!1;var k=this._getBinding(g).deepness+1,n=0,q=0;m.forEach(a,function(u){if(!this.isOwned(u)){g.children.push(u);this._registerNode(u);var t=this._provideBinding(u);t.parent=g;t.deepness=k;this._initializeNode(u,k+1);n+=t.selectCount;q+=t.leafCount}},this);this._incrementCounts(g,
n,q);!l&&this.emit("updated");return!0},select:function(a,g){return this.changeSelect(a,!0,g)},deselect:function(a){this.changeSelect(a,!1)},changeSelect:function(a,g,l){l=l||this.root.leafCount;var k=a&&this._getBinding(a);if(k){g=!!g;var n=(g?k.leafCount:0)-k.selectCount,q=0>n||this.root.selectCount+n<=l;if(!a.children)return q&&(k.selected=g,n&&this._incrementCounts(a,n)),q;q&&(k.selected=g);m.forEach(a.children,function(u){this.changeSelect(u,g,l)},this);return q}},_incrementCounts:function(a,
g,l){a=this._getBinding(a);a.selectCount+=g;l&&(a.leafCount+=l);a.selectCount?a.selectCount==a.leafCount&&(a.selected=!0):a.selected=!1;a.parent&&this._incrementCounts(a.parent,g,l)},getSelectionState:function(a){if(!this.isOwned(a))return!1;a=this._getBinding(a);return a.selectCount&&a.selectCount!=a.leafCount?"mixed":a.selected=!!a.selectCount},getSelectedNodes:function(a){return this.getDescendingNodes(this.root,!0,a)},getDescendingNodes:function(a,g,l){if(!this.isOwned(a))return[];var k=[];this._collectNodes(a.children,
k,g,l);return k},_collectNodes:function(a,g,l,k){m.forEach(a,function(n){var q=this._getBinding(n),u=null===l||void 0===l?q.leafCount:l?q.selectCount:q.leafCount-q.selectCount;u&&(!n.children||!k&&u==q.leafCount?g.push(n):this._collectNodes(n.children,g,l,k))},this)},inspectChildren:function(a,g,l,k){k&&(g=p.hitch(k,g));a=a||this.root;(a=a.children)&&l&&(a=a.slice(),a.sort(l));return m.every(a,function(n){var q=g(n);return null===q?!1:!1!==q&&n.children?this.inspectChildren(n,g,l):!0},this)},updateExpandedNodes:function(a,
g){for(var l in this._hash)this.updateExpand(this._hash[l],!!a[l]);this._updateOddEven(null,g)},updateExpand:function(a,g,l,k){if(a){var n=!1;a.children&&(a=this._getBinding(a),a.expanded!==g&&(n=!0,a.expanded=g));g={};n&&l&&this._updateOddEven(g,k);return g}},_updateOddEven:function(a,g){var l=1;this.inspectChildren(null,function(k){!1!==k.visible&&(l=1-l);var n=this._getBinding(k);a&&n.isOdd!==l&&(a[this.getIdentity(k)]=l);n.isOdd=l;return!(!k.children||!n.expanded)},g,this)},isOdd:function(a){return(a=
this._getBinding(a))&&a.isOdd},get:function(a){return this._hash[a]},getIdentity:function(a){return this.idProperty?a[this.idProperty]:null},query:function(a,g){return e(this._query(this.data,a,g))},_query:function(a,g,l){return this.queryEngine(g,l)(a)},filter:function(a){return this._filter(this.data,a)},_filter:function(a,g){a=this._query(a,g);return new d(this.storage,a)},sort:function(a,g){return this._sort(this.data,a,g)},_sort:function(a,g,l){"function"===typeof g?(a=a.slice(),a.sort(g)):(g=
Array.isArray(g)?g.map(function(k){return{attribute:k.property,descending:k.descending}}):[{attribute:g,descending:l}],a=this._query(a,{},{sort:g}));return new d(this.storage,a)},mayHaveChildren:function(a){return!!a.children},getChildren:function(a,g){var l=this.isOwned(a,!0)?a.children:null;a=this.isDstoreTree||g&&g.returnCollection;g=this.queryEngine({},a?null:g)(l||[]);return a?new d(this.storage,g):e(g)},fetch:function(){return this._fetchRange(this.data)},fetchRange:function(a){return this._fetchRange(this.data,
a)},_fetchRange:function(a,g){return c(f(g?a.slice(g.start,g.end):a.slice()),{totalLength:f(a.length)})}})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(r,p){function m(h,f){return p(this,function(e){for(var b=0,c=e.length;b<c;b++)h.call(f,e[b],b,e)})}return function(h,f){var e=f&&"totalLength"in f;if(h.then){h=r.delegate(h);var b=h.then(function(c){var d=e?f.totalLength:c.totalLength||c.length;c.totalLength=d;return!e&&d});h.totalLength=e?f.totalLength:b;h.response=
f&&f.response}else h.totalLength=e?f.totalLength:h.length;h.forEach=m;return h}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GEUtil":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojox/uuid/generateRandomUuid esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/UrlUtil ./stdGeographies/StdGeographiesModel".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n){function q(z){return D?D:(z=z&&b.id.findCredential(z)||b.id.credentials[0])&&z.token}function u(z,w){var A=d.urlToObject(z);w=p.mixin({f:"json",token:q(z),langCode:dojo.locale},A.query||{},w);for(var H in w)z=w[H],z instanceof g||z&&"object"===typeof z&&(w[H]=JSON.stringify("function"===typeof z.toJson?z.toJson():z));return{url:A.path,taskParams:w}}function t(z){F||(F=new v(B));return!z||F.initialized?F:F.initialize()}var v=r(null,{url:null,_geInfo:null,_capabilities:null,
_supportedOperations:null,constructor:function(z){this._capabilities={};this._supportedOperations={};this.url=z},_initDfd:null,initialized:!1,initialize:function(){var z=this;if(this._initDfd)return this._initDfd.promise;this._initDfd=new m;l.requestPublicFirst(u(this.url).url+"/Geoenrichment",{content:{f:"json"},handleAs:"json"},{retryOnAnyError:!0}).then(function(w){z.initWithJson(w)});return this._initDfd.promise},initWithJson:function(z){this._geInfo=z;this._capabilities={};this._supportedOperations=
{};z.capabilities&&z.capabilities.forEach(function(w){this._capabilities[w.toLowerCase()]=!0},this);z.supportedOperations&&z.supportedOperations.forEach(function(w){this._supportedOperations[w.toLowerCase()]=!0},this);this._initDfd=this._initDfd||new m;this._initDfd.resolve();this.initialized=!0},hasCapability:function(z){return!!this._capabilities[z.toLowerCase()]},addCapability:function(z){this._capabilities[z.toLowerCase()]=!0},supportsOperation:function(z){return!!this._supportedOperations[z.toLowerCase()]},
enrich:function(z){z=u(this.url,z);z.taskParams.AddDerivativeVariables="all";return c({url:z.url+"/Geoenrichment/Enrich",content:z.taskParams,handleAs:"json"}).then(function(w){return w.results[0].value.FeatureSet||[]})},stdGeographyQuery:function(z){z=u(this.url,z);return c({url:z.url+"/StandardGeographyQuery/execute",content:z.taskParams,handleAs:"json"}).then(function(w){return w.results[0].value.features||[]})},getDataCollections:function(z,w,A){A=u(this.url,A);return c({url:A.url+"/Geoenrichment/DataCollections/"+
z+(w?"/"+w:""),content:A.taskParams,handleAs:"json"}).then(function(H){return H.DataCollections})},getCountries:function(){var z=u(this.url);return c({url:z.url+"/Geoenrichment/Countries",content:z.taskParams,handleAs:"json"}).then(function(w){return w.countries})},getCountryInfo:function(z){var w=this,A=a.get("GEUtil.countries");if(!A[z]){var H=u(this.url);A[z]=c({url:H.url+"/Geoenrichment/Countries/"+z,content:H.taskParams,handleAs:"json"}).then(function(G){var I=G.countries[0],N={};return f(I.hierarchies.map(function(M){return h(w._getStdGeographyModel(z,
M.ID),function(O){N[M.ID]=O})})).then(function(){return{country:I,geographiesModels:N}})})}return A[z]},_getStdGeographyModel:function(z,w){var A=a.get("GEUtil.stdModels"),H=z+w;if(!A[H]){var G=u(this.url);A[H]=c({url:G.url+"/Geoenrichment/StandardGeographyLevels/"+z+"/"+w,content:G.taskParams,handleAs:"json"}).then(function(I){return new n({countryID:z,hierarchyID:w,levels:I.geographyLevels[0].hierarchies[0].levels})})}return A[H]},formatReport:function(z){z=u(this.url,z);return l.request({url:z.url,
urlSuffix:"Geoenrichment/FormatReport"},{handleAs:"bin",content:z.taskParams}).then(function(w){return w&&w.data&&"text/plain"===w.data.type?null:w})},getReports:function(z){var w=u(this.url);return c({url:w.url+"/Geoenrichment/reports/"+z,content:w.taskParams,handleAs:"json"}).then(function(A){return A.reports})},createReport:function(z){var w=u(this.url,z),A=e();a.get("GEUtil.tasks")[A]={taskName:"createReport",taskParams:p.clone(z)};return l.request({url:w.url,urlSuffix:"Geoenrichment/createReport"},
{handleAs:"xml"===z.format?"text":"bin",content:w.taskParams}).then(function(H){return{taskID:A,result:H}})},consumeCredits:function(z){if(z=a.get("GEUtil.tasks")[z])return z=p.clone(z),delete z.taskParams.forStorage,this[z.taskName](z.taskParams)},getLayerInfos:function(z){var w=a.get("GEUtil.dataLayers");w[z]||(w[z]=this._getLayerInfos(z));return w[z]},_getLayerInfos:function(z){var w=u(this.url);return c({url:w.url+"/Geoenrichment/DataLayers/"+z,content:w.taskParams,handleAs:"json"}).then(function(A){return A&&
A.layers||[]}).otherwise(function(A){console.log(A);return[]})},getLayerInfo:function(z,w){var A=a.get("GEUtil.dataLayers"),H=z+"_"+w;A[H]||(A[H]=this._getLayerInfo(z,w));return A[H]},_getLayerInfo:function(z,w){var A=u(this.url);return c({url:A.url+"/Geoenrichment/DataLayers/"+z+"/"+w,content:A.taskParams,handleAs:"json"}).then(function(H){return H&&H.layer}).otherwise(function(H){console.log(H);return null})}}),y={},B,D,E=new m;y.setGeoenrichmentUrl=function(z,w){(B=z||B)&&k.registerCORS(B);D=w||
D;!E.promise.isFulfilled()&&E.resolve()};y.canMakeRequests=function(){return!!B};y.getInitPromise=function(){return E.promise};y.GEClient=v;var F;y.getClient=function(){return t()};y.initialize=function(){return h(t(!0))};y.initWithJson=function(z,w){y.setGeoenrichmentUrl(z);t().initWithJson(w)};y.enrich=function(z){return t().enrich(z)};y.stdGeographyQuery=function(z){return t().stdGeographyQuery(z)};y.getDataCollections=function(z,w,A){return t().getDataCollections(z,w,A)};y.formatReport=function(z){return t().formatReport(z)};
y.createReport=function(z){return t().createReport(z)};y.consumeCredits=function(z){return t().consumeCredits(z)};y.getLayerInfos=function(z){return t().getLayerInfos(z)};y.hasCapability=function(z){return h(t(!0),function(){return F&&F.hasCapability(z)})};y.addCapability=function(z){return t().addCapability(z)};y.supportsOperation=function(z){return h(t(!0),function(){return F&&F.supportsOperation(z)})};y.getCountryInfo=function(z){return t().getCountryInfo(z)};return y})},"esri/dijit/geoenrichment/promise/all":function(){define(["dojo/promise/all"],
function(r){return r})},"dojox/uuid/generateRandomUuid":function(){define(["./_base"],function(){dojox.uuid.generateRandomUuid=function(){function r(){for(var e=Math.floor(Math.random()%1*Math.pow(2,32)).toString(16);8>e.length;)e="0"+e;return e}var p=r(),m=r();m=m.substring(0,4)+"-4"+m.substring(5,8);var h=r();h="8"+h.substring(1,4)+"-"+h.substring(4,8);var f=r();return(p+"-"+m+"-"+h+f).toLowerCase()};return dojox.uuid.generateRandomUuid})},"dojox/uuid/_base":function(){define(["dojo/_base/kernel",
"dojo/_base/lang"],function(r){r.getObject("uuid",!0,dojox);dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};dojox.uuid.assert=function(p,m){if(!p)throw m||(m="An assert statement failed.\nThe method dojox.uuid.assert() was called with a 'false' value.\n"),Error(m);};dojox.uuid.generateNilUuid=function(){return dojox.uuid.NIL_UUID};
dojox.uuid.isValid=function(p){p=p.toString();var m=r.isString(p)&&36==p.length&&p==p.toLowerCase();if(m){p=p.split("-");m=5==p.length&&8==p[0].length&&4==p[1].length&&4==p[2].length&&4==p[3].length&&12==p[4].length;for(var h in p){var f=parseInt(p[h],16);m=m&&isFinite(f)}}return m};dojox.uuid.getVariant=function(p){if(!dojox.uuid._ourVariantLookupTable){var m=dojox.uuid.variant,h=[];h[0]=m.NCS;h[1]=m.NCS;h[2]=m.NCS;h[3]=m.NCS;h[4]=m.NCS;h[5]=m.NCS;h[6]=m.NCS;h[7]=m.NCS;h[8]=m.DCE;h[9]=m.DCE;h[10]=
m.DCE;h[11]=m.DCE;h[12]=m.MICROSOFT;h[13]=m.MICROSOFT;h[14]=m.UNKNOWN;h[15]=m.UNKNOWN;dojox.uuid._ourVariantLookupTable=h}p=p.toString();p=p.charAt(19);p=parseInt(p,16);dojox.uuid.assert(0<=p&&16>=p);return dojox.uuid._ourVariantLookupTable[p]};dojox.uuid.getVersion=function(p){dojox.uuid.assert(dojox.uuid.getVariant(p)==dojox.uuid.variant.DCE,"dojox.uuid.getVersion() was not passed a DCE Variant UUID.");p=p.toString();p=p.charAt(14);return parseInt(p,16)};dojox.uuid.getNode=function(p){dojox.uuid.assert(dojox.uuid.getVersion(p)==
dojox.uuid.version.TIME_BASED,"dojox.uuid.getNode() was not passed a TIME_BASED UUID.");p=p.toString();return p.split("-")[4]};dojox.uuid.getTimestamp=function(p,m){dojox.uuid.assert(dojox.uuid.getVersion(p)==dojox.uuid.version.TIME_BASED,"dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.");p=p.toString();m||(m=null);switch(m){case "string":case String:return dojox.uuid.getTimestamp(p,Date).toUTCString();case "hex":var h=p.split("-");p=h[0];m=h[1];h=h[2];h=h.slice(1);p=h+m+p;dojox.uuid.assert(15==
p.length);return p;case null:case "date":case Date:return h=p.split("-"),p=parseInt(h[0],16),m=parseInt(h[1],16),h=(parseInt(h[2],16)&4095)<<16,h=4294967296*(h+m),h+=p,new Date(h/1E4-122192928E5);default:dojox.uuid.assert(!1,"dojox.uuid.getTimestamp was not passed a valid returnType: "+m)}};return dojox.uuid})},"esri/dijit/geoenrichment/utils/CacheUtil":function(){define([],function(){var r={},p={};r.get=function(m,h){var f=p[m];f||h||(f=p[m]={});return f};r.set=function(m,h){return p[m]=h};r.clear=
function(m,h){p={}};return r})},"esri/dijit/geoenrichment/utils/requests/FileContent":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/utils/DataUtil"],function(r,p){function m(f){return f?/^image\//.test(f)?"base64":/^text\//.test(f)?"text":/application\/json/.test(f)?"json":"bin":"bin"}var h=r(null,{data:null,filename:null,contentType:"application/octet-stream",contentTransferEncoding:"binary",constructor:function(f,e,b){this.data=f;e&&(this.contentType=e);b&&(this.contentTransferEncoding=
b)},getBase64Data:function(){return this.data?"base64"==this.contentTransferEncoding?this.data:p.base64FromByteSource(this.data):null},toString:function(){return this.filename||"\x3cunknown\x3e"}});h.fromArrayBuffer=function(f,e){return new h(p.binaryStringFromByteSource(f),e)};h.fromBlob=function(f,e){return p.arrayBufferFromBlob(f).then(function(b){return new h(p.binaryStringFromByteSource(b),e||f.type)})};h.fromFileData=function(f,e,b){b=b||p.getContentType(f);if("object"==typeof e&&window.ArrayBuffer&&
(e instanceof ArrayBuffer||e.buffer instanceof ArrayBuffer))e=p.binaryStringFromByteSource(e.buffer||e);else{var c=m(b);"json"==c&&"object"==typeof e&&(e=JSON.stringify(e));if("string"!=typeof e)throw Error("Wrong file data.");switch(c){case "base64":e=atob(e);break;case "text":case "json":e=unescape(encodeURIComponent(e))}}e=new h(e,b);e.filename=f;return e};h.getContentConversionType=m;return h})},"esri/dijit/geoenrichment/utils/requests/UniversalClient":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred dojo/request/xhr dojo/io-query dojo/sniff esri/dijit/geoenrichment/when esri/kernel esri/config esri/lang esri/urlUtils ../UrlUtil ./BinaryData ./FileContent ./MultipartDataBuilder ./ErrorUtil".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q){function u(D,E){if(E)this.reject(E);else{E=D.xhr;var F=E.getResponseHeader&&E.getResponseHeader("Content-Type");D.status=E.status;D.data=new l(E.response||E.responseBody||E.responseText,F);this.resolve(D)}}var t=0,v=f("safari"),y=function(D){"string"===typeof D?this.url=D:"object"===typeof D&&r.mixin(this,D)};y.prototype={url:null,preventCache:null,usePost:!1,timeout:0,multipartThreshold:0,useCommonAuth:!1,useProxy:!1,allowSSL:null,send:function(D,E){return this.sendUrlRequest(this.prepareUrlRequest(D,
E),"UniversalClient.send")},prepareUrlRequest:function(D,E){"string"===typeof D?D={urlSuffix:D}:D||(D={});E||(E={});var F=D.url||this.url;D=D.urlSuffix;F||(F=D,D=null);if(!F)throw Error("URL is missing.");var z=a.urlToObject(F);F=g.combine(z.path,D);D=z.query||{};"object"===typeof E.content&&(D=r.mixin(D,E.content));z=E.requireSSL;!0!==z&&!1===this.allowSSL&&(z=!1);!1!==z&&!0===this.allowSSL&&/^https/i.test(window.location.protocol)&&(z=!0);var w=this.getCredential(F,!0);w&&(D.token||!1===D.token||
(D.token=w.token),w.ssl&&!1!==z&&(z=!0));!0===z&&(F=g.toHttpsUrl(F));!1===D.token&&delete D.token;var A=E.handleAs||"json";"json"===A&&(D.f="json");w=(E.sendAs||(E.usePost||this.usePost||D.token?"post":"get")).toLowerCase();z="multipart"==w?!0:E.sendAs||E.sizeLimit?!1:null;var H=0,G=E.multipartThreshold||this.multipartThreshold;for(S in D){var I=D[S];if(I instanceof k)z=!0;else{var N=0,M=S.length;"object"===typeof I?E.allowMultipleValues&&Array.isArray(I)?D[S]=I.map(function(R){R="object"===typeof R?
JSON.stringify(R):R;N+=M+R+2;return R}):(D[S]=JSON.stringify(I),N+=M+D[S].length+2):N=M+(I?I.length:0)+2;!z&&0<G&&(H+=N)}}!1!==z&&0<G&&H>G&&(z=!0);if(E.useProxy||!a.hasSameOrigin(F,window.location.href)&&this.useProxy&&!E.hasOwnProperty("useProxy")){var O=g.getProxyUrl();O&&(F=O+"?"+F)}else a.getProxyRule(F)&&(F=a.getProxyRule(F).proxyUrl+"?"+F);var S=(S=E.hasOwnProperty("preventCache")?E.preventCache:this.preventCache)||null===S&&O||v?"_ts\x3d"+(new Date).getTime()+t++:"";O={handleAs:A};if(A=Number(d.isDefined(E.timeout)?
E.timeout:this.timeout))O.timeout=A;A="get"!==w||z;w=z?null:h.objectToQuery(D);A||(A=w.length+F.length+S.length+1>=c.defaults.io.postLength);O.method=A?"POST":"GET";O.headers={"X-Requested-With":null};O.headers["Content-Type"]="undefined"!==typeof E.contentType?E.contentType:"application/x-www-form-urlencoded; charset\x3dutf-8";z?(z=new n,z.addVariables(D),z.build(O)):A?O.data=w:w&&(F+="?"+w,S&&(F+="\x26"+S),S=null);!w&&S&&(F+="?"+S);return{url:F,options:O,sizeLimit:E.sizeLimit}},getCredential:function(D,
E){if(b.id){var F=b.id.findCredential(D);!F&&this.useCommonAuth&&(F="string"==typeof this.useCommonAuth?b.id.findCredential(this.useCommonAuth):b.id.credentials[0]);if(F){var z={token:F.token};E?z.ssl=F.ssl:z.url=F.ssl?g.toHttpsUrl(D):D;return z}}},sendUrlRequest:function(D,E){var F="string"===typeof D.options.data?D.options.data.length:null;if(D.sizeLimit&&F&&("function"===typeof D.sizeLimit?D.sizeLimit(F):F>D.sizeLimit))return(new p).reject(Error("SIZE_LIMIT_EXCEEDED"));E=E||"UniversalClient.sendUrlRequest";
var z=D.deferred||new p;if(F="bin"===D.options.handleAs)D.options.handleAs="blob";var w=m(D.url,D.options,!0);F&&(w.handleResponse=u);var A=this;w.then(function(H){H="json"===D.options.handleAs&&H&&q.parseError(H)||H;if(H instanceof Error){var G;!0===A.useCommonAuth&&498===H.code&&(G=y.handleInvalidTokenError(H));e(G)["finally"](function(){z.reject(H)})}else z.resolve(A._makeResponse(E,H))},function(H){z.reject(q.makeError(H))});return z.promise},requestToUrl:function(D){if(D.options.headers&&D.options.headers["Content-Type"]&&
0==D.options.headers["Content-Type"].indexOf("multipart/form-data"))return null;var E=D.url;if(D=D.options.data){if(E.length+D.length>=c.defaults.io.postLength)return null;E+="?"+D}return E},_makeResponse:function(D,E){return E}};y.makeError=q.makeError;y.handleInvalidTokenError=function(D){};var B=new y({useCommonAuth:!0,allowSSL:!0});y.request=function(D,E){return B.send(D,E).otherwise(function(F){var z=E&&E.content&&E.content.token;if(498!==F.code||null!=z)return(new p).reject(F);E=r.mixin({},
E);E.content=r.mixin({},E.content);E.content.token=!1;return B.send(D,E)})};y.requestPublicFirst=function(D,E,F){var z=r.mixin({},E);z.content=r.mixin({},E.content);z.content.token=!1;return B.send(D,z).otherwise(function(w){return F&&F.retryOnAnyError||499===w.code||403===w.code?B.send(D,E):(new p).reject(w)})};return y})},"esri/dijit/geoenrichment/utils/requests/BinaryData":function(){define(["dojo/_base/declare"],function(r){return r(null,{data:null,type:null,constructor:function(p,m){this.type=
m||p&&p.type||null;this.data=p}})})},"esri/dijit/geoenrichment/utils/requests/MultipartDataBuilder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/request/util","esri/lang","./FileContent"],function(r,p,m,h,f){function e(d,a){for(var g in a){var l=d[g],k=a[g];l!==k&&(l&&"object"===typeof l&&k&&"object"===typeof k?k instanceof Date?d[g]=new Date(k):e(l,k):d[g]=k)}return d}var b=r(null,{data:null,constructor:function(d){this.data=d}}),c=m.parseArgs;m.parseArgs=function(d,a,g){a.data&&
a.data instanceof b&&(a.data=a.data.data,g=!0);return c(d,a,g)};m.deepCreate=function(d,a){if(a instanceof b)return new b(a.data);a=a||{};var g=p.delegate(d),l,k;for(l in d)(k=d[l])&&"object"===typeof k&&(g[l]=m.deepCreate(k,a[l]));return e(g,a)};return r(null,{addVariables:function(d){for(var a in d)this.addVariable(a,d[a])},addVariable:function(d,a){h.isDefined(a)&&(a instanceof f?this._writeFileContent(d,a):this._writeVariable(d,a.toString()))},build:function(d){this._writeBoundary(!0);d.data=
new b(this._prepareBinaryData());var a=d.headers||{};a["Content-Type"]="multipart/form-data; boundary\x3d"+this._dataProvider.boundary;d.headers=a;this._dataProvider=null},_prepareBinaryData:function(){var d=this._dataProvider.buffer;if(!window.Uint8Array)return d;for(var a=d.length,g=new Uint8Array(new ArrayBuffer(a)),l=0;l<a;l++)g[l]=d.charCodeAt(l);return g},_dataProvider:null,_getDataProvider:function(){if(!this._dataProvider){for(var d="",a=0;32>a;a++)d+=String.fromCharCode(Math.floor(97+25*
Math.random()));this._dataProvider={buffer:"",boundary:d}}return this._dataProvider},_writeVariable:function(d,a){this._writeBoundary();this._writeContentDisposition(d);this._writeLineBreak();this._writeData(this._toUTF8(a));this._writeLineBreak()},_writeFileContent:function(d,a){this._writeBoundary();this._writeContentDisposition(d,a.filename);a.contentType&&(this._writeData("Content-Type: "+a.contentType),this._writeLineBreak());a.contentTransferEncoding&&(this._writeData("Content-Transfer-Encoding: "+
a.contentTransferEncoding),this._writeLineBreak());this._writeLineBreak();this._writeData(a.data);this._writeLineBreak()},_writeBoundary:function(d){this._writeDoubleDash();this._writeData(this._getDataProvider().boundary);d?this._writeDoubleDash():this._writeLineBreak()},_writeContentDisposition:function(d,a){a=a?'"; filename\x3d"'+this._toUTF8(a.replace(/"/g,"'")):"";this._writeData('Content-Disposition: form-data; name\x3d"'+this._toUTF8(d)+a+'"');this._writeLineBreak()},_writeDoubleDash:function(){this._writeData("--")},
_writeLineBreak:function(){this._writeData("\r\n")},_writeData:function(d){this._getDataProvider().buffer+=d},_toUTF8:function(d){return unescape(encodeURIComponent(d))}})})},"esri/dijit/geoenrichment/utils/requests/ErrorUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","require"],function(r,p,m){function h(e){var b=new r;m(["./DataResource"],function(c){p((new c(e)).getFileContent(),b.resolve,b.reject)});return b.promise}var f={getErrorFromBin:function(e){var b=
/^text\/|^application\/json/;return e&&e.type&&!b.test(e.type)?null:p(e&&h(e),function(c){if(c){if(c.hasOwnProperty("contentType")&&!b.test(c.contentType))return null;try{var d=JSON.parse(decodeURIComponent(escape(c.data))),a=f.parseError(d);if(a)return a;if(d.messages&&d.messages.length){var g=d.messages[0];if("esriJobMessageTypeError"==g.type)return Error(g.description)}}catch(l){}}return Error("Binary data error.")})},parseError:function(e){var b;e.error?b=f.makeError(e.error):"error"===e.status&&
(b=f.makeError(e));b&&b.code&&null==b.httpCode&&(b.httpCode=b.code);return b},makeError:function(e){null==e?e=Error():"string"===typeof e&&(e={message:e});if(!(e instanceof Error)&&"object"===typeof e){var b=e;e=Error();b.code&&(e.code=b.code);b.message&&(e.message=b.message);b.details&&(e.details=b.details)}e.log=dojoConfig.isDebug;return e}};return f})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/stdGeographies/StdGeographiesModel":function(){define(["dojo/_base/declare"],
function(r){return r(null,{_levelsCache:null,_levels:null,constructor:function(p){this._initWithLevels(p.levels)},_initWithLevels:function(p){this._levels=p;this._levelsCache={};this._levels.forEach(function(m){delete m.description;this._levelsCache[m.id]=m;m.adminLevel&&(this._levelsCache[m.adminLevel]=m)},this)},getLevels:function(p){return p?this._levels.filter(function(m){return!m.isWholeCountry}):this._levels.slice()},getLevel:function(p){return this._levelsCache[p]},getLevelPluralName:function(p){return(p=
this.getLevel(p))?p.name||p.pluralName:null},toJson:function(){return{levels:this._levels}}})})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayer":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dojo/on dojo/keys dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin ./config ./playerSupports/_CommandSupport ./playerSupports/_LogoSupport ./playerSupports/_MapSupport ./playerSupports/_PageNavigationSupport ./playerSupports/_PrintSupport ./playerSupports/_ReportContainersSwitcher ./playerSupports/_SmartLayoutSupport ./playerSupports/_ZoomSupport ./playerSupports/_WaitingSupport ./supportClasses/PlayerConfigurator ./supportClasses/PlayerToFullScreenAnimator ./toolbar/PlayerToolbar ./ReportPlayerViewModel ./PlayerResizeModes ./PlayerThemes ./PlayerViewModes ./ReportPlayerState ./PlayerZoomBehaviors ./DataProviderGE ./dataProvider/commands/supportClasses/LayoutXMLBuilder esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/InvokeUtil esri/dijit/geoenrichment/utils/async/AsyncQueue dojo/text!./templates/ReportPlayer.html dojo/i18n!esri/nls/jsapi ./_devConfig".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y,B,D,E,F,z,w,A,H,G,I,N,M,O,S,R,V,Z,da,W,ea){W=W.geoenrichment.dijit.ReportPlayer.ReportPlayer;return r([d,a,l,k,n,u,t,v,y,q,B],{templateString:da,nls:W,isPlayer:!0,dataProvider:null,exportCommands:null,config:null,theme:void 0,viewMode:void 0,enableDataDrilling:!0,showToolbarInPopup:!1,showAreaTitle:void 0,showReportTitle:!1,scaleSlidesToFitWindow:void 0,showCloseButton:!1,showToFullScreenAnimation:!1,canAddMoreAreas:!1,areasSelectButtons:null,comparisonSettings:null,
resizeMode:void 0,printConfig:{subtitle:W.preparedByEsri,printDialogClass:"esri/dijit/geoenrichment/ReportPlayer/printing/PageOptionsDialog/PageOptionsDialog"},showProgressBar:!0,defaultZoomBehavior:void 0,nlsMap:null,isDataDrillingPlayer:!1,isPlayerOnServer:!1,_viewModel:null,_reportData:null,_analysisAreaIndex:0,_originalAreaViewMode:null,_showAllAreasSideBySide:!1,playerToolbar:null,postCreate:function(){this.config=p.mixin(g,this.config);if(g.isPlayerOnServer=this.isPlayerOnServer)g.maps.maxNumberOfMapsShownAtTheSameTime=
1E6,this.defaultZoomBehavior=I.RESET;this._viewModel=new (this._getViewModelClass());this._setUpDataProvider();D.configurePlayer(this);!this.isPlayerOnServer&&this._initToolbar();this._initContainerSwither();!this.isPlayerOnServer&&this._initSmartLayout();!this.isPlayerOnServer&&this._initCommands();!this.isPlayerOnServer&&this._initPageNavigationControls();!this.isPlayerOnServer&&this._initZoomControls();!this.isPlayerOnServer&&this._applyTheme();!this.isPlayerOnServer&&this._showError(!1);!this.isPlayerOnServer&&
this._initProgressController();S.isMobileDevice()&&(c.add(this.domNode,"esriGEReportPlayerMobile"),this._setUpMobileOrientationHandling());this._updateElementsVisibility()},_setUpDataProvider:function(){this.dataProvider=this.dataProvider||new N;this.exportCommands&&this.exportCommands.forEach(function(Q){this.dataProvider.registerCommand(Q)},this)},_orientationDfd:null,_setUpMobileOrientationHandling:function(){var Q=this;this.own(e(window,"orientationchange",function(){Q._orientationDfd&&Q._orientationDfd.resolve("cancel");
var X=Q._orientationDfd=new h;Q._showWaiting(X.promise,"orientationchange");X.promise.then(function(U){"cancel"!==U&&(Q._setViewMode(null),Q.refresh())});f(Q.getRenderPromise(),function(){O.delay(500).then(X.resolve,X.resolve)})}))},_getViewModelClass:function(){return z},_setViewMode:function(Q){D.configurePlayer(this,Q);this._refreshZoomControls()},_initToolbar:function(){var Q=this;this.playerToolbar=(new F({player:this,popupButtonDiv:this.playerAfterToolbarDiv,showToolbarInPopup:this.showToolbarInPopup,
showAreaTitle:this.showAreaTitle,stretchToolbarNode:!this.showToolbarInPopup&&(this.resizeMode===w.FIT_WINDOW?document.body:this.domNode),showCloseButton:this.showCloseButton,canAddMoreAreas:this.canAddMoreAreas,areasSelectButtons:this.areasSelectButtons,onShowAnalysisAreaAt:function(X){Q.showAnalysisAreaAt(X)},onCompareAreasSideBySide:function(){Q.showAllAnalysisAreasSideBySide()},onShowPageAt:function(X){Q.showPageAt(X)},isScrollShown:function(){var X=Q.getCurrentReportContainer();return X&&X.isScrollShown&&
X.isScrollShown()},onClose:function(){Q._onClose()},onAddMoreAreas:function(){Q.onAddMoreAreas()},onRemoveAreas:function(X){Q.onAreasPreRemoved(X);X.forEach(function(ka){ka.hidden=!0});if(Q.viewMode===H.PANELS_IN_STACK_ALL)if(2>Q.getAnalysisAreas().filter(function(ka){return!ka.hidden}).length)Q._setAllAreasVisible(!1);else{var U={};X.forEach(function(ka){U[ka.index]=!1});Q.getCurrentReportContainer().setAreasVisibilityState(U,{append:!0});Q._updateAreaSelect()}else if(Q.getCurrentAnalysisArea().hidden){var fa=
Q.getAnalysisAreas().filter(function(ka){return!ka.hidden})[0];fa?Q.showAnalysisAreaAt(fa.index):Q.refresh()}else Q._updateAreaSelect();Q.onAreasRemoved(X)}})).placeAt(this.playerToolbarDiv);this.own(this.playerToolbar);this.showCloseButton&&this.own(e(window,"keyup",function(X){Q.getWaitingPromise()||G.isViewingDataDrillingZoom||G.isImageViewerShown||X.keyCode===b.ESCAPE&&Q._onClose()}))},_applyTheme:function(){c.remove(this.domNode,"playerThemeDark playerThemeLight");c.add(this.domNode,this.theme===
A.DARK?"playerThemeDark":"playerThemeLight");this.playerToolbar.setTheme(this.theme)},playReport:function(Q,X){return this._showWaiting(this._callAfterRendering("_doPlayReport",[Q,X]),"playReport")},_doPlayReport:function(Q,X){this.playerToolbar&&this.playerToolbar.closePopup();var U=this;this._showError(!1);this._progressController&&this._progressController.reset();this.showToFullScreenAnimation&&this.resizeMode===w.FIT_WINDOW&&E.animateTo(this);this.dataProvider._onCreateReportStarted=function(){U._viewModel.preInitialize()};
this._viewModel.reset();return f(this.dataProvider.getReportData(Q,{progressCallback:function(fa){U._progressController&&U._progressController.setLoadDataProgress(fa)}}),function(fa){if(U.viewMode===H.PANELS_IN_STACK_ALL){var ka=U.viewMode;1<fa.analysisAreas.length&&!fa.isMultiFeature?U._originalAreaViewMode||(U._showAllAreasSideBySide=!0,U._originalAreaViewMode=D.getDefaultViewMode(U)):(U._showAllAreasSideBySide=!1,ka=U._originalAreaViewMode||D.getDefaultViewMode(U));U._setViewMode(ka)}return U.setReportData(fa,
X)},function(fa){U._showError(fa)})},refresh:function(Q){return this._reportData&&f(this.setReportData(this._reportData,{waitUntilAllContentIsReady:!(!Q||!Q.waitUntilAllContentIsReady)}),function(){this.showPageAt(0);return this.resize()}.bind(this))},_isDataBeingSetFlag:!1,_notifyShownPendingFlag:!1,setReportData:function(Q,X){return this._showWaiting(this._callAfterRendering("_doSetReportData",[Q,X]),"setReportData")},setReportDataAndExport:function(Q,X){var U=this;if(Q.reportObject.isMultiFeature)return this.setReportData(Q,
{waitUntilAllContentIsReady:!0,disableAnimation:!0}).then(function(){return U.executeCommand(X.commandId,X.commandParams)});var fa=new h,ka=0,oa=[],C=function(){var J=U.dataProvider.reportDataToSingleAreaReportData(Q,{currentFeatureIndex:ka,reportTitle:Q.reportTitle,templateJson:Q.templateJson});U.setReportData(J,{waitUntilAllContentIsReady:!0,disableAnimation:!0}).then(function(){var L=p.mixin({},X.commandParams);L.pageNumerationInfo={startAreaIndex:ka,numAreas:Q.analysisAreas.length};return f(U.executeCommand(X.commandId,
L)).then(function(K){oa.push(K);++ka===Q.analysisAreas.length?fa.resolve(M.stitchDocuments(oa)):setTimeout(C)})})};C();return fa.promise},_doSetReportData:function(Q,X){var U=this;X=X||{};this._reportData=Q;ea.emulateErrors.playerError&&(Q=null);if(!Q||ea.emulateErrors.emptyDataProviderResponse)this._showError(!0);else{this._isDataBeingSetFlag=!0;G.isAnimationSuspended=!0;this.onSetReportDataStart();var fa=new h;this._viewModel.setAnimationAllowed(!X.disableAnimation);this._configureViewModel(Q);
(U.isPlayerOnServer?f():O.delay(0)).then(function(){if(1===Q.analysisAreas.length||Q.isMultiFeature)U._destroyAllContainers(),U._resetMapBuilder(),U._applyReportData({analysisAreaIndex:0,rerenderContent:!0}).then(fa.resolve,fa.reject);else{!1!==X._resetLoadedContents&&(U._destroyAllContainers(),U._resetMapBuilder());var ka=Q.analysisAreas.length-1,oa=function(){for(;0<=ka&&Q.analysisAreas[ka].hidden;)ka--;0>ka?fa.resolve():U._applyReportData({analysisAreaIndex:ka--,rerenderContent:!1,isFinalArea:0>
ka}).then(function(){(U.isPlayerOnServer?f():O.delay(0)).then(oa)},fa.reject)};oa()}});this._progressController&&this._progressController.setNumAreas(Q.analysisAreas.length);this._progressController&&this._progressController.setLoadDataProgress(1);return fa.promise.then(function(){return U._progressController&&U._progressController.finalize()}).otherwise(function(ka){U._showError(ka)}).always(function(){var ka=U.getCurrentReportContainer();if(ka&&ka.domNode)return(U.isPlayerOnServer?f():O.delay(300)).then(function(){U._isDataBeingSetFlag=
!1;U._notifyShownPendingFlag=!R.isNodeInLayout(U.domNode);G.isAnimationSuspended=U.isPlayerOnServer;U.onSetReportDataEnd();U._emitPendingResizedEvent();U._progressController&&U._progressController.reset();if(X.waitUntilAllContentIsReady)return U.getRenderPromise()})})}},showAnalysisAreaAt:function(Q){return this._callAfterRendering("_doShowAnalysisAreaAt",[Q])},_doShowAnalysisAreaAt:function(Q){var X=this;return f(this._setAllAreasVisible(!1),function(){if(X._analysisAreaIndex!==Q&&X.getAnalysisAreas()[Q]&&
!X.getAnalysisAreas()[Q].hidden)return X._applyReportData({analysisAreaIndex:Q,rerenderContent:!1})})},showAllAnalysisAreasSideBySide:function(){return this._callAfterRendering("_doShowAllAnalysisAreasSideBySide")},_doShowAllAnalysisAreasSideBySide:function(){return this._setAllAreasVisible(!0)},_setAllAreasVisible:function(Q){if(this._showAllAreasSideBySide!==Q)return Q?(this._showAllAreasSideBySide=!0,this._originalAreaViewMode=this.viewMode===H.PANELS_IN_STACK_ALL?D.getDefaultViewMode(this):this.viewMode,
this._setViewMode(H.PANELS_IN_STACK_ALL)):(this._showAllAreasSideBySide=!1,this._setViewMode(this._originalAreaViewMode),this._originalAreaViewMode=null),this.refresh()},_applyReportData:function(Q){var X=this;Q=Q||{};var U=this._reportData&&this._reportData.isMultiFeature?0:Q.analysisAreaIndex||0,fa=!1!==Q.rerenderContent;this._analysisAreaIndex=U;this._showError(!this._reportData);if(this._reportData)return f(this._viewModel.initialize(!this._reportData.reportObject.isGraphicReport,this.viewMode),
function(){return X._setReportContainer(fa)?X._doApplyTemplateJson({analysisAreaIndex:U,isFinalArea:Q.isFinalArea}):X._updateAreaSelect()})},_doApplyTemplateJson:function(Q){var X=this,U=this.getCurrentReportContainer(),fa=p.clone(this._reportData.templateJson);ea.emulateErrors.emptyTemplateJson&&(fa.sectionsTables.length=0);var ka=U.fromJson(fa,{waitUntilAllContentIsReady:!0,progressCallback:function(oa){X._progressController&&X._progressController.setProgressForAreaAt(oa,Q.analysisAreaIndex)},analysisAreaIndex:Q.analysisAreaIndex,
isFinalArea:Q.isFinalArea,renderSync:this.isPlayerOnServer});fa=U.getPagePromise?U.getPagePromise():ka;U=U.getContentPromise?U.getContentPromise():ka;this._registerContainerLoadPromise(U||fa);this._updateAreaSelect();return f(fa,function(){X._setCurrentContainerLoaded();X.showPageAt(X._currentPageIndex);return X.resize()})},_updateAreaSelect:function(){this.playerToolbar&&this.playerToolbar.updateAreaSelect({analysisAreas:this._reportData.analysisAreas,combinedAreasInfo:this._reportData.combinedAreasInfo,
currentAreaIndex:this._showAllAreasSideBySide?"all":this.getCurrentAnalysisAreaIndex(),isMultiFeature:this._reportData.isMultiFeature})},getReportData:function(){return this._reportData},getReportTitle:function(){return this._reportData&&this._reportData.reportTitle||""},getCurrentAnalysisAreaIndex:function(){return this._analysisAreaIndex},getCurrentAnalysisArea:function(){return this._reportData&&this._reportData.analysisAreas[this._analysisAreaIndex]},getAnalysisAreas:function(){return this._reportData&&
this._reportData.analysisAreas},reportDataToJson:function(Q){return this._showWaiting(this.dataProvider.reportDataToJson(this.getReportData(),Q),"reportDataToJson")},reportDataFromJson:function(Q,X){var U=this;this._showError(!1);return this._showWaiting(f(this.dataProvider.reportDataFromJson(Q),function(fa){return U.setReportData(fa,X)}),"reportDataFromJson")},_configureViewModel:function(Q){this._viewModel.setTheme(this._reportData.templateJson.theme);this._viewModel.enableDataDrilling=!this.isPlayerOnServer&&
this.enableDataDrilling;this._viewModel.setDynamicReportInfo({fieldData:this._reportData.fieldData,analysisAreas:this._reportData.analysisAreas,combinedAreasInfo:this._reportData.combinedAreasInfo,attachmentsStore:this._reportData.attachmentsStore,createMapFunc:p.hitch(this,this._createMap),reportObject:this._reportData.reportObject,isMultiFeature:this._reportData.isMultiFeature,isFixedDataMode:!this._reportData.config.geoenrichmentUrl,geClient:this._reportData.geClient,templateVariableProvider:this._reportData.templateVariableProvider,
countryID:this._reportData.config.countryID,hierarchy:this._reportData.config.hierarchy,templateJson:this._reportData.templateJson});this._viewModel.getDynamicImageFunc=p.hitch(this,this._getReportLogo)},notifyShown:function(){!this._isDataBeingSetFlag&&this._notifyShownPendingFlag&&(this.getCurrentReportContainer()&&this.getCurrentReportContainer().notifyShown(),this._notifyShownPendingFlag=!1)},_isErrorShown:!1,_showError:function(Q){this.errorViewDiv&&R.destroy(this.errorViewDiv);this.errorViewDiv=
null;R[Q?"hide":"show"](this.printableDivContainer);c[Q?"add":"remove"](this.domNode,"esriGEReportPlayerError");this._isErrorShown=!!Q;this._updateElementsVisibility();Q?(this.errorViewDiv=R.create("div",{"class":"esriGEReportPlayerErrorMessage",innerHTML:W.cantPlayReportError},this.domNode),this.playerToolbar&&this.playerToolbar.setErrorShown(!0),this._progressController&&this._progressController.reset(),console.log(Q),this.onError(Q)):this.playerToolbar&&this.playerToolbar.setErrorShown(!1)},isErrorShown:function(){return this._isErrorShown},
_updateElementsVisibility:function(){var Q=0<this._waitingCount?!1:this._reportData||this._isErrorShown,X=0<this._waitingCount||this._isErrorShown?!1:!0,U=0<this._waitingCount||this._isErrorShown?!1:!0;this.playerToolbarDiv&&(this.playerToolbarDiv.style.opacity=Q?"":"0.001");this.sidePageNavigator&&(this.sidePageNavigator.style.opacity=X?"":"0.001");this.reportContainerDiv.style.opacity=U?"":"0.001"},setPrintMode:function(Q){c[Q?"add":"remove"](this.domNode,"esriGEReportPlayerInPrinting")},resize:function(Q,
X){this._resize({width:Q,height:X});this._updatePageNavigator();this._updateZoomControls();this.playerToolbar&&this.playerToolbar.update()},_pendingResizeEvent:null,_emitResizedEvent:function(Q){this._pendingResizeEvent={isPaginating:!!Q};this._isDataBeingSetFlag||this._emitPendingResizedEvent()},_emitPendingResizedEvent:function(){this._pendingResizeEvent&&(this.onResized(this._pendingResizeEvent.isPaginating),this._pendingResizeEvent=null)},_onClose:function(){var Q;this.showToFullScreenAnimation&&
this.resizeMode===w.FIT_WINDOW&&(Q=E.animateFrom(this));f(Q,function(){this.onClose()}.bind(this))},getVisualState:function(){return{type:"reportPlayer",viewMode:this.viewMode,reportContainers:this.getAllReportContainers().map(function(Q){return Q.getVisualState&&Q.getVisualState()})}},setVisualState:function(Q){return this._callAfterRendering("_doSetVisualState",[Q])},_doSetVisualState:function(Q){var X=Q&&this.getAllReportContainers().map(function(U,fa){return U.setVisualState&&U.setVisualState(Q.reportContainers[fa])});
return m(X)},_renderQueue:null,getRenderPromise:function(){return this._renderQueue&&this._renderQueue.getPromise()},_registerContainerLoadPromise:function(Q){this._renderQueue=this._renderQueue||new Z;this._renderQueue.add(Q);this.playerToolbar&&this.playerToolbar.setContentLoadPromise(this.getRenderPromise())},_safeFuncCaller:null,_callAfterRendering:function(Q,X){if(this.isPlayerOnServer)return this[Q].apply(this,X);var U=this;this._safeFuncCaller=this._safeFuncCaller||{};this._safeFuncCaller[Q]=
function(){return U[Q].apply(U,X)};return f(this.getRenderPromise(),function(){return V.invoke(U._safeFuncCaller,Q)})},onSetReportDataStart:function(){},onSetReportDataEnd:function(){},onResized:function(Q){},onClose:function(){},onError:function(Q){},onAddMoreAreas:function(){},onAreasPreRemoved:function(Q){},onAreasRemoved:function(Q){},destroy:function(){this._destroyAllContainers();this.inherited(arguments)}})})},"esri/dijit/geoenrichment/ReportPlayer/config":function(){define(["esri/kernel"],
function(r){function p(m){m=m.split(".");return Number((Number(m[0])+Number(m[1])/100).toFixed(2))}r=Math.max(p("3.35"),p(r.version)).toFixed(2);return{jsapiVersion:r,esriDijitCssUrl:"https://js.arcgis.com/"+r+"/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/"+r+"/esri/css/esri.css",playerSourceRootUrl:"https://js.arcgis.com/"+r+"/",configScriptText:null,env:"prod",isPlayerOnServer:!1,updateVariableInfoFromDataXml:!0,runReportTask:{cacheResult:!0,ignoreErrors:!0,secondAttempt:!0},
maps:{maxNumberOfMapsShownAtTheSameTime:6},charts:{showErrorIfHasUnavailableData:!1},tables:{leaveEmptyCellsUponError:!0,showUnavailableData:!0},createImageCommand:{skipSavingFile:!1},createPDFCommand:{skipSavingFile:!1,skipCreditConsumption:!1},createPlayerCommand:{loadMapPortalItems:!0,compressData:!1,prettifyDataJson:!1,skipCreditConsumption:!1},exportToExcel:{skipSavingFile:!1},modules:{exportCommands:!0,complexCellTooltips:!0,paths:{panoramicViewer:null}},generalization:{factor:-1,maxVerticesInAllFeatures:1E5,
numVerticesPerFeature:5E4}}})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_CommandSupport":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/PlayerCommands esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),function(r,p,m,h,f,e,b){return r(null,{_initCommands:function(){b.isMobileDevice()||!e.modules.exportCommands?this.playerToolbar.notifyCommandButtonsAdded():
h(this.dataProvider.getCommands&&this.dataProvider.getCommands(),function(c){this._createCommandButtons(c);this.playerToolbar&&this.playerToolbar.notifyCommandButtonsAdded()}.bind(this))},_lastNonPrintCommandId:null,_executeExportCallback:null,_executePrintCallback:null,_createCommandButtons:function(c){function d(k){var n=new m,q=new m;a.onCommandSettingsShown(n.promise);a._saveVisualState();h(a._getPrintableContainer({commandId:k,showDialog:!0}),function(u){if(u){var t=u.getSelectedCommandId();
t&&t!==f.PRINT&&(a._lastNonPrintCommandId=t);h(a._executeCommand(t,{printableContainer:u}),q.resolve,q.reject)}else h(a._applySavedVisualState(),function(){a.onCommandCanceled();q.resolve()})}).always(n.resolve);return q.promise}var a=this;if(c&&c.length){var g,l=c.filter(function(k){return k.id===f.PRINT?(g=k,!1):!0});l.length&&(this._executeExportCallback=function(){return d(a._lastNonPrintCommandId||l[0].id)},this._createCommandButton(l[0],this._executeExportCallback));g&&(this._executePrintCallback=
function(){return d(g.id)},this._createCommandButton(g,this._executePrintCallback))}},executeExport:function(){return this._executeExportCallback&&this._executeExportCallback()},executePrint:function(){return this._executePrintCallback&&this._executePrintCallback()},_createCommandButton:function(c,d){return this.playerToolbar&&this.playerToolbar.createCommandButton(c,d)},getCommandExportDialogSettings:function(){return this._getPrintDialogSettings()},executeCommand:function(c,d){d=d||{};this._saveVisualState();
var a=this._viewModel.dynamicReportInfo.fieldData;!this.isPlayerOnServer||c!==f.PDF&&c!==f.IMAGE||(d.exportSettings=p.mixin({},a.reportInfo&&a.reportInfo.exportSettings,d.exportSettings));var g=this;return h(this._getPrintableContainer({commandId:c,showDialog:!1,exportSettings:d.exportSettings}),function(l){return g._executeCommand(c,p.mixin({printableContainer:l},d))})},_executeCommand:function(c,d){function a(){h(g.dataProvider.executeCommand&&g.dataProvider.executeCommand(c,g,d,function(q){g.onCommandProgress(q)}),
k.resolve,k.reject)}var g=this,l=this._viewModel.dynamicReportInfo.fieldData;c!==f.PDF&&c!==f.DYNAMIC_HTML||!l.runReportTaskIDs||(d.creditsTaskIDs=l.runReportTaskIDs);var k=new m;this.isPlayerOnServer?a():setTimeout(a);var n=k.promise.then(function(q){return h(g._applySavedVisualState(),function(){return q})});this.onCommandStart(n,c);this._showWaiting(n,"executeCommand");n.always(function(){g.onCommandEnd(n)});return n},_visualStateMemo:null,_saveVisualState:function(){this._visualStateMemo=this.getVisualState()},
_applySavedVisualState:function(){var c=this;return this.setVisualState(this._visualStateMemo).then(function(){c._visualStateMemo=null})},onCommandSettingsShown:function(c){},onCommandCanceled:function(){},onCommandStart:function(c,d){},onCommandProgress:function(c){},onCommandEnd:function(c){}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerCommands":function(){define([],function(){var r={HTML:"createHTML",PDF:"createPDF",PRINT:"print",DYNAMIC_HTML:"createDynamicHTML",IMAGE:"createImage",EXCEL:"exportToExcel",
isSupported:function(p){for(var m in r)if(r[m]===p)return!0;return!1}};return r})},"esri/dijit/geoenrichment/utils/DeviceUtil":function(){define(["dojo/sniff","dojo/domReady!"],function(r){var p={},m=function(){var f=window,e=f.navigator.platform,b=f.navigator.userAgent,c={ios:!1,android:!1,androidChrome:!1,desktop:!1,iphone:!1,ipod:!1,ipad:!1,edge:!1,ie:!1,firefox:!1,macos:!1,windows:!1,cordova:!(!f.cordova&&!f.phonegap),phonegap:!(!f.cordova&&!f.phonegap),electron:!1,nwjs:!1},d=f.screen.width,a=
f.screen.height,g=b.match(/(Android);?[\s\/]+([\d.]+)?/),l=b.match(/(iPad).*OS\s([\d_]+)/),k=b.match(/(iPod)(.*OS\s([\d_]+))?/),n=!l&&b.match(/(iPhone\sOS|iOS)\s([\d_]+)/),q=0<=b.indexOf("MSIE ")||0<=b.indexOf("Trident/"),u=0<=b.indexOf("Edge/"),t=0<=b.indexOf("Gecko/")&&0<=b.indexOf("Firefox/"),v="Win32"===e,y=0<=b.toLowerCase().indexOf("electron"),B="undefined"!==typeof nw&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.nw;e="MacIntel"===
e;var D="1024x1366 1366x1024 834x1194 1194x834 834x1112 1112x834 768x1024 1024x768".split(" ");!l&&e&&r("touch")&&0<=D.indexOf(d+"x"+a)&&((l=b.match(/(Version)\/([\d.]+)/))||(l=[0,1,"13_0_0"]),e=!1);c.ie=q;c.edge=u;c.firefox=t;g&&!v&&(c.os="android",c.osVersion=g[2],c.android=!0,c.androidChrome=0<=b.toLowerCase().indexOf("chrome"));if(l||n||k)c.os="ios",c.ios=!0;n&&!k&&(c.osVersion=n[2].replace(/_/g,"."),c.iphone=!0);l&&(c.osVersion=l[2].replace(/_/g,"."),c.ipad=!0);k&&(c.osVersion=k[3]?k[3].replace(/_/g,
"."):null,c.ipod=!0);c.ios&&c.osVersion&&0<=b.indexOf("Version/")&&"10"===c.osVersion.split(".")[0]&&(c.osVersion=b.toLowerCase().split("version/")[1].split(" ")[0]);c.webView=!(!(n||l||k)||!b.match(/.*AppleWebKit(?!.*Safari)/i)&&!f.navigator.standalone)||f.matchMedia&&f.matchMedia("(display-mode: standalone)").matches;c.webview=c.webView;c.standalone=c.webView;c.desktop=!(c.ios||c.android)||y||B;c.desktop&&(c.electron=y,c.nwjs=B,c.macos=e,c.windows=v,c.macos&&(c.os="macos"),c.windows&&(c.os="windows"));
c.pixelRatio=f.devicePixelRatio||1;return c}();p.device=m;p.isMobileDevice=function(){return!m.desktop};p.isPCWithTouchScreen=function(){return m.desktop&&r("touch")};p.isLandscape=function(){return 90===Math.abs(window.orientation)};var h=null;p.isWebLayout=function(){if(!h){var f=document.createElement("div");f.style="visibility:hidden;height:1in;width:1in;position:absolute;left: -100%;top:-100%;";document.body.appendChild(f);h=f.offsetHeight;f.parentNode.removeChild(f)}f=h;f*=7;var e=document.body.offsetWidth;
if(e>=f)return!0;var b=document.body.offsetHeight;return e>=b&&Math.sqrt(e*e+b*b)>=f?!0:!1};p.press=m.desktop?"mousedown":"touchstart";p.release=m.desktop?"mouseup":"touchend";p.click=m.desktop?"click":"touchend";p.clickOrRelease=m.desktop?"click, mouseup":"touchend";p.move=m.desktop?"mousemove":"touchmove";return p})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_LogoSupport":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/when","../core/annotations/supportClasses/DynamicBehaviors",
"../core/supportClasses/images/DefaultLogoLoader"],function(r,p,m,h){return r(null,{_getReportLogo:function(f,e,b){function c(){return p(d._reportData.attachmentsStore&&d._reportData.attachmentsStore.getImages(),function(a){return p(a&&a[0]&&a[0].getThumbnail(),function(g){return g||d._getDefaultLogo(e,b)})})}var d=this;switch(f){case m.ATTACHMENTS:return c();default:return this._getDefaultLogo(e,b)}},_getDefaultLogo:function(f,e){return this._reportData.customLogo||e||h.getDefaultLogo(this._viewModel.getDocumentDefaultStyles())}})})},
"esri/dijit/geoenrichment/ReportPlayer/core/annotations/supportClasses/DynamicBehaviors":function(){define([],function(){var r={ATTACHMENTS:"attachments",LOGO:"logo",toSupportedValue:function(p,m){return p===r.ATTACHMENTS?p:p||m?r.LOGO:null}};return r})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/images/DefaultLogoLoader":function(){define(["require","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/utils/ColorUtil"],function(r,p,m){return{_identifyDefaultLogoBackground:function(h){return!h||
m.isTransparent(h.backgroundColor)?"transparent":m.isLightColor(h.backgroundColor)?"light":"dark"},_loadLogo:function(h){var f=new p;r(["./"+h],function(e){f.resolve(e)});return f.promise},getDefaultLogo:function(h){switch(this._identifyDefaultLogoBackground(h)){case "light":return this._loadLogo("DefaultLogoGraphicReportDark");case "dark":return this._loadLogo("DefaultLogoGraphicReportLight");default:return this._loadLogo("DefaultLogoGraphicReportGeneric")}}}})},"esri/dijit/geoenrichment/utils/ColorUtil":function(){define(["dojo/_base/Color",
"dojox/color/_base","dojox/color/Palette"],function(r,p,m){function h(e,b,c){return Math.round((e&255)*(1-c)+(b&255)*c)}var f={toCSSColor:function(e,b,c){"string"!==typeof e||/^0x/i.test(e)||(e=r.fromString(e));if(e instanceof r)return b||1===e.a?e.toHex():e.toCss(!0);if(null==e||isNaN(e))return c?f.toCSSColor(c,b):"#000000";e="00000"+Number(e).toString(16);return"#"+e.substr(e.length-6)},toColor:function(e,b){return"object"===typeof e?(new r).setColor(e):r.fromString(f.toCSSColor(e,!1,b))},getCSSColorWithAlpha:function(e,
b){return f.toCSSColor(f.getColorWithAlpha(e,b))},getColorWithAlpha:function(e,b){e=(new r).setColor(e);e.a=b;return e},transform:function(e,b){var c=new m;c.colors=[new r(e)];return c.transform({use:void 0!==b.dl?"hsl":"hsv",dh:b.dh||0,ds:b.ds||0,dv:b.dv||0,dl:b.dl||0}).colors[0]},generateAnalogousColorScheme:function(e,b,c){return m.generators.analogous({base:e,high:b,low:c}).colors},applyColorHue:function(e,b){e=new p.Color(e);b=new p.Color(b);e=e.toHsl();var c=b.toHsl();e=p.fromHsl({h:e.h,s:0===
e.s?0:0===c.s?e.s:c.s,l:c.l});e.a=b.a;return e},getColorParams:function(e){e=new p.Color(e);var b=e.toHsv();b.l=e.toHsl().l;return b},generateGradient:function(e,b){e=e.map(f.toRGBColor);var c=[];if(0===e.length-1||1===b){e=e[0];for(var d=0;d<b;d++)c.push(e);return c}var a=1/(b-1);for(d=0;d<b;d++)c.push(f.getGradientRGBColor(e,d*a));return c},getGradientRGBColor:function(e,b,c){var d=e.length-1,a=1>d||0>=b?0:1<=b?d:-1;if(0<=a)return e[a];b*=d;a=Math.floor(b);a===d&&a--;return f.mixRGBColors(e[a],
e[a+1],b-a,c)},mixRGBColors:function(e,b,c,d){1<c?c=1:0>c&&(c=0);var a=h(e,b,c),g=h(e>>8,b>>8,c),l=h(e>>16,b>>16,c);return((d?h(e>>24,b>>24,c):0)<<24)+(l<<16)+(g<<8)+a},toRGBColor:function(e,b){e=f.toCSSColor(e,!0,b);return parseInt("0x"+e.substr(1))},getContrastColor:function(e,b,c,d){return f.isLightColor(e,d)?f.toColor(b,"#000000"):f.toColor(c,"#FFFFFF")},getHighlightColor:function(e,b){b=b||{};e=new p.Color(e);x=e.toHsl();if("darker"===b.method)x.l=50>x.l?x.l+30:x.l-20,0<x.s&&(x.s+=30);else{var c=
b.saturation||100,d=b.luminosity1||75;b=b.luminosity2||50;0===x.s?x.l=50>x.l?x.l+30:x.l-20:(x.s=c,x.l=x.l<b?d:x.l>d?b:x.l-b>d-x.l?b:d)}b=p.fromHsl(x);b.a=e.a;return b},getLightness:function(e){e=f.toRGBColor(e);return(299*(e>>16&255)+587*(e>>8&255)+114*(e&255))/1E3},isLightColor:function(e,b){return f.getLightness(e)>=(void 0===b?128:b)},colorsEqual:function(e,b){e instanceof r||(e=f.toColor(e));b instanceof r||(b=f.toColor(b));return e.a==b.a&&e.r==b.r&&e.g==b.g&&e.b==b.b},isTransparent:function(e){e=
f.toCSSColor(e);return"rgba(0,0,0,0)"===e.toLowerCase().replace(/\s/g,"")},generateRandomColor:function(e){function b(){return c+Math.round((d-c)*Math.random())}e=e||{};var c=e.min||0,d=e.max||255,a=e.randomizeAlpha?b():1;return e.grayScheme?(e=b(),new r([e,e,e,a])):new r([b(),b(),b(),a])}};return f})},"dojox/color/Palette":function(){define(["dojo/_base/lang","dojo/_base/array","./_base"],function(r,p,m){function h(d,a,g){var l=new m.Palette;l.colors=[];p.forEach(d.colors,function(k){l.colors.push(new m.Color({r:Math.min(255,
Math.max(0,"dr"==a?k.r+g:k.r)),g:Math.min(255,Math.max(0,"dg"==a?k.g+g:k.g)),b:Math.min(255,Math.max(0,"db"==a?k.b+g:k.b)),a:Math.min(1,Math.max(0,"da"==a?k.a+g:k.a))}))});return l}function f(d,a,g){var l=new m.Palette;l.colors=[];p.forEach(d.colors,function(k){k=k.toCmy();l.colors.push(m.fromCmy(Math.min(100,Math.max(0,"dc"==a?k.c+g:k.c)),Math.min(100,Math.max(0,"dm"==a?k.m+g:k.m)),Math.min(100,Math.max(0,"dy"==a?k.y+g:k.y))))});return l}function e(d,a,g){var l=new m.Palette;l.colors=[];p.forEach(d.colors,
function(k){k=k.toCmyk();l.colors.push(m.fromCmyk(Math.min(100,Math.max(0,"dc"==a?k.c+g:k.c)),Math.min(100,Math.max(0,"dm"==a?k.m+g:k.m)),Math.min(100,Math.max(0,"dy"==a?k.y+g:k.y)),Math.min(100,Math.max(0,"dk"==a?k.b+g:k.b))))});return l}function b(d,a,g){var l=new m.Palette;l.colors=[];p.forEach(d.colors,function(k){k=k.toHsl();l.colors.push(m.fromHsl(("dh"==a?k.h+g:k.h)%360,Math.min(100,Math.max(0,"ds"==a?k.s+g:k.s)),Math.min(100,Math.max(0,"dl"==a?k.l+g:k.l))))});return l}function c(d,a,g){var l=
new m.Palette;l.colors=[];p.forEach(d.colors,function(k){k=k.toHsv();l.colors.push(m.fromHsv(("dh"==a?k.h+g:k.h)%360,Math.min(100,Math.max(0,"ds"==a?k.s+g:k.s)),Math.min(100,Math.max(0,"dv"==a?k.v+g:k.v))))});return l}m.Palette=function(d){this.colors=[];d instanceof m.Palette?this.colors=d.colors.slice(0):d instanceof m.Color?this.colors=[null,null,d,null,null]:r.isArray(d)?this.colors=p.map(d.slice(0),function(a){return r.isString(a)?new m.Color(a):a}):r.isString(d)&&(this.colors=[null,null,new m.Color(d),
null,null])};r.extend(m.Palette,{transform:function(d){var a=h;if(d.use){var g=d.use.toLowerCase();0==g.indexOf("hs")?a="l"==g.charAt(2)?b:c:0==g.indexOf("cmy")&&(a="k"==g.charAt(3)?e:f)}else if("dc"in d||"dm"in d||"dy"in d)a="dk"in d?e:f;else if("dh"in d||"ds"in d)a="dv"in d?c:b;g=this;for(var l in d)"use"!=l&&(g=a(g,l,d[l]));return g},clone:function(){return new m.Palette(this)}});r.mixin(m.Palette,{generators:{analogous:function(d){var a=d.high||60,g=d.low||18;d=(r.isString(d.base)?new m.Color(d.base):
d.base).toHsv();var l=Math.max(10,95>=d.s?d.s+5:100-(d.s-95)),k=92<=d.v?d.v-9:Math.max(d.v+9,20),n=90>=d.v?Math.max(d.v+5,20):95+Math.ceil((d.v-90)/2),q=[l,1<d.s?d.s-1:21-d.s,d.s,l,l],u=[k,n,d.v,k,n];return new m.Palette(p.map([(d.h+g+360)%360,(d.h+Math.round(g/2)+360)%360,d.h,(d.h-Math.round(a/2)+360)%360,(d.h-a+360)%360],function(t,v){return m.fromHsv(t,q[v],u[v])}))},monochromatic:function(d){d=r.isString(d.base)?new m.Color(d.base):d.base;var a=d.toHsv(),g=9<a.s-30?a.s-30:a.s+30,l=a.s,k=20<a.v-
20?a.v-20:a.v+60,n=20<a.v-50?a.v-50:a.v+30;return new m.Palette([m.fromHsv(a.h,g,100-.8*(100-a.v)),m.fromHsv(a.h,l,n),d,m.fromHsv(a.h,g,n),m.fromHsv(a.h,l,k)])},triadic:function(d){d=r.isString(d.base)?new m.Color(d.base):d.base;var a=d.toHsv(),g=(a.h-157+360)%360,l=90<a.s?a.s-10:a.s+10,k=95<a.s?a.s-5:a.s+5,n=20<a.v-20?a.v-20:a.v+20,q=20<a.v-30?a.v-30:a.v+30,u=70<a.v-30?a.v-30:a.v+30;return new m.Palette([m.fromHsv((a.h+57+360)%360,20<a.s?a.s-10:a.s+10,a.v),m.fromHsv(a.h,l,q),d,m.fromHsv(g,l,n),m.fromHsv(g,
k,u)])},complementary:function(d){d=r.isString(d.base)?new m.Color(d.base):d.base;var a=d.toHsv(),g=360>2*a.h+137?2*a.h+137:Math.floor(a.h/2)-137,l=100-.9*(100-a.s),k=Math.min(100,a.s+20),n=20<a.v?a.v-30:a.v+30;return new m.Palette([m.fromHsv(a.h,Math.max(a.s-10,0),Math.min(100,a.v+30)),m.fromHsv(a.h,l,n),d,m.fromHsv(g,k,n),m.fromHsv(g,a.s,a.v)])},splitComplementary:function(d){var a=r.isString(d.base)?new m.Color(d.base):d.base,g=d.da||30;d=a.toHsv();var l=360>2*d.h+137?2*d.h+137:Math.floor(d.h/
2)-137,k=(l-g+360)%360;g=(l+g)%360;l=100-.9*(100-d.s);var n=Math.min(100,d.s+20),q=20<d.v?d.v-30:d.v+30;return new m.Palette([m.fromHsv(k,Math.max(d.s-10,0),Math.min(100,d.v+30)),m.fromHsv(k,l,q),a,m.fromHsv(g,n,q),m.fromHsv(g,d.s,d.v)])},compound:function(d){d=r.isString(d.base)?new m.Color(d.base):d.base;var a=d.toHsv(),g=360>2*a.h+18?2*a.h+18:Math.floor(a.h/2)-18,l=360>2*a.h+120?2*a.h+120:Math.floor(a.h/2)-120,k=360>2*a.h+99?2*a.h+99:Math.floor(a.h/2)-99,n=80<a.s-10?a.s-10:a.s+10,q=10<a.s-25?a.s-
25:a.s+25,u=80<a.v-20?a.v-20:a.v+20,t=Math.max(a.v,20);return new m.Palette([m.fromHsv(g,10<a.s-40?a.s-40:a.s+40,10<a.v-40?a.v-40:a.v+40),m.fromHsv(g,n,u),d,m.fromHsv(l,q,t),m.fromHsv(k,n,u)])},shades:function(d){d=r.isString(d.base)?new m.Color(d.base):d.base;var a=d.toHsv(),g=100==a.s&&0==a.v?0:a.s,l=20<=a.v-25?a.v-25:a.v+55,k=20<=a.v-75?a.v-75:a.v+5,n=Math.max(a.v-10,20);return new m.Palette([new m.fromHsv(a.h,g,20<a.v-50?a.v-50:a.v+30),new m.fromHsv(a.h,g,l),d,new m.fromHsv(a.h,g,k),new m.fromHsv(a.h,
g,n)])}},generate:function(d,a){if(r.isFunction(a))return a({base:d});if(m.Palette.generators[a])return m.Palette.generators[a]({base:d});throw Error("dojox.color.Palette.generate: the specified generator ('"+a+"') does not exist.");}});return m.Palette})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_MapSupport":function(){define(["require","dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(r,p,m,h){return p(null,{_initBuilderPromise:null,
_mapBuilder:null,_initMapBuilder:function(){var f=this;if(this._initBuilderPromise)return this._initBuilderPromise;var e=new m;r([f.isPlayerOnServer?"../core/supportClasses/map/ServerMapBuilder":"../core/supportClasses/map/MapBuilder"],function(b){f._mapBuilder=new b({getPlayerZoomScale:function(c){var d=f.getCurrentReportContainer();return d&&d.getPanelZoomScale?d.getPanelZoomScale(c):d&&d.getZoomInfo&&d.getZoomInfo().scale}});e.resolve()});return this._initBuilderPromise=e.promise},collectMaps:function(f){return this._mapBuilder?
f&&f.allAreas?this._mapBuilder.collectAllAreasMaps():this._mapBuilder.collectAreaMaps(this.getCurrentAnalysisAreaIndex()):[]},_resetMapBuilder:function(){this._mapBuilder&&this._mapBuilder.reset()},_createMap:function(f,e){e=e||{};return h(this._initMapBuilder(),function(){this._mapBuilder.setFallbackMapImageInfos(this._reportData.mapImageInfos);return this._mapBuilder.createMap(f,{reportData:this._reportData,areaIndex:e.areaIndex,defaultBasemapId:this._getDefaultBasemapId()||e.defaultBasemapId,defaultBasemapName:e.defaultBasemapName,
webMapId:e.webMapId,webMapName:e.webMapName,additionalLayerInfos:e.additionalLayerInfos,calculatorFieldName:e.calculatorFieldName,pinSymbolJson:e.pinSymbolJson,areaSymbolJsons:e.areaSymbolJsons,areaSymbolRamp:e.areaSymbolRamp,locatorPointsControllers:e.locatorPointsControllers,stdPolygonsControllers:e.stdPolygonsControllers,thisAreasHighlightController:e.thisAreasHighlightController,legendController:e.legendController,fieldData:this._viewModel.dynamicReportInfo.fieldData,geClient:this._viewModel.dynamicReportInfo.geClient,
countryID:this._viewModel.dynamicReportInfo.countryID,hierarchy:this._viewModel.dynamicReportInfo.hierarchy,waitForLoad:e.waitForLoad,extent:e.extent,attachmentsStore:this._viewModel.dynamicReportInfo.attachmentsStore,onPanContainer:function(b,c){}})}.bind(this))},_getDefaultBasemapId:function(){return null}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_PageNavigationSupport":function(){define("dojo/_base/declare dojo/on dojo/dom-class dojo/dom-geometry dojo/dom-style ../PlayerResizeModes ../PlayerViewModes esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(r,p,m,h,f,e,b,c,d,a){a=a.geoenrichment.dijit.ReportPlayer.ReportPlayer;return r(null,{_currentPageIndex:null,_initPageNavigationControls:function(){var g=this;p(this.prevPageButton,"click",function(){g._showPrevPage()});p(this.nextPageButton,"click",function(){g._showNextPage()});c.hide(this.sidePageNavigator);d.setTooltipToNode(this.prevPageButton,a.previousPage);d.setTooltipToNode(this.nextPageButton,a.nextPage)},showPageAt:function(g){this.viewMode!==b.FULL_PAGES||this.isPlayerOnServer||
(g=Math.max(0,g),this._currentPageIndex=g=Math.min(this.getCurrentReportContainer().getNumberOfPages()-1,g),this.getCurrentReportContainer().showPageAt(g),this._updatePageNavigator())},_updatePageNavigator:function(){if(this.playerToolbar){var g=this.getCurrentReportContainer()&&this.getCurrentReportContainer().getNumberOfPages&&this.viewMode===b.FULL_PAGES;this.playerToolbar.setPageControlsVisible(g);if(g){g=this.getCurrentReportContainer().getNumberOfPages();var l=1<g;l&&this._provideSideNavigationNodes();
c.display(this.sidePageNavigator,l);l&&(m[0===this._currentPageIndex?"add":"remove"](this.prevPageButton,"disabled"),m[this._currentPageIndex===g-1?"add":"remove"](this.nextPageButton,"disabled"),this.resizeMode===e.FIT_WINDOW&&(l=h.position(this.getCurrentReportContainer().stackContainer),f.set(this.sidePageNavigator,"left",Math.min(l.x+l.w+20,document.body.clientWidth-70)+"px"),f.set(this.sidePageNavigator,"top",Math.max(60,l.y+10)+"px")));this.playerToolbar.updatePageSelect(g,this._currentPageIndex)}else c.hide(this.sidePageNavigator)}},
_provideSideNavigationNodes:function(){var g=this;this.sidePageNavigator||(this.sidePageNavigator=c.create("div",{"class":"reportPlayer_sidePageNavigator"},this.domNode),this.prevPageButton=c.create("div",{"class":"reportPlayer_paginationArrowUp"},this.sidePageNavigator),this.nextPageButton=c.create("div",{"class":"reportPlayer_paginationArrowDown"},this.sidePageNavigator),p(this.prevPageButton,"click",function(){g._showPrevPage()}),p(this.nextPageButton,"click",function(){g._showNextPage()}),d.setTooltipToNode(this.prevPageButton,
a.previousPage),d.setTooltipToNode(this.nextPageButton,a.nextPage))},_showPrevPage:function(){0!==this._currentPageIndex&&(this._currentPageIndex--,this.showPageAt(this._currentPageIndex))},_showNextPage:function(){this._currentPageIndex!==this.getCurrentReportContainer().getNumberOfPages()-1&&(this._currentPageIndex++,this.showPageAt(this._currentPageIndex))}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes":function(){define([],function(){var r={AUTO:"auto",FIT_WINDOW:"fitWindow",MANUAL:"manual",
isSupported:function(p){for(var m in r)if(r[m]===p)return!0;return!1},toSupportedValue:function(p){return r.isSupported(p)?p:r.FIT_WINDOW}};return r})},"esri/dijit/geoenrichment/ReportPlayer/PlayerViewModes":function(){define([],function(){var r={FULL_PAGES:"fullPages",PANELS_IN_SLIDES:"panelsInSlides",PANELS_IN_STACK:"panelsInStack",PANELS_IN_STACK_ALL:"panelsInStackAll",isSupported:function(p){for(var m in r)if(r[m]===p)return!0;return!1},toSupportedValue:function(p){return r.isSupported(p)?p:r.FULL_PAGES},
isMobileSupported:function(p){return p===r.PANELS_IN_SLIDES||p===r.PANELS_IN_STACK||p===r.PANELS_IN_STACK_ALL},isStackLike:function(p){return p===r.PANELS_IN_STACK||p===r.PANELS_IN_STACK_ALL},isStack:function(p){return p===r.PANELS_IN_STACK||p===r.PANELS_IN_STACK_ALL}};return r})},"esri/dijit/geoenrichment/utils/DomUtil":function(){define("dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/query esri/dijit/geoenrichment/Deferred dojo/domReady!".split(" "),
function(r,p,m,h,f,e,b,c){function d(){g||(g=h.create("div",{"class":"esriGEOffscreen"},document.body));return g}var a={isHidden:function(k){return k&&m.contains(k,"esriGEHidden")},hasVisibleChildren:function(k){if(!k||!k.children.length)return!1;for(var n=0;n<k.children.length;n++)if(!a.isHidden(k.children[n]))return!0;return!1},hide:function(k){return a.addTag(k,"esriGEHidden")},show:function(k){return a.removeTag(k,"esriGEHidden")},display:function(k,n){return a[n?"show":"hide"](k)},addTag:function(k,
n){return a.applyCallback(k,function(q){q&&m.add(q,n)})},removeTag:function(k,n){return a.applyCallback(k,function(q){q&&m.remove(q,n)})},applyCallback:function(k,n,q){q&&(n=r.hitch(q,n));Array.isArray(k)?k.forEach(n):n(k);return k},getChildIndex:function(k,n){if(!k||!k.children||!n)return-1;for(var q=0;q<k.children.length;q++)if(k.children[q]===n)return q;return-1},getChildren:function(k){if(!k||!k.children)return null;for(var n=[],q=0;q<k.children.length;q++)n.push(k.children[q]);return n},getChildNodes:function(k){if(!k||
!k.childNodes)return null;for(var n=[],q=0;q<k.childNodes.length;q++)n.push(k.childNodes[q]);return n},isChildOf:function(k,n,q){var u=!1,t=function(v){if(q&&!q(v))return!1;v.parentNode===n?u=!0:v.parentNode&&t(v.parentNode)};k&&t(k);return u},isNodeInLayout:function(k){return a.isChildOf(k,document.body,function(n){return!a.isHidden(n)&&"none"!=e.get(n,"display")&&!m.contains(n,"dijitHidden")})},isNodeVisible:function(k){return a.isChildOf(k,document.body,function(n){return!m.contains(n,"dijitHidden")&&
"hidden"!=e.get(n,"visibility")})},isNodeOnscreen:function(k){return a.isChildOf(k,document.body,function(n){return!m.contains(n,"esriGEOffscreen")})},enableContent:function(k,n,q){if(k){q=q||{};var u=k.children.length-1;if(!(0>u)){u=k.children[u];m.contains(u,"esriGEDisabledContent")||(u=null);if(n)u&&k.removeChild(u);else if(u=u||h.create("div",{"class":"esriGEDisabledContent"+(q.overlayClass?" "+q.overlayClass:"")},k),q.textContent&&(u.textContent=q.textContent),!1!==q.fitParent&&(k=f[q.marginBox?
"getMarginBox":"getContentBox"](k).h))k=k.toString()+"px",e.set(u,{height:k,marginTop:"-"+k});return u}}},enableContentAbsolute:function(k,n,q){if(k){q=q||{};var u=e.get(k,"position");"relative"!==u&&"absolute"!==u&&e.set(k,"position","relative");return a.enableContent(k,n,{overlayClass:"esriGEAbsoluteStretched "+(q.overlayClass||"")+(q.isTransparent?" esriGEDisabledContentTransparent ":""),fitParent:!1,textContent:q.textContent})}}},g;a.hideNodeInBackground=function(k,n){if(k){if(k._hideNodeInBackgroundUndoController)return k._hideNodeInBackgroundUndoController;
var q=h.create("div",null,k,"after"),u=h.create("div",{style:"position: absolute; left: 0px; top: 0px;"},d());h.place(k,u);n="DomUtil.hideNodeInBackground"+(n?"."+n:"");p.set(q,"_bg_memo_node",n);p.set(u,"_bg_temp_node",n);n={undo:function(){q&&(q.parentNode&&h.place(k,q,"replace"),h.destroy(q),h.destroy(u),g.children.length||(h.destroy(g),g=null),q=null,delete k._hideNodeInBackgroundUndoController)},remove:function(){this.undo()}};return k._hideNodeInBackgroundUndoController=n}};a.showNodeFromBackground=
function(k){k&&k._hideNodeInBackgroundUndoController&&k._hideNodeInBackgroundUndoController.undo()};a.noTransformPosition=function(k){function n(v){for(var y={x:0,y:0};v.offsetParent;)y.x+=v.offsetLeft,y.y+=v.offsetTop,v=v.offsetParent,y.x+=e.get(v,"borderLeftWidth"),y.y+=e.get(v,"borderTopWidth");return y}function q(v){return e.get(v,"width")+e.get(v,"paddingLeft")+e.get(v,"paddingRight")+e.get(v,"borderLeftWidth")+e.get(v,"borderRightWidth")}function u(v){return e.get(v,"height")+e.get(v,"paddingTop")+
e.get(v,"paddingBottom")+e.get(v,"borderTopWidth")+e.get(v,"borderBottomWidth")}if(k){if(k instanceof SVGElement&&k.getBBox){var t=(t=k.ownerSVGElement&&k.ownerSVGElement.parentNode)&&n(t);k=k.getBBox();return{x:(k.x||0)+t.x,y:(k.y||0)+t.y,w:k.width||0,h:k.height||0}}t=n(k);return{x:t.x,y:t.y,w:q(k),h:u(k)}}};a.uniteNodeBoxes=function(k,n){var q=1E6,u=1E6,t=-1E6,v=-1E6;k.forEach(function(y){y=a.noTransformPosition(y);q=Math.min(q,y.x);u=Math.min(u,y.y);t=Math.max(t,y.x+y.w);v=Math.max(v,y.y+y.h)});
k={x:q,y:u,w:t-q,h:v-u};n&&(n=a.noTransformPosition(n),k.x-=n.x,k.y-=n.y);return k};a.getNodesBox=function(k,n){if(!k||!k.length)return null;for(var q=1E6,u=-1E6,t=1E6,v=-1E6,y=0;y<k.length;y++){var B=k[y];B=n&&n.ignoreTranformation?a.noTransformPosition(B):f.position(B);q=Math.min(q,B.x);t=Math.min(t,B.y);u=Math.max(u,B.x+B.w);v=Math.max(v,B.y+B.h)}return{x:q,y:t,w:u-q,h:v-t}};a.traverseChildren=function(k,n){function q(u){if(u&&u.children)for(var t=0;t<u.children.length;t++){var v=u.children[t];
if(n(v))break;q(v)}}q(k)};a.scrollToListNode=function(k,n,q){var u=n.offsetTop+n.clientHeight,t=u-(k.scrollTop+k.clientHeight);0<t&&(k.scrollTop+=t);q&&(u-=n.clientHeight-q.offsetTop,t=k.scrollTop-u,0<t&&(k.scrollTop-=t))};var l;a.getScrollbarSize=function(){if(!l){var k=h.create("div",null,document.body);k.style.width="100px";k.style.height="100px";k.style.overflow="scroll";k.style.position="absolute";k.style.top="9999px";l={w:k.offsetWidth-k.clientWidth,h:k.offsetHeight-k.clientHeight};h.destroy(k)}return l};
a.hasScrollbars=function(k){var n=e.getComputedStyle(k);return{w:"scroll"===n.overflowX||k.offsetWidth>k.clientWidth&&"auto"===n.overflowX,h:"scroll"===n.overflowY||k.offsetHeight>k.clientHeight&&"auto"===n.overflowY}};a.getMeasureContext=function(k){k=k||{};k.style=k.style?k.style+" ":"";k.style+="display: inline-block; position: absolute; left: 0; top: 0;";return{div:h.create("div",k,document.body),measureText:function(n){this.div.innerHTML=n;n=f.getMarginBox(this.div);delete n.l;delete n.t;return n},
destroy:function(){h.destroy(this.div)}}};a.getTextBox=function(k,n){n=a.getMeasureContext(n);k=n.measureText(k);n.destroy();return k};a.getNodeFontFamily=function(k){return(k=e.get(k,"fontFamily")||e.getComputedStyle(k)["font-family"])?k.replace(/'|"/g,"").split(",")[0]:k};a.getNodeFontSize=function(k){return e.toPixelValue(k,e.get(k,"fontSize"))};a.stealFocus=function(){var k=new c;try{var n=h.create("input",{type:"text",style:"position: absolute; left: 0px; top: 0px;"});h.place(n,document.body);
n.select();h.destroy(n)}catch(q){}setTimeout(k.resolve,0);return k.promise};a.getWindowBox=function(){for(var k=[],n=0,q=document.body.children.length;n<q;n++){var u=document.body.children[n];a.isHidden(u)||(a.hide(u),k.push(u))}n={w:document.body.clientWidth,h:document.body.clientHeight};k.forEach(function(t){a.show(t)});return n};a.getBorder=function(k){return{t:e.toPixelValue(k,e.get(k,"borderTopWidth")),r:e.toPixelValue(k,e.get(k,"borderRightWidth")),b:e.toPixelValue(k,e.get(k,"borderBottomWidth")),
l:e.toPixelValue(k,e.get(k,"borderLeftWidth"))}};a.isBodyLtr=function(){return"ltr"===(document.body.dir||"ltr").toLowerCase()};a.setAttribute=function(k,n,q){return 2===arguments.length?p.set(k,n):p.set(k,n,q)};a.getAttribute=function(k,n,q){return 2===arguments.length?p.get(k,n):p.get(k,n,q)};a.addClass=function(k,n){return m.add(k,n)};a.removeClass=function(k,n){return m.remove(k,n)};a.toggleClass=function(k,n,q){return m[q?"add":"remove"](k,n)};a.replaceClass=function(k,n,q){return m.replace(k,
n,q)};a.containsClass=function(k,n){return m.contains(k,n)};a.getStyle=function(k,n){return e.get(k,n)};a.setStyle=function(k,n,q){return 2===arguments.length?e.set(k,n):e.set(k,n,q)};a.toPixelValue=function(k,n){return parseFloat(n)||0};a.getComputedStyle=function(k){return k&&1===k.nodeType&&window.getComputedStyle(k)};a.position=function(k,n){return f.position(k,n)};a.getMarginBox=function(k,n){return f.getMarginBox(k,n)};a.setMarginBox=function(k,n){return f.setMarginBox(k,n)};a.getMarginExtents=
function(k,n){return f.getMarginExtents(k,n)};a.getContentBox=function(k,n){return f.getContentBox(k,n)};a.getPadBorderExtents=function(k,n){return f.getPadBorderExtents(k,n)};a.getPadExtents=function(k,n){return f.getPadExtents(k,n)};a.getBorderExtents=function(k,n){return f.getBorderExtents(k,n)};a.docScroll=function(){return f.docScroll()};a.create=function(k,n,q,u){return h.create(k,n,q,u)};a.toDom=function(k){return h.toDom(k)};a.place=function(k,n,q){return h.place(k,n,q)};a.empty=function(k){return h.empty(k)};
a.destroy=function(k){return h.destroy(k)};a.query=function(k,n){k=b(k,n);n=[];for(var q=0,u=k.length;q<u;q++)n.push(k[q]);return n};return a})},"esri/dijit/geoenrichment/utils/TooltipUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/on dojo/mouse dojo/sniff dijit/Tooltip dijit/place dojox/gfx ./DeviceUtil ./DnDUtil ./DomUtil ./MouseUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/domReady!".split(" "),function(r,
p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t){function v(){}var y={},B=r(a._MasterTooltip,{_customClasses:null,_customStyle:null,_orientKey:null,addCustomClasses:function(z){z&&(m.add(this.domNode,z),this._customClasses=z)},setCustomStyle:function(z){this._customStyle=z},show:function(z,w,A,H,G,I,N){if(!this.aroundNode||this.aroundNode!==w||this.containerNode.innerHTML!=z)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{"string"===typeof z?this.containerNode.innerHTML=z:(this.containerNode.innerHTML=
"",h.place(z.domNode||z,this.containerNode));G&&this.set("textDir",G);this.containerNode.align=H?"right":"left";var M=g.around(this.domNode,w,A&&A.length?A:a.defaultPosition,!H,p.hitch(this,"orient")),O=M.aroundNodePos;"M"==M.corner.charAt(0)&&"M"==M.aroundCorner.charAt(0)?(this.connectorNode.style.top=O.y+(O.h-this.connectorNode.offsetHeight>>1)-M.y+"px",this.connectorNode.style.left=""):"M"==M.corner.charAt(1)&&"M"==M.aroundCorner.charAt(1)?this.connectorNode.style.left=O.x+(O.w-this.connectorNode.offsetWidth>>
1)-M.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");this._drawBackground();this.domNode.style.opacity="0";this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=w;this.onMouseEnter=I||v;this.onMouseLeave=N||v}},orient:function(z,w,A,H,G){this.connectorNode.style.top="";var I=H.h;H=H.w;z.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft",
"TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[this._orientKey=w+"-"+A];this.addCustomClasses(this._customClasses);this.domNode.style.width="auto";var N=f.position(this.domNode);N.w=Math.ceil(N.w);if(d("ie")||d("trident"))N.w+=2;f.setMarginBox(this.domNode,{w:Math.min(Math.max(H,1),N.w)});"B"==A.charAt(0)&&"B"==w.charAt(0)?(z=f.position(z),w=this.connectorNode.offsetHeight,
z.h>I?(this.connectorNode.style.top=I-(G.h+w>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(G.h/2-w/2,0),z.h-w)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");this._drawBackground();return Math.max(0,N.w-H)},_surface:null,_surfaceContainer:null,_drawBackground:function(){if(this._orientKey){var z=this.domNode.clientWidth,w=this.domNode.clientHeight,A=f.position(this.domNode),H=f.position(this.connectorNode),
G=f.position(this.containerNode);H.x-=A.x;H.y-=A.y;G.x-=A.x;G.y-=A.y;G.x+=1;G.y+=1;G.w-=2;G.h-=2;this._surface&&this._surface.destroy();this._surfaceContainer&&h.destroy(this._surfaceContainer);A=this._surfaceContainer=h.create("div",{"class":"esriGEAbsoluteStretched"},this.domNode,"first");A.style.pointerEvents="none";z=this._surface=l.createSurface(A,z,w);w=[{x:G.x,y:G.y},{x:G.x+G.w,y:G.y},{x:G.x+G.w,y:G.y+G.h},{x:G.x,y:G.y+G.h},{x:G.x,y:G.y}];A=H.x+H.w/2;H=H.y+H.h/2;switch(this._orientKey){case "BL-TL":case "BM-TM":case "BR-TR":G=
[{x:A-5,y:G.y},{x:A,y:H},{x:A+5,y:G.y}];w.splice.apply(w,[1,0].concat(G));break;case "ML-MR":case "BL-BR":G=[{x:G.x+G.w,y:H-5},{x:A,y:H},{x:G.x+G.w,y:H+5}];w.splice.apply(w,[2,0].concat(G));break;case "TM-BM":case "TL-BL":case "TR-BR":G=[{x:A+5,y:G.y+G.h},{x:A,y:H},{x:A-5,y:G.y+G.h}];w.splice.apply(w,[3,0].concat(G));break;case "MR-ML":case "BR-BL":G=[{x:G.x,y:H+5},{x:A,y:H},{x:G.x,y:H-5}],w.splice.apply(w,[4,0].concat(G))}G=z.createPolyline(w);H="function"===typeof this._customStyle?this._customStyle():
this._customStyle;G.setFill(H&&H.backgroundColor||"white").setStroke({color:"#d3d3d3",width:1,join:"round"});H&&H.color&&(this.containerNode.style.color=H.color)}}}),D={show:function(z,w,A,H,G){"string"===typeof A&&(A=[A]);A=A&&A.map(function(N){return{after:"after-centered",before:"before-centered"}[N]||N});var I=new B;G&&I.setCustomStyle(G);I.addCustomClasses(H);I.show(z,w,A);return I}};y.setTooltipToNode=function(z,w,A){function H(){!G&&y.showTooltipForNode(z,w,A)}A=A||{};if(z&&!t.isPlayerOnServer&&
(y.hideTooltipForNode(z),z.__setTooltipToNodeMouseEnterHandle&&z.__setTooltipToNodeMouseEnterHandle.remove(),w)){var G=!1;k.isMobileDevice()?z.__setTooltipToNodeMouseEnterHandle=n.addNoDragClickHandler(z,H):z.__setTooltipToNodeMouseEnterHandle=b(z,c.enter,H);A.showTooltip&&H();return{remove:function(){w=null;y.hideTooltipForNode(z)},suspend:function(){y.hideTooltipForNode(z);G=!0},resume:function(){G=!1},refresh:function(){z._shownTooltip&&H()}}}};y.showTooltipForNode=function(z,w,A){function H(){y.hideTooltipForNode(z);
var M=Array.isArray(A.classes)?A.classes.join(" "):A.classes;M=(M||"")+" esriGETooltip";A.notRestricted&&(M+=" notRestricted");z._shownTooltip=I=D.show(G,z,A.position||["after","before"],M,A.style)}A=A||{};if(z&&!t.isPlayerOnServer){y.hideTooltipForNode(z);var G="function"==typeof w?w():w;if(G){A.textAlign&&(G="\x3cdiv class\x3d'"+("start"===A.textAlign?"esriGEStart":"end"===A.textAlign?"esriGEEnd":"")+"'\x3e"+G+"\x3c/div\x3e");m.add(z,"esriGESimpleTextTooltip");var I;H();var N=y.hideTooltipForNode.bind(y,
z);k.isMobileDevice()?z.__setTooltipToNodeMouseLeaveHandle=b(document.body,"touchstart",function(M){u.isMouseOver(z,{event:M})||N()}):z.__setTooltipToNodeMouseLeaveHandle=b.once(z,c.leave,function(){!A.stayOnHover&&N()});A.ignoreNodeRemoval||(z.__setTooltipToNodeInLayoutHandle=setInterval(function(){!q.isNodeInLayout(z)&&N()},300));k.isMobileDevice()||(z.__setTooltipToNodeMouseOverHandle=setInterval(function(){A.stayOnHover&&u.isMouseOver(I.domNode)||u.isMouseOver(z)||N()},300),z.__setTooltipToNodeClickHandle=
b(z,"click",function(M){A.hideOnClick?N():!z._shownTooltip&&H()}),A.stayOnHover&&(z.__setTooltipToNodeMouseLeaveMasterHandle=b(I.domNode,c.leave,N)));return z._shownTooltip}}};y.isShown=function(z){return!(!z||!z._shownTooltip)};y.hideTooltipForNode=function(z){z&&(z.title="",m.remove(z,"esriGESimpleTextTooltip"),z._shownTooltip&&z._shownTooltip.destroy(),delete z._shownTooltip,z.__setTooltipToNodeMouseLeaveHandle&&z.__setTooltipToNodeMouseLeaveHandle.remove(),clearInterval(z.__setTooltipToNodeInLayoutHandle),
clearInterval(z.__setTooltipToNodeMouseOverHandle),z.__setTooltipToNodeClickHandle&&z.__setTooltipToNodeClickHandle.remove(),z.__setTooltipToNodeMouseLeaveMasterHandle&&z.__setTooltipToNodeMouseLeaveMasterHandle.remove())};var E,F;y.autoTooltip=function(z){t.isPlayerOnServer||b(z,".TrimWithEllipses:mouseover",function(){if(this!==E&&this.offsetWidth<this.scrollWidth){var w=function(){E=null;F&&(F.tooltip.destroy(),F.mouseOutH.remove(),F.mouseMoveH.remove(),F=null)};w();E=this;F={tooltip:D.show(E.textContent,
E,["above","below"]),mouseOutH:b.once(E,"mouseout, mousedown, touchstart",w),mouseMoveH:b(document.body,"mousemove",function(){u.isMouseOver(E)||w()})}}})};y.showClosableTooltip=function(z){var w=y._createClosableTooltip(z.message,z.tooltipClass,z.position);return y._placeClosableTooltip(w,z.node,z.timeout,z.position,z.onClosed)};y.removeClosableTooltip=function(z){z&&z._removeFunc&&z._removeFunc()};y._createClosableTooltip=function(z,w,A){function H(){var O=h.create("div",{"class":"esriGEClosableTooltipTip"},
I);m.add(O,"right"===A?"esriGEClosableTooltipTipRight":"esriGEClosableTooltipTipLeft")}function G(){N=h.create("div",{"class":"esriGEClosableTooltipBody"},I);h.create("div",{innerHTML:z,"class":"esriGEClosableTooltipLabel"},N);M=h.create("div",{"class":"esriGEClosableTooltipCloseButton"},N)}var I=h.create("div",{"class":"esriGEClosableTooltip esriGENonSelectable "+(w||"")},document.body),N,M;"right"!==A?(G(),H()):(H(),G());I.style.position="fixed";return{tooltip:I,body:N,closeButton:M}};y._placeClosableTooltip=
function(z,w,A,H,G){function I(){var W=f.position(w),ea=W.x+";"+W.y+";"+W.w+";"+W.h;ea!==M&&(M=ea,ea=f.getMarginBox(z.tooltip),e.set(z.tooltip,{left:(N?W.x+W.w:W.x-ea.w)+"px",top:W.y+W.h/2-ea.h/2+"px"}))}var N="rtl"===document.dir&&"right"!==H||"rtl"!==document.dir&&"right"===H,M;I();var O,S,R=function(){O&&clearTimeout(O);V&&clearInterval(V);Z&&clearInterval(Z);da&&da.remove();z.tooltip.parentNode&&z.tooltip.parentNode.removeChild(z.tooltip)};var V=setInterval(function(){q.isNodeInLayout(w)&&w.parentNode||
(S=!1,R());q.isNodeVisible(w)&&q.isNodeOnscreen(w)?(S=!0,q.show(z.tooltip)):(S=!1,q.hide(z.tooltip))},0);var Z=setInterval(function(){S&&I()},0);A&&(O=setTimeout(R,A));var da=b(z.closeButton,"click",function(){R();G&&G()});z.tooltip._removeFunc=R;return z.tooltip};y.showTooltipForNode(document.body,"Normal \x3cb\x3eBold\x3c/b\x3e \x3ci\x3eItalic\x3c/i\x3e",{});y.hideTooltipForNode(document.body);return y})},"esri/dijit/geoenrichment/utils/DnDUtil":function(){define(["dojo/on","dojo/sniff","./DeviceUtil",
"./KeyboardUtil"],function(r,p,m,h){var f={MOBILE_TOLERANCE:10,LONG_PRESS_TIMEOUT:500,addNoDragClickHandler:function(e,b,c){c=c||{};return m.isMobileDevice()?f._addMobile(e,b,c):f._addPC(e,b,c)},_addPC:function(e,b,c){var d=c.tolerance||0,a,g,l=r(e,"mousedown",function(k){g&&g.remove();var n=k.clientX,q=k.clientY,u;a=r(document.body,"mousemove",function(t){if(!t.shiftKey&&!h.isCtrl(t)){var v=t.clientY;if(0<Math.abs(t.clientX-n)||0<Math.abs(v-q))u=!0}});g=r.once(document.body,"mouseup",function(t){a.remove();
var v=t.clientX,y=t.clientY;!u&&Math.abs(v-n)<=d&&Math.abs(y-q)<=d&&b(t)})});return{remove:function(){a&&a.remove();g&&g.remove();l&&l.remove()}}},_addMobile:function(e,b,c){function d(){g&&g.remove();l&&l.remove();k&&k.remove();clearTimeout(n)}var a=c.tolerance||f.MOBILE_TOLERANCE,g,l,k,n;var q=r(e,"touchstart",function(u){function t(B){return Math.abs(u.clientX-B.clientX)<a&&Math.abs(u.clientY-B.clientY)<a}d();var v;if(c.detectLongPress){var y;l=r(e,"touchmove",function(B){y=B});n=setTimeout(function(){t(y||
u)&&(c.ignoreReleaseIfLongPressHappened&&(v=!0),c.longPressCallback(u))},c.longPressTimeout||f.LONG_PRESS_TIMEOUT)}g=r.once(e,"touchend",function(B){!v&&t(B)&&b(B);d()});k=r.once(e,"touchcancel",d)});return{remove:function(){q&&q.remove();d()}}},addGlobalDragHanlder:function(e){function b(){c&&c.remove();d&&d.remove();a&&a.remove();g&&g.remove();l&&e.destroyDnDBox&&e.destroyDnDBox(l)}e.tolerance=0<e.tolerance?e.tolerance:5;var c,d,a,g,l;return r(e.node,e.downEventName||m.press,function(k){b();if(!e.onMouseDown||
e.onMouseDown(k)){var n=k.clientX,q=k.clientY,u=n,t=q;c=r(document.body,m.move,function(v){function y(){b();e.dragEnded&&e.dragEnded()}v.shiftKey||h.isCtrl(v)||!(Math.abs(n-v.clientX)>=e.tolerance||Math.abs(q-v.clientY)>=e.tolerance)||(c.remove(),e.dragStarted&&!e.dragStarted(v,v.clientX-u,v.clientY-t))||(u=v.clientX,t=v.clientY,l=e.createDnDBox&&e.createDnDBox(),d=r(document.body,m.move,function(B){e.dragMoved&&e.dragMoved(B,B.clientX-u,B.clientY-t,y);u=B.clientX;t=B.clientY}),a=r.once(document.body,
p("ie")||p("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){y()}),g=r(document.body,"keyup",function(B){27==B.keyCode&&(b(),e.dragCanceled&&e.dragCanceled())}))});r.once(document.body,p("ie")||p("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){c.remove()})}})}};return f})},"esri/dijit/geoenrichment/utils/KeyboardUtil":function(){define(["dojo/on","dojo/sniff","./DomUtil"],function(r,p,m){var h={listenToKeyboardCombinationOverNode:function(f){return r(document.body,
"keydown",function(e){if(!f.isCtrl||h.isCtrl(e))if(!f.isShift||e.shiftKey)if(!f.isAlt||e.altKey)String.fromCharCode(e.keyCode).toLowerCase()!==f["char"]||f.node&&!m.isNodeInLayout(f.node)||f.callback(e)})},isCtrl:function(f){return p("mac")?f.metaKey:f.ctrlKey}};return h})},"esri/dijit/geoenrichment/utils/MouseUtil":function(){define("dojo/_base/lang dojo/on dojo/sniff dojo/touch dojo/dom-geometry ./DomUtil dojo/domReady!".split(" "),function(r,p,m,h,f,e){var b={_latestEvent:null,_setLatestEvent:function(d){b._latestEvent=
d}};m("touch")?(p(document.body,h.press,function(d){b._setLatestEvent(b.fixTouchEvent(d,!0))}),p(document.body,h.move,function(d){b._setLatestEvent(b.fixTouchEvent(d,!0))})):p(document.body,"mousemove",function(d){b._setLatestEvent(b.fixTouchEvent(d,!0))});var c;p(document.body,"mousedown",function(){c||(c=!0,p.once(document.body,"mouseup, click",function(){c=!1}))});b.getCursorPosition=function(){return b._latestEvent};b.isMouseOver=function(d,a){var g=a&&a.event||b._latestEvent;if(!(d&&d.parentNode&&
d.getBoundingClientRect&&g))return!1;if(a&&a.checkAllChildren){a=r.mixin({},a);delete a.checkAllChildren;var l=!1;e.traverseChildren(d,function(k){if(b.isMouseOver(k,a))return l=!0});return l}return b.isMouseOverBox(f.position(d),a)};b.isMouseOverBox=function(d,a){if(!d)return!1;var g=a&&a.event||b._latestEvent;a&&a.ignoreBorderTolerance&&(a=a.ignoreBorderTolerance,d=r.mixin({},d),d.x+=a,d.y+=a,d.w-=2*a,d.h-=2*a);return d.x<=g.clientX&&d.x+d.w>=g.clientX&&d.y<=g.clientY&&d.y+d.h>=g.clientY};b.fixTouchEvent=
function(d,a){d=a?r.mixin({},d):d;d.touches&&1===d.touches.length?(a=d.touches[0],d.clientX=a.clientX,d.clientY=a.clientY,d.pageX=a.pageX,d.pageY=a.pageY):d.changedTouches&&1===d.changedTouches.length&&(a=d.changedTouches[0],d.clientX=a.clientX,d.clientY=a.clientY,d.pageX=a.pageX,d.pageY=a.pageY);return d};b.isBeingDragged=function(){return c};b.addOverOutHandler=function(d){function a(){clearTimeout(l);g&&g.remove()}var g,l,k=p(d.node,"mouseover",function(n){function q(){b.isMouseOver(d.node)&&(d.onMouseOver(n),
g=p(document.body,"mousemove",function(u){b.isMouseOver(d.node)||(a(),d.onMouseOut(u))}))}a();d.delayTimeout?l=setTimeout(q,d.delayTimeout):q()});return{remove:function(){k.remove();a()}}};b.addOutHandler=function(d,a){return p(document.body,"mousemove",function(g){b.isMouseOver(d,{checkAllChildren:!0})||a(g)})};return b})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_PrintSupport":function(){define(["require","dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when",
"../ReportPlayerState"],function(r,p,m,h,f){function e(){var b=new m;r(["../printing/PrintableContainer"],function(c){b.resolve(c)});return b.promise}return p(null,{_getPrintableContainer:function(b){var c=this;f.isAnimationSuspended=!0;return c._showWaiting(e(),"loadPrintModules").then(function(d){var a=new d(c,c._viewModel);b.onShowWaiting=function(g){c._showWaiting(g,"initPrintContainer")};return h(a.initialize(b),function(g){f.isAnimationSuspended=!1;return g?g:h(a.stop(),function(){return null})})})},
_getPrintDialogSettings:function(){var b=this;return e().then(function(c){return(new c(b,b._viewModel)).getPrintDialogSettings()})}})})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayerState":function(){define([],function(){return{isImageViewerShown:!1,isViewingDataDrillingZoom:!1,isViewingDynamicSettings:!1,isAnimationSuspended:!1}})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_ReportContainersSwitcher":function(){define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct ../PlayerViewModes esri/dijit/geoenrichment/utils/DomUtil".split(" "),
function(r,p,m,h,f,e){var b={createContainer:function(a,g){var l=a.getCurrentAnalysisAreaIndex();a.viewMode===f.PANELS_IN_STACK_ALL&&(l=0);var k=g.getContainer(l);if(!k){switch(a.viewMode){case f.PANELS_IN_SLIDES:k=this._createPaginationReportContainer(a);break;case f.PANELS_IN_STACK:k=this._createStackReportContainer(a);break;case f.PANELS_IN_STACK_ALL:k=this._createStackReportContainerAll(a);break;default:k=this._createFullPageReportContainer(a)}k.isCurrentContainer=function(){return a.getCurrentReportContainer()===
k}}g.setContainer(k,l);return k},_createPaginationReportContainer:function(a){var g=a._viewModel;return g.layoutBuilder.createElement("reportContainerPagination",{viewModel:g,parentWidget:a,currentFeatureIndex:a.getCurrentAnalysisAreaIndex(),scaleSectionsToFit:a.scaleSlidesToFitWindow,onResized:function(l){a.playerToolbar.update();a._emitResizedEvent(l)},onPendingDataApplied:function(){a._emitResizedEvent()}},a.reportContainerDiv)},_createStackReportContainer:function(a){var g=a._viewModel,l={center:!0,
minRight:10,minBottom:10,minLeft:10,minTop:a.showToolbarInPopup?43:10};return g.layoutBuilder.createElement("reportContainerStack",{viewModel:g,parentWidget:a,currentFeatureIndex:a.getCurrentAnalysisAreaIndex(),isVertical:!0,renderOptions:l,onPendingDataApplied:function(){a._emitResizedEvent()}},a.reportContainerDiv)},_createStackReportContainerAll:function(a){var g=a._viewModel;return g.layoutBuilder.createElement("reportContainerStackAll",{viewModel:g,parentWidget:a,isVertical:!0,renderOptions:{center:!0,
minRight:10,minBottom:10,minLeft:10,minTop:a.showToolbarInPopup?43:0},comparisonSettings:a.comparisonSettings,onPendingDataApplied:function(){a._emitResizedEvent()},onSwitchToSingleAreaView:function(){a.showAnalysisAreaAt(0)}},a.reportContainerDiv)},_createFullPageReportContainer:function(a){var g=a._viewModel,l={viewModel:g,parentWidget:a,currentFeatureIndex:a.getCurrentAnalysisAreaIndex(),onPendingDataApplied:function(){a._emitResizedEvent()}};l.renderOptions={center:!0,minRight:10,minBottom:10,
minLeft:10,minTop:a.showToolbarInPopup?43:10};return g.layoutBuilder.createElement(a.getReportData().reportObject.isGraphicReport?"reportContainerGrid":"reportContainer",l,a.reportContainerDiv)}},c=r(null,{_containerInfos:null,constructor:function(){this._containerInfos=[]},getContainer:function(a){return this._getInfo(a,"container")},getContainers:function(){return this._containerInfos.map(function(a){return a.container})},getContainerIndex:function(a){return this.getContainers().indexOf(a)},setContainer:function(a,
g){p.set(a.domNode,"area-index",g);this._getInfo(g,null,a)},isLoaded:function(a){return this._getInfo(a,"loaded")},setLoaded:function(a){if(a=this._getInfo(a))a.loaded=!0},resetAllLoaded:function(){this._containerInfos.forEach(function(a){a.loaded=!1})},destroyAllContainers:function(){this._containerInfos.forEach(function(a){a.container.destroy()});this._containerInfos.length=0},_getInfo:function(a,g,l){var k=this._containerInfos[a];!k&&l&&(k=this._containerInfos[a]={container:l,loaded:!1});return g?
k&&k[g]:k}}),d=r(null,{_lastVisuals:null,reset:function(){this._lastVisuals=null},rememberCurrentContainerVisuals:function(a){this._lastVisuals=a?{scrollTop:a.getScrollableContainer&&a.getScrollableContainer().scrollTop||0,pageIndex:a.getCurrentPageIndex&&a.getCurrentPageIndex()||0,slideIndex:a.getCurrentSlideIndex&&a.getCurrentSlideIndex()||0,zoomInfo:a.getZoomInfo&&a.getZoomInfo()}:null},applyCurrentContainerVisuals:function(a){this._lastVisuals&&(a.getScrollableContainer&&(a.getScrollableContainer().scrollTop=
this._lastVisuals.scrollTop||0),a.showSlideAt&&a.showSlideAt(this._lastVisuals.slideIndex||0),a.showPageAt?a.showPageAt(this._lastVisuals.pageIndex||0):a.notifyShown(),a.setZoomInfo&&a.setZoomInfo(this._lastVisuals.zoomInfo))}});return r(null,{_containerDict:null,_visualsHelper:null,_initContainerSwither:function(){this._containerDict=new c;this._visualsHelper=new d},getCurrentReportContainer:function(){return this._currentReportContainer},getAllReportContainers:function(){return this._containerDict.getContainers()},
_destroyAllContainers:function(){this._containerDict.destroyAllContainers();this._currentReportContainer=null},_setReportContainer:function(a){a?this._resetLoadedFlags():this._visualsHelper.rememberCurrentContainerVisuals(this._currentReportContainer);this._switchToCurrentReportContainer();return!a&&this._containerDict.isLoaded(this.getCurrentAnalysisAreaIndex())?(this._resize({isPaginating:!0}),this._visualsHelper.applyCurrentContainerVisuals(this._currentReportContainer),!1):!0},_switchToCurrentReportContainer:function(){this._currentReportContainer&&
this._hideContainer(this._currentReportContainer);this._currentReportContainer=b.createContainer(this,this._containerDict);m.remove(this.domNode,"esriGEReportPlayerFullView esriGEReportPlayerPaginationView esriGEReportPlayerStackView");switch(this.viewMode){case f.PANELS_IN_SLIDES:m.add(this.domNode,"esriGEReportPlayerPaginationView");break;case f.PANELS_IN_STACK:m.add(this.domNode,"esriGEReportPlayerStackView");break;case f.PANELS_IN_STACK_ALL:m.add(this.domNode,"esriGEReportPlayerStackAllView");
break;default:m.add(this.domNode,"esriGEReportPlayerFullView")}this._showContainer(this._currentReportContainer);this._connectZoomToCurrentContainer();this.notifyShown()},_hideContainer:function(a){this.isPlayerOnServer||(a.__undoHideContainerHandle=e.hideNodeInBackground(a.domNode,"reportContainer_"+this._containerDict.getContainerIndex(a)),a.own(a.__undoHideContainerHandle))},_showContainer:function(a){!this.isPlayerOnServer&&a.__undoHideContainerHandle&&(a.__undoHideContainerHandle.undo(),delete a.__undoHideContainerHandle)},
_showAllContainers:function(){var a=this;this.getAllReportContainers().forEach(function(g){a._showContainer(g);a.reportContainerDiv.removeChild(g.domNode);h.place(g.domNode,a.reportContainerDiv)});return{undo:function(){a.getAllReportContainers().forEach(function(g){a._hideContainer(g)});a._switchToCurrentReportContainer()}}},_resetLoadedFlags:function(){this._visualsHelper.reset();this._containerDict.resetAllLoaded()},_setCurrentContainerLoaded:function(){this._visualsHelper.applyCurrentContainerVisuals(this._currentReportContainer);
this._containerDict.setLoaded(this.getCurrentAnalysisAreaIndex())}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_SmartLayoutSupport":function(){define("dojo/_base/declare dojo/dom-class dojo/on esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil ../PlayerResizeModes ../PlayerViewModes".split(" "),function(r,p,m,h,f,e,b){return r(null,{_width:0,_height:0,_measuredWinBox:null,_initSmartLayout:function(){var c=this;this.resizeMode===e.FIT_WINDOW&&this.own(m(window,
"resize, orientationchange",function(){setTimeout(function(){c._measuredWinBox=null;c.resize()})}));this._resize()},_resize:function(c){c=c||{};p.remove(this.domNode,"esriGEReportPlayerFullScreen esriGEReportPlayerAutoResize esriGEReportPlayerManualResize");switch(this.resizeMode){case e.FIT_WINDOW:return this._resize_fitWindow(c);case e.AUTO:return this._resize_auto(c);case e.MANUAL:return this._resize_manual(c)}},_resize_fitWindow:function(c){this._measuredWinBox=this._measuredWinBox||f.getWindowBox();
this._width=this._maxWidth=this._measuredWinBox.w;this._height=this._maxHeight=this._measuredWinBox.h;p.add(this.domNode,"esriGEReportPlayerFullScreen");this.domNode.style.width=this._width+"px";this.domNode.style.height=this._height+"px";this._currentReportContainer&&(this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight(this._maxHeight-this._getToolbarHeight()),this._currentReportContainer.resize(this._width,
this._height-this._getToolbarHeight()),this._emitResizedEvent(c.isPaginating))},_resize_auto:function(c){this._height=this._width=0;p.add(this.domNode,"esriGEReportPlayerAutoResize");this.domNode.style.width="auto";this.domNode.style.height="auto";this._currentReportContainer&&(this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight(this._maxHeight-this._getToolbarHeight()),
this._currentReportContainer.resize(0,0),this._emitResizedEvent(c.isPaginating))},_resize_manual:function(c){this._width=void 0!==c.width?c.width:this._width;this._height=void 0!==c.height?c.height:this._height;this._width&&this._height&&(this._maxWidth&&(this._width=Math.min(this._maxWidth,this._width)),this._maxHeight&&(this._height=Math.min(this._maxHeight,this._height)),p.add(this.domNode,"esriGEReportPlayerManualResize"),this.domNode.style.width=this._width+"px",this.domNode.style.height=this._height+
"px",this._currentReportContainer&&(this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth||this._width),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight((this._maxHeight||this._height)-this._getToolbarHeight()),this._currentReportContainer.resize(this._width,this._height-this._getToolbarHeight()),this._emitResizedEvent(c.isPaginating)))},_getToolbarHeight:function(){if(this.showToolbarInPopup)return 0;var c=this.playerToolbar&&
0===this.playerToolbar.toolbarHolder.infographicsSelectDiv.children.length,d=!this.showAreaTitle,a=this._reportData&&(this._reportData.isMultiFeature||1===this._reportData.analysisAreas.length),g=this.viewMode===b.PANELS_IN_SLIDES,l=h.isMobileDevice();return c&&d&&a&&g&&l?0:50},_maxWidth:0,_maxHeight:0,setMaxWidth:function(c){this._maxWidth=c},setMaxHeight:function(c){this._maxHeight=c}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_ZoomSupport":function(){define(["dojo/_base/declare",
"dojo/aspect","../PlayerResizeModes","../PlayerViewModes","../PlayerZoomBehaviors"],function(r,p,m,h,f){return r(null,{_initZoomControls:function(){var e=this;this.playerToolbar.onZoomToFitPage=function(){e.getCurrentReportContainer().zoomToFitPage({showAnimation:!0})};this.playerToolbar.onZoomToFitPageWidth=function(){e.getCurrentReportContainer().zoomToFitPageWidth({showAnimation:!0})};this.playerToolbar.onZoomToFitPageHeight=function(){e.getCurrentReportContainer().zoomToFitPageHeight({showAnimation:!0})};
this.playerToolbar.onSetZoomPercent=function(b){e.getCurrentReportContainer().setZoomPercent(b,{showAnimation:!0})};this._refreshZoomControls()},_refreshZoomControls:function(){this.playerToolbar&&this.playerToolbar.setZoomSupportsInfo(this._getZoomSupportsInfo())},setBestZoom:function(){this._callZoomMethod("setBestZoom")},zoomToFitPage:function(){this._callZoomMethod("zoomToFitPage")},zoomToFitPageWidth:function(){this._callZoomMethod("zoomToFitPageWidth")},zoomToFitPageHeight:function(){this._callZoomMethod("zoomToFitPageHeight")},
resetZoom:function(){this._callZoomMethod("resetZoom")},_callZoomMethod:function(e){if(this._getZoomSupportsInfo().supported){var b=this.getCurrentReportContainer();b&&b[e]&&b[e]()}},_getZoomSupportsInfo:function(){var e={supported:!1,canFitPage:!1,canFitPageWidth:!1,canFitPageHeight:!1};this.viewMode!==h.PANELS_IN_SLIDES&&(e.supported=!0,this.resizeMode!==m.AUTO&&(e.canFitPage=!h.isStackLike(this.viewMode),e.canFitPageWidth=!0,e.canFitPageHeight=!1));return e},_updateZoomControls:function(){this._connectZoomToCurrentContainer();
this._applyDefaultZoomBehavior()},_reportContainerZoomChangedHandle:null,_connectZoomToCurrentContainer:function(){var e=this.getCurrentReportContainer();this._reportContainerZoomChangedHandle&&this._reportContainerZoomChangedHandle.remove();this._reportContainerZoomChangedHandle=e&&p.after(e,"onZoomChanged",function(){if(this.playerToolbar){var b=this.getCurrentReportContainer();b&&b.getZoomInfo&&this.playerToolbar.setZoomInfo(this.getCurrentReportContainer().getZoomInfo());this._updatePageNavigator();
this.playerToolbar.update()}}.bind(this));e&&e.own(this._reportContainerZoomChangedHandle)},_applyDefaultZoomBehavior:function(){var e=this._getZoomSupportsInfo();e.supported&&e.canFitPage&&this.defaultZoomBehavior===f.FIT_PAGE?this.zoomToFitPage():e.supported&&e.canFitPageWidth&&this.defaultZoomBehavior===f.FIT_PAGE_WIDTH?this.zoomToFitPageWidth():e.supported&&e.canFitPageHeight&&this.defaultZoomBehavior===f.FIT_PAGE_HEIGHT?this.zoomToFitPageHeight():this.resetZoom()}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerZoomBehaviors":function(){define([],
function(){var r={RESET:"reset",FIT_PAGE:"fitPage",FIT_PAGE_WIDTH:"fitPageWidth",FIT_PAGE_HEIGHT:"fitPageHeight",isSupported:function(p){for(var m in r)if(r[m]===p)return!0;return!1},toSupportedValue:function(p){return r.isSupported(p)?p:r.RESET}};return r})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_WaitingSupport":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when dojo/dom-class dojo/dom-construct ../PlayerResizeModes esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/WaitingUtil esri/dijit/geoenrichment/utils/progress/SmoothProgress".split(" "),
function(r,p,m,h,f,e,b,c,d,a){var g=r(null,{_dataProgress:0,_areaProgresses:null,_numAreas:0,constructor:function(l){p.mixin(this,l);this.reset()},reset:function(){this._dataProgress=0;this._areaProgresses={};this._fireProgress()},setLoadDataProgress:function(l){this._dataProgress=l;this._fireProgress()},setNumAreas:function(l){this._numAreas=l},setProgressForAreaAt:function(l,k){this._areaProgresses[k]=l;this._fireProgress()},finalize:function(){this.onChange(1);return b.delay(300)},_fireProgress:function(){var l=
.25*this._dataProgress,k=.75/this._numAreas,n;for(n in this._areaProgresses)l+=k*(this._areaProgresses[n]||0);l=Math.min(.999999,Math.max(0,l));this.onChange(l);this._printProgress()},_printProgress:function(){},onChange:function(l){}});return r(null,{_progressController:null,_initProgressController:function(){var l=this;this.showProgressBar&&(this._progressController=new g,(new a(this._progressController)).onChange=function(k){d.showProgressBar({value:k,node:l.domNode,position:"top"})})},_waitingCount:0,
_hideUndoHandle:null,_waitNode:null,getWaitingPromise:function(){return d.getProgressPromiseForNode(this._waitNode||this.domNode)},_showWaiting:function(l,k){var n=this;if(this.isPlayerOnServer)return l;this.onWaitingShown(l);return this.resizeMode!==e.FIT_WINDOW?(0===this._waitingCount++&&(this._updateElementsVisibility(),this._waitNode=f.create("div",{"class":"esriGEReportPlayerWaitingNode"},this.domNode.parentNode),this._waitNode.style.width=this.domNode.clientWidth?this.domNode.clientWidth+"px":
"",this._waitNode.style.height=this.domNode.clientHeight?this.domNode.clientHeight+"px":"",this._waitNode.style.position="relative",this._hideUndoHandle=c.hideNodeInBackground(this.domNode)),m(l)["finally"](function(){0===--n._waitingCount&&(n._hideUndoHandle.undo(),n._hideUndoHandle=null,f.destroy(n._waitNode),n._updateElementsVisibility())}),d.showProgressPromise(this._waitNode,l,{progressClass:"esriGEReportPlayerProgress"})):this._showWaitingFullScreen(l,k)},_showWaitingFullScreen:function(l,k){return d.showProgressPromise(this.domNode,
l,{progressClass:"esriGEReportPlayerProgress",onShowProgress:function(){this._waitingCount++;this._updateElementsVisibility()}.bind(this),onRemoveProgress:function(){if(this.domNode){this._waitingCount--;this._updateElementsVisibility();var n=this.getCurrentReportContainer();n&&!n.__isBeingAnimated&&(n.__isBeingAnimated=!0,n.domNode&&h.add(n.domNode,"esriGEReportPlayer_fadeIn1000"),n.notifyShown(),b.delay(1500).then(function(){n.__isBeingAnimated=!1;n.domNode&&h.remove(n.domNode,"esriGEReportPlayer_fadeIn1000")}))}}.bind(this)})},
onWaitingShown:function(l){}})})},"esri/dijit/geoenrichment/utils/DelayUtil":function(){define(["esri/dijit/geoenrichment/Deferred"],function(r){return{delay:function(p,m){var h=new r,f="function"===typeof p?p:null;setTimeout(h.resolve,("number"===typeof p?p:m)||0);return h.promise.then(function(){return f&&f()})}}})},"esri/dijit/geoenrichment/utils/WaitingUtil":function(){define("esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/ReportPlayer/config".split(" "),
function(r,p,m,h,f,e){var b={showProgress:function(c,d){e.isPlayerOnServer||c&&!c["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]&&(c["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]=m.create("div",{"class":"esriGEProgress esriGEProgressAbsolute "+(d||"")},c))},removeProgress:function(c){c&&c["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]&&(m.destroy(c["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]),delete c["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"])},
showProgressBar:function(c){var d=c.node;if(d){d._progressBar&&m.destroy(d._progressBar);delete d._progressBar;var a=Number(c.value);0>=a||isNaN(a)||(a=Math.min(a,1),d._progressBar=m.create("div",{"class":"esriGEWaitingMessageProgressBar esriGEWaitingMessageProgressBar_"+(c.position||"bottom")},d),f.set(d._progressBar,"width",h.position(d).w*a+"px"))}},showProgressPromise:function(c,d,a){if(!c)return d;a=a||{};void 0===c.__progressIndex&&(c.__progressIndex=0);0===c.__progressIndex&&(c.__progressDfd=
new r,b.showProgress(c,a.progressClass),a.onShowProgress&&a.onShowProgress());c.__progressIndex++;p(d)["finally"](function(){c.__progressIndex=Math.max(0,--c.__progressIndex);0===c.__progressIndex&&(c.__progressDfd&&c.__progressDfd.resolve(),delete c.__progressDfd,b.removeProgress(c),a.onRemoveProgress&&a.onRemoveProgress())});return d},getProgressPromiseForNode:function(c){return c&&c.__progressDfd&&c.__progressDfd.promise}};return b})},"esri/dijit/geoenrichment/utils/progress/SmoothProgress":function(){define(["dojo/_base/declare",
"dojo/aspect"],function(r,p){return r(null,{elasticTime:1E3,fireInterval:30,_intervalHandle:null,_progressHandle:null,_realProgress:0,_smoothProgress:0,_runAheadSpeed:2.5E-4,_currentSpeed:0,constructor:function(m){0<m.fireInterval&&(this.fireInterval=m.fireInterval);0<m.elasticTime&&(this.elasticTime=m.elasticTime);0<m.timeEstimate&&(this._runAheadSpeed=Math.min(this.fireInterval/m.timeEstimate,.5));var h=this;this._progressHandle=p.after(m,"onChange",function(f){1<=f?h._finalize():h._updateProgress(f)},
!0)},start:function(){this._updateProgress(0,!0)},_updateProgress:function(m,h){this._realProgress=Math.max(m,0);if(0===this._realProgress&&(this._smoothProgress=0,this._setIntervalHandle(!1),this.onChange(0),!h))return;this._setIntervalHandle(!0);this._currentSpeed=this._smoothProgress>=this._realProgress?this._runAheadSpeed:(this._realProgress-this._smoothProgress)*this.fireInterval/this.elasticTime},_setIntervalHandle:function(m){m!==!!this._intervalHandle&&(m?this._intervalHandle=setInterval(this._tryFireProgress.bind(this),
this.fireInterval):(clearInterval(this._intervalHandle),this._intervalHandle=null))},_tryFireProgress:function(){0!==this._currentSpeed&&(this._smoothProgress+=this._currentSpeed,this._smoothProgress=Math.min(1-this._runAheadSpeed,this._smoothProgress),this._smoothProgress>=this._realProgress&&(this._currentSpeed=this._runAheadSpeed),this.onChange(this._smoothProgress))},_finalize:function(){this._smoothProgress=this._realProgress=1;this.onChange(1)},onChange:function(m){},destroy:function(){this._progressHandle.remove();
this._setIntervalHandle(!1)}})})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/PlayerConfigurator":function(){define("../PlayerResizeModes ../PlayerZoomBehaviors ../PlayerThemes ../PlayerViewModes ../config esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),function(r,p,m,h,f,e){var b={configurePlayer:function(c,d){c._originalConfigurationSettings||(c.theme=c.theme&&m.toSupportedValue(c.theme)||m.DARK,c.viewMode=c.viewMode&&h.toSupportedValue(c.viewMode),c.resizeMode=c.resizeMode&&r.toSupportedValue(c.resizeMode)||
r.FIT_WINDOW,c.defaultZoomBehavior=c.defaultZoomBehavior&&p.toSupportedValue(c.defaultZoomBehavior),c._originalConfigurationSettings={viewMode:c.viewMode,defaultZoomBehavior:c.defaultZoomBehavior,scaleSlidesToFitWindow:c.scaleSlidesToFitWindow,showAreaTitle:c.showAreaTitle});c.viewMode=d||c._originalConfigurationSettings.viewMode||b.getDefaultViewMode(c);switch(c.viewMode){case h.FULL_PAGES:b._configure_fullPages(c);break;case h.PANELS_IN_SLIDES:b._configure_panelsInSlides(c);break;case h.PANELS_IN_STACK:b._configure_panelsInStack(c);
break;case h.PANELS_IN_STACK_ALL:b._configure_panelsInStackAll(c)}c._viewModel.setAnimationSuspended(c.viewMode===h.PANELS_IN_STACK_ALL);e.isMobileDevice()&&(f.modules.exportCommands=!1);f.modules.complexCellTooltips=c.viewMode===h.FULL_PAGES||c.viewMode===h.PANELS_IN_STACK_ALL},getDefaultViewMode:function(c){return e.isMobileDevice()&&!e.isWebLayout()?e.isLandscape()?h.PANELS_IN_SLIDES:h.PANELS_IN_STACK:h.FULL_PAGES},_configure_fullPages:function(c){c.showAreaTitle=!1!==c._originalConfigurationSettings.showAreaTitle;
c.scaleSlidesToFitWindow=!1;switch(c.resizeMode){case r.FIT_WINDOW:c.defaultZoomBehavior=c._originalConfigurationSettings.defaultZoomBehavior||(e.isMobileDevice()?p.FIT_PAGE_WIDTH:null)||p.FIT_PAGE;break;case r.AUTO:c.defaultZoomBehavior=p.RESET;break;case r.MANUAL:c.defaultZoomBehavior=c._originalConfigurationSettings.defaultZoomBehavior||p.FIT_PAGE}},_configure_panelsInSlides:function(c){c.showAreaTitle=!!c._originalConfigurationSettings.showAreaTitle;c.defaultZoomBehavior=null;switch(c.resizeMode){case r.FIT_WINDOW:c.scaleSlidesToFitWindow=
!1!==c._originalConfigurationSettings.scaleSlidesToFitWindow;break;case r.AUTO:c.scaleSlidesToFitWindow=!1;break;case r.MANUAL:c.scaleSlidesToFitWindow=!1!==c._originalConfigurationSettings.scaleSlidesToFitWindow}},_configure_panelsInStack:function(c){c.showAreaTitle=!!c._originalConfigurationSettings.showAreaTitle;c.scaleSlidesToFitWindow=!1;switch(c.resizeMode){case r.FIT_WINDOW:c.defaultZoomBehavior=p.FIT_PAGE_WIDTH;break;case r.AUTO:c.defaultZoomBehavior=p.RESET;break;case r.MANUAL:c.defaultZoomBehavior=
p.FIT_PAGE_WIDTH}},_configure_panelsInStackAll:function(c){c.showAreaTitle=!1!==c._originalConfigurationSettings.showAreaTitle;c.scaleSlidesToFitWindow=!1;switch(c.resizeMode){case r.FIT_WINDOW:c.defaultZoomBehavior=p.FIT_PAGE_WIDTH;break;case r.AUTO:c.defaultZoomBehavior=p.RESET;break;case r.MANUAL:c.defaultZoomBehavior=p.FIT_PAGE_WIDTH}},configurePlayerForCustomBuild:function(c,d){d=d||f;d.esriDijitCssUrl=c+"/dijit/themes/claro/claro.css";d.esriCssUrl=c+"/esri/css/esri.css";d.playerSourceRootUrl=
c+"/dojo/dojo.js";d.configScriptText='var dojoConfig \x3d { baseUrl: "'+c+'/", waitSeconds: 60, async: true, locale: typeof dojoConfig !\x3d\x3d "undefined" \x26\x26 dojoConfig.locale || null, packages: [{ name: "dojo", location: "./dojo" }, { name: "dijit", location: "./dijit" }, { name: "dojox", location: "./dojox" }, { name: "dgrid1", location: "./dgrid1" }, { name: "dstore", location: "./dstore" }, { name: "xstyle", location: "./xstyle" }, { name: "esri", location: "./esri" }, { name: "moment", location: "./moment", main: "moment/moment" }] }'}};
return b})},"esri/dijit/geoenrichment/ReportPlayer/PlayerThemes":function(){define([],function(){var r={LIGHT:"light",DARK:"dark",isSupported:function(p){for(var m in r)if(r[m]===p)return!0;return!1},toSupportedValue:function(p){return r.isSupported(p)?p:r.DARK}};return r})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/PlayerToFullScreenAnimator":function(){define(["esri/dijit/geoenrichment/utils/animation/AnimationUtil","esri/dijit/geoenrichment/utils/DelayUtil"],function(r,p){return{animateTo:function(m){if(!m._isAnimatedTo){m._isAnimatedTo=
!0;var h=r.animateResize({duration:300,domNode:m.domNode,startScaleX:.3,startScaleY:.3,fromOffset:{x:"c",y:"c"},toBox:{x:0,y:0,w:document.body.clientWidth,h:document.body.clientHeight}});r.animateFadeIn({domNode:m.domNode,duration:300});return h.then(function(){return p.delay(100)})}},animateFrom:function(m){if(m._isAnimatedTo){m._isAnimatedTo=!1;var h=r.animateResize({duration:300,domNode:m.domNode,endScaleX:.3,endScaleY:.3,toOffset:{x:"c",y:"c"},toBox:{x:(document.body.clientWidth-300)/2,y:(document.body.clientHeight-
200)/2,w:300,h:200}});r.animateFadeOut({domNode:m.domNode,duration:300});return h.then(function(){return p.delay(100)})}}}})},"esri/dijit/geoenrichment/utils/animation/AnimationUtil":function(){define(["dojo/dom-construct","dojo/dom-style","dojo/sniff","./Animator","esri/dijit/geoenrichment/utils/DomUtil"],function(r,p,m,h,f){var e={animateResize:function(b){function c(u){b.domNode=r.create("div",{"class":b.ghostClass},document.body);p.set(b.domNode,{width:u.w+"px",height:u.h+"px"})}function d(u,
t,v){var y=b.fromOffset.x,B=b.fromOffset.y;if("number"!==typeof y){var D=t.w*v.x;switch(y){case "l":y=0;break;case "r":y=(u.w||0)-D;break;default:y=((u.w||0)-D)/2}}if("number"!==typeof B)switch(D=t.h*v.y,B){case "t":B=0;break;case "b":B=(u.h||0)-D;break;default:B=((u.h||0)-D)/2}return{x:u.x+y,y:u.y+B}}function a(u,t,v){var y=b.toOffset.x,B=b.toOffset.y;if("number"!==typeof y){var D=u.w*v.x;switch(y){case "l":y=0;break;case "r":y=(t.w||0)-D;break;default:y=((t.w||0)-D)/2}}if("number"!==typeof B)switch(D=
u.h*v.y,B){case "t":B=0;break;case "b":B=(t.h||0)-D;break;default:B=((t.h||0)-D)/2}return{x:t.x+y,y:t.y+B}}var g=b.fromBox||(b.domFrom||b.domNode)&&f.noTransformPosition(b.domFrom||b.domNode);b.animateGhost&&c(g);var l=b.toBox||f.noTransformPosition(b.domTo);if(g&&l){var k=function(u,t){var v={x:b.startScaleX,y:b.startScaleY},y=0;"fit"===v.x&&(u.w?y=v.x=u.w/t.w:v.x=0);"fit"===v.y&&(u.h?y=Math.max(v.y=u.h/t.h,y):v.y=0);v.x=v.x||y||1;v.y=v.y||y||1;return v}(g,l),n=function(u,t){var v={x:b.endScaleX,
y:b.endScaleY},y=0;"fit"===v.x&&(t.w?y=v.x=t.w/u.w:v.x=0);"fit"===v.y&&(t.h?y=Math.max(v.y=t.h/u.h,y):v.y=0);v.x=v.x||y||1;v.y=v.y||y||1;return v}(g,l);b.fromOffset&&(g=d(g,l,k));b.toOffset&&(l=a(g,l,n));var q=m("webkit")?"webkitTransformOrigin":"transformOrigin";b.domNode.style[q]="0% 0%";return h.animateProperty({obj:b.domNode,duration:b.duration||250,properties:{__x:{start:g.x,end:l.x},__y:{start:g.y,end:l.y},__scaleX:{start:k.x||1,end:n.x},__scaleY:{start:k.y||1,end:n.y}},endFunction:function(){b.animateGhost&&
r.destroy(b.domNode);b.onEnd&&b.onEnd()},progressFunction:function(u,t){var v=m("webkit")?"webkitTransform":"transform";"__x"==u?b.domNode.style.left=t+"px":"__y"==u?b.domNode.style.top=t+"px":"__scaleX"==u?b.domNode.style[v]="scaleX("+t+") scaleY("+(b.domNode.__scaleY||1)+")":"__scaleY"==u&&(b.domNode.style[v]="scaleX("+(b.domNode.__scaleX||1)+") scaleY("+t+")")}}).promise}b.onEnd&&b.onEnd()},animateShrinkResize:function(b){b.endScaleX=b.endScaleX||.1;b.endScaleY=b.endScaleY||.05;return e.animateResize(b)},
animateFadeIn:function(b){return h.animateProperty({obj:b.domNode.style,duration:b.duration||250,properties:{opacity:{start:0,end:1}},endFunction:function(){b.onEnd&&b.onEnd()}}).promise},animateFadeOut:function(b){return h.animateProperty({obj:b.domNode.style,duration:b.duration||250,properties:{opacity:{start:1,end:0}},endFunction:function(){b.onEnd&&b.onEnd()}}).promise},animateSlide:function(b,c,d){var a=d.width;h.animateProperty({obj:b.style,duration:d.duration||250,properties:{left:{start:d.leftToRight?
0:-a,end:d.leftToRight?-a:0,units:"px"},right:{start:d.leftToRight?0:a,end:d.leftToRight?a:0,units:"px"}},endFunction:function(){d.onEnd&&d.onEnd()}});return h.animateProperty({obj:c.style,duration:d.duration||250,properties:{left:{start:d.leftToRight?a:0,end:d.leftToRight?0:a,units:"px"},right:{start:d.leftToRight?-a:0,end:d.leftToRight?0:-a,units:"px"}}}).promise},animateExpand:function(b,c,d){d=d||{};b.style.overflow="hidden";c&&f.show(b);var a=p.get(b,"height");return h.animateProperty({obj:b.style,
duration:d.duration,properties:{height:{start:c?0:a,end:c?a:0,units:"px"}},progressFunction:d.progressFunction,endFunction:function(){!c&&f.hide(b);p.set(b,"height","");p.set(b,"overflow","")}}).promise}};return e})},"esri/dijit/geoenrichment/utils/animation/Animator":function(){define(["esri/dijit/geoenrichment/Deferred","dojo/fx/easing","dojox/gfx/matrix"],function(r,p,m){function h(c){1>c.progress&&!c.isStopped?b.setTimeout(function(){if(c.isStopped)c.endFunction();else{var d=(new Date).getTime();
c.progress=1-(c.endTime-d)/c.duration;c.progress=Math.min(1,c.progress);f(c);h(c)}}):c.endFunction()}function f(c){for(var d in c.params.properties){var a=c.params.properties[d],g=a.easing?"function"===typeof a.easing?a.easing:p[a.easing]:null;g=g?g(c.progress):c.progress;var l=a.start+g*(a.end-a.start);c.obj[d]=a.units?l+a.units:l;c.progressFunction&&c.progressFunction(d,l,g)}}var e={},b={_funcs:null,setTimeout:function(c){var d=this;this._funcs?this._funcs.push(c):(this._funcs=[c],setTimeout(function(){var a=
d._funcs;d._funcs=null;a.forEach(function(g){g()})},33))}};e.animateProperty=function(c){var d={},a=new r;d.promise=a.promise;d.params=c;d.obj=c.obj||c.node||{};d.duration=void 0!==c.duration?c.duration:1E3;d.startTime=(new Date).getTime();d.endTime=d.startTime+d.duration;d.progress=0;d.endFunction=function(){c.endFunction&&c.endFunction();a.resolve()};d.progressFunction=c.progressFunction;d.stop=function(){d.isStopped=!0};f(d);h(d);return d};e.animateTransform=function(c){var d=c.shape;d.setTransform(null);
return e.animateProperty({duration:c.duration,properties:{p:{start:0,end:1,easing:c.easing}},progressFunction:function(a,g,l){var k,n,q,u;c.transform.forEach(function(t){var v=t.start[0]+(t.end[0]-t.start[0])*l,y=t.start[1]+(t.end[1]-t.start[1])*l;"translate"===t.name?(k=v,n=y):"scale"===t.name&&(q=v,u=y)});d.setTransform(new m.Matrix2D({dx:k,dy:n,xx:q,yy:u}))},endFunction:function(){d.setTransform(null);c.onEnd&&c.onEnd()}}).promise};return e})},"dojo/fx/easing":function(){define(["../_base/lang"],
function(r){var p={linear:function(m){return m},quadIn:function(m){return Math.pow(m,2)},quadOut:function(m){return m*(m-2)*-1},quadInOut:function(m){m*=2;return 1>m?Math.pow(m,2)/2:-1*(--m*(m-2)-1)/2},cubicIn:function(m){return Math.pow(m,3)},cubicOut:function(m){return Math.pow(m-1,3)+1},cubicInOut:function(m){m*=2;return 1>m?Math.pow(m,3)/2:(Math.pow(m-2,3)+2)/2},quartIn:function(m){return Math.pow(m,4)},quartOut:function(m){return-1*(Math.pow(m-1,4)-1)},quartInOut:function(m){m*=2;return 1>m?
Math.pow(m,4)/2:-.5*(Math.pow(m-2,4)-2)},quintIn:function(m){return Math.pow(m,5)},quintOut:function(m){return Math.pow(m-1,5)+1},quintInOut:function(m){m*=2;return 1>m?Math.pow(m,5)/2:(Math.pow(m-2,5)+2)/2},sineIn:function(m){return-1*Math.cos(Math.PI/2*m)+1},sineOut:function(m){return Math.sin(Math.PI/2*m)},sineInOut:function(m){return-1*(Math.cos(Math.PI*m)-1)/2},expoIn:function(m){return 0==m?0:Math.pow(2,10*(m-1))},expoOut:function(m){return 1==m?1:-1*Math.pow(2,-10*m)+1},expoInOut:function(m){if(0==
m)return 0;if(1==m)return 1;m*=2;if(1>m)return Math.pow(2,10*(m-1))/2;--m;return(-1*Math.pow(2,-10*m)+2)/2},circIn:function(m){return-1*(Math.sqrt(1-Math.pow(m,2))-1)},circOut:function(m){return Math.sqrt(1-Math.pow(m-1,2))},circInOut:function(m){m*=2;return 1>m?-.5*(Math.sqrt(1-Math.pow(m,2))-1):.5*(Math.sqrt(1-Math.pow(m-2,2))+1)},backIn:function(m){return Math.pow(m,2)*(2.70158*m-1.70158)},backOut:function(m){--m;return Math.pow(m,2)*(2.70158*m+1.70158)+1},backInOut:function(m){m*=2;if(1>m)return Math.pow(m,
2)*(3.5949095*m-2.5949095)/2;m-=2;return(Math.pow(m,2)*(3.5949095*m+2.5949095)+2)/2},elasticIn:function(m){if(0==m||1==m)return m;--m;return-1*Math.pow(2,10*m)*Math.sin(2*(m-.075)*Math.PI/.3)},elasticOut:function(m){return 0==m||1==m?m:Math.pow(2,-10*m)*Math.sin(2*(m-.075)*Math.PI/.3)+1},elasticInOut:function(m){if(0==m)return 0;m*=2;if(2==m)return 1;var h=.3*1.5,f=h/4;if(1>m)return--m,-.5*Math.pow(2,10*m)*Math.sin(2*(m-f)*Math.PI/h);--m;return.5*Math.pow(2,-10*m)*Math.sin(2*(m-f)*Math.PI/h)+1},bounceIn:function(m){return 1-
p.bounceOut(1-m)},bounceOut:function(m){return m<1/2.75?7.5625*Math.pow(m,2):m<2/2.75?7.5625*Math.pow(m-1.5/2.75,2)+.75:m<2.5/2.75?7.5625*Math.pow(m-2.25/2.75,2)+.9375:7.5625*Math.pow(m-2.625/2.75,2)+.984375},bounceInOut:function(m){return.5>m?p.bounceIn(2*m)/2:p.bounceOut(2*m-1)/2+.5}};r.setObject("dojo.fx.easing",p);return p})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/PlayerToolbar":function(){define("dojo/_base/declare dojo/on dojo/string esri/dijit/geoenrichment/when dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin ../PlayerCommands ../PlayerThemes ./Select ./AreasSelect ./ZoomSelect ./ToolbarArranger ./ZoomUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/InvokeUtil esri/dijit/geoenrichment/utils/MouseUtil esri/dijit/geoenrichment/utils/PopupUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/text!../templates/PlayerToolbarHolder.html dojo/i18n!esri/nls/jsapi".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y,B,D,E,F){F=F.geoenrichment.dijit.ReportPlayer.PlayerToolbar;var z=r([b,c],{templateString:E,nls:F,player:null,areaTitleFormatter:null,areaTitleMultiFormatter:null,showAreaTitle:!1,stretchToolbarNode:null,canAddMoreAreas:!1,areasSelectButtons:null,areasSelect:null,pageSelect:null,zoomSelect:null,_toolbarArranger:null,_infographicSelect:null,postCreate:function(){t.hide(this.commandButtonsContainer);this._toolbarArranger=new n({showAreaTitle:this.showAreaTitle,
stretchToolbarNode:this.stretchToolbarNode,domNode:this.domNode,infographicsSelectDiv:this.infographicsSelectDiv,areaTitleDiv:this.areaTitleDiv,areaTitleInnerDiv:this.areaTitleInnerDiv,rightSideControlsBlock:this.rightSideControlsBlock,areasSelectDiv:this.areasSelectDiv,zoomSelectDiv:this.zoomSelectDiv,pageSelectDiv:this.pageSelectDiv,commandButtonsContainer:this.commandButtonsContainer});this._initAreaSelect();this._initPageSelect();this._initZoomSelect();D.autoTooltip(this.domNode)},_initAreaSelect:function(){var w=
this;this.areasSelect=(new l({player:this.player,canAddMoreAreas:this.canAddMoreAreas,areasSelectButtons:this.areasSelectButtons,onChange:function(A){w.onShowAnalysisAreaAt(A.value);w.onClosePopup()},onAddMoreAreas:function(){w.onAddMoreAreas();w.onClosePopup()},onRemoveAreas:function(A,H){w.onRemoveAreas(A);H&&w.onClosePopup()},onCompareAreasSideBySide:function(){w.onCompareAreasSideBySide();w.onClosePopup()},onStopComparison:function(A){w.onShowAnalysisAreaAt(A);w.onClosePopup()}})).placeAt(this.areasSelectDiv);
this.own(this.areasSelect)},updateAreaSelect:function(w){var A=w.analysisAreas,H=w.combinedAreasInfo,G=w.currentAreaIndex,I=w.isMultiFeature;this.areasSelect.buildAreaOptions(w);this.areasSelect.set("value",G);w=1<this.areasSelect.get("options").length&&!I;t[w?"show":"hide"](this.areasSelectDiv);this._toolbarArranger.syncRightSideVisibility();this.player.showReportTitle?500<document.body.clientWidth||!w?(this.infographicsSelectDiv.innerHTML="\x3cdiv class\x3d'TrimWithEllipses' style\x3d'max-width:"+
.4*document.body.clientWidth+"px;'\x3e"+this.player.getReportTitle()+"\x3c/div\x3e",this._toolbarArranger.showAreaTitle=!0):(this.infographicsSelectDiv.innerHTML="",this._toolbarArranger.showAreaTitle=!1):I?this.areaTitleMultiFormatter?this.areaTitleMultiFormatter(this.areaTitleInnerDiv,H):this._formatAreaTitleMulti(H):(A=A["all"===G?0:G],this.areaTitleFormatter?this.areaTitleFormatter(this.areaTitleInnerDiv,A):this._formatAreaTitle(A,G))},_formatAreaTitle:function(w,A){this.areaTitleInnerDiv.innerHTML=
"all"===A?F.allAreas:w.locationName||w.name},_formatAreaTitleMulti:function(w){this.areaTitleInnerDiv.innerHTML=w.locationName||w.name||w.shortName||""},_pageControlsVisible:!0,_initPageSelect:function(){var w=this;this.pageSelect=(new g({onChange:function(A){w.onShowPageAt(A.value);w.onClosePopup()}})).placeAt(this.pageSelectDiv);this.own(this.pageSelect)},setPageControlsVisible:function(w){this._pageControlsVisible=w;t[w?"show":"hide"](this.pageSelectDiv)},updatePageSelect:function(w,A){for(var H=
[],G=0;G<w;G++)H.push({label:m.substitute(F.pageIndex,{index:G+1}),value:G});this.pageSelect.set("options",H);this.pageSelect.set("value",A);t[this._pageControlsVisible&&1<w&&500<document.body.clientWidth?"show":"hide"](this.pageSelectDiv)},_initZoomSelect:function(){var w=this;this.zoomSelect=(new k({onChange:function(A){if(A.value===q.FIT_PAGE)w.onZoomToFitPage();else if(A.value===q.FIT_PAGE_WIDTH)w.onZoomToFitPageWidth();else if(A.value===q.FIT_PAGE_HEIGHT)w.onZoomToFitPageHeight();else w.onSetZoomPercent(A.value);
w.onClosePopup()}})).placeAt(this.zoomSelectDiv);this.own(this.zoomSelect)},setZoomSupportsInfo:function(w){t[w.supported?"show":"hide"](this.zoomSelectDiv);this._toolbarArranger.syncRightSideVisibility();this.zoomSelect.store.data.forEach(function(A){A.hidden=!1;A.value!==q.FIT_PAGE||w.canFitPage?A.value!==q.FIT_PAGE_WIDTH||w.canFitPageWidth?A.value!==q.FIT_PAGE_HEIGHT||w.canFitPageHeight||(A.hidden=!0):A.hidden=!0:A.hidden=!0})},setZoomInfo:function(w){w=w.isFitPageScale?q.FIT_PAGE:w.isFitPageWidthScale?
q.FIT_PAGE_WIDTH:w.isFitPageHeightScale?q.FIT_PAGE_HEIGHT:q.getClosestZoomAndUpdateOptions(100*w.scale,this.zoomSelect.get("options"));w!==this.zoomSelect.get("value")&&this.zoomSelect.set("value",w)},createCommandButton:function(w,A){return this.createCustomCommandButton({callback:A,buttonClass:w.id===d.PRINT?"playerPrintButton":"playerExportButton",tooltip:w.id===d.PRINT?F.printInfographic:F.exportInfographic,visibleOnError:!1})},createCustomCommandButton:function(w){t.show(this.commandButtonsContainer);
var A=e.create("div",{"class":"playerToolbar_commandButtonContainer dijitInline"},this.commandButtonsContainer,w.addFirst?"first":"last");A.__visibleOnError=w.visibleOnError;A=e.create("div",{"class":"playerToolbar_commandButton"},A);w.buttonClass&&f.add(A,w.buttonClass);w.tooltip&&D.setTooltipToNode(A,w.tooltip);p(A,"click",w.callback);return A},setTheme:function(w){f.remove(this.domNode,"playerThemeDark playerThemeLight");f.add(this.domNode,w===a.DARK?"playerThemeDark":"playerThemeLight");this.areasSelect.setTheme(w);
this.pageSelect.setTheme(w);this.zoomSelect.setTheme(w)},setErrorShown:function(w){if(w)for(t.hide([this.areaTitleDiv,this.areasSelectDiv,this.pageSelectDiv,this.zoomSelectDiv]),w=0;w<this.commandButtonsContainer.children.length;w++){var A=this.commandButtonsContainer.children[w];t[A.__visibleOnError?"show":"hide"](A)}},arrangeControls:function(){this._toolbarArranger.arrangeControls()},hasVisibleControls:function(){return this._toolbarArranger.hasVisibleControls()},addInfographicsSelect:function(w){this._infographicSelect=
w;w.placeAt(this.infographicsSelectDiv)},isMouseOver:function(){return y.isMouseOver(this.domNode)||this.areasSelect&&this.areasSelect.isMouseOver()||this.pageSelect&&this.pageSelect.isMouseOver()||this.zoomSelect&&this.zoomSelect.isMouseOver()||this._infographicSelect&&this._infographicSelect.isMouseOver&&this._infographicSelect.isMouseOver()},setContentLoadPromise:function(w){t.enableContentAbsolute(this.commandButtonsContainer,!1);t.enableContentAbsolute(this.infographicsSelectDiv,!1);h(w,function(){t.enableContentAbsolute(this.commandButtonsContainer,
!0);t.enableContentAbsolute(this.infographicsSelectDiv,!0)}.bind(this))},onShowPageAt:function(w){},onShowAnalysisAreaAt:function(w){},onCompareAreasSideBySide:function(){},onZoomToFitPage:function(){},onZoomToFitPageWidth:function(){},onZoomToFitPageHeight:function(){},onSetZoomPercent:function(w){},onClosePopup:function(){},onAddMoreAreas:function(){},onRemoveAreas:function(w){}});return r([b,c],{templateString:"\x3cdiv class\x3d'esriGEPlayerToolbarOuter'\x3e\x3c/div\x3e",player:null,popupButtonDiv:null,
areaTitleFormatter:null,areaTitleMultiFormatter:null,showToolbarInPopup:!1,showAreaTitle:!1,stretchToolbarNode:null,showCloseButton:!1,canAddMoreAreas:!1,areasSelectButtons:null,toolbarHolder:null,postCreate:function(){var w=this;this.inherited(arguments);this.toolbarHolder=(new z({player:this.player,showAreaTitle:this.showAreaTitle,stretchToolbarNode:this.stretchToolbarNode,canAddMoreAreas:this.canAddMoreAreas,areasSelectButtons:this.areasSelectButtons,onShowPageAt:function(A){w.onShowPageAt(A)},
onShowAnalysisAreaAt:function(A){w.onShowAnalysisAreaAt(A)},onCompareAreasSideBySide:function(){w.onCompareAreasSideBySide()},onZoomToFitPage:function(){w.onZoomToFitPage()},onZoomToFitPageWidth:function(){w.onZoomToFitPageWidth()},onZoomToFitPageHeight:function(){w.onZoomToFitPageHeight()},onSetZoomPercent:function(A){w.onSetZoomPercent(A)},onClosePopup:function(){w.closePopup()},onAddMoreAreas:function(){w.onAddMoreAreas()},onRemoveAreas:function(A){w.onRemoveAreas(A)}})).placeAt(this.domNode);
this.own(this.toolbarHolder)},updateAreaSelect:function(w){this.toolbarHolder.areaTitleFormatter=this.areaTitleFormatter;this.toolbarHolder.areaTitleMultiFormatter=this.areaTitleMultiFormatter;this.toolbarHolder.updateAreaSelect(w)},setPageControlsVisible:function(w){this.toolbarHolder.setPageControlsVisible(w)},updatePageSelect:function(w,A){this.toolbarHolder.updatePageSelect(w,A)},setZoomSupportsInfo:function(w){this.toolbarHolder.setZoomSupportsInfo(w)},setZoomInfo:function(w){this.toolbarHolder.setZoomInfo(w)},
createCommandButton:function(w,A){return this.toolbarHolder.createCommandButton(w,A)},setTheme:function(w){this.toolbarHolder.setTheme(w)},setErrorShown:function(w){this.toolbarHolder.setErrorShown(w);this._arrangeControls()},_arrangeControls:function(){t.show(this.domNode);this.toolbarHolder.arrangeControls();t[this.toolbarHolder.hasVisibleControls()?"show":"hide"]([this._popupButton,this.domNode])},_popupHandle:null,_popupButton:null,update:function(){v.invoke(this,"_doUpdateToolbar")},_doUpdateToolbar:function(){f[this.isScrollShown()?
"add":"remove"](this.popupButtonDiv,"playerToolbar_parentHasScroll");f[u.isMobileDevice()?"add":"remove"](this.popupButtonDiv,"isMobileDevice");f[u.isMobileDevice()?"add":"remove"](this.toolbarHolder.domNode,"isMobileDevice");this._resetToolbarNode();var w=B.isOpen(this.toolbarHolder);this._popupHandle&&this._popupHandle.remove();this._popupHandle=null;this.showToolbarInPopup?(this._popupButton=e.create("div",{"class":"dijitInline playerToolbar_outerButton playerToolbar_settingsButton"},this.popupButtonDiv,
"first"),this._popupHandle=B.makePopup(this.toolbarHolder,this,this._popupButton,{orient:["before","below"],openPopup:w})):e.place(this.toolbarHolder.domNode,this.domNode);this._arrangeControls()},_resetToolbarNode:function(){this.toolbarHolder.domNode.parentNode&&this.toolbarHolder.domNode.parentNode.removeChild(this.toolbarHolder.domNode);this.domNode.innerHTML="";this._popupButton&&e.destroy(this._popupButton);this._popupButton=null},closePopup:function(){this.showToolbarInPopup&&B.close(this.toolbarHolder)},
isScrollShown:function(){return!1},createCustomCommandButton:function(w){return this.toolbarHolder.createCustomCommandButton(w)},notifyCommandButtonsAdded:function(){if(this.showCloseButton)if(this.showToolbarInPopup){var w=e.create("div",{"class":"dijitInline playerToolbar_outerButton playerToolbar_closeButtonOuter"},this.popupButtonDiv);D.setTooltipToNode(w,F.close);p(w,"click",function(){this.onClose()}.bind(this))}else this.createCustomCommandButton({buttonClass:"playerToolbar_closeButton",tooltip:F.close,
callback:function(){this.closePopup();this.onClose()}.bind(this),visibleOnError:!0})},addInfographicsSelect:function(w){this.toolbarHolder.addInfographicsSelect(w)},isMouseOver:function(){return y.isMouseOver(this.domNode)||this.toolbarHolder.isMouseOver()},setContentLoadPromise:function(w){this.toolbarHolder.setContentLoadPromise(w)},onShowPageAt:function(w){},onShowAnalysisAreaAt:function(w){},onCompareAreasSideBySide:function(){},onZoomToFitPage:function(){},onZoomToFitPageWidth:function(){},onZoomToFitPageHeight:function(){},
onSetZoomPercent:function(w){},onClose:function(){},onAddMoreAreas:function(){},onRemoveAreas:function(w){}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/Select":function(){define(["dojo/_base/declare","dojo/dom-class","esri/dijit/geoenrichment/OnDemandSelect","../PlayerThemes"],function(r,p,m,h){return r(m,{"class":"esriGEOnDemandSelectNoBackground",listClass:"esriGEOnDemandSelectVeryTallList esriGEOnDemandSelectSpacedOut",allowRepetitiveSelection:!1,setTheme:function(f){p[f===h.DARK?"add":
"remove"](this.domNode,"esriGEOnDemandSelectWhite")}})})},"esri/dijit/geoenrichment/OnDemandSelect":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-geometry dojo/store/Memory dijit/_WidgetBase dijit/_TemplatedMixin ./lists/FlowList ./lists/FlowListDefaultItemRenderer ./lists/_FlowListHoverSupport ./utils/DeviceUtil ./utils/DomUtil ./utils/MouseUtil ./utils/PopupUtil ./utils/TooltipUtil dojo/text!./templates/OnDemandSelect.html".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y){var B=r([g,k]),D={_currentSelect:null,_keyHandler:null,_mouseMoveHandler:null,_currentItemIndex:-1,_currentSearchLetter:null,setFocusedSelect:function(E){this._currentSelect=E;this._updateHandlers()},_updateHandlers:function(){var E=this;this._keyHandler&&this._keyHandler.remove();this._keyHandler=null;this._mouseMoveHandler&&this._mouseMoveHandler.remove();this._mouseMoveHandler=null;this._currentItemIndex=-1;this._currentSearchLetter=null;this._setNodeFocused(null);
this._currentSelect&&(this._keyHandler=m(document.body,"keyup",function(F){F=String.fromCharCode(F.keyCode);1===F.length&&(F=F.toLowerCase(),E._tryHighlightNextItemForKey(F))}),this._mouseMoveHandler=m(this._currentSelect.popupList.domNode,"mousemove",function(){E._setNodeFocused(null)}))},_tryHighlightNextItemForKey:function(E){E===this._currentSearchLetter?this._currentItemIndex++:this._currentItemIndex=0;this._currentSearchLetter=E;var F=this,z=this._currentSelect.store.query(function(A){return(A=
A[F._currentSelect.labelProperty])&&A.toLowerCase().charAt(0)===E});if(z.length){this._currentItemIndex>z.length-1&&(this._currentItemIndex=0);var w=(z=z[this._currentItemIndex])&&this._currentSelect.popupList.getItemNode(z);z&&this._currentSelect.popupList.scrollToItem(z);this._setNodeFocused(w)}},_currentFocusedNode:null,_setNodeFocused:function(E){this._currentFocusedNode&&(f.remove(this._currentFocusedNode,"listItemFocused"),this._currentFocusedNode=null);E&&(f.add(E,"listItemFocused"),this._currentFocusedNode=
E)}};return r([d,a],{templateString:y,value:null,popupList:null,listClass:null,placeHolderClass:"placeHolder",idProperty:"value",labelProperty:"label",options:null,store:null,itemRenderer:null,itemClass:null,placeHolder:null,requireSelection:!0,renderSelectionAsItem:!1,makePopupListWidthMatchOpenButtonWidth:!0,orient:null,noPopupOverflow:!1,stopOpenEventPropagation:!1,stopPopupInteractionEventPropagation:!0,onClickComponent:null,clearPopupOnClose:!0,detectItemHover:!1,hasSelectableItems:!0,allowRepetitiveSelection:!0,
labelTextToKeep:null,nodeToKeepAsSelected:null,openMouseEvent:null,toggleOnClick:!0,supportsKeyNavigation:!0,_closePopupOnChangeFunc:null,_lastPopupListScrollTop:0,postCreate:function(){var E=this;this.inherited(arguments);this._normalizeValue();this.labelTextToKeep?this.selectedLabel.innerHTML=this.labelTextToKeep:this.requireSelection||this._tryAssignPlaceholder();this.nodeToKeepAsSelected?this._updateSelection():q.hide(this.selectedItemHolder);this._createPopupList();this.own(this.popupList);this.listClass&&
f.add(this.popupList.domNode,this.listClass);this._popupCreationHandler=m(this.openButton,this.openMouseEvent||n.click,function(F){E.stopOpenEventPropagation&&("function"===typeof E.stopOpenEventPropagation?E.stopOpenEventPropagation(F):F.stopPropagation());E.openPopup()});this.popupList.startup();this._trySelectValue();m(this.popupList.domNode,n.clickOrRelease,function(F){E.stopPopupInteractionEventPropagation&&F.stopPropagation()});m(this.popupList.domNode,"scroll",function(F){E._lastPopupListScrollTop=
E.popupList.domNode.scrollTop});v.autoTooltip(this.domNode)},_createPopupList:function(){var E=this,F=this.itemRenderer||new l;this.popupList=new (this.detectItemHover?B:g)(p.mixin({"class":"esriGEOnDemandSelectFlowList",idProperty:this.idProperty,labelProperty:this.labelProperty,itemRenderer:F,itemClass:this.itemClass,stopMouseEventPropagation:this.stopPopupInteractionEventPropagation,hasSelectableItems:this.hasSelectableItems,allowRepetitiveSelection:this.allowRepetitiveSelection,onChange:function(){E._processOnChangeEvent()},
onItemHovered:function(z){E.onItemHovered(z)}},this._buildAdditionalPopupListProperties()))},_buildAdditionalPopupListProperties:function(){return null},_processOnChangeEvent:function(){if(this.popupList.selectedItem){var E=this.value,F=this.popupList.selectedItem;this.value=F[this.idProperty];this._updateSelection();this.onChange&&this.onChange({type:"change",value:this.value,previousValue:E,selectedItem:F})}this._closePopupOnChangeFunc&&!this._closePopupOnChangeFunc(this.value)||t.close(this.popupList)},
_makePopup:function(){if(this._popupCreationHandler){this._popupCreationHandler.remove();delete this._popupCreationHandler;var E=this;t.makePopup(this.popupList,this,this.openButton,{openMouseEvent:this.openMouseEvent,stopEventPropagation:this.stopOpenEventPropagation,toggleOnClick:this.toggleOnClick,wrapperClass:this.listClass?this.listClass.split(" ").map(function(F){return F+"Popup"}).join(" "):null,orient:this.orient,allowAutoOrientation:this.allowAutoOrientation,noOverflow:this.noPopupOverflow,
onClickComponent:this.onClickComponent,onPreShow:function(){E.onPopupListPreBuild();E.makePopupListWidthMatchOpenButtonWidth&&e.set(E.popupList.domNode,"minWidth",b.getContentBox(E.domNode).w+"px");E._updatePopupListStore();E.onPopupPreOpened()},onShow:function(){E.onPopupOpened();D.setFocusedSelect(E);E._onPopupOpened()},onClose:function(){E.onPopupClosed();D.setFocusedSelect(null);E.clearPopupOnClose&&E._clearPopup()},isMouseOver:function(){return E.isMouseOverList()}})}},_clearPopup:function(){this.popupList&&
this.popupList.clear&&this.popupList.clear()},_tryAssignPlaceholder:function(){if(this.placeHolder&&null===this.value)return this.selectedLabel.innerHTML=this.placeHolder,f.add(this.selectedLabel,this.placeHolderClass),!0;f.remove(this.selectedLabel,this.placeHolderClass);return!1},_normalizeValue:function(){null!==this.value&&(void 0===this.value?this.value=null:("string"===typeof this.value&&(this.value=this.value.trim()),String(this.value)||(this.value=null)))},trySelectValue:function(E){this.value=
E;this._normalizeValue();return this._trySelectValue()},_trySelectValue:function(){if(null!==this.value&&this._setValueAttr(this.value,!0))return!0;if(this.requireSelection){var E=this.store&&this.store.query();if(E&&E.length){var F=this;this.value&&E.some(function(z){return F.value===z[F.idProperty]})?this._setValueAttr(this.value,!0):this._setValueAttr(E[0][this.idProperty],!0)}}return!1},_setValueAttr:function(E,F){this.value=E;this._normalizeValue();if(!this.store||!this.popupList)return!1;var z=
this;(E=this.store.query(function(w){return w[z.idProperty]===z.value})[0])&&this.popupList.setSelectedItem(E);this._updateSelection(E);return!!E},_setOptionsAttr:function(E){this.options=E;this.store=this._createStore(E);this._updatePopupListStore();this._trySelectValue()},_setStoreAttr:function(E){this.options=(this.store=this._createStore(E))&&this.store.query();E.idProperty&&(this.idProperty=E.idProperty);this._updatePopupListStore();this._trySelectValue()},_createStore:function(E){return E instanceof
Array?new c({data:E,idProperty:this.idProperty}):E},_updatePopupListStore:function(){this.popupList&&(this.popupList.store&&this.popupList.store===this.store&&!this.clearPopupOnClose||this.popupList.setStore(this.store,!0),this.popupList.setSelectedItem(this.getSelectedItem()),this._lastPopupListScrollTop&&(this.popupList.domNode.scrollTop=this._lastPopupListScrollTop))},getSelectedItem:function(){if(!this.store)return null;var E=this.get("value"),F=this;return void 0!==E&&this.store.query(function(z){return z[F.idProperty]===
E})[0]},setSelectedItem:function(E){this.store&&this.popupList&&E&&this._setValueAttr(E[this.idProperty],!0)},getSelectedIndex:function(){var E=this,F=-1;if(this.store){var z=this.get("value");void 0!==z&&this.store.query().some(function(w,A){if(w[E.idProperty]==z)return F=A,!0})}return F},setSelectedIndex:function(E){this.setSelectedItem(this.store&&this.store.data[E])},_nodeToKeepAsSelectedPlacedFlag:!1,_updateSelection:function(E){E=E||this.getSelectedItem();this.nodeToKeepAsSelected?this._nodeToKeepAsSelectedPlacedFlag||
(q.hide(this.selectedLabel),q.show(this.selectedItemHolder),this.selectedItemHolder.innerHTML="",h.place(this.nodeToKeepAsSelected,this.selectedItemHolder),this._nodeToKeepAsSelectedPlacedFlag=!0):this.renderSelectionAsItem?(q.hide(this.selectedLabel),q.show(this.selectedItemHolder),this.selectedItemHolder.innerHTML="",E&&this.popupList.itemRenderer.createPresentation(E,!1,this.selectedItemHolder,this.popupList)):(q.hide(this.selectedItemHolder),this.labelTextToKeep?this.selectedLabel.innerHTML=this.labelTextToKeep:
(this.selectedLabel.innerHTML=E?E[this.labelProperty]:"",this.selectedLabel.innerHTML&&f.remove(this.selectedLabel,this.placeHolderClass),q[this.selectedLabel.innerHTML||this._tryAssignPlaceholder()?"show":"hide"](this.selectedLabel)))},refresh:function(){this.popupList.refresh();this._updateSelection()},isPopupOpen:function(){return t.isOpen(this.popupList)},openPopup:function(){this.isPopupOpen()||(this._makePopup(),t.open(this.popupList))},closePopup:function(){this._popupCreationHandler||t.close(this.popupList)},
refreshPopup:function(){this.isPopupOpen()&&t.refresh(this.popupList)},isMouseOver:function(E){return u.isMouseOver(this.domNode,{event:E})||this.isMouseOverList(E)},isMouseOverList:function(E){return this.popupList&&u.isMouseOver(this.popupList.domNode,{event:E})},onPopupListPreBuild:function(){},onPopupPreOpened:function(){},onPopupOpened:function(){},_onPopupOpened:function(){},onPopupClosed:function(){},onChange:function(E){},onItemHovered:function(E){},destroy:function(){this._popupCreationHandler&&
this._popupCreationHandler.remove();this.closePopup(this.popupList);this.popupList.destroy();this.inherited(arguments)}})})},"esri/dijit/geoenrichment/lists/FlowList":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on ../utils/DeviceUtil ../utils/DnDUtil ../utils/MouseUtil ../utils/TooltipUtil ./FlowListDefaultItemRenderer ../utils/PopupUtil dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(r,p,m,h,f,e,b,c,d,a,g,l,k){var n=r([l,k],{templateString:"\x3cdiv class\x3d'esriGEFlowList esriGENonSelectable'\x3e\x3c/div\x3e",
idProperty:"value",labelProperty:"label",selectedIndex:-1,selectedItem:null,items:null,store:null,defaultItemRendererClass:a,itemRenderer:null,itemClass:null,itemClassSelected:null,keepScrollPosition:!1,allowRepetitiveSelection:!0,selectOnMouseDown:!1,noDragTolerance:0,selectionValidator:null,allowManualSelection:!0,stopMouseEventPropagation:!0,hasSelectableItems:!0,autoDetectUrlsInLabels:!1,storeItemsInInnerDiv:!1,_addedWrappers:null,_clickHandles:null,_valueOnCreation:null,_isCreated:!1,itemsDiv:null,
postCreate:function(){this.inherited(arguments);this.itemsDiv=this.storeItemsInInnerDiv?m.create("div",{"class":"esriGEFlowList_innerDiv"},this.domNode):this.domNode;this._clearHandlers();this._setUpItemRenderer();d.autoTooltip(this.domNode);this._isCreated=!0;this._valueOnCreation?this._setValueAttr(this._valueOnCreation):this.refresh()},_setUpItemRenderer:function(){this.itemRenderer||(this.itemRenderer=new this.defaultItemRendererClass);this.itemClass&&(this.itemRenderer.itemClass=this.itemClass);
this.itemClassSelected&&(this.itemRenderer.itemClassSelected=this.itemClassSelected)},_getValueAttr:function(){return this.selectedItem&&this.selectedItem[this.idProperty]},_setValueAttr:function(q){var u=this;if(this._isCreated){var t=this.items||this.store&&this.store.data;t&&t.some(function(v){if(v[u.idProperty]==q)return u.setSelectedItem(v),!0})}else this._valueOnCreation=q},_scrollTopMemo:0,memoScroll:function(){this._scrollTopMemo=this.domNode.scrollTop},applyScrollFromMemo:function(){this.domNode.scrollTop=
this._scrollTopMemo||0},_setItemsAttr:function(q){this.setItems(q)},setItems:function(q,u){this.keepScrollPosition&&this.memoScroll();this.clear();this.items=q;u||(this.items&&this._isCreated?(this._addItems(q),this._checkIfStillSelected(),this.keepScrollPosition&&this.applyScrollFromMemo()):this._checkIfStillSelected())},_checkIfStillSelected:function(){if(-1!=this.selectedIndex||this.selectedItem){var q=this;this._addedWrappers&&this._addedWrappers.some(function(u,t){return q._isItemSelected(u,
t)})||(this.selectedIndex=-1,this.selectedItem=null)}},refresh:function(){this.store?this.setStore(this.store):this.setItems(this.items)},setSelectedItem:function(q,u){this.hasSelectableItems&&(this.selectedItem=q,this.selectedIndex=-1,this.refresh(),u&&this._dispatchChangeEvent())},setSelectedIndex:function(q,u){this.hasSelectableItems&&(this.selectedIndex=q,this.selectedItem=null,this.refresh(),u&&this._dispatchChangeEvent())},getItemNode:function(q){var u;this._addedWrappers&&this._addedWrappers.some(function(t){if(t.itemRef===
q)return u=t.__itemPresentation,!0});return u},getItemByNode:function(q){var u;this._addedWrappers&&this._addedWrappers.some(function(t){if(t.__itemPresentation===q)return u=t.itemRef,!0});return u},getItemByValue:function(q){var u,t=this;this._addedWrappers&&this._addedWrappers.some(function(v){if(v[t.idProperty]===q)return u=v.itemRef,!0});return u},__selectedPresentation:null,_addItems:function(q){this._addedWrappers=this._addedWrappers||[];var u=this;q.forEach(function(t){var v=p.mixin({},t);
v.itemRef=t;u.__addWrapper(v)})},__addWrapper:function(q){var u=this._addedWrappers.length,t=this.itemRenderer.createPresentation(q.itemRef,this._isItemSelected(q,u),this.itemsDiv,this,q);t&&(t.index=u,t.item=q.itemRef,q.__itemPresentation=t,this._isItemSelected(q,u)&&(this.selectedItem=q.itemRef,this.selectedIndex=u,this.__selectedPresentation=t),this._addClickHandler(t),this._addedWrappers.push(q),q=this._addedWrappers.length-1,h.add(t,"listItem_"+q),h.add(t,"listItem_"+(0==q%2?"even":"odd")))},
_isItemSelected:function(q,u){return this.hasSelectableItems&&this._isItemClickable(q)?u==this.selectedIndex||q.itemRef===this.selectedItem?!0:q.itemRef&&this.selectedItem?(q=q.itemRef[this.idProperty],u=this.selectedItem[this.idProperty],void 0!==q&&q===u):!1:!1},_isItemClickable:function(q){return this.selectionValidator?this.selectionValidator(q):this._selectionValidatorDefault(q)},_selectionValidatorDefault:function(q){return!!q&&!q.isSeparator&&!1!==q.enabled},_addClickHandler:function(q){function u(){(t.allowRepetitiveSelection||
t.__selectedPresentation!=q)&&t._isItemClickable(q.item)&&(t.__selectedPresentation&&t.itemRenderer.selectPresentation&&t.itemRenderer.selectPresentation(t.__selectedPresentation,!1,t.__selectedPresentation.item),t.itemRenderer.selectPresentation&&t.itemRenderer.selectPresentation(q,t.hasSelectableItems,q.item),t.__selectedPresentation=q,t.selectedIndex=q.index,t.selectedItem=q.item,t._dispatchChangeEvent())}var t=this;if(this.allowManualSelection){var v=this.selectOnMouseDown||!this.noDragTolerance?
f(q,this.selectOnMouseDown?e.press:e.click,function(y){t.stopMouseEventPropagation&&y.stopPropagation();u()}):b.addNoDragClickHandler(q,u,{tolerance:this.noDragTolerance});this._clickHandles.push(v)}},_dispatchChangeEvent:function(){this.onChange({type:"change",selectedIndex:this.selectedIndex,selectedItem:this.selectedItem,value:this.selectedItem&&this.selectedItem[this.idProperty]})},clear:function(){this.__selectedPresentation=null;this._addedWrappers=this._addedWrappers||[],this._addedWrappers.forEach(function(q){q.destroyPresentation&&
q.destroyPresentation()});this._addedWrappers.length=0;this.itemsDiv&&(this.itemsDiv.innerHTML="");this._clearHandlers()},_clearHandlers:function(){this._clickHandles=this._clickHandles||[];this._clickHandles.forEach(function(q){q.remove()});this._clickHandles.length=0},scrollToItem:function(q){if(q=this.getItemNode(q))this.domNode.scrollTop=q.offsetTop},store:null,onDemandModeLoadStep:1E3,onDemandPopulateLimit:1E3,onDemandPopulatePeriod:200,_storeScrollHandler:null,_setStoreAttr:function(q){this.setStore(q)},
setStore:function(q){if(this.domNode)if(this.keepScrollPosition&&this._memoScroll(),this.clear(),this.idProperty=(this.store=q)&&q.idProperty,this.store&&this._isCreated){this._loadNextPart();this._checkIfStillSelected();this.keepScrollPosition&&this.applyScrollFromMemo();var u=this;this._storeScrollHandler=this._storeScrollHandler||f(this.domNode,"scroll",function(){var t=u._addedWrappers[u._addedWrappers.length-30];(t=t?t.__itemPresentation:null)&&t.offsetTop<u.domNode.scrollTop&&u._loadNextPart()})}else this._checkIfStillSelected()},
_loadNextPart:function(){if(this.store&&this.store.query().length!=this._addedWrappers.length){var q=this.store.query(null,{start:this._addedWrappers.length,count:this.onDemandModeLoadStep});delete q.total;this._addItems(q);q.length&&this._addedWrappers.length<this.onDemandPopulateLimit&&(q=this._loadNextPart.bind(this),setTimeout(q,this.onDemandPopulatePeriod))}},isMouseOver:function(q){return c.isMouseOver(this.domNode,{event:q})},onChange:function(q){},destroy:function(){this.clear();this.inherited(arguments)}});
n.createPopup=function(q){function u(){t||(t=new n({"class":q.listClass,itemRenderer:q.itemRenderer,items:q.options,onChange:function(v){q.onChange(v);!q.keepSelection&&t.setSelectedItem(null);g.close(t)}}),q.doNotOwn||q.wizard.own(t),q.isDeferred&&q.isDeferred(t));return t}var t;g.makePopup(q.isDeferred?u:u(),q.wizard,q.aroundNode,q.popupOptions||{});return t};return n})},"esri/dijit/geoenrichment/lists/FlowListDefaultItemRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct ../utils/DomUtil ../utils/TooltipUtil ../utils/RegExpUtil ../utils/UrlUtil".split(" "),
function(r,p,m,h,f,e,b,c){return r(null,{itemClass:"",itemClassSelected:"",labelClass:"",createLabelNode:!1,createImageAfterLabel:!1,constructor:function(d){p.mixin(this,d)},createPresentation:function(d,a,g,l,k){if(d.isSeparator)return a=h.create("div",{"class":"flowList_listSeparator"},g),d.hidden&&f.hide(a),a;g=h.create("div",{"class":"listItem "+(this.itemClass||" ")+(d.itemClass||""),style:d.style},g);d.isLink&&m.add(g,"esriGELink");!1===d.enabled&&m.add(g,"disabled");this._createParts(d,g,l);
this._setTooltip(d,g,l);this.selectPresentation(g,a,d);d.hidden&&f.hide(g);return g},_setTooltip:function(d,a,g){d.tooltip&&g.own(e.setTooltipToNode(a,d.tooltip))},_createParts:function(d,a,g){if(this.createImageAfterLabel){this._createLabel(d,a,g);var l=!0}this._createImage(d,a,g);!l&&this._createLabel(d,a,g)},_createImage:function(d,a,g){if(a=this._createImageNode(d,a,g))d.imageClass&&m.add(a,d.imageClass),d.imageUrl&&(a.style="background-image: url("+d.imageUrl+");")},_createImageNode:function(d,
a,g){return a},_createLabel:function(d,a,g){if(this.createLabelNode)return a=h.create("div",{innerHTML:d[g.labelProperty],"class":"dijitInline TrimWithEllipses listItemLabel"},a),d.labelClass&&m.add(a,d.labelClass),this.labelClass&&m.add(a,this.labelClass),g.autoDetectUrlsInLabels&&this._tryConvertToUrls(a),a;d[g.labelProperty]&&(a.innerHTML=d[g.labelProperty],g.autoDetectUrlsInLabels&&this._tryConvertToUrls(a))},_tryConvertToUrls:function(d){var a=d.innerHTML.match(b.IS_URL_RE);if(a=a&&a[0])d.innerHTML=
d.innerHTML.replace(a,"\x3ca href\x3d'"+c.toHttpsUrl(a)+"' target\x3d'_blank'\x3e"+a+"\x3c/a\x3e")},selectPresentation:function(d,a,g){m[a?"add":"remove"](d,"listItemSelected "+this.itemClassSelected)}})})},"esri/dijit/geoenrichment/utils/RegExpUtil":function(){define([],function(){var r={createRegExp:function(c,d,a){c=r.trimText(c);return!c&&a?null:new RegExp(c,d)},trimText:function(c){return c?c.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,"").trim():""},replace:function(c,d,a){return null==c?"":(""+
c).replace(d,function(g){return a[g]||""})}},p=/&|<|>/g,m=/&|<|>|"|'/g,h={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26apos;"};r.encodeXML=function(c,d){return r.replace(c,d?m:p,h)};var f=/&amp;|&lt;|&gt;|&quot;|&apos;/g,e={"\x26amp;":"\x26","\x26lt;":"\x3c","\x26gt;":"\x3e","\x26quot;":'"',"\x26apos;":"'"};r.decodeXML=function(c){return r.replace(c,f,e)};r.IS_RICH_TEXT_RE=/<\w/;r.IS_URL_RE=/((www\.|http:\/\/|https:\/\/)[A-Za-z0-9_.\-~]+\.[A-Za-z0-9_.\-~/]+)|([A-Za-z0-9_.\-~]+\.com[A-Za-z0-9_.\-~/]*)/;
r.isRichText=function(c){return c&&r.IS_RICH_TEXT_RE.test(c)};r.isUrl=function(c){return c&&r.IS_URL_RE.test(c)};var b=/^[0-9a-fA-F]{32}$/;r.isId=function(c){return c&&b.test(c)};return r})},"esri/dijit/geoenrichment/utils/PopupUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/utils/onClickTouch dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/config dijit/popup dijit/place dijit/Viewport ./DeviceUtil ./DnDUtil ./MouseUtil dojo/domReady!".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n){function q(t){if(!t)return["below"];var v=[];t.forEach(function(y){var B=f.isBodyLtr();switch(y){case "before-alt":B=!B;case "after-alt":v.push(B?{aroundCorner:"BR",corner:"BL"}:{aroundCorner:"BL",corner:"BR"});v.push(B?{aroundCorner:"TR",corner:"TL"}:{aroundCorner:"TL",corner:"TR"});return}v.push(y)});return v}var u={makePopup:function(t,v,y,B){function D(O){if(B.overlay&&O._popupWrapper){var S=h.create("div",{"class":B.overlay.overlayClass});if(B.overlay.overlayParent)h.place(S,
B.overlay.overlayParent);else{h.place(S,H,"before");var R=e.get(O._popupWrapper,"zIndex");e.set(S,"zIndex",R)}O.__popupOverlay=S}}function E(O){O.__popupOverlay&&(h.destroy(O.__popupOverlay),O.__popupOverlay=null)}function F(O){G=!1;O.__bodyClickHandler&&O.__bodyClickHandler.remove();O.__bodyClickHandler=null;O.__popupWidgetOpenFlag=!1;E(O);B.onClose&&B.onClose()}function z(O){O&&B.stopEventPropagation&&O.stopPropagation();G||(G=!0,b(A||("function"==typeof t?t():t),function(S){A=S;A.domNode?(A.__openPopupWidgetFunc=
z,H=d.moveOffScreen(A),b(B.onPreShow&&B.onPreShow(),function(){var R=q(B.orient);if(H&&!1!==B.allowAutoOrientation){var V=R.indexOf("below");-1!==V&&-1===R.indexOf("above")&&R.splice(V+1,0,"above")}V=-1;if(-1!==R.indexOf("after")||-1!==R.indexOf("before")){V=g.getEffectiveBox(this.ownerDocument);var Z=f.position(y,!1);V=Math.floor(Math.max(Z.y+Z.h,V.h-Z.y))-10}B.noOverflow&&(A.baseClass="esriGENoOverflow "+A.baseClass);d.open({parent:v,popup:A,around:y,maxHeight:V,orient:R,onClose:function(){F(A)}});
B.suppressReposition&&clearTimeout(d._aroundMoveListener);B.noOverflow&&(A.baseClass=A.baseClass.replace("esriGENoOverflow ",""));H&&B.wrapperClass&&m.add(H,B.wrapperClass);A.__popupInfo=r.mixin({},d.getTopPopup());A.__popupInfo.orient=R;A.__popupInfo.around=y;E(A);D(A);B.onShow&&B.onShow();A.__popupWidgetOpenFlag=!0;M&&A.own&&A.own(M);A.__bodyClickHandler&&A.__bodyClickHandler.remove();if(!1!==B.closeOnClickOutside){var da="function"===typeof B.closeOnClickOutside?B.closeOnClickOutside:null;setTimeout(function(){A.__bodyClickHandler&&
A.__bodyClickHandler.remove();A.__bodyClickHandler=p(document.body,l.isMobileDevice()?l.press:w,function(W){G&&(n.fixTouchEvent(W),da&&!da(W)||n.isMouseOver(H)||B.isMouseOver&&B.isMouseOver()||A.isMouseOver&&A.isMouseOver()||A.__lockPopupWidgetFlag||u.close(A))})})}})):G=!1}))}if(t){if(c.isPlayerOnServer)return{remove:function(){}};B=B||{};var w=B.openMouseEvent?B.openMouseEvent:l.clickOrRelease,A="function"!==typeof t?t:null;if(A)var H=d.moveOffScreen(A);var G=!1;A&&(A.__openPopupWidgetFunc=z);if(!1!==
B.openOnMouseEvent){var I=z;if(B.toggleOnClick){var N;I=function(O){N=N||O.type;A?N===O.type&&u.toggle(A):z()}}var M=!1===B.onClickComponent?null:void 0!==B.noDragClickTolerance?k.addNoDragClickHandler(B.onClickComponent||y,I,{tolerance:B.noDragClickTolerance}):p(B.onClickComponent||y,w,I)}B.openPopup&&z();return{remove:function(){A&&"function"!==typeof A&&(u.close(A),F(A),A._popupWrapper&&(A.domNode&&A.domNode.parentNode===A._popupWrapper&&A._popupWrapper.removeChild(A.domNode),h.destroy(A._popupWrapper),
delete A._popupWrapper),delete A.__openPopupWidgetFunc,delete A.__popupWidgetOpenFlag);M&&M.remove()}}}},setLocked:function(t,v){t.__lockPopupWidgetFlag=v},open:function(t){t&&!t.__lockPopupWidgetFlag&&!t.__popupWidgetOpenFlag&&t.__openPopupWidgetFunc&&t.__openPopupWidgetFunc()},close:function(t){t&&!t.__lockPopupWidgetFlag&&d.close(t)},isOpen:function(t){return!(!t||!t.__popupWidgetOpenFlag)},toggle:function(t){u.isOpen(t)?u.close(t):u.open(t)},refresh:function(t){if(t){t=t.__popupInfo;var v=f.isBodyLtr();
t&&a.around(t.wrapper,t.around,t.orient,v)}},getWrapper:function(t){return t&&t._popupWrapper}};return u})},"esri/dijit/geoenrichment/utils/onClickTouch":function(){define(["dojo/_base/lang","dojo/on","dojo/sniff"],function(r,p,m){var h=m("touch");return r.mixin(function(f,e,b,c){if(h){switch(e){case "click":e="touchstart,click";break;case "mousedown":e="touchstart,mousedown";break;case "mouseup":e="touchend,mouseup";break;case "clickend":e="touchend,click";break;default:return p(f,e,b,c)}var d=!1;
return p(f,e,function(a){"touchstart"===a.type||"touchend"===a.type?(b.call(this,a),d=!0,setTimeout(function(){d=!1},500)):d||b.call(this,a)},c)}"clickend"===e&&(e="click");return p(f,e,b,c)},p)})},"esri/dijit/geoenrichment/lists/_FlowListHoverSupport":function(){define(["dojo/_base/declare","dojo/on","../utils/MouseUtil"],function(r,p,m){var h=r(null,{_list:null,_checkIntervalH:null,constructor:function(f){this._list=f},setHoveredItem:function(f){clearInterval(this._checkIntervalH);this._emitHoverEvent(f);
this._checkIntervalH=setInterval(function(){m.isMouseOver(f)||this.setHoveredItem(null)}.bind(this),100)},_emitHoverEvent:function(f){this._list.onItemHovered({type:"itemHover",index:f?f.index:-1,item:f?f.item:null,value:f?f.item[this._list.idProperty]:void 0})}});return r(null,{_mouseHelper:null,postCreate:function(){this._mouseHelper=new h(this);this.inherited(arguments)},_addClickHandler:function(f){this.inherited(arguments);this._clickHandles.push(p(f,"mouseover",function(){this._mouseHelper.setHoveredItem(f)}.bind(this)))},
onItemHovered:function(f){}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/AreasSelect":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct esri/dijit/geoenrichment/TriStateItem esri/dijit/geoenrichment/ToggleButton esri/dijit/geoenrichment/lists/FlowListDefaultItemRenderer ../PlayerViewModes ./Select ./ComparisonSettings ../dataProvider/supportClasses/areas/AnalysisAreaUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/PopupUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q){q=q.geoenrichment.dijit.ReportPlayer.PlayerToolbar;var u=r(b,{canRemoveAreas:!1,canMoveAreas:!1,wrapInCards:!1,nls:null,createPresentation:function(t,v,y,B){var D=this,E=this.inherited(arguments);if(t.isSeparator)return E;E.innerHTML="";if("all"===t.value){E.style.cursor="pointer";var F=h.create("div",{"class":"dijitInline esriGEReportPlayerToolbar_checkboxRoot"},E);(new e(F,{mode:"toggle"})).set("checked",this.isCompareAll());h.create("div",{"class":"dijitInline",
innerHTML:t.label},E);E.addEventListener("click",function(){if(D.isCompareAll())D.onStopComparison();else D.onCompareAreasSideBySide()});n.setTooltipToNode(E,this.isCompareAll()?this.nls.compareAreasSideBySideTooltipOff:this.nls.compareAreasSideBySideTooltipOn,{position:["before","after"]});return E}if("addAreas"===t.value)return E.style.cursor="pointer",h.create("div",{"class":"dijitInline esriGESpaceAfterBig esriGEReportPlayerToolbar_addMoreAreasIcon"},E),h.create("div",{"class":"dijitInline",innerHTML:t.label},
E),E.addEventListener("click",function(){D.onAddMoreAreas()}),E;if(t.isAdditional)return E.style.cursor="pointer",t.buttonInfo.imageClass&&h.create("div",{"class":"dijitInline esriGESpaceAfterBig "+t.buttonInfo.imageClass},E),h.create("div",{"class":"dijitInline",innerHTML:t.label},E),E.addEventListener("click",function(w){t.buttonInfo.callback(w);D.onClosePopup()}),t.buttonInfo.tooltip&&(F=h.create("div",{"class":"dijitInline esriGESpaceBeforeBig esriGEInfoIcon"},E),n.setTooltipToNode(F,t.buttonInfo.tooltip,
t.buttonInfo.tooltipParams)),t.buttonInfo.onCreated&&t.buttonInfo.onCreated(E),E;if(t.canSelect){F=h.create("div",{"class":"dijitInline esriGEReportPlayerToolbar_checkboxRoot"},E);var z=new f(F);z.autoToggle=!1;z.set("checked",t.selected);E.addEventListener("click",function(){t.selected=!t.selected;z.set("checked",t.selected);t.isGroup?t.children.forEach(function(w){w.selected=t.selected}):t.parent&&(t.parent.selected=t.parent.children.some(function(w){return w.selected}));D.onVisibilityChanged()})}this.canRemoveAreas&&
t.isHost&&(F=h.create("div",{"class":"esriGEFloatEnd esriGESpaceBeforeBig esriGEReportPlayerToolbar_removeAreaButton"},E),F.addEventListener("click",function(w){w.stopPropagation();D.onRemoveAreas(t.isArea?[t.analysisArea]:t.analysisAreas)}),n.setTooltipToNode(F,t.isGroup?this.nls.removeAreasFromInfographic:this.nls.removeAreaFromInfographic));this.canMoveAreas&&t.isHost&&this.isCompareAll()&&(F=h.create("div",{"class":"esriGEFloatEnd upDownArrowsBlock"},E),0<t.hostIndex&&h.create("div",{"class":"dijitInline upArrow"},
F).addEventListener("click",function(w){w.stopPropagation();D.onMoveUp(t)}),t.hostIndex<this.getNumHostItems()-1&&h.create("div",{"class":"dijitInline downArrow"},F).addEventListener("click",function(w){w.stopPropagation();D.onMoveDown(t)}));F=h.create("div",{"class":"dijitInline",innerHTML:t.label},E);t.parent&&(F.style.paddingLeft="20px");this.wrapInCards&&(t.isArea&&!t.parent?m.add(E,"areaCard_only"):t.isGroup?m.add(E,"areaCard_groupTop"):t.isArea&&m.add(E,t.parent.children.indexOf(t)===t.parent.children.length-
1?"areaCard_groupBottom":"areaCard_groupMiddle"));this.selectPresentation(E,v,t);return E},isCompareAll:function(){return!1},getNumHostItems:function(){return 0},onAddMoreAreas:function(){},onRemoveAreas:function(t){},onVisibilityChanged:function(){},onMoveUp:function(t){},onMoveDown:function(t){},onCompareAreasSideBySide:function(){},onStopComparison:function(){},onClosePopup:function(){}});return r(d,{"class":"dijitInline esriGEOnDemandSelectNoBackground",listClass:"esriGEOnDemandSelectVeryTallList800 esriGEOnDemandSelectSpacedOut esriGEReportPlayerToolbar_areasSelectList",
player:null,canAddMoreAreas:!1,areasSelectButtons:null,comparisonSettingsBlock:null,comparisonSettings:null,_nls:null,buildRendering:function(){var t=this;this.inherited(arguments);this._nls=p.mixin({},q,this.player.nlsMap);this.itemRenderer=new u({nls:this._nls,onAddMoreAreas:function(){t.onAddMoreAreas();t.closePopup()},onRemoveAreas:function(v){var y=2>=t._getNumHostItems();t.onRemoveAreas(v,y);y&&t.closePopup()},isCompareAll:function(){return t.player.viewMode===c.PANELS_IN_STACK_ALL},getNumHostItems:function(){return t._getNumHostItems()},
onVisibilityChanged:function(){var v={};t.get("options").forEach(function(y){y.isArea&&(v[y.analysisArea.index]=y.selected)});t.refresh();t.player.getCurrentReportContainer().setAreasVisibilityState(v,{append:!0})},onMoveUp:function(v){},onMoveDown:function(v){},onCompareAreasSideBySide:function(){t.onCompareAreasSideBySide();t.closePopup()},onStopComparison:function(){var v=-1;t.get("options").some(function(y){if(y.analysisArea&&!y.analysisArea.hidden)return v=y.analysisArea.index,!0});t.onStopComparison(v);
t.closePopup()},onClosePopup:function(){t.closePopup()}})},_buildAdditionalPopupListProperties:function(){var t=this;return{selectionValidator:function(v){return t.player.viewMode!==c.PANELS_IN_STACK_ALL&&!!v&&!v.isSeparator&&!1!==v.enabled}}},buildAreaOptions:function(t){var v=g.groupAreas(t),y=1<v.groupInfos.length&&!v.isOnlyAreasInOnlyGroup;this.itemRenderer.wrapInCards=y;this.itemRenderer.canRemoveAreas=y&&!l.isMobileDevice();this.itemRenderer.canMoveAreas=!1;var B=[],D=0;v.groupInfos.forEach(function(E,
F){if(E.isRealGroup){var z={isGroup:!0,isHost:!0,hostIndex:D++,label:E.label,value:"group_"+F,enabled:!1,analysisAreas:E.areas,children:[]};B.push(z)}E.areas.forEach(function(w){w={isArea:!0,label:w.shortName||w.name||"",value:w.index,analysisArea:w,parent:z,isHost:!z};w.isHost&&(w.hostIndex=D++);B.push(w);z&&z.children.push(w)})});v={isSeparator:!0};B.push(v);this.player.viewMode!==c.PANELS_IN_SLIDES&&(!l.isMobileDevice()&&1<t.analysisAreas.filter(function(E){return!E.hidden}).length&&B.push({label:this._nls.compareAreasSideBySide,
value:"all"}),this.canAddMoreAreas&&B.push({label:this._nls.addMoreAreas,value:"addAreas"}));this.areasSelectButtons&&this.areasSelectButtons.forEach(function(E){E.isVisible&&!E.isVisible()||B.push({label:E.label,value:E.id,isAdditional:!0,buttonInfo:E})});B[B.length-1]===v&&B.pop();this._updateTreeSelection(B);this.set("options",B);this._updateComparisonSettings()},_getNumHostItems:function(){var t=0;this.get("options").some(function(v){v.isHost&&t++});return t},onPopupListPreBuild:function(){this._updateTreeSelection()},
_updateTreeSelection:function(t){if(this.player.viewMode===c.PANELS_IN_STACK_ALL){var v=this.player.getCurrentReportContainer().getAreasVisibilityState();t=t||this.get("options");t.forEach(function(y){if(y.isGroup||y.isArea)y.canSelect=!0,y.isGroup?(y.children.forEach(function(B){B.selected=v[B.analysisArea.index]}),y.selected=y.children.some(function(B){return B.selected})):y.selected=v[y.analysisArea.index]})}},_updateComparisonSettings:function(){var t=this;this.comparisonSettings&&this.comparisonSettings.destroy();
this.comparisonSettings=null;this.comparisonSettingsBlock&&h.destroy(this.comparisonSettingsBlock);this.comparisonSettingsBlock=null;this.player.viewMode===c.PANELS_IN_STACK_ALL&&(this.comparisonSettingsBlock=h.create("div",{"class":"dijitInline esriGEClickable"},this.domNode.parentNode),h.create("div",{"class":"dijitInline esriGESpaceBeforeBig esriGEIcon16 esriGEReportPlayerToolbar_comparisonSettingsIcon"},this.comparisonSettingsBlock),k.makePopup(function(){t.comparisonSettings||(t.comparisonSettings=
new a({player:t.player,onChange:function(){t.player.getCurrentReportContainer().setComparisonSettings(t.comparisonSettings.getSettings())}}));t.comparisonSettings.setSettings(t.player.getCurrentReportContainer().getComparisonSettings());return t.comparisonSettings},this,this.comparisonSettingsBlock))},onAddMoreAreas:function(){},onRemoveAreas:function(t,v){},onCompareAreasSideBySide:function(){},onStopComparison:function(t){},destroy:function(){this.comparisonSettings&&this.comparisonSettings.destroy();
this.inherited(arguments)}})})},"esri/dijit/geoenrichment/TriStateItem":function(){define("dojo/_base/declare dojo/_base/event dojo/_base/lang dojo/Stateful dojo/on dojo/dom-construct dojo/dom-class ./utils/DeviceUtil".split(" "),function(r,p,m,h,f,e,b,c){return r(h,{domNode:null,checkboxNode:null,checked:!1,disabled:!1,autoToggle:!0,_currentClass:null,_lastChecked:!1,constructor:function(d,a,g){var l=c.isMobileDevice()?"touchstart":"click";a=a||{};var k=a["class"];a["class"]=(k?k+" ":"")+"esriTriStateCheckBoxIcon";
if(k=a.label){if(d instanceof HTMLLabelElement)d.innerHTML="\x26nbsp;"+k;else{var n=a.labelAttrs||{};n.innerHTML="\x26nbsp;"+k;n=e.create("label",n);d&&e.place(n,d);d=n}a=m.mixin({},a);delete a.label;delete a.labelAttrs}this.checkboxNode=e.create("div",a,d,d instanceof HTMLLabelElement?"first":g);this._currentClass=this._composeClass();b.add(this.checkboxNode,this._currentClass);d instanceof HTMLLabelElement?(f(d,l,m.hitch(this,this._onClick)),b.add(d,"esriTriStateCheckBoxLabel")):f(this.checkboxNode,
l,m.hitch(this,this._onClick));this.domNode=k?d:this.checkboxNode},postscript:function(){},_onClick:function(d){this.disabled||(this.autoToggle&&this.toggle(),d.checked=this.checked,this.onClick(p.fix(d)))},onClick:function(d){},toggle:function(){this.set("checked",!this._lastChecked);return this.checked},_checkedSetter:function(d){d!==this.checked&&(this.checked="mixed"===d?d:this._lastChecked=!!d,this._updateClass())},_disabledSetter:function(d){this.disabled=!!d;this._updateClass()},_updateClass:function(){var d=
this._composeClass();d!==this._currentClass&&(b.replace(this.checkboxNode,d,this._currentClass),this._currentClass=d)},_composeClass:function(){var d="esriTriStateCheckBox"+("mixed"==this.checked?"Mixed":this.checked?"Checked":"");return this.disabled?d+"Disabled":d}})})},"esri/dijit/geoenrichment/ToggleButton":function(){define(["dojo/_base/declare","dojo/Stateful","dojo/on","dojo/dom-construct","dojo/dom-class"],function(r,p,m,h,f){return r(p,{domNode:null,checked:!1,disabled:!1,mode:"toggle",constructor:function(e,
b,c){b=b||{};var d=b["class"];this.checked=!!b.checked;this.mode=b.mode||"toggle";this.domNode=h.create("div",{"class":(d?d+" ":"")+"esriGEToggleButton"},e,c);this._updateClass();m(this.domNode,"click",function(a){this.disabled||(a.checked=this.toggle(),this.onClick(a))}.bind(this))},postscript:function(){},_checkedSetter:function(e){this.checked=!!e;this._updateClass()},_modeSetter:function(e){this.mode=e;this._updateClass()},_disabledSetter:function(e){this.disabled=e;this._updateClass()},_updateClass:function(){f.remove(this.domNode,
"checked unchecked switch toggle");f.add(this.domNode,"toggle"===this.mode?"toggle":"switch");f.add(this.domNode,this.checked?"checked":"unchecked");f[this.disabled?"add":"remove"](this.domNode,"disabled")},onClick:function(e){},toggle:function(){this.set("checked",!this.checked);return this.checked}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ComparisonSettings":function(){define("dojo/_base/declare esri/dijit/geoenrichment/TriStateItem dijit/_WidgetBase dijit/_TemplatedMixin esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/NodeLabelEditor esri/dijit/geoenrichment/utils/TooltipUtil dojo/text!../templates/ComparisonSettings.html dojo/i18n!esri/nls/jsapi".split(" "),
function(r,p,m,h,f,e,b,c,d){d=d.geoenrichment.dijit.ReportPlayer.PlayerToolbar;return r([m,h],{templateString:c,nls:d,player:null,showBackgroundImageCheckbox:null,splitPanelsCheckbox:null,postCreate:function(){var a=this;this.inherited(arguments);this.showBackgroundImageCheckbox=new p(this.showBackgroundImageLabel);this.showBackgroundImageCheckbox.onClick=function(){a._onChange()};this.splitPanelsCheckbox=new p(this.splitPanelsLabel);this.splitPanelsCheckbox.onClick=function(){a._update();a._onChange()};
b.setTooltipToNode(this.splitPanelsInfoIcon,d.splitPanelsTooltip);var g=this.player.nlsMap&&this.player.nlsMap.zoomPanelsTooltip||d.zoomPanelsTooltip;f[g?"show":"hide"](this.zoomPanelsInfoIcon);b.setTooltipToNode(this.zoomPanelsInfoIcon,g);this._initZoomControls();this._initZoomSplitControls()},_zoomEditor:null,_zoom:0,_initZoomControls:function(){var a=this;this._zoomEditor=new e({numericOnly:!0,onApply:function(g){a._setZoom(g)},onCancel:function(){a._updateZoomLabel()}});this.zoomLabel.addEventListener("click",
function(){a._zoomEditor.range={min:10,max:500};a._zoomEditor.editNodeLabel(a.zoomLabel,a._zoom)});this.zoomOutButton.addEventListener("click",function(){a._setZoom(Math.max(10,a._zoom-10))});this.zoomInButton.addEventListener("click",function(){a._setZoom(Math.min(500,a._zoom+10))});this.resetButton.addEventListener("click",function(){a._setZoom(100)})},_setZoom:function(a,g){a=Math.round(a);this._zoom!==a&&(this._zoom=a,this._updateZoomLabel(),this._update(),!g&&this._onChange())},_updateZoomLabel:function(){this.zoomLabel.innerHTML=
this._zoom+"%"},_zoomSplitEditor:null,_zoomSplit:0,_initZoomSplitControls:function(){var a=this;this._zoomSplitEditor=new e({numericOnly:!0,onApply:function(g){a._setZoomSplit(g)},onCancel:function(){a._updateZoomSplitLabel()}});this.zoomSplitLabel.addEventListener("click",function(){a._zoomSplitEditor.range={min:10,max:500};a._zoomSplitEditor.editNodeLabel(a.zoomSplitLabel,a._zoomSplit)});this.zoomOutSplitButton.addEventListener("click",function(){a._setZoomSplit(Math.max(10,a._zoomSplit-10))});
this.zoomInSplitButton.addEventListener("click",function(){a._setZoomSplit(Math.min(500,a._zoomSplit+10))});this.resetSplitButton.addEventListener("click",function(){a._setZoomSplit(100)})},_setZoomSplit:function(a,g){a=Math.round(a);this._zoomSplit!==a&&(this._zoomSplit=a,this._updateZoomSplitLabel(),this._update(),!g&&this._onChange())},_updateZoomSplitLabel:function(){this.zoomSplitLabel.innerHTML=this._zoomSplit+"%"},_update:function(){this.resetButton.style.visibility=100===this._zoom?"hidden":
"visible";this.resetSplitButton.style.visibility=100===this._zoomSplit?"hidden":"visible";f.hide([this.zoomBlock,this.zoomSplitBlock]);f.show(this.splitPanelsCheckbox.get("checked")?this.zoomSplitBlock:this.zoomBlock)},setSettings:function(a){this.showBackgroundImageCheckbox.set("checked",!a.hideBackgroundImage);this.splitPanelsCheckbox.set("checked",a.splitPanels);this._setZoom(100*(a.scale||1),!0);this._setZoomSplit(100*(a.scaleSplit||1),!0);this._update()},getSettings:function(){return{hideBackgroundImage:!this.showBackgroundImageCheckbox.get("checked"),
splitPanels:this.splitPanelsCheckbox.get("checked"),scale:this._zoom/100,scaleSplit:this._zoomSplit/100}},_onChange:function(){this._update();this.onChange()},onChange:function(){}})})},"esri/dijit/geoenrichment/utils/NodeLabelEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/utils/MouseUtil esri/dijit/geoenrichment/utils/ObjectUtil".split(" "),function(r,p,m,h,f,e,b,c,d){return r(null,{_textMemo:null,
_handlers:null,_textBox:null,_node:null,numericOnly:!1,range:null,keepLabelDimensions:!0,constructor:function(a){p.mixin(this,a)},editNodeLabel:function(a,g){var l=this;this._stopEdit();this._node=a;this._textMemo="string"===typeof g||"number"===typeof g?g:a.innerHTML;g=e.position(a).w;a.innerHTML="";this._textBox=f.create("input",{type:"text"},a);this._textBox.name="node-label";this._textBox.value=this._textMemo;this._textBox.focus();this._textBox.select();this.keepLabelDimensions&&b.set(this._textBox,
"width",g+"px");this._handlers=[m(document.body,"keyup",function(k){k.keyCode===h.ESCAPE?l._cancelEdit():k.keyCode===h.ENTER&&l._applyEdit()}),m(document.body,"click",function(){c.isMouseOver(a)||l._cancelEdit()})]},_checkCanApply:function(a){if(!this.numericOnly)return!0;a=d.parseNumber(a);return isNaN(a)||this.range&&void 0!==this.range.min&&this.range.min>a||this.range&&void 0!==this.range.max&&this.range.max<a?!1:!0},_applyEdit:function(){var a=this._textBox.value;this._checkCanApply(a)?(this._node.innerHTML=
a,this._stopEdit(),this.onApply(a)):this._cancelEdit()},_cancelEdit:function(){this._node.innerHTML=this._textMemo;this._stopEdit();this.onCancel()},_stopEdit:function(){this._handlers&&this._handlers.forEach(function(a){a.remove()});this._textMemo=this._handlers=null;f.destroy(this._textBox);this._node=this._textBox=null},onApply:function(a){},onCancel:function(){}})})},"esri/dijit/geoenrichment/utils/ObjectUtil":function(){define(["dojo/number"],function(r){var p={};Math.log10=Math.log10||function(h){return Math.log(h)*
Math.LOG10E};p.populateObject=function(h,f,e){function b(c,d){function a(l){var k=c[l],n=d[l],q=k&&"object"===typeof k;void 0!==k&&(void 0===n?d[l]=k:n&&"object"===typeof n&&q?b(k,n):e&&(q?(n=d[l]={},b(k,n)):d[l]=c[l]))}if(c&&d&&!(Array.isArray(c)&&!Array.isArray(d)||Array.isArray(d)&&!Array.isArray(c)))if(Array.isArray(c))c.forEach(function(l,k){a(k)});else for(var g in c)a(g)}b(f,h);return h};p.filterByPattern=function(h,f){function e(c,d,a){for(var g in c){var l=c[g],k=d[g];if(Array.isArray(l)){var n=
l[0];if(k&&Array.isArray(k)){var q=a[g]=[];k.forEach(function(t){if(t&&"object"===typeof t){var v=Array.isArray(t)?[]:{};e(n,t,v);q.push(v)}})}}else if("object"===typeof l){if(k&&"object"===typeof k){var u=a[g]={};e(l,k,u)}}else void 0!==k&&(a[g]=k)}}var b={};e(f,h,b);return b};p.traverseObject=function(h,f){for(var e in h){var b=h[e];f(b,e,h);b&&"object"===typeof b&&p.traverseObject(b,f)}};p.copyOwnJsonProperties=function(h,f,e){f=f||{};for(var b in h){var c=h[b];h.hasOwnProperty(b)&&"function"!=
typeof c&&(c&&"object"==typeof c&&e&&(c=e(b,c)),void 0!==c&&(f[b]=c))}return f};p.removeUndefinedProperties=function(h){h&&Object.keys(h).forEach(function(f){void 0===h[f]&&delete h[f]});return h};p.getValue=function(h,f){if("string"!==typeof f)return h;f=f.split(".");for(var e=0;e<f.length;e++)h=h&&h[f[e]];return h};p.setValue=function(h,f,e){if("string"===typeof f&&(f=f.split("."),f.length)){for(var b=0;b<f.length-1;b++)h=h&&h[f[b]];h&&(h[f[f.length-1]]=e)}};p.isNumber=function(h){return!isNaN(parseFloat(h))&&
isFinite(h)};p.roundNumber=function(h,f){return"number"!==typeof h?h:parseFloat(h.toFixed(void 0!==f?f:0))};p.getBestPrecision=function(h){return 0===h?0:Math.max(0,Math.round(Math.log10(3E3/Math.abs(h))))};p.getPlaces=function(h,f){function e(g,l){var k=h.indexOf(g,b);if(0>k)return c;g=h.charAt(k+g.length);return!g||0>l.indexOf(g)?c:k-b}h=+h;if(isNaN(h))return-1;h+="";var b=h.indexOf(".")+1,c=b?h.length-b:0;if(2>=c||!f)return c;f=0;if(!+h.substr(0,b-1))for(;"0"===h.charAt(b);)b++,f++,c--;for(var d=
c-1;2<=d;d--){var a=Math.min(e("000000000000000".substr(0,d),"01234"),e("999999999999999".substr(0,d),"56789"));if(a!==c){c=a;break}}return c+f};p.formatNumber=function(h,f){f="number"===typeof f?{places:f}:f||{};var e=f.places,b={};0<=e?b.places=e:e=-1;h=r.format(h,b);if(f.noSeparator){b=p.getSeparator();var c;if(b)for(;0<=(c=h.indexOf(b));)h=h.substr(0,c)+h.substr(c+1)}if(f.preserveTrailingZeroes||0>=e||!h)return h;for(f=h.length;0<e&&"0"==h.charAt(f-1);)f--,--e||f--;return h.substr(0,f)};p.formatNumberAsCurrency=
function(h,f,e){return f?f.split(";")[0>h?1:0].replace("0",p.formatNumber(Math.abs(h),e)):p.formatNumber(h,e)};var m;p.getSeparator=function(){void 0===m&&(m=r.format(9999,{places:0}).replace(/9/g,""));return m};p.parseNumber=function(h,f,e,b){if(""===h)return"undefined"!==typeof e?e:NaN;if(null==h||"string"!==typeof h&&isNaN(h))return NaN;h=String(h);if(!h.trim())return void 0!==e?e:NaN;e=r.parse(h,{strict:b});isNaN(e)&&h.trim().length&&(e=b?r.parse(h,{strict:b,locale:"en-US"}):Number(h));return isNaN(e)||
void 0===f||0>f?e:r.round(e,f)};p.parsePercentOrCurrency=function(h,f,e,b,c){"string"===typeof h&&(h=h.replace("%",""),f&&(f=f.split(";")[0].replace("0",""),h=h.replace(f,"")));return p.parseNumber(h,e,b,c)};p.compareEqual=function(h,f,e){return void 0===e?h===f:Number(Number(h).toFixed(e))===Number(Number(f).toFixed(e))};return p})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaUtil":function(){define(["dojo/_base/lang","esri/geometry/webMercatorUtils","esri/dijit/geoenrichment/utils/CoordinateUtil"],
function(r,p,m){var h={geometryToLatLong:function(f){var e=f.spatialReference.wkid;return e===m.WGS_84_WKID?{STORE_LONG:f.x,STORE_LAT:f.y}:m.isWebMercator(e)?(f=p.xyToLngLat(f.x,f.y),{STORE_LONG:f[0],STORE_LAT:f[1]}):null},populateCombinedAreasInfo:function(f,e){var b={},c={};e.forEach(function(d){d.latitude&&(b[d.latitude]=1);d.longitude&&(c[d.longitude]=1)});f.name=f.name||e.map(function(d){return d.name}).join(", ");f.shortName=f.shortName||e.map(function(d){return d.shortName||d.name}).join(", ");
f.description=f.description||e.map(function(d){return d.description||d.name}).join(", ");f.address=f.address||e.map(function(d){return d.address||d.name}).join(", ");f.latitude=f.latitude||Object.keys(b).join(", ");f.longitude=f.longitude||Object.keys(c).join(", ");return f},groupAreas:function(f){function e(l){var k=l.locationName||l.name;return{isSingleAreaGroup:!0,label:k,hideGroupLabel:k===(l.shortName||l.name),areas:[l]}}var b=f.combinedAreasInfo&&f.combinedAreasInfo.groups||[],c=[],d=[],a={};
f.analysisAreas.forEach(function(l){if((!f.filter||f.filter(l))&&!l.hidden)if(l.isGrouped){if(!a[l.groupIndex]){var k=b[l.groupIndex];k=a[l.groupIndex]={isRealGroup:!0,label:k.locationName||k.name,areas:[]};d.push(k);c.push(k)}a[l.groupIndex].areas.push(l)}else c.push(e(l))});if(1===c.length&&c[0].isRealGroup){c=c[0].areas.map(e);d.length=0;var g=!0}return{groupInfos:c,isOnlyAreasInOnlyGroup:g}},parseSites:function(f){if(f.sites){f.analysisAreas=[];f.sites.forEach(function(b){b.areas.forEach(function(c){f.analysisAreas.push(c)})});
f.combinedAreasInfo={groups:f.sites.map(function(b){var c=r.mixin({},b);delete c.areas;delete c.attributes;delete c.notes;delete c.images;c.indexes=b.areas.map(function(d){return f.analysisAreas.indexOf(d)});return c})};h.populateCombinedAreasInfo(f.combinedAreasInfo,f.sites);if(!f.attachmentsProvider||!f.attachmentsProvider.getAttributesForAreaAt){f.attachmentsProvider={};f.attachmentsProvider.supportsMultipleAreas=1<f.sites.length;var e=f.attachmentsProvider.areaAttachments=[];f.sites.forEach(function(b){b.areas.forEach(function(c){e.push({attributes:b.attributes,
notes:b.notes,images:b.images})})})}delete f.sites}}};return h})},"esri/dijit/geoenrichment/utils/CoordinateUtil":function(){define(["esri/geometry/webMercatorUtils","esri/geometry/jsonUtils"],function(r,p){var m={},h=[4326,102100,102113,3857];m.WGS_84_WKID=4326;m.WEB_MERCATOR_WKID=102100;m.getSupportedWKIDs=function(){return h.slice()};m.testSpatialReferenceWKID=function(f){f=h.indexOf(Number(f&&"object"===typeof f?f.wkid:f));return 0<=f?h[0===f?0:1]:0};m.isWebMercator=function(f){return 102100===
m.testSpatialReferenceWKID(f)};m.isWGS84=function(f){return 4326===m.testSpatialReferenceWKID(f)};m.getGeometryConverter=function(f,e){f=m.testSpatialReferenceWKID(f);e=m.testSpatialReferenceWKID(e);return f&&e&&f!==e?4326===f?r.geographicToWebMercator:r.webMercatorToGeographic:null};m.toWGS84=function(f){return m.toSpatialReference(f,4326)};m.toWebMercator=function(f){return m.toSpatialReference(f,102100)};m.toSpatialReference=function(f,e){f&&!f.toJson&&(f=p.fromJson(f));e=m.getGeometryConverter(f&&
f.spatialReference,e);return null!=e?e(f):f};return m})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ZoomSelect":function(){define("dojo/_base/declare dojo/dom-construct esri/dijit/geoenrichment/lists/FlowListDefaultItemRenderer ./Select ./ZoomUtil esri/dijit/geoenrichment/utils/NodeLabelEditor dojo/i18n!esri/nls/jsapi".split(" "),function(r,p,m,h,f,e,b){b=b.geoenrichment.dijit.ReportPlayer.PlayerToolbar;var c=r(m,{createPresentation:function(d,a,g,l){var k=this,n=this.inherited(arguments);if(d.isCustomZoom){n.innerHTML=
"";var q=p.create("div",{"class":"esriGELink",innerHTML:b.customZoom},n),u=new e({numericOnly:!0,onApply:function(t){k.onCustomZoomApplied(t);q.innerHTML=b.customZoom},onCancel:function(){q.innerHTML=b.customZoom}});q.addEventListener("click",function(){u.range={min:10,max:1E3};u.editNodeLabel(q,"")})}else this.selectPresentation(n,a);return n},onCustomZoomApplied:function(d){}});return r(h,{listClass:"esriGEOnDemandSelectUnlimitedTallList esriGEOnDemandSelectSpacedOut",buildRendering:function(){var d=
this;this.inherited(arguments);this.itemRenderer=new c({onCustomZoomApplied:function(a){d.set("value",a);d.onChange({value:a});d.closePopup()}})},postCreate:function(){this.inherited(arguments);var d=f.getOptions().slice();d.push({isCustomZoom:!0,enabled:!1});this.set("options",d);this.set("value",100)}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ZoomUtil":function(){define(["dojo/i18n!esri/nls/jsapi"],function(r){var p={};r=r.geoenrichment.dijit.ReportPlayer.PlayerToolbar;p.FIT_PAGE="fitPage";
p.FIT_PAGE_WIDTH="fitPageWidth";p.FIT_PAGE_HEIGHT="fitPageHeight";p.getOptions=function(){var m=[{value:p.FIT_PAGE,label:r.fitPage},{value:p.FIT_PAGE_WIDTH,label:r.fitPageWidth},{value:p.FIT_PAGE_HEIGHT,label:r.fitPageHeight}];[{value:400,label:"400%"},{value:200,label:"200%"},{value:150,label:"150%"},{value:125,label:"125%"},{value:100,label:"100%"},{value:90,label:"90%"},{value:80,label:"80%"},{value:70,label:"70%"},{value:60,label:"60%"},{value:50,label:"50%"}].forEach(function(h){m.push({isCustom:!0,
value:-1,label:""});m.push(h)});m.push({isCustom:!0,value:-1,label:""});return m};p.getClosestZoomAndUpdateOptions=function(m,h){h.forEach(function(c){c.isCustom&&(c.value=-1,c.hidden=!0)});var f=[];h.forEach(function(c){c.isCustom||"number"!==typeof c.value||f.push({option:c,value:c.value,score:m<c.value?m/c.value:c.value/m})});f.sort(function(c,d){return d.score-c.score});var e=f[0];if(1===e.score)return e.value;var b=h.indexOf(e.option);h=h[b+(m>e.value?-1:1)];h.value=m;h.label=Math.round(m)+"%";
h.hidden=!1;return h.value};return p})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ToolbarArranger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","esri/dijit/geoenrichment/utils/DomUtil"],function(r,p,m,h){return r(null,{showAreaTitle:!1,stretchToolbarNode:null,domNode:null,infographicsSelectDiv:null,areaTitleDiv:null,areaTitleInnerDiv:null,rightSideControlsBlock:null,areasSelectDiv:null,zoomSelectDiv:null,pageSelectDiv:null,commandButtonsContainer:null,constructor:function(f){p.mixin(this,
f)},arrangeControls:function(){h[0<this.infographicsSelectDiv.children.length?"show":"hide"](this.infographicsSelectDiv);h[this.showAreaTitle?"show":"hide"](this.areaTitleDiv);this.domNode.style.width="";this.areaTitleDiv.style.marginLeft="";this.areaTitleInnerDiv.style.maxWidth="";this.rightSideControlsBlock.style.position=this.stretchToolbarNode?"absolute":"static";this.stretchToolbarNode&&(this.domNode.style.width=this.stretchToolbarNode.clientWidth+"px",this._processStretchSpecialCases(this.stretchToolbarNode));
this.syncRightSideVisibility()},_processStretchSpecialCases:function(f){function e(c){return h.isHidden(c)?0:c.clientWidth+b(c)}function b(c){return h.isHidden(c)?0:m.get(c,"marginLeft")+m.get(c,"marginRight")}this.showAreaTitle&&(f=f.clientWidth,f-=e(this.infographicsSelectDiv),f-=e(this.rightSideControlsBlock),f-=e(this.areasSelectDiv),f-=b(this.areaTitleDiv),this.areaTitleInnerDiv.style.maxWidth=f+"px",h.isHidden(this.infographicsSelectDiv)||h.isHidden(this.infographicsSelectDiv)||(this.areaTitleDiv.style.marginLeft=
Math.min(f-this.areaTitleDiv.clientWidth,(this.domNode.clientWidth-this.areaTitleDiv.clientWidth)/2-e(this.infographicsSelectDiv))+"px"))},hasVisibleControls:function(){return[this.infographicsSelectDiv,this.areaTitleDiv,this.areasSelectDiv,this.pageSelectDiv,this.zoomSelectDiv,this.commandButtonsContainer].some(h.isNodeInLayout)},syncRightSideVisibility:function(){h.show(this.rightSideControlsBlock);var f=[this.pageSelectDiv,this.zoomSelectDiv,this.commandButtonsContainer].some(h.isNodeInLayout);
h[f?"show":"hide"](this.rightSideControlsBlock)}})})},"esri/dijit/geoenrichment/utils/InvokeUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(r,p){return{invoke:function(m,h,f,e,b){m.__invokeTimeoutIDs||(m.__invokeTimeoutIDs={});var c=m.__invokeTimeoutIDs[h];if(c){if(null==f||!1===e)return c.dfd.promise;clearTimeout(c.handle)}c||(c=m.__invokeTimeoutIDs[h]={dfd:new r});c.handle=setTimeout(function(){delete m.__invokeTimeoutIDs[h];p(b?m[h].apply(m,
b):m[h](),function(d){c.dfd.resolve(d)},function(d){c.dfd.reject(d)})},f||0);return c.dfd.promise},hasPendingInvoke:function(m,h){return!(!m.__invokeTimeoutIDs||!m.__invokeTimeoutIDs[h])},cancelInvoke:function(m,h){m.__invokeTimeoutIDs&&m.__invokeTimeoutIDs[h]&&(clearTimeout(m.__invokeTimeoutIDs[h].handle),delete m.__invokeTimeoutIDs[h])}}})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayerViewModel":function(){define("dojo/_base/declare dojo/aspect esri/dijit/geoenrichment/promise/all ./core/layout/LayoutBuilder ./core/themes/ThemeLibrary ./core/themes/ReportThemes ./core/supportClasses/map/layers/locator/LocatorPointsController ./core/supportClasses/map/layers/std/StdPolygonsController ./core/supportClasses/map/layers/thisAreas/ThisAreasHighlightController ./core/supportClasses/EditorUnits ../utils/ColorUtil".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g){return r(null,{isReportPlayerViewModel:!0,isGraphicStyle:!1,layoutBuilder:null,dynamicReportInfo:null,enableDataDrilling:!1,preInitialize:function(){this.layoutBuilder=this.layoutBuilder||new h;return this.layoutBuilder.initCoreComponents()},initialize:function(l,k){this.preInitialize();return this.layoutBuilder[l?"initClassicComponents":"initGraphicComponents"](k)},_animationAllowed:!1,_animationSuspended:!1,isAnimationAllowed:function(){return this._animationAllowed&&
!this._animationSuspended},setAnimationAllowed:function(l){this._animationAllowed=l},setAnimationSuspended:function(l){this._animationSuspended=l},_theme:null,getCurrentTheme:function(l){return l||this._theme},setTheme:function(l){this._theme=l||f.getReportThemeById(e.GRAPHIC)},getTableDefaultStyles:function(l,k){l=this.getCurrentTheme(l).table.overrideStyles;return k?l[k]:l},getChartDefaultStyles:function(l){return this.getCurrentTheme(l).chart},getDocumentDefaultStyles:function(l){return this.getCurrentTheme(l).document},
getInfographicDefaultStyles:function(l){return this.getCurrentTheme(l).infographic},getStaticInfographicDefaultStyles:function(l){return(l=this.getInfographicDefaultStyles(l))&&l.staticInfographic},isLightDocumentTheme:function(l){return g.isLightColor(this.getCurrentTheme(l).document.backgroundColor)},setDynamicReportInfo:function(l){this.dynamicReportInfo=l;this.isGraphicStyle=l.reportObject.isGraphicReport},getDynamicImageFunc:function(l,k,n){},_locatorPointsControllers:null,getLocatorPointsController:function(l,
k){var n=l.calculatorName+"_"+k;this._locatorPointsControllers=this._locatorPointsControllers||{};var q=this._locatorPointsControllers[n];q||(q=this._locatorPointsControllers[n]=new b(l,this.dynamicReportInfo.fieldData,this.dynamicReportInfo.isMultiFeature,k),p.after(q,"destroy",function(){delete this._locatorPointsControllers[n]}.bind(this)));return q},_stdPolygonsControllers:null,getStdPolygonsController:function(l,k){this._stdPolygonsControllers=this._stdPolygonsControllers||{};var n=l+"_"+(k||
0),q=this._stdPolygonsControllers[n];q||(q=this._stdPolygonsControllers[n]=new c(l,this.dynamicReportInfo.fieldData,this.dynamicReportInfo.isMultiFeature,k),p.after(q,"destroy",function(){delete this._stdPolygonsControllers[n]}.bind(this)));return q},loadAllStdFeatures:function(){var l=[],k;for(k in this._stdPolygonsControllers)l.push(this._stdPolygonsControllers[k].loadAllFeatures());return m(l)},_thisAreasHighlightController:null,getThisAreasHighlightController:function(){this._thisAreasHighlightController||
(this._thisAreasHighlightController=new d,p.after(this._thisAreasHighlightController,"destroy",function(){this._thisAreasHighlightController=null}.bind(this)));return this._thisAreasHighlightController},_legendControllers:null,registerLegendController:function(l,k,n){this._legendControllers=this._legendControllers||{};var q=this._legendControllers[k]=this._legendControllers[k]||{};q[n]=l;var u=l.addCallback(function(t,v){if(v)for(var y in q)v=q[y],v!==l&&v.setLegendVisible(t)},"viewModel");return{remove:function(){delete q[n];
u.remove()}}},_benchmarkController:null,_benchmarkDisabled:!1,getBenchmarkController:function(){return!this._benchmarkDisabled&&this._benchmarkController},registerBenchmarkController:function(l){this._benchmarkController&&this._benchmarkController.destroy();this._benchmarkController=l;p.after(this._benchmarkController,"destroy",function(){this._benchmarkController=null}.bind(this))},isBenchmarkedArea:function(l){return this._benchmarkDisabled?!1:"number"===typeof l&&this._benchmarkController&&0<=
this._benchmarkController.getAreaIndex()&&this._benchmarkController.getAreaIndex()!==l},setBenchmarkDisabled:function(l){this._benchmarkDisabled=l},reset:function(){[this._locatorPointsControllers,this._stdPolygonsControllers].forEach(function(l){l&&Object.keys(l).forEach(function(k){(k=l[k])&&k.destroy()})});this._stdPolygonsControllers=this._locatorPointsControllers=null;this._thisAreasHighlightController&&this._thisAreasHighlightController.destroy();this._thisAreasHighlightController=null},canExportToExcel:function(){return!1},
exportToExcel:function(l){},prepareExportToExcelParameters:function(l){},getUnits:function(){return"px"},provideUnits:function(l){return a.provideUnits(l,this.getUnits())},roundForUnits:function(l){return a.round(l,this.getUnits())}})})},"esri/dijit/geoenrichment/ReportPlayer/core/layout/LayoutBuilder":function(){define(["dojo/_base/declare","dojo/_base/lang","esri/dijit/geoenrichment/Deferred","dojo/dom-construct"],function(r,p,m,h){return r(null,{_moduleMap:null,_getModulePaths:function(){return{core:{section:"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionRenderer",
grid:"esri/dijit/geoenrichment/ReportPlayer/core/grid/AdjustableGrid",image:"esri/dijit/geoenrichment/ReportPlayer/core/annotations/image/ImageRenderer",chart:"esri/dijit/geoenrichment/ReportPlayer/core/charts/ChartRenderer",map:"esri/dijit/geoenrichment/ReportPlayer/core/map/MapRenderer"},classic:{reportContainer:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainer/ReportContainer"},graphicCore:{shape:"esri/dijit/geoenrichment/ReportPlayer/core/annotations/shape/ShapeRenderer",infographic:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicRenderer"},
graphic_fullPages:{reportContainerGrid:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerGrid/ReportContainerGrid"},graphic_panelsInSlides:{reportContainerPagination:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerPagination/ReportContainerPagination",infographicPage:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPage"},graphic_panelsInStack:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"},
graphic_panelsInStackAll:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",reportContainerStackAll:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStackAll",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"},graphic_panelsInRow:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"}}},
initCoreComponents:function(){var f=this._getModulePaths();return this._initPaths(p.mixin({},f.core,f.graphicCore))},initClassicComponents:function(){var f=this._getModulePaths();return this._initPaths(p.mixin({},f.core,f.classic))},initGraphicComponents:function(f){var e=this._getModulePaths();return this._initPaths(p.mixin({},e.core,e.graphicCore,e["graphic_"+f]||e.graphic_fullPages))},_initPaths:function(f){var e=this;this._moduleMap=this._moduleMap||{};var b=[],c;for(c in f)b.push({id:c,path:f[c]});
var d=new m;require(b.map(function(a){return a.path}),function(){for(var a=0;a<arguments.length;a++)e._moduleMap[b[a].id]=arguments[a];d.resolve()});return d.promise},createElement:function(f,e,b,c){switch(f){case "grid":case "reportContainer":case "reportContainerGrid":case "reportContainerPagination":case "reportContainerStack":case "reportContainerStackAll":case "infographicPage":case "infographicPageStack":return new this._moduleMap[f](e,b?h.create("div",null,b,c):void 0);case "section":return this._moduleMap.section.createSection(e,
b,c);case "emptySection":return this._moduleMap.section.createEmptySection(e,b,c);case "image":return this._moduleMap.image.createImageContainer(e);case "shape":return this._moduleMap.shape.createShapeContainer(e);case "chart":return this._moduleMap.chart.createChartPage(e);case "infographic":return this._moduleMap.infographic.createInfographicPage(e);case "map":return this._moduleMap.map.createMapContainer(e)}return!1},getClass:function(f){return this._moduleMap[f]}})})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeLibrary":function(){define("dojo/_base/lang ./PageBorderStyles ../charts/utils/ChartLineStyles ./ReportThemes ./ThemeUtil esri/dijit/geoenrichment/utils/ObjectUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(r,p,m,h,f,e,b){function c(k){k=k||{};k=k.defaultFontFamilty||"Avenir Next";return{backgroundColor:"#FFFFFF",padding:5,icon:{backgroundColor:"#56a5d8"},highlightedIcon:{backgroundColor:"#D6851A"},iconBarBackground:{backgroundColor:"#AAAAAA",borderColor:"#AAAAAA"},titleLine:{color:"#A8A7A8"},titleStyle:{fontFamily:k,color:"#828282",fontSize:16,backgroundColor:"transparent"},variableLabelStyle:{fontFamily:k,color:"#56a5d8",fontSize:24,backgroundColor:"transparent"},variableLabelStyleHighlighted:{fontFamily:k,
fontSize:24},variableLabelStyleContrast:{fontFamily:k,fontSize:24},variableDescriptionStyle:{fontFamily:k,color:"#828282",fontSize:13,backgroundColor:"transparent"}}}function d(){return{style:p.ALL,lineStyle:"dashed",thickness:1,color:"#b2b2b2"}}function a(k){k=k||{};var n=k.defaultFontFamilty||"Avenir Next",q=k.defaultFontSize||13;return{document:{fontSize:q,fontFamily:n,backgroundImage:{data:null,position:"center",repeat:!1,scale:!0,opacity:1,size:null},border:d()},icon:{backgroundColor:"#56a5d8"},
highlightedIcon:{backgroundColor:"#D6851A"},table:{dataTablePadding:5,tooltip:{color:"#4c4c4c",backgroundColor:"#FFFFFF"},tooltipLink:{color:"#4c4c4c"}},chart:{renderSingleDataSeriesWithSameColor:!0,outlineStyle:m.SOLID,titleStyle:{fontFamily:n,fontSize:16},xAxis:{gridLinesStyle:m.SOLID,axisStyle:{fontFamily:n,fontSize:9},titleStyle:{fontFamily:n,fontSize:q}},yAxis:{gridLinesStyle:m.SOLID,baseLineStyle:m.SOLID,axisStyle:{fontFamily:n,fontSize:9},titleStyle:{fontFamily:n,fontSize:q}},dataLabelsStyle:{fontFamily:n,
fontSize:10},legendStyle:{fontFamily:n,fontSize:10},minMaxLegend:{titleStyle:{fontFamily:n,fontSize:10},minVariableLabelStyle:{fontFamily:n,fontSize:16},maxVariableLabelStyle:{fontFamily:n,fontSize:16}},icon:{backgroundColor:"#56a5d8"},line:{},column:{},bar:{},pie:{},donut:{},ring:{},pictureColumn:{},pictureBar:{},gauge:{dataLabelStyle:{fontFamily:n}},waffle:{dataValueStyle:{fontFamily:n,fontSize:30},dataLabelStyle:{fontFamily:n,fontSize:16}},tooltip:{color:"#4c4c4c",backgroundColor:"#FFFFFF"},tooltipLink:{color:"#4c4c4c"}},
infographic:{staticInfographic:c(k)}}}var g={DEFAULT_FONT_FAMILY_CLASSIC:"Verdana",DEFAULT_FONT_FAMILY_GRAPHIC:"Avenir Next",DEFAULT_FONT_SIZE_CLASSIC:10,DEFAULT_FONT_SIZE_GRAPHIC:13,CHART_DATA_FONT_SIZE:10,defaultStaticInfographic:c(),standardRamps:[{id:h.CLASSIC,colors:["#FFFFFF","#13729F","#DEA429"],additional:{table:{overrideStyles:{Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"},ReportTitle:{color:"#FFFFFF",backgroundColor:"#00436D"},TableHeader:{color:"#4C4C4C",backgroundColor:"#CCCCCC"},
GreyText:{color:"#AAAAAA",backgroundColor:"#FFFFFF"},BlueText:{color:"#00436D",backgroundColor:"#FFFFFF"},AlternatingRow:{color:"#4C4C4C",backgroundColor:"#EEEEEE"}}},chart:{renderSingleDataSeriesWithSameColor:!1,colors:"#13729F #DEA429 #6A9741 #A75523 #456E35 #D7DF22 #868686 #3C546D #829AB3 #DEDEDE #03406E #B1B1B1".split(" ")}}},{id:h.GRAPHIC,colors:["#FFFFFF","#56A5D8","#D6851A"],additional:{chart:{colors3series:["#56A5D8","#AED6F1","#2874A6"],colors:"#AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}},
{id:"red",colors:["#d3d3d3","#8b4513","#ff4500"],additional:{chart:{colors3series:["#8b4513","#F1948A","#E74C3C"],colors:"#8b4513 #F1948A #EC7063 #E74C3C #CB4335 #B03A2E #943126 #78281F".split(" ")}}},{id:"dark",colors:["#6A6A6A","#FFFFFF","#EEEEEE"],additional:{chart:{colors3series:["#FFFFFF","#CACFD2","#A6ACAF"],colors:"#FFFFFF #D7DBDD #CACFD2 #BDC3C7 #A6ACAF #909497 #797D7F #626567 #4d4d4d #3e3e3e #262626".split(" ")}}},{id:"green",colors:["#556b2f","#90ee90","#ffffe0"],additional:{chart:{colors3series:["#E9F7EF",
"#A9DFBF","#27AE60"],colors:"#E9F7EF #A9DFBF #7DCEA0 #52BE80 #27AE60 #229954 #1E8449 #196F3D #145A32".split(" ")}}},{id:"green2",colors:["#FFFFFF","#0B7AC0","#35AC46"],additional:{chart:{colors3series:["#56A5D8","#AED6F1","#2874A6"],colors:"#56A5D8 #AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}}]},l={};g.standardRamps.forEach(function(k){var n=r.mixin({},k.additional);n.id=k.id;var q=a({defaultFontFamilty:k.id===h.CLASSIC?"Verdana":"Avenir Next",defaultFontSize:k.id===
h.CLASSIC?10:13});f.applyThemeColorsToTheme({theme:q,colors:k.colors});e.populateObject(q,n,!0);g[k.id]=q;l[k.id]=q});g.TABLE_STYLES="Default ReportTitle TableHeader GreyText BlueText AlternatingRow".split(" ");g.getReportThemeById=function(k){return l[k]};g.isStandardTheme=function(k){return!!l[k]};g.getStandardThemes=function(){return Object.keys(l).map(function(k){return l[k]})};g.getDefaultStaticInfographicSettings=function(){return r.clone(g.defaultStaticInfographic)};g.getDefaultBorderSettings=
function(){return d()};g.getDefaultTheme=function(k){return a(k)};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/PageBorderStyles":function(){define([],function(){var r={NONE:"none",ALL:"all",INNER_ONLY:"innerOnly",OUTER_ONLY:"outerOnly",HORIZONTAL_INNER_ONLY:"horizontalInnerOnly",VERTICAL_INNER_ONLY:"verticalInnerOnly",isSupported:function(p){for(var m in r)if(r[m]===p)return!0;return!1},toSupportedValue:function(p){return r.isSupported(p)?p:r.ALL}};return r})},"esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/ChartLineStyles":function(){define([],
function(){var r={SOLID:"Solid",DASHED:"Dashed",DOTTED:"Dotted",isSupported:function(p){for(var m in r)if(r[m]===p)return!0;return!1},toGFXValue:function(p,m){switch(p){case "Dashed":return 1>m?"LongDash":"Dash";case "Dotted":return 1>m?"Dash":"Dot";default:return"Solid"}}};return r})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ReportThemes":function(){define([],function(){return{GRAPHIC:"graphic",CLASSIC:"classic",COMPARISON:"comparison"}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUtil":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/ColorUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],function(r,p,m){function h(c){var d=p.isLightColor(c);return p.transform(c,{dv:d?-7:7}).toHex()}var f={getPanelTitleColor:function(c){var d=p.isLightColor(c);return p.transform(c,{dv:d?-50:50}).toHex()},getChartElementBackgroundColor:function(c){var d=p.isLightColor(c);return p.transform(c,{dv:d?-13:13}).toHex()}},e={getThemeColors:function(c){return[c.document.backgroundColor,c.icon.backgroundColor,c.highlightedIcon.backgroundColor]},
generateChartColors:function(c,d,a){a=a||{};var g=a.gradientFactor||1,l=[d,p.transform(d,{dv:-20*g}).toHex(),p.transform(d,{dv:-40*g}).toHex(),p.transform(d,{dv:-50*g}).toHex(),p.transform(d,{dv:-55*g}).toHex(),p.transform(d,{dv:-60*g}).toHex(),p.transform(d,{dv:-65*g}).toHex(),p.transform(d,{dv:-70*g}).toHex()];if(a.numLighterColors)for(var k=0;k<a.numLighterColors;k++)l.unshift(p.transform(d,{dv:20*g*(k+1),ds:-20*(k+1)}).toHex());c&&c!==d&&l.unshift(c);var n={};return l.filter(function(q){return n[q]?
!1:n[q]=!0})},applyThemeColorsToTheme:function(c){var d=c.theme,a=c.colors,g=c.preserveForegroundColor,l=c.chartColors,k=c.colors3series;c=c.preprocessGeneratedThemeFunc;var n=a[0],q=a[1];a=a[2];var u=g&&d.chart&&d.chart.dataLabelsStyle&&d.chart.dataLabelsStyle.color||p.getContrastColor(n).toHex();g=g&&d.document.color||("#FFFFFF"===n.toUpperCase()?"#4C4C4C":u);var t=p.isLightColor(n),v=f.getChartElementBackgroundColor(n),y=f.getPanelTitleColor(n),B=p.transform(n,{dv:t?-33:33}).toHex(),D={overrideStyles:{Default:{color:g,
backgroundColor:"transparent"},TableHeader:{color:p.getContrastColor(q,void 0,void 0,200).toHex(),backgroundColor:q},AlternatingRow:{color:g,backgroundColor:p.transform(n,{dv:t?-7:7}).toHex()},ReportTitle:{color:a,backgroundColor:"transparent"},GreyText:{color:B,backgroundColor:"transparent"},BlueText:{color:"#56A5D8",backgroundColor:"transparent"}}},E={lineColor:u,gridLinesColor:u,gridStripesColor:h(n),gridStripesColorAlt:"transparent",axisStyle:{color:u},titleStyle:{color:u}},F={lineColor:u,gridLinesColor:u,
gridStripesColor:h(n),gridStripesColorAlt:"transparent",baseLineColor:u,axisStyle:{color:u},titleStyle:{color:u}};var z=p.isLightColor(n)?"#666666":"#BBBBBB";n={document:{color:g,backgroundColor:n,border:{color:B}},icon:{backgroundColor:q},highlightedIcon:{backgroundColor:a},table:D,chart:{backgroundColor:"transparent",outlineColor:void 0,titleStyle:{color:y},dataLabelsAltColor:u,dataLabelsStyle:{color:u},xAxis:E,yAxis:F,legendStyle:{color:u,backgroundColor:"transparent"},minMaxLegend:{titleStyle:{color:u}},
comparisonInfo:{lineColor:z},icon:{backgroundColor:q},ring:{ringBackground:{backgroundColor:v}},gauge:{dataLabelStyle:{color:q},othersColor:v,arrowIndicator:{lineColor:y,backgroundColor:y}},waffle:{dataValueStyle:{color:q},dataLabelStyle:{color:q},othersColor:v},columnBarBackground:{backgroundColor:v}},infographic:{backgroundColor:"transparent",agePyramid:{theme:t?"light":"common",male:{backgroundColor:q},female:{backgroundColor:a}},staticInfographic:{backgroundColor:"transparent",icon:{backgroundColor:q},
highlightedIcon:{backgroundColor:a},iconBarBackground:{},titleLine:{color:p.transform(n,{dv:t?-40:40}).toHex()},titleStyle:{color:y},variableLabelStyle:{color:q},variableLabelStyleHighlighted:{color:a},variableLabelStyleContrast:{color:n},variableDescriptionStyle:{color:p.transform(n,{dv:t?-50:50}).toHex()}}}};c&&c(n);m.populateObject(d,n,!0);d.chart.colors=l&&l.length?l:e.generateChartColors(q,a);d.chart.colors3series=k},applyTextStyleToTheme:function(c,d){function a(l,k){var n=r.mixin({},d);l&&
delete n.color;k||delete n.fontSize;return n}d=e.filterTextStyles(d);var g={document:a(!1,!0),table:{overrideStyles:{Default:a(!1,!0),TableHeader:a(!1,!0),AlternatingRow:a(!1,!0),ReportTitle:a(!1,!0),GreyText:a(!1,!0),BlueText:a(!1,!0)}},chart:{titleStyle:a(),dataLabelsStyle:a(),xAxis:{axisStyle:a(),titleStyle:a()},yAxis:{axisStyle:a(),titleStyle:a()},legendStyle:a(),minMaxLegend:{titleStyle:a(),minVariableLabelStyle:a(!0),maxVariableLabelStyle:a(!0)},gauge:{dataLabelStyle:a()},waffle:{dataValueStyle:a(),
dataLabelStyle:a()}},infographic:{staticInfographic:{titleStyle:a(),variableLabelStyle:a(),variableLabelStyleHighlighted:a(),variableLabelStyleContrast:a(),variableDescriptionStyle:a()}}};m.populateObject(c,g,!0)}},b={fontFamily:1,fontSize:1,fontWeight:1,fontStyle:1,textDecoration:1,color:1};e.filterTextStyles=function(c){var d={},a;for(a in b){var g=c[a];void 0!==g&&(d[a]=g)}return d};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/locator/LocatorPointsController":function(){define("dojo/_base/declare dojo/on dijit/Destroyable ../../../../../dataProvider/supportClasses/data/AreaDataUtil ../../MapEventUtil esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),
function(r,p,m,h,f,e){return r(m,{_info:null,_fieldData:null,_isMultiFeature:null,_calcDataArray:null,_currentFeatureIndex:null,_layerNames:null,constructor:function(b,c,d,a){this._info=b;this._fieldData=c;this._isMultiFeature=d;this._currentFeatureIndex=a;this._layerIndexes={};this._layerNames={};this._rendererJsons={};this._mapInfos={};this._graphicLayerInfos={}},_getCalculatorName:function(){return this._info.calculatorName},getVariableObjects:function(){return this._info.variableObjects},getLayerID:function(){return this._info.layerID},
getLayerUrl:function(){return this._info.layerUrl},getLayerName:function(b){return this._layerNames[b]||this._info.layerName},setLayerName:function(b,c){this._layerNames[b]=c},getCalculatorDataArray:function(){if(!this._calcDataArray)if(this._isMultiFeature){var b=h.combineAreaDataObjectCalculators(this._fieldData.areaData,this._getCalculatorName());this._calcDataArray=h.removeDuplicacatedCalcData(b.thisAreas.concat(b.comparisonLevels))}else this._calcDataArray=(b=h.getAreaDataObjectCalculator(this._fieldData.areaData[this._currentFeatureIndex],
this._getCalculatorName()))&&[b.data].concat(b.comparisonLevels);return this._calcDataArray},_rendererJsons:null,getRendererJson:function(b){return this._rendererJsons[b]},setRendererJson:function(b,c){this._rendererJsons[b]=c},_layerIndexes:null,getLayerIndex:function(b){return this._layerIndexes[b]},setLayerIndex:function(b,c){this._layerIndexes[b]=c},_mapInfos:null,getMapInfo:function(b){return this._mapInfos[b]},getMapInfos:function(){var b=[],c;for(c in this._mapInfos)b.push(this._mapInfos[c]);
return b},setMapInfo:function(b,c){this._mapInfos[b]=c},_getPointIndexForCellFunc:null,_getCellForPointAtFunc:null,_highlightedCell:null,setLocatorTableCallbacks:function(b){this._getPointIndexForCellFunc=b.getPointIndexForCellFunc;this._getCellForPointAtFunc=b.getCellForPointAtFunc},registerLocatorTable:function(b){var c=this,d;b.set("highlightRowsOnHover",!0);p(b.domNode,"mouseover,mousemove",function(){var a=b.getOverFieldCell();a&&a!==d&&(d=a,c._highlightGraphicForFieldCell(d))});p(b.domNode,
"mouseout",function(){c._highlightGraphicForFieldCell(null);d=null})},_highlightRowForGraphic:function(b,c){this._highlightedCell&&(this._highlightedCell.parentGrid&&this._highlightedCell.parentGrid.setCellRowHighlighted(this._highlightedCell,!1),this._highlightedCell=null);c&&this._getCellForPointAtFunc&&(b=b.getPointIndexForGraphicFunc(c),(b=this._getCellForPointAtFunc(b))&&b.parentGrid&&(b.parentGrid.setCellRowHighlighted(b,!0),this._highlightedCell=b))},_graphicLayerInfos:null,setLocatorPointsLayer:function(b,
c,d,a){this._unSetInfo(b);c={map:d,graphicsLayer:c,getPointIndexForGraphicFunc:a.getPointIndexForGraphicFunc,getGraphicForPointAtFunc:a.getGraphicForPointAtFunc,setGraphicHighlightedFunc:a.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null,overGraphic:null};this._graphicLayerInfos[b]=c;this._addLayerListeners(c)},_addLayerListeners:function(b){var c=this,d=b.map,a=b.graphicsLayer;b.layerMouseOverHandle=f.onLayerMouseOver(a,d,function(g){g.graphic&&
g.graphic._graphicsLayer===a&&b.overGraphic!==g.graphic&&((b.layerMouseOutHandle&&b.layerMouseOutHandle.remove(),b.layerMouseOutHandle=null,c._removeHighlight(b),b.overGraphic=g.graphic,c._highlightRowForGraphic(b,b.overGraphic),b.setGraphicHighlightedFunc(b.overGraphic,!0),e.isMobileDevice())?d.infoWindow&&(d.infoWindow.setFeatures([b.overGraphic]),d.infoWindow.show(g.mapPoint,{closestFirst:!0})):b.layerMouseOutHandle=p.once(a,"mouse-out",function(l){c._removeHighlight(b,!0)}))})},_highlightGraphicForFieldCell:function(b){for(var c in this._graphicLayerInfos){var d=
this._graphicLayerInfos[c];this._removeHighlight(d);if(b){var a=this._getPointIndexForCellFunc(b);if(a=d.getGraphicForPointAtFunc(a))d.setGraphicHighlightedFunc(a,!0),d.highlightedGraphic=a}}},_removeHighlight:function(b,c){this._highlightRowForGraphic(b,null);b.highlightedGraphic&&(b.setGraphicHighlightedFunc(b.highlightedGraphic,!1),b.highlightedGraphic=null);b.overGraphic&&b.setGraphicHighlightedFunc(b.overGraphic,!1);b.overGraphic=null;!c&&b.map.infoWindow&&b.map.infoWindow.hide()},setPointVisibleAt:function(b,
c){for(var d in this._graphicLayerInfos){var a=this._graphicLayerInfos[d].getGraphicForPointAtFunc(b);if(a)a[c?"show":"hide"]()}},_unSetInfo:function(b){var c=this._graphicLayerInfos[b];delete this._graphicLayerInfos[b];c&&(c.layerMouseOverHandle&&c.layerMouseOverHandle.remove(),c.layerMouseOutHandle&&c.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/AreaDataUtil":function(){define(["dojo/_base/lang","../../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../../../_devConfig"],function(r,p,m){var h={getAreaDataValue:function(f){function e(B){!1!==t&&(v=B[t]);void 0===v&&(v=B[c])}function b(){if(k)e(k);else{var B=a[g];B&&e(B.data)}}var c=f.fieldName,d=f.fieldData,a=f.areaDataObject,g=f.calculatorName,l=f.featureIndex,k=f.featureAttributes,n=f.ignoreMetadata,
q=f.isMultiFeature;if(!m.showAreaDataUtilUndefinedData&&c){var u=c.indexOf("."),t=!1;-1!==u&&(t=c.substr(u+1));g||-1===u||(g=c.substr(0,u));l=void 0===l?0:Number(l)||0;if((a=f.areaDataObject||d.areaData[l])||k){var v;q&&g===p.AREA_ATTRIBUTES_CALCULATOR_NAME&&!n&&d&&e(d.metadata);void 0===v&&b();if(g)return v;void 0===v&&!n&&d&&e(d.metadata);if(void 0===v&&!k)for(var y in a)if(e(a[y].data),void 0!==v)break;return v}}},getAreaDataObjectCalculator:function(f,e,b){if(!f)return null;var c=f[e];!c&&b&&
(c=f[e]=h.createCalculator());return c},createCalculator:function(f,e){return{data:f||{},comparisonLevels:e||[]}},combineAreaDataObjectCalculators:function(f,e,b){var c=[],d=[];f.forEach(function(a){if(a=h.getAreaDataObjectCalculator(a,e))c.push(a.data),d=d.concat(a.comparisonLevels)});b&&b.removeDuplicates&&(d=h.removeDuplicacatedCalcData(d));return{thisAreas:c,comparisonLevels:d}},removeDuplicacatedCalcData:function(f){if(!f.length)return f;var e=[],b={},c=Object.keys(f[0]);f.forEach(function(d){var a=
function(g){var l="";c.forEach(function(k){l+=g[k]+";"});return l}(d);b[a]||(b[a]=!0,e.push(d))});return e},setAreaDataValue:function(f,e,b,c,d){d=void 0===d?0:Number(d)||0;h.setAreaDataObjectValue(f,e,b[d],c)},setAreaDataObjectValue:function(f,e,b,c){b&&c&&null!==e&&void 0!==e&&(h.getAreaDataObjectCalculator(b,c,!0).data[f]=e)},mergeAreaData:function(f,e){e.forEach(function(b,c){(c=f[c])&&h.mergeAreaDataObjects(c,b)})},mergeAreaDataObjects:function(f,e){for(var b in f){var c=f[b],d=e[b];d?c.comparisonLevels.length!==
d.comparisonLevels.length?console.log("Error: can't merge calculators with different comparison levels!"):(r.mixin(d.data,c.data),c.comparisonLevels.forEach(function(a,g){r.mixin(d.comparisonLevels[g],a)})):e[b]=c}console.log("AreaDataUtil.js merging area data \x3d\x3e areaData");console.log(e)}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil":function(){define(["esri/dijit/geoenrichment/utils/MaskUtil","./FieldLibrary"],function(r,
p){var m={SCRIPT_PREFIX:"",DEFAULT_SCRIPT_NAME:"Custom",TOTAL_SCRIPT_NAME:"Total",AVG_SCRIPT_NAME:"Average",SCRIPT_PREFIX_RE:/^SCRIPT_/i,FIRST_SYMBOL_IS_NUMBER_RE:/^[0-9]/,DATA_COLLECTIONS_CALCULATOR_NAME:"dataCollectionsCalculator",MAPS_CALCULATOR_NAME:"mapsCalculator",UNITED_MAPS_CALCULATOR_NAME:"unitedMapsCalculator",AREA_ATTRIBUTES_CALCULATOR_NAME:"headers",ENRICHED_DATA_NO_LEVELS:"enrichFieldData_noLevels",SCRIPTS_CALCULATOR_NAME:"scripts",createFieldNameFromSource:function(h,f){if(!h)return"";
var e="";h.isSiteAttribute?e=h.attribute.name:h.isChartAttribute?e=h.id:h.isWebMap?e=h.webMapFieldName||h.fieldName:(h=(h.fullName||h).replace(/_|\.|\s/g,""),f=f||"n",h+="n"===f?"":"_"+f,m.FIRST_SYMBOL_IS_NUMBER_RE.test(h)&&(h="_"+h),e=h.toUpperCase());return m._validateName(e)},createFieldNameFromScript:function(h){h=h.name;m.SCRIPT_PREFIX_RE.test(h)&&(h=h.replace(m.SCRIPT_PREFIX_RE,""));return m._validateName(m.SCRIPT_PREFIX+h.replace(/\.|-/g,""))},_validateName:function(h){return m._checkXMLValidName(m._maskUnicodeInName(h))},
_XML_MASK_NAME_RE:/(_X)(\d\d\d\d)/i,_checkXMLValidName:function(h){return m._XML_MASK_NAME_RE.test(h)?h.replace(m._XML_MASK_NAME_RE,"$1_$2"):h},_XML_UNICODE_RE:/&#x|;/ig,_maskUnicodeInName:function(h){return r.maskWithUnicodeXML(h).replace(m._XML_UNICODE_RE,"")},renderScriptName:function(h){return h.replace(m.SCRIPT_PREFIX_RE,"")},provideQualifiedFieldInfoTemplateName:function(h,f){h&&(h.templateName=f?f+"."+h.name:h.isWebMap?m.AREA_ATTRIBUTES_CALCULATOR_NAME+"."+h.name:h.isSiteAttribute?m.AREA_ATTRIBUTES_CALCULATOR_NAME+
"."+h.name:m.DATA_COLLECTIONS_CALCULATOR_NAME+"."+h.name)},getCalculatorName:function(h){return h&&h.templateName&&h.templateName.substr(0,h.templateName.indexOf("."))},isAreaAttributesFieldInfo:function(h){return m.getCalculatorName(h)===m.AREA_ATTRIBUTES_CALCULATOR_NAME},updateCalculatorName:function(h,f){h&&(h.hasVariable||h.script)&&(h.templateName=f+h.templateName.substr(h.templateName.indexOf(".")))},refreshNameAndTemplateName:function(h){h.statefulName&&h.fullName&&(h.name=m.createFieldNameFromSource(h,
h.statefulName.charAt(0)),h.templateName=h.templateName.substr(0,h.templateName.lastIndexOf(".")+1)+h.name)},getFieldInfoAlias:function(h){return h?h.script?h.script.alias:h.hasVariable||h.isMissing?h.alias:p.getFieldLabel(h.name):null}};return m})},"esri/dijit/geoenrichment/utils/MaskUtil":function(){define([],function(){function r(p,m){return"string"!==typeof p?p:String(p).replace(/[^\x20-\x7f]/g,function(h){h=h.charCodeAt(0).toString(16).toUpperCase();return m(h)})}return{maskWithUnicode:function(p){return r(p,
function(m){return"\\u000".substr(0,6-m.length)+m})},maskWithUnicodeXML:function(p){return r(p,function(m){return"\x26#x000".substr(0,7-m.length)+m+";"})},removeUnicode:function(p,m){return r(p,function(h){return m||""})},removeXMLMasks:function(p,m){return p.replace(/&#x.*?;/g,m||"")}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary":function(){define(["dojo/string","dojo/i18n!esri/nls/jsapi"],function(r,p){var m=p.geoenrichment.dijit.ReportPlayer.FieldInfoLabels;
p=p.geoenrichment.dijit.ReportPlayer.FieldInfoPreview;m={_SPECIAL_HEADER_FIELDS_NAME_MAP:{SITE_NAME:"SiteName",STORE_ADDR:"SiteAddr",AREA_DESC2:"SiteDesc",STORE_LAT:"Latitude",STORE_LONG:"Longitude",AREA_ID:"AreaID",AREA_DESC:"AreaDesc",STORE_ID:"StoreID",RING:"Ring",STORE_NAME:"StoreName",GROUPCOUNT:"SummaryCount"},_ADDITIONAL_HEADER_FIELDS_MAP:{SITENOTE:"SiteNote",SITENOTE2:"SiteNote2",SITENOTE3:"SiteNote3",SITENOTE4:"SiteNote4",SITENOTE5:"SiteNote5",SITENOTE6:"SiteNote6",SITENOTE7:"SiteNote7",
SITENOTE8:"SiteNote8",SITENOTE9:"SiteNote9",SITENOTE10:"SiteNote10",SITENOTES:"SiteNotes",CHART_AREA_NAME:"ChartAreaName",CHART_SERIES_NAME:"ChartSeriesName",CHART_POINT_NAME:"ChartVariableName",CHART_POINT_VALUE:"ChartVariableValue"},_REPORT_VAR_FIELDS_MAP:{REPORTNAME:"Title",REPORTTITLE2:"Subtitle",CURRPAGE:"Page",COPYRIGHT:"Copyright",TRIALURLTEXT:"TrialUrlText",PHONENUMBER:"PhoneNumber",PRODUCTURL:"ProductUrl",PRODUCTLABEL:"ProductLabel",SOURCE:"Source",CENSUSYEAR:"CensusYear",CURRENTYEAR:"CurrentYear",
FUTUREYEAR:"FutureYear",LATITUDELABEL:"LatitudeLabel",LONGITUDELABEL:"LongitudeLabel",PAGEFORMAT:"PageFormat",BANDFROM0TO1UNIT2:"BandFrom0To1Unit2",RADIUS0UNIT1:"Radius0Unit1",AREADELIMITER:"AreaDelimiter",BANDREGIONFROM0TO1:"BandRegionFrom0To1",ET_AL:"ET_AL",LINEBUFFERSEGMENTFROM0TO1UNIT2RADIUS:"LineBufferSegmentFrom0To1Unit2Radius",LINEBUFFERRADIUS0UNIT1RADIUS:"LineBufferRadius0Unit1Radius",RINGVALUE0UNIT1RADIUS:"RingValue0Unit1Radius",RINGSVALUES0UNIT1RADII:"RingsValues0Unit1Radii",RINGBUFFERBANDFROM0TO1UNIT2RADIUS:"RingBufferBandFrom0To1Unit2Radius",
DRIVETIMEBANDFROM0TO1UNIT2RADIUS:"DriveTimeBandFrom0To1Unit2Radius",RINGBUFFERBANDSBANDS0UNIT1RADII:"RingBufferBandsBands0Unit1Radii",RINGBUFFERBANDRING0UNIT1RADIUS:"RingBufferBandRing0Unit1Radius",DRIVETIMEBANDBAND0UNIT1RADIUS:"DriveTimeBandBand0Unit1Radius",DRIVETIMESRINGS0UNIT1RADII:"DriveTimesRings0Unit1Radii",DRIVETIMERING0UNIT1RADIUS:"DriveTimeRing0Unit1Radius",DRIVEDISTANCEVALUE0UNIT1RADIUS:"DriveDistanceValue0Unit1Radius",DRIVEDISTANCESRINGS0UNIT1RADII:"DriveDistancesRings0Unit1Radii",DRIVEDISTANCERING0UNIT1RADIUS:"DriveDistanceRing0Unit1Radius"},
_SPECIAL_HEADER_FIELDS_NAME_MAP_BACK:{},_ADDITIONAL_HEADER_FIELDS_MAP_BACK:{},_REPORT_VAR_FIELDS_MAP_BACK:{},_PREVIEW:{Title:p.fieldPreviewTitle,Title_graphic:p.fieldPreviewTitleGraphic,Subtitle:p.fieldPreviewSubtitle,Date:p.fieldPreviewDate,Page:p.fieldPreviewPage,Count:p.fieldPreviewLocationsCount,Copyright:p.fieldPreviewCopyright,TrialUrlText:p.fieldPreviewTrialUrlText,PhoneNumber:p.fieldPreviewPhoneNumber,ProductUrl:p.fieldPreviewProductUrl,ProductLabel:p.fieldPreviewProductLabel,Source:p.fieldPreviewSource,
SITE_NAME:p.fieldPreviewSiteName,SITE_NAME_multi:p.fieldPreviewSiteNameMulti,STORE_LAT:p.fieldPreviewLat,STORE_LONG:p.fieldPreviewLong,AREA_DESC2:p.fieldPreviewAreaDesc2,STORE_ADDR:p.fieldPreviewStoreAddr,AREA_DESC:p.fieldPreviewAreaDesc,CHART_AREA_NAME:p.fieldPreview_chartArea,CHART_SERIES_NAME:p.fieldPreview_seriesName,CHART_POINT_NAME:p.fieldPreview_pointName},_LABELS:{CHART_AREA_NAME:m.chartAreaName,CHART_SERIES_NAME:m.chartSeriesName,CHART_POINT_NAME:m.chartPointName,CHART_POINT_VALUE:m.chartPointValue},
DATE_FIELD_NAME:"Date",DATE_FIELD_ALIAS:"Date",DATE_FIELD_DEFAULT_FORMAT:"d-MMMM dd, yyyy",GROUPCOUNT_FIELD_NAME:"SummaryCount",GROUPCOUNT_FIELD_ALIAS:"SummaryCount",SITENOTES_FIELD_NAME:"SiteNotes",SITENOTES_FIELD_ALIAS:"SiteNotes",init:function(){for(var h in this._SPECIAL_HEADER_FIELDS_NAME_MAP)this._SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[this._SPECIAL_HEADER_FIELDS_NAME_MAP[h].toUpperCase()]=h;for(h in this._ADDITIONAL_HEADER_FIELDS_MAP)this._ADDITIONAL_HEADER_FIELDS_MAP_BACK[this._ADDITIONAL_HEADER_FIELDS_MAP[h].toUpperCase()]=
h;for(h in this._REPORT_VAR_FIELDS_MAP)this._REPORT_VAR_FIELDS_MAP_BACK[this._REPORT_VAR_FIELDS_MAP[h].toUpperCase()]=h},templateToUIHeader:function(h){h=h&&this.trimTemplateHeaderName(h).toUpperCase();return this._SPECIAL_HEADER_FIELDS_NAME_MAP[h]||this._ADDITIONAL_HEADER_FIELDS_MAP[h]},qualifyTemplateHeaderName:function(h){return h&&0!==h.indexOf("headers.")?"headers."+h:h},trimTemplateHeaderName:function(h){if(!h)return h;0===h.indexOf("headers.")&&(h=h.substr(h.indexOf(".")+1));return h},templateToUIReportVar:function(h){h=
h&&h.toUpperCase();return this._REPORT_VAR_FIELDS_MAP[h]},uiToTemplate:function(h){h=h&&h.toUpperCase();return this._SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[h]||this._ADDITIONAL_HEADER_FIELDS_MAP_BACK[h]||this._REPORT_VAR_FIELDS_MAP_BACK[h]},getPreview:function(h,f,e){h=this.trimTemplateHeaderName(h);if(!h)return null;f&&"Title"===h&&(h+="_graphic");e&&"SITE_NAME"===h&&(h+="_multi");return"SiteNotes"===h?p.fieldPreviewSiteNotes:0===h.indexOf("SiteNote")?r.substitute(p.fieldPreviewSiteNote,{index:h.replace("SiteNote",
"")||1}):this._PREVIEW[h]},hasField:function(h){return!!(this.uiToTemplate(h)||this.templateToUIHeader(h)||this.templateToUIReportVar(h))},isAdditionalHeadersField:function(h){h=h&&this.trimTemplateHeaderName(h).toUpperCase();return this._ADDITIONAL_HEADER_FIELDS_MAP[h]},isChartAttribute:function(h){return this.isAdditionalHeadersField(h)&&-1!==h.toUpperCase().indexOf("CHART_")},getSiteNoteFieldNameAt:function(h){return"SiteNote"+(!h||1>=Number(h)?"":h)},getFieldLabel:function(h){h=h&&this.trimTemplateHeaderName(h).toUpperCase();
return this._LABELS[h]},getReportVarSelfTagsMap:function(){return{Page:"currPage",Title:"reportName",Subtitle:"reportTitle2"}},getReportVarTextTagsMap:function(){var h=this.getReportVarSelfTagsMap(),f={},e;for(e in this._REPORT_VAR_FIELDS_MAP){var b=this._REPORT_VAR_FIELDS_MAP[e];h[b]||(f[b]=b)}return f}};m.init();return m})},"esri/dijit/geoenrichment/ReportPlayer/_devConfig":function(){define([],function(){return{logData:!0,showAreaDataUtilUndefinedData:!1,createPlayerCommand:{saveDataJsonAsTextFile:!1,
useTestBuild:!1,configUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/reportPlayer/config.js",baseUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release",mainUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/dojo/dojo.js",esriDijitCssUrl:"https://js.arcgis.com/3.31/dijit/themes/claro/claro.css",esriCssUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/reportPlayer/reportPlayer.css"},
createPDFCommand:{removeUnicodeChars:!1},preview:{bigValues:!1},charts:{enableEffects:!1},table:{printGridRefresh:!1},emulateErrors:{playerError:!1,contentErrors:!1,themeParseError:!1,metadataParseError:!1,layoutParseError:0,reportContainerRenderError:!1,createReportError:!1,createReportNaN:!1,createReportNull:!1,getMapItemError:!1,emptyDataProviderResponse:!1,emptyTemplateJson:!1}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/MapEventUtil":function(){define(["dojo/on","dojo/sniff",
"esri/dijit/geoenrichment/utils/DeviceUtil"],function(r,p,m){return{onLayerMouseOver:function(h,f,e){var b=m.isMobileDevice();h=b?h:p("touch")?f:h;b=b?"mouse-over":p("touch")?"mouse-down, mouse-move":"mouse-move";return r(h,b,e)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/std/StdPolygonsController":function(){define("dojo/_base/declare esri/dijit/geoenrichment/Deferred dojo/on esri/dijit/geoenrichment/promise/all dijit/Destroyable ../../MapEventUtil ../../../../comparison/ComparisonUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig".split(" "),
function(r,p,m,h,f,e,b,c){return r(f,{currentFeatureIndex:null,_calculatorName:null,_fieldData:null,_isMultiFeature:null,_hasRegisteredLayers:!1,_hasRegisteredInfographics:!1,constructor:function(d,a,g,l){this._calculatorName=d;this._fieldData=a;this._isMultiFeature=g;this.currentFeatureIndex=l;this._layerIndexes={};this._rendererJsons={};this._labelRendererJsons={};this._mapInfos={};this._graphicLayerInfos={};this._pendingLayerInfos={}},getCalculatorName:function(){return this._calculatorName},_rendererJsons:null,
_labelRendererJsons:null,getRendererJson:function(d){return this._rendererJsons[d]},getLabelRendererJson:function(d){return this._labelRendererJsons[d]},setRendererJson:function(d,a){this._rendererJsons[d]=a},setLabelRendererJson:function(d,a){this._labelRendererJsons[d]=a},_layerIndexes:null,getLayerIndex:function(d,a){var g=c.getGeographiesModel().getLevels(),l=-1;g.some(function(k,n){if(k.id===a)return l=n,!0});return this._layerIndexes[d]+l/g.length},setLayerIndex:function(d,a){this._layerIndexes[d]=
a},_mapInfos:null,getMapInfo:function(d){return this._mapInfos[d]},getMapInfos:function(){var d=[],a;for(a in this._mapInfos)d.push(this._mapInfos[a]);return d},setMapInfo:function(d,a){this._mapInfos[d]=a},_attributeFields:null,getAttributeFields:function(){return this._attributeFields},setAttributeFields:function(d){this._attributeFields=d},_shownFeatureAttributes:null,_featuresChangedHandlers:null,getShownFeatureAttributes:function(){return this._shownFeatureAttributes},setShownFeaturesChangedListener:function(d){var a=
this;this._featuresChangedHandlers=this._featuresChangedHandlers||[];this._featuresChangedHandlers.push(d);return{remove:function(){var g=a._featuresChangedHandlers;if(g){var l=g.indexOf(d);-1!==l&&g.splice(l,1)}}}},setShownFeatureAttributes:function(d){this._shownFeatureAttributes=d||[];this._featuresChangedHandlers&&this._featuresChangedHandlers.forEach(function(a){a()})},_allFeatureAttributes:null,_loadAllFeaturesHandlers:null,getAllFeatureAttributes:function(){return this._allFeatureAttributes||
[]},setAllFeatureAttributes:function(d){this._allFeatureAttributes=d},setLoadAllFeaturesListener:function(d){var a=this;this._loadAllFeaturesHandlers=this._loadAllFeaturesHandlers||[];this._loadAllFeaturesHandlers.push(d);return{remove:function(){var g=a._loadAllFeaturesHandlers;if(g){var l=g.indexOf(d);-1!==l&&g.splice(l,1)}}}},loadAllFeatures:function(){return this._loadAllFeaturesHandlers&&h(this._loadAllFeaturesHandlers.map(function(d){return d()}))},buildGeometryFieldName:function(d){return"__stdGeometry_"+
d},saveGeometryInCalculatorData:function(d,a){b.copyValueToCalculatorData(d,{fieldName:a,fieldData:this._fieldData,isMultiFeature:this._isMultiFeature,currentFeatureIndex:this.currentFeatureIndex,calculatorName:this._calculatorName})},provideGeometryFromCalculatorData:function(d,a){b.copyValueFromCalculatorData(d,{fieldName:a,fieldData:this._fieldData,isMultiFeature:this._isMultiFeature,currentFeatureIndex:this.currentFeatureIndex,calculatorName:this._calculatorName})},_highlightInfographicForAttributesFunc:null,
_registerInfographicDfd:null,registerInfographic:function(d){this._highlightInfographicForAttributesFunc=d.highlightInfographicForAttributes;this._registerInfographicDfd=new p;this._hasRegisteredLayers&&this._registerInfographicDfd.resolve();this._hasRegisteredInfographics||(this._hasRegisteredInfographics=!0,this._doRegisterLayers());return this._registerInfographicDfd.promise},_graphicLayerInfos:null,_pendingLayerInfos:null,setStdPolygonsLayer:function(d,a,g,l){this._unSetInfo(d);this._pendingLayerInfos[d]=
{map:g,graphicsLayer:a,getGraphicForAttributesFunc:l.getGraphicForAttributesFunc,setGraphicHighlightedFunc:l.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null};this._hasRegisteredInfographics&&this._doRegisterLayers();this._hasRegisteredLayers||(this._hasRegisteredLayers=!0,this._registerInfographicDfd&&this._registerInfographicDfd.resolve())},_doRegisterLayers:function(){for(var d in this._pendingLayerInfos){var a=this._pendingLayerInfos[d];this._graphicLayerInfos[d]=
a;this._addLayerListeners(a)}this._pendingLayerInfos={}},_addLayerListeners:function(d){var a=this,g=d.graphicsLayer,l;d.layerMouseOverHandle=e.onLayerMouseOver(g,d.map,function(k){k.graphic&&k.graphic._graphicsLayer===g&&l!==k.graphic&&(d.layerMouseOutHandle&&d.layerMouseOutHandle.remove(),d.layerMouseOutHandle=null,l&&d.setGraphicHighlightedFunc(l,!1),l=k.graphic,a._highlightInfographicForAttributesFunc(l.attributes),d.setGraphicHighlightedFunc(l,!0),d.layerMouseOutHandle=m.once(g,"mouse-out",function(n){a._highlightInfographicForAttributesFunc(null);
l&&d.setGraphicHighlightedFunc(l,!1);l=null}))})},highlightGraphicForAttributes:function(d){for(var a in this._graphicLayerInfos){var g=this._graphicLayerInfos[a];g.highlightedGraphic&&(g.setGraphicHighlightedFunc(g.highlightedGraphic,!1),g.highlightedGraphic=null);if(d){var l=g.getGraphicForAttributesFunc(d);l&&(g.setGraphicHighlightedFunc(l,!0),g.highlightedGraphic=l)}}},_unSetInfo:function(d){var a=this._graphicLayerInfos[d];delete this._graphicLayerInfos[d];a&&(a.layerMouseOverHandle&&a.layerMouseOverHandle.remove(),
a.layerMouseOutHandle&&a.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},"esri/dijit/geoenrichment/ReportPlayer/core/comparison/ComparisonUtil":function(){define(["esri/dijit/geoenrichment/utils/ObjectUtil","../../dataProvider/supportClasses/data/AreaDataUtil","dojo/i18n!esri/nls/jsapi"],function(r,p,m){m=m.geoenrichment.dijit.ReportPlayer.ReportPlayer;
var h={valueFormatFunction:function(f,e){return e&&e.isMissing?m.missingVariable:void 0===f||"string"===typeof f?f:r.formatNumber(f,{places:e.decimals,preserveTrailingZeroes:!0})},copyValueToCalculatorData:function(f,e){var b=h._findAttrsInCalcData(e,f);b&&(b[e.fieldName]=f[e.fieldName])},copyValueFromCalculatorData:function(f,e){var b=h._findAttrsInCalcData(e,f);b&&(f[e.fieldName]=b[e.fieldName])},_findAttrsInCalcData:function(f,e){f=f.isMultiFeature?(f=p.combineAreaDataObjectCalculators(f.fieldData.areaData,
f.calculatorName))&&f.comparisonLevels||[]:(f=p.getAreaDataObjectCalculator(f.fieldData.areaData[f.currentFeatureIndex],f.calculatorName))&&f.comparisonLevels||[];var b;f.some(function(c){if(c.StdGeographyLevel&&c.StdGeographyLevel===e.StdGeographyLevel&&c.StdGeographyID===e.StdGeographyID)return b=c,!0});return b}};return h})},"esri/dijit/geoenrichment/ReportPlayer/countryConfig":function(){define(["./dataProvider/supportClasses/stdGeographies/StdGeographiesModel"],function(r){function p(){if(!h||
!h.hierarchies)return"census";var d=h.hierarchies[0].ID;if(1==h.hierarchies.length)return d;if(h.defaultDatasetID)for(var a in h.hierarchies){var g=h.hierarchies[a];if(g.datasets&&g.datasets.some(function(l){return l==h.defaultDatasetID})){d=g.ID;break}}return d}var m={},h;m.getCurrentCountry=function(){return h};m.getCountryID=function(){return h&&h.id};m.getCurrencySymbol=function(){return h&&h.currencySymbol||"$"};m.getCurrencyFormat=function(){if(h&&h.currencyFormat)return h.currencyFormat;var d=
m.getCurrencySymbol();return d+"0;-"+d+"0"};m.setCountry=function(d){h=d};var f,e;m.getSingleUnits=function(){return f};m.getPluralUnits=function(){return e};m.setSingleAndPluralUnits=function(d,a){f=d;e=a};var b;m.getHierarchyID=function(){return b};m.setHierarchyID=function(d){b=d||p()};var c;m.getGeographiesModel=function(){return c};m.setGeographiesModel=function(d){c=d};m.reset=function(){c=e=f=b=h=null};m.toJson=function(){return{country:{id:m.getCountryID(),currencySymbol:m.getCurrencySymbol(),
currencyFormat:m.getCurrencyFormat()},hierarchy:b,geographiesModel:c&&c.toJson()}};m.fromJson=function(d){d&&(h=d.country,b=d.hierarchy,c=d.geographiesModel&&new r(d.geographiesModel))};return m})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/thisAreas/ThisAreasHighlightController":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/Deferred","dojo/on","dijit/Destroyable","../../MapEventUtil"],function(r,p,m,h,f){return r(h,{_hasRegisteredLayers:!1,_hasRegisteredTables:!1,
constructor:function(e){this._graphicLayerInfos={};this._registerTableDfds=[];this._highlightTableForAreaIndexFuncs=[];this._pendingLayerInfos={}},_highlightTableForAreaIndexFuncs:null,_registerTableDfds:null,registerTable:function(e){this._highlightTableForAreaIndexFuncs.push(e.highlightTableForAreaIndex);e=new p;this._registerTableDfds.push(e);this._hasRegisteredLayers&&this._doRegisterTables();this._hasRegisteredTables||(this._hasRegisteredTables=!0,this._doRegisterLayers());return e.promise},
_doRegisterTables:function(){this._registerTableDfds.forEach(function(e){e.resolve()});this._registerTableDfds.length=0},_graphicLayerInfos:null,_pendingLayerInfos:null,setThisAreaLayer:function(e,b,c,d){this._unSetInfo(e);this._pendingLayerInfos[e]={graphicsLayer:b,areaIndex:d.thisAreaIndex,getGraphicForAreaIndexFunc:d.getGraphicForAreaIndexFunc,setGraphicHighlightedFunc:d.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null,map:c};this._hasRegisteredTables&&
this._doRegisterLayers();this._hasRegisteredLayers||(this._hasRegisteredLayers=!0,this._doRegisterTables())},_doRegisterLayers:function(){for(var e in this._pendingLayerInfos){var b=this._pendingLayerInfos[e];this._graphicLayerInfos[e]=b;this._addLayerListeners(b)}this._pendingLayerInfos={}},_addLayerListeners:function(e){var b=this,c=e.graphicsLayer,d;e.layerMouseOverHandle=f.onLayerMouseOver(c,e.map,function(a){a.graphic&&a.graphic._graphicsLayer===c&&d!==a.graphic&&(e.layerMouseOutHandle&&e.layerMouseOutHandle.remove(),
e.layerMouseOutHandle=null,d&&e.setGraphicHighlightedFunc(d,!1),d=a.graphic,b._highlightTableForAreaIndexFuncs.forEach(function(g){g(e.areaIndex)}),e.setGraphicHighlightedFunc(d,!0),e.layerMouseOutHandle=m.once(c,"mouse-out",function(g){b._highlightTableForAreaIndexFuncs.forEach(function(l){l(null)});d&&e.setGraphicHighlightedFunc(d,!1);d=null}))})},highlightGraphicForAreaIndex:function(e){for(var b in this._graphicLayerInfos){var c=this._graphicLayerInfos[b];c.highlightedGraphic&&(c.setGraphicHighlightedFunc(c.highlightedGraphic,
!1),c.highlightedGraphic=null);var d=c.getGraphicForAreaIndexFunc(e);d&&(c.setGraphicHighlightedFunc(d,!0),c.highlightedGraphic=d)}},_unSetInfo:function(e){var b=this._graphicLayerInfos[e];delete this._graphicLayerInfos[e];b&&(b.layerMouseOverHandle&&b.layerMouseOverHandle.remove(),b.layerMouseOutHandle&&b.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},
"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/EditorUnits":function(){define(["esri/dijit/geoenrichment/utils/ObjectUtil","dojo/i18n!esri/nls/jsapi"],function(r,p){p=p.geoenrichment.dijit.ReportPlayer.units;var m={},h=["px","pt","mm","cm","in"],f={px:0,pt:1,mm:1,cm:2,"in":2};m.getSupportedUnits=function(){return h};m.getShortName=function(e){return p.shortNames[e]};m.getLongName=function(e){return p.longNames[e]};m.getLongNameWithUnits=function(e){return p.longNamesWithUnits[e]};m.getPlaces=
function(e){return f[e]||0};m.round=function(e,b){return r.roundNumber(e,m.getPlaces(b))};m.provideUnits=function(e,b){return e.replace("${units}",m.getShortName(b))};return m})},"esri/dijit/geoenrichment/ReportPlayer/DataProviderGE":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/when esri/kernel ./dataProvider/_CommandSupport ./dataProvider/_SerializationSupport ./dataProvider/_ServerSerializationSupport ./dataProvider/supportClasses/areas/AnalysisAreaUtil ./dataProvider/supportClasses/areas/AnalysisAreaJsonUtil ./dataProvider/supportClasses/areas/AreasPreprocessor ./dataProvider/supportClasses/CustomReportsManager ./dataProvider/supportClasses/TemplateJsonLoader ./dataProvider/supportClasses/ReportDataProcessor ./dataProvider/supportClasses/GEUtil ./dataProvider/supportClasses/attachments/DefaultAttachmentsStore ./dataProvider/supportClasses/attachments/CustomAttachmentsStore ./dataProvider/supportClasses/data/VariablesUtil ./dataProvider/commands/mapToImage/MapToURLUtil ./core/themes/ThemeLibrary ./core/themes/ReportThemes esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/countryConfig esri/dijit/geoenrichment/utils/ProjectionUtil esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y,B,D,E,F,z,w,A){return r([e,b,c],{analysisAreasLimit:-1,cacheTemplates:!0,printMapTaskUrl:null,resetReportItemsCache:!0,constructor:function(H){p.mixin(this,H)},_getAttachmentsStore:function(H){return(new u(H)).initialize()},_currentContext:null,getReportData:function(H,G){var I=this,N=G&&G.progressCallback||function(){},M=p.mixin({},H);M.portalUrl=A.getPortalUrl(M.portalUrl);E.isPlayerOnServer||A.setArcgisUrl(M.portalUrl);d.parseSites(M);F.reset();M.hierarchy||
M.analysisAreas.some(function(O){if(O.geographies&&O.geographies[0].hierarchy)return M.hierarchy=O.geographies[0].hierarchy,!0});I.resetReportItemsCache&&l.resetCache();I._currentContext=M;M.analysisAreas=a.areasFromJson(M.analysisAreas);M.combinedAreasInfo=M.combinedAreasInfo&&a.combinedAreasInfoFromJson(M.combinedAreasInfo)||{};d.populateCombinedAreasInfo(M.combinedAreasInfo,M.analysisAreas);M.fieldData={specialTradeAreaCalculatorName:null,runReportTaskIDs:null,metadata:{},areaData:[],errors:[],
reportInfo:null};return m([h(l.tryFindReportIdByAlias(M),function(O){M.reportID=O||M.reportID}),this._discoverPortal(M),function(){return M.variables&&h(v.preprocessVariables(M.variables,M.portalUrl),function(O){M.variables=O})}()]).then(function(){return h(g.preprocessAreas(M,{analysisAreasLimit:I.analysisAreasLimit}),function(){N(.25);setTimeout(function(){I._onCreateReportStarted()});var O=M.attachmentsProvider?t(M.attachmentsProvider):I._getAttachmentsStore(M.analysisAreas),S={initGE:q.initialize(),
countryInfo:q.getCountryInfo(M.countryID),attachmentsStore:O};M.reportID?(S.reportObject=l.getCustomReportByID(M),S.templateJsonInfo=k.getTemplateJsonByID(M,I.cacheTemplates),S.runReportResult=n.runReportAndGetData(M,O)):M.variables&&(S.reportObject=l.getFakeCustomReportByContext(M),S.templateJsonInfo=k.createTemplateJsonFromVariables(M),S.runReportResult=n.runReportFromVariables(M));return m(S).then(function(R){var V=R.reportObject,Z=R.attachmentsStore,da=R.templateJsonInfo.templateJson,W=R.templateJsonInfo.templateVariableProvider,
ea=R.runReportResult;N(.75);if(!da||!V||!M.fieldData)return null;F.setCountry(R.countryInfo.country);F.setHierarchyID(M.hierarchy);F.setGeographiesModel(R.countryInfo.geographiesModels[F.getHierarchyID()]);da.theme||(da.theme=B.getReportThemeById(V.isGraphicReport?D.GRAPHIC:D.CLASSIC));var Q={isMultiFeature:V.isMultiFeature&&1<M.analysisAreas.length,reportTitle:M.reportTitle||V.title,templateJson:da,reportObject:V,fieldData:M.fieldData,analysisAreas:M.analysisAreas,combinedAreasInfo:M.combinedAreasInfo,
reverseAnalysisAreasOnMap:M.reverseAnalysisAreasOnMap,attachmentsStore:Z,geClient:q.getClient(),templateVariableProvider:W,customLogo:M.customLogo,config:{portalUrl:M.portalUrl,geoenrichmentUrl:M.geoenrichmentUrl,geometryServiceUrl:M.geometryServiceUrl,printMapTaskUrl:M.printMapTaskUrl,countryID:M.countryID,hierarchy:M.hierarchy,reportID:M.reportID,variables:M.variables}};return h(n.applyRunReportAndGetDataResults(ea,Q),function(){N(1);return Q})})})})},_discoverPortal:function(H){return w.getPortalSelf(H.portalUrl).then(function(G){H.geoenrichmentUrl=
H.geoenrichmentUrl||G.helperServices.geoenrichment.url;var I=f.id.findCredential(H.portalUrl);q.setGeoenrichmentUrl(H.geoenrichmentUrl,I&&I.token);H.geometryServiceUrl=H.geometryServiceUrl||G.helperServices.geometry.url;z.setGeometryServiceUrl(H.geometryServiceUrl);H.printMapTaskUrl=H.printMapTaskUrl||G.helperServices.printTask.url;y.setPrintMapTaskUrl(H.printMapTaskUrl)})},reportDataToSingleAreaReportData:function(H,G){var I=G.currentFeatureIndex||0,N=p.mixin({},H.fieldData);N.areaData=[N.areaData[I]];
var M=[p.mixin({},H.analysisAreas[I])];g.removeGroupInfo(M);var O=H.attachmentsStore;return{isMultiFeature:!1,reportTitle:G.reportTitle,templateJson:G.templateJson,reportObject:H.reportObject,fieldData:N,analysisAreas:M,combinedAreasInfo:null,reverseAnalysisAreasOnMap:!1,attachmentsStore:O&&{getImages:function(){O.supportsMultipleAreas&&O.setCurrentAnalysisAreaIndex(I);return O.getImages()},getAttributes:function(){O.supportsMultipleAreas&&O.setCurrentAnalysisAreaIndex(I);return O.getAttributes()},
getNotes:function(){O.supportsMultipleAreas&&O.setCurrentAnalysisAreaIndex(I);return O.getNotes()}},geClient:H.geClient,templateVariableProvider:H.templateVariableProvider,config:H.config}},_getCurrentContext:function(){return this._currentContext},_onCreateReportStarted:function(){}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_CommandSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ../PlayerCommands ./supportClasses/GEUtil esri/dijit/geoenrichment/ReportPlayer/config".split(" "),
function(r,p,m,h,f,e,b,c){var d={};return p(null,{_commands:null,_commandIndex:0,_initCommandsPromise:null,constructor:function(){this._commands={}},_initCommands:function(){var a=this;if(this._initCommandsPromise)return f(this._initCommandsPromise);var g=new h;if(c.modules.exportCommands)r(["./commands/CreateHTMLCommand","./commands/CreatePDFCommand","./commands/CreateImageCommand","./commands/PrintReportCommand","./commands/CreatePlayerCommand"],function(l,k,n,q,u){d[e.HTML]=l;d[e.PDF]=k;d[e.IMAGE]=
n;d[e.PRINT]=q;d[e.DYNAMIC_HTML]=u;b.getInitPromise().then(g.resolve)});else return g.resolve();g.promise.then(function(){a._initCommandsPromise=!0});return this._initCommandsPromise=g.promise},registerCommand:function(a,g,l){function k(q){if(!q.isBrowserSupported||q.isBrowserSupported())n._commands[a]||(n._commands[a]={index:n._commandIndex++,id:a,label:g||q.label,command:q})}var n=this;if(l)k(l);else return this._initCommands().then(function(){var q=d[a];q&&k(new q)})},getCommands:function(){return this._initCommands().then(function(){var a=
[],g=this._commands[e.PDF],l;for(l in this._commands)a.push(this._commands[l]);a.sort(function(k,n){return k.index-n.index});return(l=this._getCurrentContext())&&l.geoenrichmentUrl&&g?f(b.hasCapability("FormatInfographics"),function(k){k||(a=a.filter(function(n){return n!==g}));return a}):f(a)}.bind(this))},getCommandById:function(a){return this._commands[a]&&this._commands[a].command},executeCommand:function(a,g,l,k){return this._initCommands().then(function(){l=m.mixin({printMapTaskUrl:this.printMapTaskUrl},
l);return this._commands[a]&&this._commands[a].command&&this._commands[a].command.execute(g,l||{},k)}.bind(this))},executeCommandOnData:function(a,g,l,k){return this._initCommands().then(function(){l=m.mixin({printMapTaskUrl:this.printMapTaskUrl},l);return this._commands[a]&&this._commands[a].command&&this._commands[a].command.executeOnData(this,g,l||{},k)}.bind(this))}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_SerializationSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./supportClasses/areas/AnalysisAreaJsonUtil ./supportClasses/areas/AnalysisAreaUtil ../core/infographics/InfographicTypes ../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k){function n(){var D=new h;r("./supportClasses/attachments/AttachmentsStoreSerializer ./supportClasses/GEUtil ../core/supportClasses/templateJsonUtils/TemplateJsonSerializer ../core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer ../core/infographics/utils/InfographicJsonUtil ../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../core/infographics/InfographicTypes ./commands/mapToImage/MapToURLUtil esri/dijit/geoenrichment/utils/ProjectionUtil".split(" "),
function(E,F,z,w,A,H,G,I,N){q=E;u=F;t=z;v=H;c=G;y=I;B=N;D.resolve()});return D.promise}var q,u,t,v,y,B;return p(null,{reportDataToJson:function(D,E){var F=this;E=E||{};var z=!1;d.processTemplateFieldInfos(D.templateJson,function(w){w.isInfographic&&w.infographicJson.type===c.ATTACHMENTS&&(z=!0)});return n().then(function(){return f(null,function(){return f(D.attachmentsStore&&q.getAttachmentsStoreJson(D.attachmentsStore,{numAreas:D.analysisAreas.length,saveImages:z}),function(w){var A=m.mixin({},
D.config);!1!==E.forceFixedDataMode&&delete A.geoenrichmentUrl;w={isMultiFeature:D.isMultiFeature,reportTitle:D.reportTitle,templateJson:t.serialize(D.templateJson),reportObject:F._prepareReportObjectJson(D.reportObject),fieldData:D.fieldData,analysisAreas:e.areasToJson(D.analysisAreas),combinedAreasInfo:D.combinedAreasInfo&&e.combinedAreasInfoToJson(D.combinedAreasInfo),reverseAnalysisAreasOnMap:D.reverseAnalysisAreasOnMap,attachmentsStore:w,templateVariableProvider:D.templateVariableProvider&&D.templateVariableProvider.toJson(),
config:A,countryConfig:a.toJson(),mapImageInfos:E.mapImageInfos,loadedMapPortalItems:E.loadedMapPortalItems,customLogo:D.customLogo};k.logData&&(console.log("_SerializationSupport.js \x3d\x3e reportDataJson"),console.log(w));return w})})})},_prepareReportObjectJson:function(D){var E={},F;for(F in D)D[F]&&"object"!==typeof D[F]&&(E[F]=D[F]);return E},reportDataFromJson:function(D){return n().then(function(){var E=D.fieldData;E.featureData&&(E.areaData=E.featureData.map(function(z){return{mainCalculator:{data:z}}}),
delete E.featureData);var F={isMultiFeature:D.isMultiFeature,reportTitle:D.reportTitle,templateJson:t.deserialize(D.templateJson),reportObject:D.reportObject,fieldData:E,analysisAreas:e.areasFromJson(D.analysisAreas),combinedAreasInfo:D.combinedAreasInfo&&e.combinedAreasInfoFromJson(D.combinedAreasInfo)||{},reverseAnalysisAreasOnMap:D.reverseAnalysisAreasOnMap,attachmentsStore:D.attachmentsStore&&q.getAttachmentsStoreFromJson(D.attachmentsStore),templateVariableProvider:D.templateVariableProvider&&
new v(D.templateVariableProvider),config:D.config||{},mapImageInfos:D.mapImageInfos,loadedMapPortalItems:D.loadedMapPortalItems,customLogo:D.customLogo};b.populateCombinedAreasInfo(F.combinedAreasInfo,F.analysisAreas);u.setGeoenrichmentUrl(null);E=!1;F.config.portalUrl&&l.setArcgisUrl(l.getPortalUrl(F.config.portalUrl));F.config.geometryServiceUrl?B.setGeometryServiceUrl(F.config.geometryServiceUrl):E=!0;F.config.printMapTaskUrl?y.setPrintMapTaskUrl(F.config.printMapTaskUrl):E=!0;a.fromJson(D.countryConfig);
return f(E&&g.tryConfigureServicesFromAGOLPublic()).then(function(){return F})})}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaJsonUtil":function(){define(["esri/graphic","esri/dijit/PopupTemplate"],function(r,p){function m(e,b){if(!e)return null;e.getLayer()&&(e=new r(e.geometry,e.symbol,e.attributes,e.infoTemplate));e=e.toJson();b&&delete e.infoTemplate;return e}function h(e){if(!e)return null;if(e instanceof r)return e;var b=e.infoTemplate&&new p(e.infoTemplate);
delete e.infoTemplate;e=new r(e);b&&e.setInfoTemplate(b);return e}function f(e){var b={},c;for(c in e){var d=e[c];if("string"===typeof d||"number"===typeof d&&!isNaN(d))b[c]=d}return b}return{areasToJson:function(e,b){var c=b&&b.excludeInfoTemplate;return e.map(function(d){var a=f(d);a.feature=m(d.feature,c);a.location=d.location&&m(d.location,c);a.additionalFeatures=d.additionalFeatures&&d.additionalFeatures.map(function(g){return m(g,c)});a.geographies=d.geographies;a.buffer=d.buffer;a.featureServiceQueryInfos=
d.featureServiceQueryInfos;return a})},combinedAreasInfoToJson:function(e){var b=f(e);b.groups=e.groups&&e.groups.map(function(c){var d=f(c);d.indexes=c.indexes.slice();d.location=c.location&&m(c.location);d.additionalFeatures=c.additionalFeatures&&c.additionalFeatures.map(m);return d});return b},areasFromJson:function(e){return e.map(function(b){var c=f(b);c.feature=h(b.feature);c.location=b.location&&h(b.location);c.additionalFeatures=b.additionalFeatures&&b.additionalFeatures.map(h);c.geographies=
b.geographies;c.buffer=b.buffer;c.featureServiceQueryInfos=b.featureServiceQueryInfos;return c})},combinedAreasInfoFromJson:function(e){var b=f(e);b.groups=e.groups&&e.groups.map(function(c){var d=f(c);d.indexes=c.indexes.slice();d.location=c.location&&h(c.location);d.additionalFeatures=c.additionalFeatures&&c.additionalFeatures.map(h);return d});return b}}})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicTypes":function(){define(["dojo/_base/lang"],function(r){var p={STATIC:"static",
ATTACHMENTS:"attachments",AREA_DETAILS:"areaDetails",INTERESTING_FACTS:"interestingFacts",LOCATOR_TABLE:"locatorTable",COMPARISON_TABLE:"comparisonTable"},m={AGE_PYRAMID:"AgePyramid",ONE_VAR:"OneVar",RELATED_VARS:"RelatedVariables",TAPESTRY:"Tapestry",PRIZM5:"Prizm5"},h={},f;for(f in m)h[m[f]]=!0;r.mixin(p,m);var e={};for(f in p)e[p[f]]=!0;p.isDynamic=function(b){return h[b]};p.isSupported=function(b){return e[b]};p.isTableLike=function(b){return b===p.AREA_DETAILS||b===p.LOCATOR_TABLE||b===p.COMPARISON_TABLE};
p.fixTapestryNameToWidget=function(b){return"TapestryNEW"===b?"Tapestry":b};p.fixTapestryNameToData=function(b){return"Tapestry"===b?"TapestryNEW":b};p.supportsMultiFeature=function(b){return b===p.COMPARISON_TABLE||b===p.LOCATOR_TABLE||b===p.ATTACHMENTS||b===p.AREA_DETAILS};p.supportsComparison=function(b){return b===p.ONE_VAR||b===p.AGE_PYRAMID||b===p.RELATED_VARS||b===p.COMPARISON_TABLE};p.isDynamicWithFiltering=function(b){return b===p.ONE_VAR||b===p.AGE_PYRAMID||b===p.RELATED_VARS};return p})},
"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil":function(){define(["./_SectionJsonCollector","../../../infographics/InfographicTypes"],function(r,p){var m={},h={process:function(f,e,b,c,d){var a=c;c=function(g,l,k){g&&a.apply(this,arguments)};d={processLevel:e,objJson:b,processFunc:c,ignoreComparisonCalculators:d&&d.ignoreComparisonCalculators};f!==e||"field"===f&&"field"===e?"document"===f?h._processTemplateJson(b,d):"section"===f?h._processSectionJson(b,
d):"table"===f?h._processTableJson(b,d,null):"tableRow"===f?h._processTableDataObj(b,d,null):"field"===f&&h._processFieldInfo(b,d,null):c(b)},_processTemplateJson:function(f,e){f.sectionsTables?f.sectionsTables.forEach(function(b){h._processTableJson(b,e)}):r.collectSectionJsons(f,{saveParentInfo:!1,processFieldInfoFunc:function(b){"field"===e.processLevel&&e.processFunc(b)}}).forEach(function(b){h._processSectionJson(b,e)})},_processSectionJson:function(f,e){"section"===e.processLevel&&e.processFunc(f);
f.stack&&f.stack.forEach(function(b){"sectionElement"===e.processLevel&&e.processFunc(b);"table"===b.id&&h._processTableJson(b,e)})},_processTableJson:function(f,e,b){"table"===e.processLevel&&e.processFunc(f);f.data.data.forEach(function(c){"tableRow"===e.processLevel&&e.processFunc(c,b);h._processTableDataObj(c,e,b)});f.backgroundSectionJson&&h._processSectionJson(f.backgroundSectionJson,e);f.foregroundSectionJson&&h._processSectionJson(f.foregroundSectionJson,e);f.backgroundFloatingTablesSectionJson&&
h._processSectionJson(f.backgroundFloatingTablesSectionJson,e);f.foregroundFloatingTablesSectionJson&&h._processSectionJson(f.foregroundFloatingTablesSectionJson,e)},_processTableDataObj:function(f,e,b){if(f.fieldInfos)for(var c in f.fieldInfos)h._processFieldInfo(f.fieldInfos[c],e,b,"tableCell")},_processFieldInfo:function(f,e,b,c){if(f){"field"!==e.processLevel||e.skipVariables&&(f.hasVariable||f.script)||e.processFunc(f,b,c);f.triggerJson&&f.triggerJson.fieldInfo&&f.templateName!==f.triggerJson.fieldInfo.templateName&&
h._processFieldInfo(f.triggerJson.fieldInfo,e,f,"trigger");f.dataDrillingPanelInfo&&h._processSectionJson(f.dataDrillingPanelInfo.sectionJson,e);f.tooltipInfo&&f.tooltipInfo.fieldInfo&&h._processFieldInfo(f.tooltipInfo.fieldInfo,e,f,"fieldTooltip");f.linkFieldInfo&&h._processFieldInfo(f.linkFieldInfo,e,f,"linkFieldInfo");if(f.isRichText)for(var d in f.richTextJson.fieldInfos)h._processFieldInfo(f.richTextJson.fieldInfos[d],e,f,"richTextPart");f.isInfographic&&h._processInfographicFieldInfo(f,e);f.isChart&&
h._processChartFieldInfo(f,e);f.isReportSection&&f.sectionJson&&h._processSectionJson(f.sectionJson,e)}},_processInfographicFieldInfo:function(f,e){var b=f.infographicJson;switch(b.type){case p.STATIC:b.header&&h._processTableJson(b.header,e,f);b.variableTables&&b.variableTables.forEach(function(a){a.variable&&h._processFieldInfo(a.variable.fieldInfo,e,f,"staticInfographicVariable");a.description&&a.description.fieldInfo&&h._processFieldInfo(a.description.fieldInfo,e,f,"staticInfographicDescription")});
if(b.dataDrilling)for(var c in b.dataDrilling){var d=b.dataDrilling[c];d&&d.sectionJson&&h._processSectionJson(d.sectionJson,e)}break;case p.AGE_PYRAMID:case p.TAPESTRY:case p.PRIZM5:case p.RELATED_VARS:case p.ONE_VAR:!e.ignoreComparisonCalculators&&b.fieldInfos&&b.fieldInfos.forEach(function(a){h._processFieldInfo(a,e,f,"dynamicInfographicVariable")});break;case p.AREA_DETAILS:b.titleSectionJson&&h._processSectionJson(b.titleSectionJson,e,f);b.attributesSectionJson&&h._processSectionJson(b.attributesSectionJson,
e,f);b.notesSectionJson&&h._processSectionJson(b.notesSectionJson,e,f);break;case p.LOCATOR_TABLE:b.titleSectionJson&&h._processSectionJson(b.titleSectionJson,e);h._processSectionJson(b.headerSectionJson,e);h._processSectionJson(b.dataSectionJson,e);b.summarySectionJson&&h._processSectionJson(b.summarySectionJson,e);b.summaryFooterSectionJson&&h._processSectionJson(b.summaryFooterSectionJson,e);break;case p.COMPARISON_TABLE:b.titleSectionJson&&h._processSectionJson(b.titleSectionJson,e),e.ignoreComparisonCalculators||
h._processSectionJson(b.dataSectionJson,e)}},_processChartFieldInfo:function(f,e){var b=f.chartJson.visualProperties;b.chartIcons&&b.chartIcons.forEach(function(c){h._processFieldInfo(c,e,f,"chartIcon")});b.floatingIcons&&b.floatingIcons.forEach(function(c){h._processTableJson(c,e,f,"floatingIcon")});b.floatingTexts&&b.floatingTexts.forEach(function(c){h._processTableJson(c,e,f,"floatingText")});e.ignoreComparisonCalculators&&f.chartJson.comparisonInfo&&(e=Object.assign({},e),e.skipVariables=!0);
b.tooltip&&b.tooltip.fieldInfo&&h._processFieldInfo(b.tooltip.fieldInfo,e,f,"chartTooltip");f.chartJson.dataDrillingPanelInfo&&h._processSectionJson(f.chartJson.dataDrillingPanelInfo.sectionJson,e);f.chartJson.seriesItems.forEach(function(c){c.points.forEach(function(d){h._processFieldInfo(d.fieldInfo,e,f,"chartPointField");d.iconFieldInfo&&h._processFieldInfo(d.iconFieldInfo,e,f,"chartPointIcon");d.captionFieldInfo&&h._processFieldInfo(d.captionFieldInfo,e,f,"chartPointCaption")})})}};m.DOCUMENT=
"document";m.SECTION="section";m.TABLE="table";m.SECTION_ELEMENT="sectionElement";m.TABLE_ROW="tableRow";m.FIELD="field";m.process=h.process;m.processTemplateFieldInfos=function(f,e,b){h.process("document","field",f,e,b)};m.processSectionFieldInfos=function(f,e,b){h.process("section","field",f,e,b)};m.processSectionElements=function(f,e){h.process("document","sectionElement",f,e)};m.processTableFieldInfos=function(f,e,b){h.process("table","field",f,e,b)};m.processChartFieldInfos=function(f,e){f.seriesItems.forEach(function(d){d.points.forEach(function(a){a.fieldInfo&&
e(a.fieldInfo,"series")})});var b=f.visualProperties.tooltip;if(b&&b.fieldInfo&&b.fieldInfo.isRichText)for(var c in b.fieldInfo.richTextJson.fieldInfos)e(b.fieldInfo.richTextJson.fieldInfos[c],"tooltip");f.dataDrillingPanelInfo&&m.processSectionFieldInfos(f.dataDrillingPanelInfo.sectionJson,function(d){e(d,"dataDrilling")})};m.processDataDrillingPanelInfos=function(f,e){m.processTemplateFieldInfos(f,function(b){if(b.isInfographic&&b.infographicJson.dataDrilling)for(var c in b.infographicJson.dataDrilling){var d=
b.infographicJson.dataDrilling[c];d&&e(d)}else b.isChart&&b.chartJson.dataDrillingPanelInfo?e(b.chartJson.dataDrillingPanelInfo):b.dataDrillingPanelInfo&&e(b.dataDrillingPanelInfo)})};m.hasMultiFeatureChart=function(f){var e=!1;m.processTemplateFieldInfos(f,function(b){b.isChart&&(e=e||b.chartJson&&!!b.chartJson.isMultiFeatureChart)});return e};m.hasComparisonInfographicTable=function(f){var e=!1;m.processTemplateFieldInfos(f,function(b){b.isInfographic&&(e=e||b.infographicJson&&b.infographicJson.type===
p.COMPARISON_TABLE)});return e};m.isGraphicReport=function(f){return!!f.sectionsTables};m.hasDynamicColumns=function(f){return m._checkTableAttributes(f,function(e){return 0<e.dynamicColumns})};m.hasDynamicRows=function(f){return m._checkTableAttributes(f,function(e){return 0<e.dynamicRows})};m._checkTableAttributes=function(f,e){var b;m.isGraphicReport(f)?m.processTemplateFieldInfos(f,function(c){c.isReportSection&&c.sectionJson&&c.sectionJson.stack&&c.sectionJson.stack.some(function(d){if("table"===
d.id&&d.attributes&&e(d.attributes))return b=!0})}):b=m.collectSectionJsons(f).some(function(c){return c.stack&&c.stack.some(function(d){return"table"===d.id&&d.attributes&&e(d.attributes)})});return b};m.hasMultiFeatureSections=function(f){return m.isGraphicReport(f)?m.hasMultiFeatureChart(f)||m.hasDynamicColumns(f)||m.hasComparisonInfographicTable(f):!1};m.calcNumberOfMaps=function(f,e){var b=0;m.collectSectionJsons(f).forEach(function(c){b+=m.calcNumberOfMapsInSectionJson(c,e)});return b};m.calcNumberOfMapsInSectionJson=
function(f,e){var b=0;f.stack&&f.stack.forEach(function(c){c.isMap&&(e&&e(c),b++)});m.processSectionFieldInfos(f,function(c){c.isMap&&(e&&e(c.mapJson),b++)});return b};m.calcNumberOfMapsInTableJson=function(f,e){var b=0;m.processTableFieldInfos(f,function(c){c.isReportSection&&(b+=m.calcNumberOfMapsInSectionJson(c.sectionJson,e))});return b};m.collectSectionJsons=r.collectSectionJsons;m.getParentBox=r.getParentBox;m.setParentBox=r.setParentBox;m.getParentStyle=r.getParentStyle;return m})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/_SectionJsonCollector":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/MathUtil","esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil","../../tableJson/TableJsonUtil"],function(r,p,m,h){var f={},e={provideParentInfo:function(d,a,g,l,k,n){b.collectStatistics(a);a:{switch(k){case "floating":var q=a.style.left+n.left;break a;case "page":q=b.calcX(a,g,l)+n.left;break a}q=void 0}a:{switch(k){case "floating":k=a.style.top+n.top;break a;case "page":k=b.calcY(a,g,l)+n.top;break a}k=void 0}d._parentBox={x:q,y:k,w:b.calcFullWidth(a,
g,l),h:b.calcFullHeight(a,g,l)};a=l.field;g.style.fields=g.style.fields||{};g=(g.style.fields[a]=g.style.fields[a]||{}).backgroundColor;d._parentStyle={backgroundColor:g}},sanitize:function(d){b.sanitize(d)}},b={collectStatistics:function(d){if(!d._measureInfo){var a={},g={},l;d.data.columns.forEach(function(y){l&&(g[l.field]=y);l=y;a[y.field]=y});var k={},n={},q={},u={},t={},v={};d.data.data.forEach(function(y,B){d.data.columns.forEach(function(D,E){var F=t[E]||0,z=v[B]||0,w=b._getDataHeight(y,D.field);
D=b._getFieldWidth(y,D);F+=w;z+=D;t[E]=F;v[B]=z;w=E+"_"+B;n[w]=F;k[w]=z;q[w]=k[E-1+"_"+B]||0;u[w]=n[E+"_"+(B-1)]||0})});d._measureInfo={xPositions:q,yPositions:u,columnsHash:a,nextColumnHash:g}}},calcX:function(d,a,g){g=d.data.columns.indexOf(g);a=d.data.data.indexOf(a);return d._measureInfo.xPositions[g+"_"+a]||0},calcY:function(d,a,g){g=d.data.columns.indexOf(g);a=d.data.data.indexOf(a);return d._measureInfo.yPositions[g+"_"+a]||0},calcFullWidth:function(d,a,g){g=g.field;var l=b._getFieldWidth(a,
d._measureInfo.columnsHash[g]),k=a.columnSpans&&a.columnSpans[g]||1;if(1<k)for(var n,q=0;q<k-1;q++)n=d._measureInfo.nextColumnHash[n?n.field:g],l+=b._getFieldWidth(a,n);return l},_getFieldWidth:function(d,a){d.style.fields=d.style.fields||{};return(d.style.fields[a.field]=d.style.fields[a.field]||{}).width||a.style.width},calcFullHeight:function(d,a,g){g=g.field;var l=d.data.data.indexOf(a),k=b._getDataHeight(a,g);a=a.rowSpans&&a.rowSpans[g]||1;if(1<a)for(var n=l+1,q=0;q<a-1;q++)l=d.data.data[n++],
k+=b._getDataHeight(l,g);return k},_getDataHeight:function(d,a){d.style.fields=d.style.fields||{};return(d.style.fields[a]=d.style.fields[a]||{}).height||d.style.height},sanitize:function(d){delete d._measureInfo}},c={getIntersectingTableJsonsBehind:function(d,a,g,l,k){function n(v){var y=v.data.data[0].fieldInfos[v.data.columns[0].field];return m.isTextLikeCell(y)||m.isShapeCell(y)||m.isImageCell(y)?p.checkRectsIntersect([g,{x:v.style.left+a.left,y:v.style.top+a.top,w:h.getTableWidth(v),h:h.getTableHeight(v)}]):
!1}function q(v){return p.checkRectsIntersect([g,{x:v.style.left+a.left,y:v.style.top+a.top,w:v.style.width,h:v.style.height}])}var u=[],t=[];d.backgroundFloatingTablesSectionJson&&d.backgroundFloatingTablesSectionJson.stack.forEach(function(v,y){if(-1===l||k||l!==y)if("table"===v.id&&n(v)||"img"===v.id&&q(v))-1===l||k||l>y?u.push(v):t.push(v)});d.foregroundFloatingTablesSectionJson&&d.foregroundFloatingTablesSectionJson.stack.forEach(function(v,y){if(k&&l===y)return!0;if("table"===v.id&&n(v)||"img"===
v.id&&q(v))k&&l>y?u.push(v):t.push(v)});return{elementJsonsBehind:u,elementJsonsAbove:t}}};f.collectSectionJsons=function(d,a){a=a||{};var g=[];if(!d)return[];if(d.sections)return d.sections;if(!d.sectionsTables)return[];a.processSectionJson=a.processSectionJson||function(){};d.sectionsTables.forEach(function(l,k){var n={addBackground:function(){!1!==a.backgroundForeground&&l.backgroundSectionJson&&l.backgroundSectionJson.stack&&g.push(l.backgroundSectionJson)},addBackgroundTables:function(q){var u=
[];!1!==a.floatingTables&&l.backgroundFloatingTablesSectionJson&&l.backgroundFloatingTablesSectionJson.stack.forEach(function(t,v){"table"===t.id&&f._processTableJson(t,u,"floating",d.documentOptions,a,l,v,!1)});q&&u.reverse();u.forEach(function(t){a.processSectionJson(t,{pageIndex:k,source:"foreground",floatingIndex:t.__floatingIndex});delete t.__floatingIndex});g=g.concat(u)},addInGridSections:function(){var q=[];f._processTableJson(l,q,"page",d.documentOptions,a,l);q.forEach(function(u){a.processSectionJson(u,
{pageIndex:k,source:"grid",index:u.__inGridIndex});delete u.__inGridIndex});g=g.concat(q)},addForegroundTables:function(q){var u=[];!1!==a.floatingTables&&l.foregroundFloatingTablesSectionJson&&l.foregroundFloatingTablesSectionJson.stack.forEach(function(t,v){"table"===t.id&&f._processTableJson(t,u,"floating",d.documentOptions,a,l,v,!0)});q&&u.reverse();u.forEach(function(t){a.processSectionJson(t,{pageIndex:k,source:"foreground",floatingIndex:t.__floatingIndex});delete t.__floatingIndex});g=g.concat(u)},
addForeground:function(){!1!==a.backgroundForeground&&l.foregroundSectionJson&&l.foregroundSectionJson.stack&&g.push(l.foregroundSectionJson)}};a.topFirst?(n.addForeground(),n.addForegroundTables(!0),n.addInGridSections(),n.addBackgroundTables(!0),n.addBackground()):(n.addBackground(),n.addBackgroundTables(),n.addInGridSections(),n.addForegroundTables(),n.addForeground())});return g};f._processTableJson=function(d,a,g,l,k,n,q,u){d.data.data.forEach(function(t,v){t.fieldInfos&&d.data.columns.forEach(function(y,
B){var D=t.fieldInfos[y.field];if(D&&D.sectionJson&&D.sectionJson.stack){k.processFieldInfoFunc&&k.processFieldInfoFunc(D);(!1!==k.saveParentInfo||k.populateWithFloatingElementsBehind)&&e.provideParentInfo(D.sectionJson,d,t,y,g,l);if(k.populateWithFloatingElementsBehind){var E=r.clone(D.sectionJson),F;"page"===g?F=c.getIntersectingTableJsonsBehind(n,l,E._parentBox,-1,void 0):"floating"===g&&(F=c.getIntersectingTableJsonsBehind(n,l,E._parentBox,q,u));D=function(z){z=r.clone(z);z.isContextFloatingElement=
!0;z.style.left=z.style.left+l.left-E._parentBox.x;if("table"===z.id)z.style.top=z.style.top+l.top-E._parentBox.y;else if("img"===z.id||"map"===z.id)z.style.top=z.style.top+l.top-E._parentBox.y;return z};y=F.elementJsonsBehind.map(D);F=F.elementJsonsAbove.map(D);E.stack=y.concat(E.stack);E.stack=E.stack.concat(F);a.push(E)}else a.push(D.sectionJson);F=a[a.length-1];"page"===g?F.__inGridIndex=v*d.data.columns.length+B:F.__floatingIndex=q}})});e.sanitize(d)};f.getParentBox=function(d){return d&&d._parentBox};
f.setParentBox=function(d,a){d._parentBox=a};f.getParentStyle=function(d){return d&&d._parentStyle};return f})},"esri/dijit/geoenrichment/utils/MathUtil":function(){define([],function(){function r(e){return Array.isArray(e)?e:[e.x,e.y]}function p(e){return Array.isArray(e)?e:[e.x,e.y,e.x+e.w,e.y+e.h]}function m(e){return Array.isArray(e)?{x:e[0],y:e[1],w:e[2]-e[0],h:e[3]-e[1]}:e}function h(e){return[[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]],[e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2]]}var f={rotatePointAroundPoint:function(e,
b,c){c=f.degToRad(c);var d=r(e),a=r(b);b=Math.cos(c)*(a[0]-d[0])-Math.sin(c)*(a[1]-d[1])+d[0];c=Math.sin(c)*(a[0]-d[0])+Math.cos(c)*(a[1]-d[1])+d[1];return Array.isArray(e)?[b,c]:{x:b,y:c}},degToRad:function(e){return e*Math.PI/180},radToDeg:function(e){return 180*e/Math.PI},cosDeg:function(e){return Math.cos(f.degToRad(e))},sinDeg:function(e){return Math.sin(f.degToRad(e))},angleTo180_180Range:function(e){e=(e+180)%360;0>e&&(e=360+e);return e-180},angleTo0_360Range:function(e){e%=360;0>e&&(e=360+
e);return e},calcVectorLength:function(e){var b=e[0]-e[2];e=e[1]-e[3];return Math.sqrt(b*b+e*e)},addPointToVector:function(e,b){b=r(b);e=e.slice();e[0]+=b[0];e[1]+=b[1];e[2]+=b[0];e[3]+=b[1];return e},subtractPointFromVector:function(e,b){b=r(b);e=e.slice();e[0]-=b[0];e[1]-=b[1];e[2]-=b[0];e[3]-=b[1];return e},putVectorToOrigin:function(e){return f.subtractPointFromVector(e,[e[0],e[1]])},normalizeVector:function(e){e=f.putVectorToOrigin(e);var b=f.calcVectorLength(e);e[2]/=b;e[3]/=b;return e},calcDotProduct:function(e,
b){e=f.putVectorToOrigin(e);b=f.putVectorToOrigin(b);return e[2]*b[2]+e[3]*b[3]},calcAngleBetweenVectors:function(e,b){e=f.normalizeVector(e);b=f.normalizeVector(b);return Math.acos(f.calcDotProduct(e,b))},addLengthToVector:function(e,b){var c=f.calcVectorLength(e),d=[e[0],e[1]];e=f.normalizeVector(e);e[2]*=c+b;e[3]*=c+b;return f.addPointToVector(e,d)},rotateVectorAroundPoint:function(e,b,c){b=r(b);var d=f.rotatePointAroundPoint(b,[e[0],e[1]],c);e=f.rotatePointAroundPoint(b,[e[2],e[3]],c);return[d[0],
d[1],e[0],e[1]]},toLineABC:function(e){var b=e[3]-e[1],c=e[0]-e[2];return[b,c,-b*e[0]-c*e[1]]},intersect2Lines:function(e,b){var c=f.toLineABC(e),d=f.toLineABC(b);b=c[0];e=c[1];c=c[2];var a=d[0],g=d[1];d=d[2];var l=b*g-a*e;return 0===l?null:[(d*e-c*g)/l,(a*c-b*d)/l]},intersectLineWithRect:function(e,b){function c(n,q){(n=f.intersect2Lines(e,[n[0],n[1],q[0],q[1]]))&&f.isPointInRect(b,n)&&k.push(n)}var d=h(b),a=d[0],g=d[1],l=d[2];d=d[3];var k=[];c(a,g);c(g,l);c(l,d);c(d,a);if(2!==k.length)return null;
a=[k[0][0],k[0][1],k[1][0],k[1][1]];return f.calcVectorLength(a)?a:null},isPointInRect:function(e,b){e=p(e);b=r(b);var c=e[2]-e[0],d=e[3]-e[1];return!(b[0]<e[0]||b[0]>e[0]+c||b[1]<e[1]||b[1]>e[1]+d)},isRectInRect:function(e,b){return f.checkRectsIntersect([e,b])&&h(p(e)).every(function(c){return f.isPointInRect(b,c)})},checkRectsIntersect:function(e){e=e.map(p);return e.every(function(b){var c=h(b);return e.every(function(d){return b===d?!0:c.some(function(a){return f.isPointInRect(d,a)})||h(d).some(function(a){return f.isPointInRect(b,
a)})})})},getRotatedRectBox:function(e,b){var c=!Array.isArray(e);e=p(e);var d=h(e);e=d[0];var a=d[1],g=d[2],l=d[3];d=d[4];e=f.rotatePointAroundPoint(d,e,b);a=f.rotatePointAroundPoint(d,a,b);g=f.rotatePointAroundPoint(d,g,b);l=f.rotatePointAroundPoint(d,l,b);e=f.getPointsExtent([e,a,g,l]);return c?m(e):e},uniteRects:function(e){var b=!Array.isArray(e[0]);e=e.map(p);var c=[];e.forEach(function(d){c=c.concat(h(d))});e=f.getPointsExtent(c);return b?m(e):e},getPointsExtent:function(e){var b=!Array.isArray(e[0]),
c=Infinity,d=-Infinity,a=Infinity,g=-Infinity;e.forEach(function(l){l=r(l);c=Math.min(c,l[0]);d=Math.max(d,l[0]);a=Math.min(a,l[1]);g=Math.max(g,l[1])});e=[c,a,d,g];return b?m(e):e}};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil":function(){define(["dojo/_base/lang","../../supportClasses/templateJsonUtils/fieldInfo/FieldLibrary","esri/dijit/geoenrichment/utils/FieldUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/ReportPlayer/countryConfig"],
function(r,p,m,h,f){var e={getFieldCellValue:function(b){return b.gridData&&b.gridData[b.column.field]},setFieldCellContent:function(b,c){b.set("value",c);b.gridData[b.column.field]=c},clearFieldInfo:function(b,c){b.fieldInfos&&delete b.fieldInfos[c];b[c]="";e.setNumericDataValue(void 0,b,c)},getNumericCellValue:function(b){return e.getNumericDataValue(b.gridData,b.column.field)},setNumericCellValue:function(b,c){return e.setNumericDataValue(c,b.gridData,b.column.field)},getNumericDataValue:function(b,
c){return b&&c&&b[c+"_numeric"]},setNumericDataValue:function(b,c,d){c[d+"_numeric"]=b},getRenderedValue:function(b,c,d){var a={parentGrid:b,gridData:c,column:d};b=b._getCellRenderer().getRenderedContent(a);if(b.isUnavailableData)return{};if("number"!==typeof b.value||isNaN(b.value))"string"===typeof b.formattedValue&&(a=h.parsePercentOrCurrency(b.formattedValue,f.getCurrencyFormat()),isNaN(a)||(g=a));else var g=b.value;"number"!==typeof g&&(g=e.getNumericDataValue(c,d.field));return{numericValue:g,
formattedValue:b.formattedValue}},isEmptyCell:function(b){return!b.get("value")&&!b.gridData[b.column.field]&&!e.getFieldInfo(b)},hasSpans:function(b){return e.getColumnSpan(b)||e.getRowSpan(b)},getColumnSpan:function(b){return b&&b.gridData&&b.gridData.columnSpans&&b.gridData.columnSpans[b.column.field]},getRowSpan:function(b){return b&&b.gridData&&b.gridData.rowSpans&&b.gridData.rowSpans[b.column.field]},getDataColumnSpan:function(b,c){return b&&b.columnSpans&&b.columnSpans[c]},getDataRowSpan:function(b,
c){return b&&b.rowSpans&&b.rowSpans[c]},getFieldInfo:function(b){return b&&b.gridData&&b.column&&b.gridData.fieldInfos&&b.gridData.fieldInfos[b.column.field]},getGridFirstFieldInfo:function(b){return e.getFieldInfo(b.getFirstCell())},setFieldInfo:function(b,c){b.gridData&&(b.gridData.fieldInfos[b.column.field]=c)},provideFieldInfo:function(b){e.setFieldInfo(b,e.getFieldInfo(b)||{});return e.getFieldInfo(b)},getPreservableSettings:function(b){return{triggerJson:e.getConditionalFormatting(b),dataDrilling:e.getDataDrilling(b),
tooltipInfo:e.getTooltipInfo(b)}},setPreservableSettings:function(b,c){e.setConditionalFormatting(b,c&&c.triggerJson);e.setDataDrilling(b,c&&c.dataDrilling);e.setTooltipInfo(b,c&&c.tooltipInfo)},getCellStyle:function(b,c){if(!b||!b.gridData||!b.column)return null;var d=b.gridData.style&&b.gridData.style.fields&&b.gridData.style.fields[b.column.field];!d&&c&&(d={},e.setCellStyle(b,d));return d},getCellThemeStyle:function(b){return b&&b.gridData&&b.column?b.gridData.themeStyle&&b.gridData.themeStyle.fields[b.column.field]:
null},setCellStyle:function(b,c){var d=b.gridData.style=b.gridData.style||{};d.fields=d.fields||{};d.fields[b.column.field]=c},updateCellStyle:function(b,c){b=e.getCellStyle(b,!0);r.mixin(b,c)},copyFieldStyle:function(b,c,d){b=e.getCellStyle(b);c=e.getCellStyle(c,!0);for(var a in d)void 0!==b[a]&&(c[a]=b[a])},getFieldCellUrl:function(b){if(b.gridData&&b.gridData.urls&&b.column)return b.gridData.urls[b.column.field]},setFieldCellUrl:function(b,c){b.gridData&&b.column&&(b.gridData.urls=b.gridData.urls||
{},void 0===c?delete b.gridData.urls[b.column.field]:b.gridData.urls[b.column.field]=c)},getConditionalFormatting:function(b){return(b=e._toFieldInfo(b))&&b.triggerJson},setConditionalFormatting:function(b,c){var d=e.getFieldInfo(b);d.triggerJson=null;if(c){if(b=e.isVariableLikeFieldCell(b))c.fieldInfo=d;c.fieldInfo===d&&(c.fieldInfo=r.clone(c.fieldInfo),delete c.fieldInfo.triggerJson,b&&(delete c.fieldInfo.tooltipInfo,delete c.fieldInfo.dataDrillingPanelInfo))}d.triggerJson=c},getDataDrilling:function(b){return(b=
e.getSourceFieldInfo(b))&&b.dataDrillingPanelInfo},setDataDrilling:function(b,c){if(b=e.getSourceFieldInfo(b))b.dataDrillingPanelInfo=c},getTooltipInfo:function(b){return(b=e.getSourceFieldInfo(b))&&b.tooltipInfo},setTooltipInfo:function(b,c){if(b=e.getSourceFieldInfo(b))b.tooltipInfo=c},getSourceFieldInfo:function(b){var c=e._toFieldInfo(b);b=e.getConditionalFormatting(b);return c&&c.isImage?b&&b.fieldInfo:c},_toFieldInfo:function(b){return b?b.gridData?e.getFieldInfo(b):"object"===typeof b&&b:null},
isReportSectionCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.isReportSection)},isInfographicCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.isInfographic)},isChartCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.isChart)},isMapCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.isMap)},isImageCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.isImage)},isImageTriggerCell:function(b){b=e._toFieldInfo(b);return!!(b&&b.isImage&&b.triggerJson)},getImageTriggerFieldInfo:function(b){return(b=
e._toFieldInfo(b))&&b.isImage&&b.triggerJson?b.triggerJson.fieldInfo:null},isShapeCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.isShape)},isEmptyShapeCell:function(b){b=(b=e._toFieldInfo(b))&&b.shapeJson;return!(!b||b.g&&b.g.length)},isPlaceholderShapeCell:function(b){b=(b=e._toFieldInfo(b))&&b.shapeJson;return!(!b||!b.isPlaceholder)},isTextLikeCell:function(b){return!e._toFieldInfo(b)||e.isRichTextCell(b)||e.isVariableLikeFieldCell(b)||e.isSpecialFieldCell(b)},isRichTextCell:function(b){b=
e._toFieldInfo(b);return!(!b||!b.isRichText)},isVariableLikeFieldCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.hasVariable&&!b.script&&"headers.CHART_POINT_VALUE"!==b.name)},isVariableFieldCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.hasVariable)},isScriptFieldCell:function(b){b=e._toFieldInfo(b);return!(!b||!b.script)},isUneditableScript:function(b){b=e._toFieldInfo(b);return!!(b&&b.script&&b.script.isUneditableScript)},isNumericVariableFieldCell:function(b){return(b=e._toFieldInfo(b))?
b.hasVariable&&m.isNumericField(b)||b.script&&!b.script.isUneditableScript&&"String"!==b.script.type||"headers.CHART_POINT_VALUE"===b.name?!0:!1:!1},isCalculatableNumericVariableFieldCell:function(b){return e.isNumericVariableFieldCell(b)},isStringVariableFieldCell:function(b){b=e._toFieldInfo(b);return!(!b||!(b.hasVariable&&"esriFieldTypeString"===b.type||b.script&&"String"===b.script.type))},isSpecialFieldCell:function(b){var c=e._toFieldInfo(b);return c&&("headers.CHART_POINT_VALUE"===c.name||
!e.isVariableLikeFieldCell(b)&&p.hasField(c.name))}};return e})},"esri/dijit/geoenrichment/utils/FieldUtil":function(){define([],function(){function r(f){return("string"===typeof f?f:f&&f.type)||""}var p={isNumericField:function(f){switch(r(f)){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":return"i";case "esriFieldTypeSingle":case "esriFieldTypeDouble":return"f"}return!1},isStringField:function(f){return"esriFieldTypeString"==r(f)||!1},isDateField:function(f){return"esriFieldTypeDate"==
r(f)||!1}},m=/DISTANCE$/;p.isDistanceField=function(f){return m.test(r(f))};var h=/^(SHAPE__Area|SHAPE__Length)$/i;p.canShowField=function(f,e){if(!f||!f.name||"esriFieldTypeOID"===f.type)return!1;if("esriFieldTypeDate"===f.type)return"d";var b=p.isNumericField(f)||p.isStringField(f);if("f"===b&&!1===f.editable&&h.test(f.name))return null;void 0===e&&(e=/^(OBJECTID|OID|FID)$/i);return e&&e.test(f.name)?!1:!0===b?"s":b};p.createFieldInfo=function(f){var e=p.canShowField(f);f={fieldName:f.name,label:f.alias||
f.name,isEditable:!!f.editable,visible:!!e};switch(e){case "i":f.format={places:0,digitSeparator:!0};break;case "f":f.format={digitSeparator:!0};break;case "s":f.stringFieldOption="textbox"}return f};return p})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/tableJson/TableJsonUtil":function(){define(["dojo/_base/lang","../templateJsonUtils/fieldInfo/FieldInfoBuilder","../templateJsonUtils/fieldInfo/FieldLibrary","../../grid/coreUtils/GridDataUtil","esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes"],
function(r,p,m,h,f){var e={createTable:function(b){var c=b.numColumns,d=b.numRows,a=b.width,g=b.widths,l=b.style,k=b.attributes&&b.attributes.fixedColumns,n=b.attributes&&b.attributes.dynamicColumns;if(a)if(g)g=g.map(function(E){return a*Number(E.replace("%",""))/100});else{var q=a/c;g=[];for(var u=0;u<c;u++)g.push(q)}if(g)a||isNaN(Number(g[0]))||(a=0,g.forEach(function(E){a+=E}));else for(q=Number(100/c).toFixed(3)+"%",g=[],u=0;u<c;u++)g.push(q);q=[];for(u=0;u<c;u++)q.push({field:"field"+u,style:{width:g[u]}});
g=[];for(var t=!0,v=b.height?b.height/d:b.rowHeight||15.07,y=0;y<d;y++){var B={style:{height:v,fields:{}},fieldInfos:{}};for(u=0;u<c;u++){var D="field"+u;!1!==b.useDefaultTheme&&(B.style.fields[D]=r.mixin({horizontalAlign:0===u?"left":"right",overrideStyle:0===y?1<d?!1!==b.useDefaultHeaderTheme?"TableHeader":"Default":void 0:t?"AlternatingRow":"Default"},b.cellParams));n&&u>=k&&0===y&&(B.fieldInfos[D]=p.createFieldInfoFromSpecialFieldName("AREA_DESC"));b.processTableCell&&b.processTableCell(B,D,y,
u,b)}g.push(B);t=!t}return{id:"table",attributes:r.mixin({},b.attributes),style:r.mixin({width:a||772.33},l),data:{columns:q,data:g}}},createSingleCellTable:function(b){b=b||{};var c=e.createTable({numColumns:1,numRows:1,attributes:b.attributes,useDefaultTheme:!1});e.modifyTableJson(c,0,0,b);return c},modifyTableJson:function(b,c,d,a){c=b.data.data[c];d=b.data.columns[d];var g=d.field;a.text&&(c[g]=a.text);a.fieldInfo&&(c.fieldInfos[g]=a.fieldInfo);a.cellStyle&&(c.style.fields[g]=a.cellStyle);a.columnSpan&&
(c.columnSpans=c.columnSpans||{},c.columnSpans[g]=a.columnSpan);a.rowSpan&&(c.rowSpans=c.rowSpans||{},c.rowSpans[g]=a.rowSpan);c.themeStyle=a.themeStyle;a.width&&(b.style.width=a.width,d.style.width=a.width);a.height&&(c.style.height=a.height);void 0!==a.left&&(b.style.left=a.left);void 0!==a.top&&(b.style.top=a.top)},getTableWidth:function(b){return b.style.width},getTableHeight:function(b){var c=0;b.data.data.forEach(function(d){c+=d.style?d.style.height:0});return c},calcTableBox:function(b){return{x:b.style.left||
0,y:b.style.top||0,w:e.getTableWidth(b),h:e.getTableHeight(b)}},createDetailsSection:function(b){return{type:f.DETAILS,stack:[e.createTable(b)]}},createDetailsSectionForFieldInfos:function(b,c){return{type:f.DETAILS,stack:[function(){var d=e.createTable(r.mixin({numColumns:2,numRows:b.length+1},c));d.data.data.forEach(function(a,g){0===g?a.field0=b[0].hasVariable?b[0].fieldCategory:"":(g=b[g-1],a.field0=g.script?g.script.alias:g.hasVariable?g.alias:m.getFieldLabel(g.name)||"",a.fieldInfos.field1=
g)});e.provideSpaceAfter(d);return d}()]}},createDetailsSectionForFieldInfoGroups:function(b,c){return{type:f.DETAILS,stack:[function(){var d=e.createTable(r.mixin({numColumns:b.length+1,numRows:b[0].length+1},c));d.data.data.forEach(function(a,g){d.data.columns.forEach(function(l,k){0!==k&&(0===g?a[l.field]=b[k-1][0].fieldCategory||"":(k=b[k-1][g-1],a.field0=a.field0||(k.script?k.script.alias:k.alias),a.fieldInfos[l.field]=k))})});e.provideSpaceAfter(d);return d}()]}},provideSpaceAfter:function(b,
c){b.style.spaceAfter=Math.max(c||0,90-15.07*b.data.data.length)},applyDefaultStyling:function(b){var c=!0;b.data.data.forEach(function(d,a){b.data.columns.forEach(function(g){d.style.fields[g.field].overrideStyle=0===a?"TableHeader":c?"AlternatingRow":void 0});c=!c})},setTableHeaderStyle:function(b){if(b.style)for(var c in b.style.fields)(b.style.fields[c]=b.style.fields[c]||{}).overrideStyle="TableHeader"},DEFAULT_ROW_HEIGHT:15.07,isEmptyTable:function(b){return b.isGrid?!b.columns||!b.columns.length||
!b.store||!b.store.data.length:b.data?!b.data.columns||!b.data.columns.length||!b.data.data||!b.data.data.length:!1},isSingleCelledTable:function(b){return b.isGrid?b.store&&1===b.store.data.length&&b.columns&&1===b.columns.length:b.data?1===b.data.columns.length&&1===b.data.data.length:!1},isMultiDataTable:function(b){return b.isGrid?1<b.columns.length||2<b.store.data.length:b.data?1<b.data.columns.length||2<b.data.data.length:!1},getTableSubtype:function(b){if(!e.isSingleCelledTable(b))return null;
b=e.getFirstFieldInfo(b);return h.isTextLikeCell(b)?"isTextLike":b.isImage?b.triggerJson?"isImage.hasConditionalStyling":"isImage":b.isShape?"isShape":null},getFirstFieldInfo:function(b){return b.isGrid?b.store.data[0].fieldInfos&&b.store.data[0].fieldInfos[b.columns[0].field]:b.data.data[0].fieldInfos&&b.data.data[0].fieldInfos[b.data.columns[0].field]},tableJsonHasInfographic:function(b){return!!e.getTableJsonInfographic(b)},getTableJsonInfographic:function(b){var c;b.data.data.some(function(d){if(d.fieldInfos)for(var a in d.fieldInfos){var g=
d.fieldInfos[a];if(g&&g.isInfographic)return c=g.infographicJson,!0}});return c},getTableJsonFirstFieldInfo:function(b){return b.data.data[0].fieldInfos[b.data.columns[0].field]},tableJsonHasChart:function(b){return b.data.data.some(function(c){if(c.fieldInfos)for(var d in c.fieldInfos){var a=c.fieldInfos[d];if(a&&a.isChart)return!0}})}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder":function(){define(["./utils","dojo/i18n!esri/nls/jsapi"],
function(r,p){function m(c){Object.keys(c).forEach(function(d){var a=c[d];void 0!==a&&null!==a||delete c[d]})}p=p.geoenrichment.dijit.ReportPlayer.ReportPlayer;var h={NUMBER:"n/",createFieldInfoFromCalculator:function(c,d,a){if(!c)return null;c=(d="function"===typeof c.getDescriptionWithType?c:null)?d.variable:c;var g=a&&a.format,l=a&&a.autoformatCurrency,k=a&&a.additionalText,n=a&&a.calculatorName,q=a&&a.defaultDistanceUnits;a=a&&a.summaryType;var u=d&&d.getToggleGroup&&d.getToggleGroup();a={alias:d?
d.getDescriptionWithType()||d.getAliasWithType():c.description||c.alias,hasVariable:!0,variableID:c.id,fullName:c.fullName,fieldCategory:c.fieldCategory,vintage:c.vintage,type:c.type,statefulName:u?u.value:"n/"+c.fullName,summaryType:a};d=d?d.getCalcType().charAt(0):"n";a.name=r.name.createFieldNameFromSource(c,d);g?r.format.setFieldInfoFormat(a,g):(a.decimals=c.precision,a.showCurrency=!(!l||"n"!==d||!c.units||"CURRENCY"!==c.units.toUpperCase()),a.showPercent=!a.showCurrency&&("p"===d||"n"===d&&
c.units&&"PCT"===c.units.toUpperCase()),a.useThousandsSeparator=!0);c.isWebMap&&(a.isWebMap=!0,a.webMapFieldName=c.fieldName,a.webMapField=c.fieldInfo,a.webMapId=c.webMapId,a.layerUrl=c.layerUrl,!g&&c.fieldInfo&&c.fieldInfo.format&&(a.decimals=c.fieldInfo.format.places,a.useThousandsSeparator=!1!==c.fieldInfo.format.digitSeparator));c.customDataCollection&&(a.isCustomDataCollection=!0,a.customDataCollectionId=c.customDataCollection.id,a.customDataCollectionUrl=c.customDataCollection.url,a.customDataCollectionPortalUrl=
c.customDataCollection.portalUrl);c.isSiteAttribute&&(a.isSiteAttribute=!0,a.attribute=c.attribute,a.type=c.attribute.type,!g&&0<c.attribute.places&&(a.decimals=c.attribute.places));c.isDataLayerAttribute&&(a.isDataLayerAttribute=!0,a.layerID=c.layerID,a.layerUrl=c.layerUrl,a.layerName=c.layerName,a.attribute=c.attribute,a.type=c.attribute.type,!g&&0<c.attribute.decimals&&(a.decimals=c.attribute.decimals),"DISTANCE"===c.attribute.name&&(a.units=c.attribute.units||q||"esriMiles"));"string"===typeof k&&
(a.additionalText=k);a.usedFields=c.usedFields;a.expressionText=c.expressionText;r.name.provideQualifiedFieldInfoTemplateName(a,n);m(a);return a},fieldInfoToVariable:function(c){if(!c.hasVariable)return null;var d={id:c.variableID,fullName:c.fullName,fieldCategory:c.fieldCategory,vintage:c.vintage,type:c.type,precision:c.decimals,usedFields:c.usedFields,expressionText:c.expressionText};c.isWebMap&&(d.isWebMap=!0,d.fieldName=c.webMapFieldName,d.fieldInfo=c.webMapField,d.webMapId=c.webMapId,d.layerUrl=
c.layerUrl);c.isSiteAttribute&&(d.isSiteAttribute=!0,d.attribute=c.attribute);return d},createFieldInfoFromScript:function(c,d){var a=d&&d.format,g=d&&d.additionalText;d=d&&d.calculatorName;c=c||{};c.name=c.name||r.name.DEFAULT_SCRIPT_NAME;c.alias=c.alias||p.scriptNameDefault;c.decimals=Number(c.decimals)||0;var l={};l.name=r.name.createFieldNameFromScript(c);r.name.provideQualifiedFieldInfoTemplateName(l,d);l.script=c;a?r.format.setFieldInfoFormat(l,a):(l.decimals=Number(c.decimals),l.showCurrency=
!1,l.showPercent=!1,l.useThousandsSeparator=!0);"string"===typeof g&&(l.additionalText=g);m(l);return l},createFieldInfoFromImage:function(c,d){return{isImage:!0,imageJson:c,triggerJson:d}},createFieldInfoFromMap:function(c){return{isMap:!0,mapJson:c}},createFieldInfoFromShape:function(c){return{isShape:!0,shapeJson:c}},createFieldInfoFromChart:function(c){return{isChart:!0,chartJson:c}},createFieldInfoFromInfographic:function(c){return{isInfographic:!0,infographicJson:c}},createFieldInfoFromSection:function(c){return{isReportSection:!0,
sectionJson:c}},createFieldInfoFromMissingVariable:function(c,d){return{name:c&&c.substr(c.indexOf(".")+1),templateName:c,isMissing:!0,alias:d}},createFieldInfoForUnsupportedContent:function(){return{isUnsupportedContent:!0}}},f=/^\[\w+\]$/,e=/\[\w+\]/;h.createFieldInfoFromLabel=function(c,d){if("string"!==typeof c)return null;c=c.trim();var a=f.test(c);if(!d||a){if(!a)return null;c=c.replace(/\[|\]/g,"").toUpperCase();return h.createFieldInfoFromSpecialFieldName(r.fields.uiToTemplate(c))}return e.test(c)?
r.richText.createFieldInfoFromRenderedXMLString(c):null};h.createFieldInfoFromSpecialFieldName=function(c,d){if("string"!==typeof c)return null;c=r.fields.trimTemplateHeaderName(c);c=c.toUpperCase();if("GROUPCOUNT"===c)var a={name:r.fields.GROUPCOUNT_FIELD_NAME,alias:r.fields.GROUPCOUNT_FIELD_ALIAS};else"CURRDATE"===c?a={name:r.fields.DATE_FIELD_NAME,alias:r.fields.DATE_FIELD_ALIAS,format:d||r.fields.DATE_FIELD_DEFAULT_FORMAT}:"SITENOTES"===c?a={name:r.fields.qualifyTemplateHeaderName(r.fields.SITENOTES_FIELD_NAME),
alias:r.fields.SITENOTES_FIELD_ALIAS,type:"esriFieldTypeString"}:0===c.indexOf("SITENOTE")&&(a=r.fields.getSiteNoteFieldNameAt(c.replace("SITENOTE","")),a={name:r.fields.qualifyTemplateHeaderName(a),alias:a,type:"esriFieldTypeString"});if(a)return a;var g=r.fields.templateToUIHeader(c);g?(a={name:r.fields.qualifyTemplateHeaderName(c),alias:g,type:"esriFieldTypeString"},r.fields.isChartAttribute(c)&&(a.isChartAttribute=!0),"CHART_POINT_VALUE"===c&&(a.type="esriFieldTypeDouble",a.decimals=0,a.useThousandsSeparator=
!0,d&&r.format.setFieldInfoFormat(a,d))):(d=r.fields.templateToUIReportVar(c))&&(a={name:d,alias:d,type:"esriFieldTypeString"});a&&(a.templateName=a.name);return a};var b=/_P$/i;h.isFieldInfoInPercentState=function(c){return c?c.statefulName&&("p"===c.statefulName.charAt(0)||b.test(c.statefulName))||c.alias&&-1!==c.alias.indexOf("(%)"):!1};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/utils":function(){define(["esri/dijit/geoenrichment/Deferred",
"require"],function(r,p){var m={},h;m.init=function(){if(h)return h.promise;h=new r;p("./FieldInfoBuilder ./FieldInfoFormatUtil ./FieldInfoNameUtil ./FieldInfoRenderer ./RichTextJsonUtil ./FieldLibrary".split(" "),function(f,e,b,c,d,a){m.builder=f;m.format=e;m.name=b;m.renderer=c;m.richText=d;m.fields=a;h.resolve()});return h.promise};m.init();return m})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes":function(){define([],function(){return{PAGE_HEADER:"PageHeader",DETAILS_HEADER:"DetailsHeader",
DETAILS:"Details",GROUP:"Group",PAGE_FOOTER:"PageFooter",REPORT_FOOTER:"ReportFooter",DATA_SOURCE:"DataSource",EMPTY:"empty",INFOGRAPHIC_HEADER:"InfographicHeader",INFOGRAPHIC_VARIABLE:"InfographicVariable",INFOGRAPHIC_BACKGROUND:"InfographicBackground",INFOGRAPHIC_FOREGROUND:"InfographicForeground",INFOGRAPHIC_ATTRIBUTES:"InfographicAttributes",INFOGRAPHIC_NOTES:"InfographicNotes",INFOGRAPHIC_SUMMARY:"InfographicSummary",INFOGRAPHIC_SUMMARY_FOOTER:"InfographicSummaryFooter",TABLE_BACKGROUND:"TableBackground",
TABLE_FOREGROUND:"TableForeground",TABLE_BACKGROUND_FLOATING_PANELS:"BackgroundFloatingPanels",TABLE_FOREGROUND_FLOATING_PANELS:"ForegroundFloatingPanels",TABLE_FLOATING_PANELS:"FloatingPanels"}})},"esri/dijit/geoenrichment/utils/PortalUtil":function(){define("dojo/_base/lang esri/kernel esri/request ./requests/EveryRequest ./requests/UniversalClient ../ReportPlayer/dataProvider/commands/mapToImage/MapToURLUtil ./CacheUtil ./ProjectionUtil ./UrlUtil".split(" "),function(r,p,m,h,f,e,b,c,d){var a={query:function(g,
l,k,n){l=l||{};k=k||"results";n=n||100;var q="number"===typeof l.num?l.num:-1,u=l.num=0>q||l.num>n?n:l.num;l.start=l.start||1;return g(l).then(function(t){var v=t[k],y=t.total-l.start+1;0<=q&&y>q&&(y=q);y-=u;if(0>=y)return t;l.num=u;for(var B=[];0<y;)l.start+=u,B.push(g.bind(null,r.mixin({},l))),y-=u;return h(B,{stopOnError:!0}).then(function(D){D.forEach(function(E){Array.prototype.push.apply(v,E[k])});return t})})},queryCommon:function(g,l){return a.query(function(k){var n=p.id.findCredential(g)||
p.id.credentials[0];return m({url:g,content:r.mixin({f:"json",token:n?n.token:void 0},l,k),handleAs:"json"},{usePost:!0})}).then(function(k){return k.results})},getPortalSelf:function(g){return f.requestPublicFirst(d.combine(g,"sharing/rest/portals/self"),{})},getDefaultBasemaps:function(g){var l=b.get("PortalUtil.basemaps");l[g]||(l[g]=a.getPortalSelf(g).then(function(k){return f.request(d.combine(g,"sharing/rest/community/groups"),{content:{q:k.useVectorBasemaps?k.vectorBasemapGalleryGroupQuery:
k.basemapGalleryGroupQuery,f:"json"},handleAs:"json"}).then(function(n){return(n=n.results[0])?f.request(d.combine(g,"sharing/rest/search"),{content:{q:"group:"+n.id+' AND type:"web map"',num:100,f:"json"},handleAs:"json"}).then(function(q){return q.results}):null})}));return l[g]},tryConfigureServicesFromAGOLPublic:function(){return a.getPortalSelf("https://www.arcgis.com").then(function(g){if(g=g&&g.helperServices)g.geometry&&c.setGeometryServiceUrl(g.geometry.url),g.printTask&&e.setPrintMapTaskUrl(g.printTask.url)}).otherwise(function(g){console.log(g)})}};
return a})},"esri/dijit/geoenrichment/utils/requests/EveryRequest":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(r,p,m){var h=r(null,{requests:null,results:null,requestCount:0,chunkSize:0,stopOnError:!1,onProgress:null,index:0,completeCount:0,executeCount:0,isExecuting:!1,dfd:null,constructor:function(f,e,b,c,d){this.requests=f;this.results=e;this.requestCount=this.requests.length;this.chunkSize=Math.max(b,0);this.stopOnError=
c;this.onProgress=d},execute:function(){this.isExecuting=!0;for(this.dfd=new p;this.tryStartNextRequest(););return this.dfd.promise},tryStartNextRequest:function(){if(!this.isExecuting)return!1;if(this.index==this.requestCount&&!this.executeCount)return this.isExecuting=!1,this.dfd.resolve(this.results),!1;if(this.index==this.requestCount||this.executeCount==this.chunkSize)return!1;var f=this.requests[this.index++];this.executeCount++;var e=f.request;"function"===typeof e&&(e=e());var b=this,c=!0;
m(e,function(d){b.processResult(d,f.key,d instanceof Error,c)},function(d){b.processResult(d,f.key,!0,c)});c=!1;return!0},processResult:function(f,e,b,c){if(this.isExecuting)if(b&&this.stopOnError)this.isExecuting=!1,this.onProgress&&this.onProgress(1),this.dfd.reject(f);else if(this.results[e]=f,this.completeCount++,this.executeCount--,this.onProgress&&this.onProgress(this.completeCount/this.requestCount),!c)for(;this.tryStartNextRequest(););}});return function(f,e){var b=!1,c=10,d=null;"boolean"===
typeof e?b=e:e&&("number"===typeof e.chunkSize&&(c=e.chunkSize),"boolean"===typeof e.stopOnError&&(b=e.stopOnError),"function"===typeof e.onProgress&&(d=e.onProgress));var a=[];if(Array.isArray(f)){var g=[];f.forEach(function(k,n){a.push({key:n,request:k})})}else for(var l in f)g={},a.push({key:l,request:f[l]});return(new h(a,g,c,b,d)).execute()}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/mapToImage/MapToURLUtil":function(){define("require dojo/_base/declare esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/dom-style esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/ImageInfoUtil esri/dijit/geoenrichment/utils/RegExpUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),
function(r,p,m,h,f,e,b,c,d,a){function g(){var E=new m;r("esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/layers/GraphicsLayer ./DotDensityToImageUtil ./LegendToLayerUtil".split(" "),function(F,z,w,A,H,G){k=z;n=w;q=A;u=H;t=G;l=p(F,{returnJson:!1,mapName:null,_execute:function(){this.returnJson&&(this.printGp.submitJob=this.printGp.execute=function(I,N){I="data:application/json;base64,"+b.base64FromJson(I.Web_Map_as_JSON);N([{value:{url:I}}]);return(new m).resolve()});
return this.inherited(arguments)},_getPrintDefinition:function(I,N){var M=this.inherited(arguments);this.returnJson&&this.mapName&&(M.title=this.mapName);console.log(M);return M},_createOperationalLayers:function(I,N){var M=this.inherited(arguments);if(N.__legendLayerId){var O=M.filter(function(S){return S.id===N.__legendLayerId})[0];M.splice(M.indexOf(O),1);M.push(O)}return M},_createFeatureCollection:function(I,N,M,O){var S=this.inherited(arguments);this.returnJson&&S&&("esri.layers.FeatureLayer"===
I.declaredClass||"esri.layers.StreamLayer"===I.declaredClass||"esri.layers.GraphicsLayer"===I.declaredClass)&&S.featureCollection.layers.forEach(function(R){R.layerDefinition.name=I.arcgisProps&&I.arcgisProps.title||I._titleForLegend||I.name||I.id;R.layerDefinition.name=d.decodeXML(R.layerDefinition.name);R.layerDefinition.objectIdField="OBJECTID";R.layerDefinition.fields=[{name:"OBJECTID",type:"esriFieldTypeOID"}];var V={OBJECTID:1},Z=/[^\w]/g,da;R.featureSet.features.forEach(function(W,ea){W.attributes=
W.attributes||{};W.attributes.OBJECTID=ea+1+"";W.attributes.__nameField||(W.attributes.Name=d.decodeXML(W.attributes.Name||R.layerDefinition.name),da="Name");ea=W.attributes.__fieldAliases;for(var Q in W.attributes)if(0!==Q.indexOf("__")){var X=Q,U=W.attributes[Q];"string"===typeof U&&(U=d.decodeXML(U));var fa=ea&&ea[Q];(fa=fa&&fa.replace(Z,"_"))&&void 0===W.attributes[fa]&&(W.attributes[fa]=U,X=fa);W.attributes.__nameField===Q&&(da=X);V[Q]||(V[Q]=1,R.layerDefinition.fields.push({name:X,type:"string"===
typeof U?"esriFieldTypeString":"esriFieldTypeDouble"}))}});R.layerDefinition.displayField=da});return S},_convertSvgSymbol:function(I){return I}});E.resolve()});return E.promise}var l,k,n,q,u,t,v,y={setPrintMapTaskUrl:function(E){v=E;a.registerCORS(E)},mapToURL:function(E,F,z,w){var A=y._getUrlForMap(E);if(A)return A;A=g().then(function(){return y._replaceDotDensityLayersWithPictureMarkers(E).then(function(H){return h(F&&t.legendToGraphicsLayer(F,E,z),function(G){G&&E.addLayer(G);return h(y._runPrintTask(E,
z,G,w),function(I){G&&E.removeLayer(G);y._rollbackReplacing(E,H);var N=new m;setTimeout(function(){N.resolve(I.url)},100);return N.promise})})})});y._putUrlToCache(E,A);return A},_replaceDotDensityLayersWithPictureMarkers:function(E){var F=[];for(i=0;i<E.graphicsLayerIds.length;i++)layer=E.getLayer(E.graphicsLayerIds[i]),layer.loaded&&layer.visible&&u.isDotDensity(layer)&&F.push(y._createGraphicsLayerFromDotDensityLayer(i,layer,E));return f(F)},_createGraphicsLayerFromDotDensityLayer:function(E,F,
z){return u.createPictureMarkersFromDotDensityLayer(F,z.extent,z).then(function(w){if(!w)return null;var A=new q;w.map(function(H){A.add(H)});z.addLayer(A,E);F.visible=!1;return{addedLayer:A,hiddenLayer:F}}).otherwise(function(w){console.log(w);return null})},_runPrintTask:function(E,F,z,w){function A(){var H=new l(v);H.returnJson=w&&w.replaceWithJson;H.mapName=w&&w.mapName;var G=new k;G.map=E;var I=new n;I.exportOptions={width:3.125*e.get(F,"width"),height:3.125*e.get(F,"height"),dpi:300};I.format=
"png32";I.showAttribution=!1;I.forceFeatureAttributes=!0;I.__legendLayerId=z&&z.id;G.template=I;return H.execute(G)}return h(A(),function(H){return H},function(H){console.log(H);return h(A(),function(G){return G},function(G){console.log(G);return A()})})},_rollbackReplacing:function(E,F){F.forEach(function(z){z&&z.addedLayer&&E.removeLayer(z.addedLayer);z&&z.hiddenLayer&&(z.hiddenLayer.visible=!0)})},urlToSrc:function(E,F){return F&&F.saveImagesAsDataUrl?c.getRemoteImageDataUrl(E,{sizeLimit:1500}):
E}},B,D=0;y.enableCaching=function(){B={}};y.clearCaching=function(){B=null};y._putUrlToCache=function(E,F){B&&F&&(E.__mapToImageUtilKey=D++,B[E.__mapToImageUtilKey]=F)};y._getUrlForMap=function(E){return B&&B[E.__mapToImageUtilKey]};return y})},"esri/dijit/geoenrichment/utils/ImageInfoUtil":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/when","./CacheUtil","./ImageUtil","./UrlUtil"],function(r,p,m,h,f){var e=/^data:/i,b={getImageInfo:function(c,d,a){var g=a&&a.sizeLimit||1E5,l=m.get("ImageInfoUtil"),
k=c+(a&&a.crossOrigin||"");l[k]||(l[k]=h.imageFromUrl(c,a).then(function(n){var q=h.imageToDataURL(n),u={dataUrl:q,contentType:h.getContentType(q),width:n.width,height:n.height};setTimeout(function(){l[k]=u});return u}));return p(l[k],function(n){n=r.mixin({},n);d&&(n.filename=d&&d.replace(/\.\w+$/,".png").toLowerCase());return function(q){return p(b._processDataUrl(q,g),function(u){if(u&&u.dataUrl){var t=r.mixin({},q);t.dataUrl=u.dataUrl;t.width*=u.factor;t.height*=u.factor;return p(t)}return p(q)})}(n)})},
ensureDataUrlForRemoveImage:function(c,d){return!c||e.test(c)?c:b.getRemoteImageDataUrl(c,d)},getRemoteImageDataUrl:function(c,d){function a(n,q){return b.getImageInfo(n?k+"?"+c:c,null,{crossOrigin:q}).then(function(u){return p(b._processDataUrl(u,l),function(t){return t&&t.dataUrl||t})})}function g(){console.log("Failed to get data for URL: "+c);return c}if(!c)return c;var l=d&&d.sizeLimit||1E5,k=f.getProxyUrl();return a(!1,"anonymous").otherwise(function(){return a(!1,null)}).otherwise(function(){return k?
a(!0,"anonymous"):g()}).otherwise(function(){return a(!0,null)}).otherwise(g)},_processDataUrl:function(c,d){var a=Math.max(c.width,c.height);if(a<=d)return c.dataUrl;var g=d/a;return p(h.scaleImage(c.dataUrl,{factor:g}),function(l){return{dataUrl:l,factor:g}})}};return b})},"esri/dijit/geoenrichment/utils/ProjectionUtil":function(){define("esri/dijit/geoenrichment/Deferred esri/SpatialReference esri/geometry/jsonUtils esri/dijit/geoenrichment/utils/CoordinateUtil esri/dijit/geoenrichment/utils/PolygonUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/requests/EveryRequest".split(" "),
function(r,p,m,h,f,e,b,c){function d(t){return t&&t.spatialReference||t instanceof p&&t||t&&new p(t)||new p(h.WEB_MERCATOR_WKID)}function a(t,v){var y=[];try{for(var B=0;B<t.length;B++)y.push(h.toSpatialReference(t[B],v))}catch(D){console.log(D)}return(new r).resolve(y)}function g(t,v){function y(A){F.push(function(){return l(E,A,D,v)})}var B=t[0],D=m.getJsonType(B),E={outSR:v.wkid||v.toJson(),inSR:B.spatialReference.wkid||B.spatialReference.toJson()},F=[],z=0,w=[];1==t.length?w.push(B):t.forEach(function(A){var H=
f.getNumberOfPoints(A);z+=H;if(1E4<z){var G=[];w.length?(G.push(A),z=H):(w.push(A),z=0);y(w);w=G}else w.push(A)});w.length&&y(w);return c(F,{stopOnError:!0}).then(function(A){for(var H=A[0],G=1;G<A.length;G++)H=H.concat(A[G]);return H},function(A){console.log(A);return[]})}function l(t,v,y,B){t.geometries=k(v);return u("project",t).then(function(D){return n(D.geometries,y,B)})}function k(t){var v=t.map(function(y){y=y.toJson();delete y.spatialReference;return y});return{geometryType:m.getJsonType(t[0]),
geometries:v}}function n(t,v,y){var B=m.getGeometryType(v),D=y.toJson();return t.map(function(E){E.spatialReference=D;return new B(E)})}var q={},u;q.setGeometryServiceUrl=function(t){e.registerCORS(t);u=function(v,y){return b.requestPublicFirst({url:t,urlSuffix:v},{content:y})}};q.setGeometryRequest=function(t){u=t};q.getSpatialReference=d;q.projectGeometries=function(t,v){var y=d(v);v=Array.isArray(t)?t:[t];if(!v.length)return(new r).resolve(t);var B={},D=v.slice(),E=0;v=v.filter(function(F,z){if(F.spatialReference&&
F.spatialReference.wkid!==y.wkid)return B[z]=E++,!0});return v.length?(h.testSpatialReferenceWKID(y)&&h.testSpatialReferenceWKID(v[0].spatialReference)?a(v,y):g(v,y)).then(function(F){D.forEach(function(z,w){void 0!==B[w]&&(D[w]=F[B[w]])});return Array.isArray(t)?D:D[0]}):(new r).resolve(t)};q.unionGeometries=function(t){var v=d(t[0].spatialReference);t={sr:v.wkid||v.toJson(),geometries:k(t)};return u("union",t).then(function(y){return n([y.geometry],y.geometryType,v)[0]})};q.geometriesToJson=k;q.geometriesFromJson=
n;return q})},"esri/dijit/geoenrichment/utils/PolygonUtil":function(){define([],function(){var r={getNumberOfPoints:function(p){if(!p)return 0;Array.isArray(p)||(p=[p]);var m=0;p.forEach(function(h){m+=r.getGeometryPointCount(h.geometry||h)});return m},getGeometryPointCount:function(p){if(!p)return 0;var m=0,h=p.rings||p.paths;!h&&p.points&&(h=[p.points]);h?h.forEach(function(f){m+=f&&f.length||0}):m+="x"in p?1:2;return m}};return r})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_ServerSerializationSupport":function(){define("dojo/_base/declare esri/dijit/geoenrichment/when esri/dijit/geoenrichment/utils/ImageUtil ./supportClasses/ReportDataProcessor ./supportClasses/tasks/parsers/DataXMLParser ./supportClasses/areas/AnalysisAreaUtil ./supportClasses/areas/AnalysisAreaJsonUtil ./supportClasses/areas/AreasPreprocessor ./supportClasses/GEUtil ../core/supportClasses/ReportTemplateTypes ../core/conversion/PortalToEditorConverter ../core/supportClasses/map/WebMapJsonUtil ../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil ./supportClasses/attachments/AttachmentsStoreSerializer ../core/supportClasses/templateJsonUtils/TemplateJsonSerializer ../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../core/conversion/portalToEditorUtils/metadata/MetadataFromDataBuilder ../countryConfig".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v){return r(null,{reportDataToServerData:function(y){return null},reportDataFromServerData:function(y,B){function D(M){F.some(function(O){return"metadata.xml"===O.name})||F.push({name:"metadata.xml",data:t.recoverMetadataFromAreaData(I.areaData,M)})}function E(M){y.sites=[];var O={},S=1;I.areaData.forEach(function(R){R=R.headers&&R.headers.data||{};var V=R.SITE_NAME||R.STORE_NAME,Z=R.STORE_ID||"unclassified."+S++;"number"!==typeof O[Z]&&(O[Z]=y.sites.length,
y.sites.push({locationName:V,name:null,shortName:null,description:null,address:R.STORE_ADDR,latitude:R.STORE_LAT,longitude:R.STORE_LONG,areas:[]}));y.sites[O[Z]].areas.push({locationName:V,name:R.AREA_DESC?V+" ("+R.AREA_DESC+")":V,shortName:R.AREA_DESC,description:R.AREA_DESC2,address:R.STORE_ADDR,latitude:R.STORE_LAT,longitude:R.STORE_LONG,feature:{attributes:{STORE_ID:R.STORE_ID,AREA_ID:R.AREA_ID}}})});y.sites.forEach(function(R){var V=!1;R.shortName=R.areas.map(function(da){return V=!!da.shortName,
da.shortName}).join(", ");V&&(R.name=R.locationName+" ("+R.shortName+")");var Z=R.areas.map(function(da){return da.description});R.description=1<Z.length?Z[0]===Z[1]?Z[0]:Z.join(", "):Z[0]||""});I.reportInfo.sites&&I.reportInfo.sites.forEach(function(R,V){if(V=y.sites[V])V.attributes=R.attributes,V.notes=R.notes,V.images=R.images,V.images&&V.images.forEach(function(Z){function da(W){return(W=M[W])&&m.base64DataToDataURL(W,"image/png")}Z.url=da(Z.url);Z.thumbnail=da(Z.thumbnail)})})}v.reset();var F=
y.reportItem.resources,z;if(!Array.isArray(F)){var w=F;F=[];for(var A in w)F.push({name:A,data:w[A]})}F.forEach(function(M){"theme.css"===M.name&&(M.name="theme.css.txt")});var H=F.filter(function(M){return"report.xml"===M.name})[0],G=F.filter(function(M){return"data.xml"===M.name})[0],I;(function(){var M=/.*\.(png|jpg|jpeg)$/i,O=/(.*\.(json)$)|(^maps\/.*\.(png)$)/i,S={},R={};F.forEach(function(W){M.test(W.name)&&(S[W.name]=W.data,"logo.png"===W.name&&(z=m.base64DataToDataURL(W.data,"image/png")));
O.test(W.name)&&(-1!==W.data.indexOf("operationalLayers")?R[W.name]=l.processWebMapJson(W.name,W.data):R[W.name]=W.data)});var V={},Z=H.data.match(/<section[^<>]*query=("|').+?("|').*?>/g);Z&&Z.forEach(function(W){W=W.replace(/.*?query=("|')/,"");W=W.replace(/("|').*/,"");V[W]=1});var da={};I=f.parse(G.data,function(W,ea,Q){return(W=R[ea])?da[Q]=W:S[ea]||ea});D({map:da,locator:V});E(S)})();var N=new u;return p(function(M){var O=H.data.indexOf("\x3csection"),S={isGraphicReport:H.data.indexOf("\x3ctable")<
O,isMultiFeature:!1,defaultComparisonZoom:null,type:a.STANDARD,portalJson:{files:F}};return p(g.provideEditorJson(S,{variableProvider:M}),function(){S.templateJson=q.deserialize(S.templateJson);S.isMultiFeature=k.hasMultiFeatureSections(S.templateJson);delete S.portalJson;return S})}(N),function(M){e.parseSites(y);var O=b.areasFromJson(y.analysisAreas),S=y.combinedAreasInfo&&b.combinedAreasInfoFromJson(y.combinedAreasInfo)||{},R=y.attachmentsProvider&&n.getAttachmentsStoreFromJson(y.attachmentsProvider),
V={isMultiFeature:M.isMultiFeature&&1<O.length,reportTitle:null,templateJson:M.templateJson,reportObject:M,fieldData:{specialTradeAreaCalculatorName:null,runReportTaskIDs:null,metadata:{},areaData:[],errors:[],reportInfo:null},analysisAreas:O,combinedAreasInfo:S,reverseAnalysisAreasOnMap:!0,attachmentsStore:R,templateVariableProvider:N,customLogo:z,config:{}};e.populateCombinedAreasInfo(V.combinedAreasInfo,V.analysisAreas);c.provideAreasIndexes(V);d.setGeoenrichmentUrl(null);B&&B.forEach(function(Z){switch(Z){case "Maps":d.addCapability("FormatInfographicsMaps");
break;case "ImageUrls":d.addCapability("FormatInfographicsImageUrls")}});return p(h.applyRunReportAndGetDataResults(I,V)).then(function(){return V})})}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportDataProcessor":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred ./tasks/EnrichAreasTask ./tasks/RunReportTask ./data/AreaCalculatorsUtil ./data/VariablesUtil ./CustomReportsManager ./stdGeographies/StdGeographiesModel esri/dijit/geoenrichment/utils/DateUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil ../../core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer ../../core/infographics/utils/InfographicJsonUtil ../../config ../../countryConfig".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t){return{runReportAndGetData:function(v,y){return p([c.getCustomReportByID(v),y]).then(function(B){var D=B[0];B=B[1];return(new f).execute({portalUrl:v.portalUrl,analysisAreas:v.analysisAreas,countryID:v.countryID,hierarchy:v.hierarchy,report:{reportID:D.reportID,portalUrl:D.templateData.getPortalUrl(!0),modified:D.modified,isMultiFeature:D.isMultiFeature},attachmentsStore:B,cacheResult:u.runReportTask.cacheResult}).then(function(E){return{taskIDs:E.taskIDs,
areaData:E.areaData,reportInfo:E.reportInfo}},function(E){v.fieldData.errors.push(E);return(new m).reject(E)})})},runReportFromVariables:function(v){var y={};v.variables.fullNames.forEach(function(B){var D=l.createFieldNameFromSource(B);y[B.substr(B.indexOf(".")+1)]=D});return(new h).enrichAreas({portalUrl:v.portalUrl,analysisAreas:v.analysisAreas,countryID:v.countryID,hierarchy:v.hierarchy,fields:b.convertForEnrich(v.variables),comparisonLevels:v.comparisonLevels||q.getDefaultLevels()}).then(function(B){var D=
v.analysisAreas.map(function(){return{}});e.addEnrichFeatures(B,y,l.DATA_COLLECTIONS_CALCULATOR_NAME,D);return{areaData:D}},function(B){v.fieldData.errors.push(B);return(new m).reject(B)})},applyRunReportAndGetDataResults:function(v,y){if(v&&v.areaData){var B=y.templateJson;y.fieldData.specialTradeAreaCalculatorName=B.metadata&&B.metadata.specialTradeAreaCalculatorName;delete B.metadata;y.fieldData.runReportTaskIDs=v.taskIDs;y.fieldData.areaData=v.areaData;(y.fieldData.reportInfo=v.reportInfo)&&this._populateReportDataFromReportInfo(v.reportInfo,
y);this._reportDataFromAreas(y.analysisAreas,y.fieldData.areaData);this._reportDataFromReport(y.reportObject,y.fieldData,y.combinedAreasInfo);return this._populateReportDataFromAttachmentsStore(y)}},_populateReportDataFromReportInfo:function(v,y){y.reportTitle=y.reportObject.title=y.reportTitle||v.Title||"";v.country&&!t.getCurrentCountry()&&(t.setCountry(v.country),t.setHierarchyID(null));v.stdLevels&&!t.getGeographiesModel()&&t.setGeographiesModel(new d({levels:v.stdLevels}));if(u.updateVariableInfoFromDataXml||
u.isPlayerOnServer){var B=v.variables;k.processTemplateFieldInfos(y.templateJson,function(D){if(D.hasVariable&&D.variableID&&D.templateName){var E=D.templateName.indexOf("."),F=D.templateName.substr(0,E);E=D.templateName.substr(E+1);(F=B[F]&&B[F][E])&&F.alias&&(D.alias=F.alias,D=y.templateVariableProvider.get(D.templateName))&&(D.alias=F.alias,F.vintage&&(D.vintage=F.vintage),F.source&&(D.source=F.source))}})}v=n.collectVariablesStats(y.templateJson);if(v=y.templateVariableProvider.getVariablesDataVintageDescription({usedVariablesCache:v}))y.reportObject.dataVintageDescription=
v},_populateReportDataFromAttachmentsStore:function(v){var y=v.attachmentsStore,B=[];v.analysisAreas.forEach(function(D,E){y.supportsMultipleAreas&&y.setCurrentAnalysisAreaIndex(E);B.push(r(y.getNotes(),function(F){if(F&&F.length){var z={attributes:{}};z.attributes[g.SITENOTES_FIELD_NAME]=F.map(function(w){return w.text}).join("\x3cbr/\x3e\x3cbr/\x3e");F.forEach(function(w,A){z.attributes[g.getSiteNoteFieldNameAt(A+1)]=w.text});(F=v.fieldData.areaData[E])&&e.addFeatureAttributesCalculator(z,F)}}));
B.push(r(y.getAttributes(),function(F){if(!F||!F.length)return null;var z={attributes:{}};F.forEach(function(w){z.attributes[w.name]=w});(F=v.fieldData.areaData[E])&&e.addFeatureAttributesCalculator(z,F)}))});return p(B)},_reportDataFromAreas:function(v,y){v.forEach(function(B,D){if(D=y[D])e.addFeatureAttributesCalculator(B.feature,D),e.addAreaInfoCalculator(B,D)})},_reportDataFromReport:function(v,y,B){var D=y.metadata;v&&!D.Title&&(D.Title=v.title);D.Subtitle=y.reportInfo&&y.reportInfo.Subtitle||
"";D.Source=v.dataVintageDescription||"Esri";D.Date=a.getReportFooterDate();D.Copyright="\u00a9 "+a.getFullYear()+" Esri";D.ProductLabel="";D.ProductUrl="";D.PhoneNumber="";D.TrialUrlText="";v.isMultiFeature&&(D.SITE_NAME=B.locationName||B.name,D.STORE_NAME=B.locationName||B.name,D.AREA_DESC2=B.description||B.name,D.STORE_ADDR=B.address)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/EnrichAreasTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/kernel esri/SpatialReference esri/tasks/FeatureSet esri/geometry/Point ../GEUtil ../areas/AnalysisAreaUtil ../attachments/AttributesUtil ../../../core/supportClasses/map/Projector ../../../countryConfig esri/dijit/geoenrichment/utils/CoordinateUtil".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n){function q(u){return(u=u&&f.id.findCredential(u)||f.id.credentials[0])&&u.token}return r(null,{enrichAreas:function(u){var t={};return m(this._analysisAreasToStudyAreas(u.analysisAreas,u.countryID,u.comparisonLevels),function(v){t.studyAreas=v;u.report?t.analysisVariables=[{itemid:u.report.reportID,url:u.report.portalUrl,token:q(u.portalUrl),outFields:["*"]}]:u.fields&&(t.analysisVariables=u.fields);return this._doRunTask(t,u,"enrich")}.bind(this)).then(this._handleFeatureSetsRequest.bind(this))},
createReport:function(u){var t={f:"bin",format:"xml",reportfields:{}};t.report={itemid:u.report.reportID,url:u.report.portalUrl,token:q(u.portalUrl)};return m(this._analysisAreasToStudyAreas(u.analysisAreas,u.countryID,null,u.getAttributes),function(v){t.studyAreas=v;return this._doRunTask(t,u,"createReport")}.bind(this))},_analysisAreasToStudyAreas:function(u,t,v,y){var B=this;v=v&&v.map(function(D){return{layer:D}});return h(u.map(function(D,E){if(D.geographies&&D.geographies.length){var F=B._studyAreaFromGeographies(D.geographies,
t,!0);D.feature&&D.feature.attributes&&(F.attributes=p.mixin({},F.attributes,D.feature.attributes))}else F={attributes:p.mixin({},D.feature.attributes),geometry:D.feature.geometry.toJson()};v&&(F.comparisonLevels=v);return h([B._getStorePointForArea(D),y&&y(D)]).then(function(z){var w=z[0];z=z[1];F.attributes=F.attributes||{};w&&(F.attributes.STORE_LAT=F.attributes.STORE_LAT||w.STORE_LAT,F.attributes.STORE_LONG=F.attributes.STORE_LONG||w.STORE_LONG);F.attributes.STORE_ID=E+"";z&&z.forEach(function(A){F.attributes[A.name]=
g.formatAttributeValueForStudyArea(A)});return F})}))},_getStorePointForArea:function(u){if(u=u.location&&u.location.geometry||u.buffer&&u.buffer.point){u=u instanceof c?u:new c(u);var t=a.geometryToLatLong(u);return t?t:m(l.projectGeometries(u,new e(n.WGS_84_WKID)),function(v){return a.geometryToLatLong(v)})}},createFeatureForGeographies:function(u,t){return this._createFeaturesForGeographies(u,t,!0).then(function(v){return v[0]})},createFeaturesForGeographies:function(u,t){return this._createFeaturesForGeographies(u,
t,!1)},_createFeaturesForGeographies:function(u,t,v){u={returnGeometry:!0,outSR:t.outSR||new e(n.WEB_MERCATOR_WKID),studyAreas:v?[this._studyAreaFromGeographies(u,t.countryID,!0,t.generalizationLevel)]:u.map(function(y){return this._studyAreaFromGeographies([y],t.countryID,!1,t.generalizationLevel)},this),dataCollections:["GlobalIntersect"]};return this._doRunTask(u,t,"enrich").then(this._handleFeatureSetsRequest.bind(this))},_studyAreaFromGeographies:function(u,t,v,y){var B={sourceCountry:t,layer:null,
ids:null},D=null,E=[],F;u.forEach(function(z){if(!z||!z.id)throw Error("Wrong geography.");var w=z.levelId;if(w)if(!D)D=w;else if(v&&D!==w)throw Error("Geographies have different level IDs.");E.push(z.id);z.sourceCountry&&(B.sourceCountry=z.sourceCountry);z.hierarchy&&(B.hierarchy=z.hierarchy);z.attributes&&(F=p.mixin(F||{},z.attributes))});B.layer=D;B.ids=v?[E.join(",")]:E;B.attributes=F;B.generalizationlevel=y;return B},createFeaturesForBuffer:function(u,t){t=t||{};var v={bufferUnits:u.units,bufferRadii:u.radii||
[u.radius],areaType:u.areaType||"RingBuffer"};"NetworkServiceArea"===v.areaType&&(v.travelMode=u.travelMode,v.networkOptions=u.networkOptions);u=u.point||u.polyline;v={returnGeometry:!0,outSR:t.outSR||u.spatialReference||new e(n.WEB_MERCATOR_WKID),dataCollections:["GlobalIntersect"],studyAreasOptions:v,studyAreas:[{geometry:u.toJson?u.toJson():u}]};return this._doRunTask(v,t,"enrich").then(this._handleFeatureSetsRequest.bind(this))},createFeaturesForBuffers:function(u,t){function v(D){var E=D.point||
D.polyline;return JSON.stringify(E.toJson?E.toJson():E)+";"+D.units+";"+D.areaType+";"+D.travelMode+";"+JSON.stringify(D.networkOptions)}var y={},B=[];u.forEach(function(D){var E=v(D),F=y[E],z=!1;if(F){var w=D.radii||[D.radius];F.radii.some(function(A){return-1!==w.indexOf(A)})&&(F=null,z=!0)}F||(F=p.clone(D),z||(y[E]=F),delete F.radius,F.radii=[],B.push(F));D.radii?F.radii=F.radii.concat(D.radii):F.radii.push(D.radius)});return h(B.map(function(D){return this.createFeaturesForBuffer(D,t)},this)).then(function(D){var E=
[];D.forEach(function(F){E=E.concat(F)});return E})},_doRunTask:function(u,t,v){u=p.mixin({useData:{sourceCountry:t.countryID,hierarchy:t.hierarchy||k.getHierarchyID()},forStorage:!1},u);return d[v](u)},_handleFeatureSetsRequest:function(u){return(new b(u[0])).features}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil":function(){define(["dojo/_base/lang","esri/layers/CodedValueDomain","esri/dijit/geoenrichment/utils/DateUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],
function(r,p,m,h){var f={composeAttributesFromFieldInfos:function(e,b){return e&&e.filter(function(c){return c.visible}).map(function(c){var d=c.fieldName,a=c.label,g=c.format&&c.format.places,l=c.format&&c.format.digitSeparator,k=c.format&&c.format.dateFormat,n=b[c.fieldName];c=(c=c.format)&&c.dateFormat?"esriFieldTypeDate":c&&void 0!==c.places?0<c.places?"esriFieldTypeDouble":"esriFieldTypeInteger":"esriFieldTypeString";return{name:d,alias:a,places:g,digitSeparator:l,dateFormat:k,value:n,type:c,
domain:null,length:void 0}})},formatAttributeValue:function(e,b){b=b||{};var c=b.hasOwnProperty("unavailableDataValue")?b.unavailableDataValue:"";if(!e||null===e.value||void 0===e.value)return c;if(!b.skipFormattedValue&&e.formattedValue&&e.formattedValue!==c)return e.formattedValue;var d=e.domain&&"codedValue"===e.domain.type?new p(e.domain):null;d?(b=d.getName(e.value))||(b=e.value+""):"esriFieldTypeString"===e.type?b=e.value:"esriFieldTypeDate"===e.type?b=m.formatDateShort(e.value):(b=b.format,
b=h.formatNumber(e.value,{places:b&&void 0!==b.decimals?b.decimals:e.places,noSeparator:b&&void 0!==b.useThousandsSeparator?!b.useThousandsSeparator:!1===e.digitSeparator,preserveTrailingZeroes:!0}));return null===b||void 0===b?c:b},formatAttributeValueForStudyArea:function(e){var b;e&&null!==e.value&&void 0!==e.value||(b=!0);b||(b=e.domain&&"codedValue"===e.domain.type||"esriFieldTypeDate"===e.type);return b?f.formatAttributeValue(e):e.value},getAttributeTypeForStudyArea:function(e){return"esriFieldTypeDate"===
e.type?"esriFieldTypeString":e.type},attributeToJson:function(e){return{name:e.name,alias:e.alias,type:e.type,value:e.value,domain:e.domain&&(e.domain.toJson?e.domain.toJson():r.clone(e.domain)),places:e.places,digitSeparator:e.digitSeparator,dateFormat:e.dateFormat,length:e.length}},attributeFromJson:function(e){return{name:e.name,alias:e.alias,type:e.type,value:e.value,domain:e.domain,places:e.places,digitSeparator:e.digitSeparator,dateFormat:e.dateFormat,length:e.length}}};return f})},"esri/dijit/geoenrichment/utils/DateUtil":function(){define(["dojo/date/locale",
"esri/moment"],function(r,p){var m={formatDate:function(h,f){return(h=m.objectToDate(h))?r.format(h,f):""},formatMoment:function(h,f){return(h=m.objectToTime(h))?p(h).format(f):""},formatDateShort:function(h){return m.formatMoment(h,"L")},formatDateTimeShort:function(h){return m.formatMoment(h,"L LT")},formatLiveTime:function(h){var f=m.formatMoment(h,"l, LT").replace(/\d\d\d\d/,function(e){return e.substr(2)});return f?f+" "+m.formatDate(h,{datePattern:"ZZZZ",selector:"date"}):""},formatTypicalTime:function(h){return m.formatMoment(h,
"ddd LT")},parseDateShort:function(h){return(h=+p(h,"L"))?new Date(h):null},getReportFooterDate:function(h){return r.format(h||new Date,{datePattern:"MMMM d, yyyy",selector:"date"})},getFullYear:function(){return(new Date).getFullYear()},objectToTime:function(h){if(!h)return null;h="string"===typeof h?new Date(h):h;return h.getTime?h.getTime():Number(h)||null},objectToDate:function(h){return h?h.getTime?h:new Date(h):null}};return m})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/Projector":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/ProjectionUtil"],function(r,p,m,h,f){function e(b,c){return f.projectGeometries(b,c)}r=r(null,{_pendingInfos:null,_isBusy:!1,constructor:function(){this._pendingInfos=[]},addForProjection:function(b,c){if(this._isBusy)throw Error("Can't interrupt the current projection process.");b=b&&b.geometry||b;var d=new p;this._pendingInfos.push({geom:b,mapOrSR:c,dfd:d,index:this._pendingInfos.length});
return d.promise},project:function(){function b(n){var q=a[n];return m(e(q.geoms,q.mapOrSR),function(u){u.forEach(function(t,v){v=q.indexMap[v];l[v]=t;d[v].resolve(t)})})}var c=this;if(this._isBusy)throw Error("Can't interrupt the current projection process.");this._isBusy=!0;var d=[],a={};this._pendingInfos.forEach(function(n){d.push(n.dfd);var q=n.geom.type+";"+n.geom.spatialReference.wkid+";"+f.getSpatialReference(n.mapOrSR).wkid;q=a[q]=a[q]||{geoms:[],indexMap:{},mapOrSR:n.mapOrSR};q.geoms.push(n.geom);
q.indexMap[q.geoms.length-1]=n.index});this._pendingInfos.length=0;var g=[],l=[],k;for(k in a)g.push(b(k));return h(g).then(function(){c._isBusy=!1;return l})}});r.needProject=function(b,c){b=b&&b.geometry||b;return b.spatialReference&&b.spatialReference.wkid!==f.getSpatialReference(c).wkid};r.projectGeometries=e;return r})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/RunReportTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./parsers/DataXMLParser ./EnrichAreasTask ../areas/AnalysisAreaJsonUtil esri/dijit/geoenrichment/utils/ArrayUtil esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l){var k={_getCache:function(){return a.get("CreateReportResultCache")},_buildKey:function(q){return[q.countryID,q.hierarchy,JSON.stringify(c.areasToJson(q.analysisAreas,{excludeInfoTemplate:!0})),q.report.reportID,q.report.portalUrl,q.report.modified].join("_")},getCopy:function(q){q=this._buildKey(q);return(q=this._getCache()[q])&&p.clone(q)},copyAndPut:function(q,u){q=this._buildKey(q);this._getCache()[q]=u&&p.clone(u)},getResults:function(){var q=[],u;for(u in this._getCache())q.push(this._getCache()[u]);
return q}},n={execute:function(q){var u=q.cacheResult&&k.getCopy(q);if(u)return f(u);u=d.splitArrayToBunches(q.analysisAreas,10);var t;return m(u.map(function(v){function y(){var B=p.mixin({},q,{analysisAreas:v});B.getAttributes=function(D){if(!q.attachmentsStore)return null;if(!q.attachmentsStore.supportsMultipleAreas&&t)return t;q.attachmentsStore.supportsMultipleAreas&&q.attachmentsStore.setCurrentAnalysisAreaIndex(q.analysisAreas.indexOf(D));return f(q.attachmentsStore.getAttributes(),function(E){t=
t||E;return E})};return(new b).createReport(B).then(function(D){var E=D&&D.taskID;D=D&&D.result;try{l.emulateErrors.createReportError&&(D={error:{message:"Error test: something crashed on the server!"}});if(D&&"object"===typeof D)var F=D.error;if(!F&&"string"===typeof D&&-1!==D.indexOf("{"))try{var z=JSON.parse(D);F=z&&z.error}catch(A){}if(F)if(g.runReportTask.ignoreErrors)D=[];else return(new h).reject(F);var w=e.parse(D);return{taskID:E,areaData:w.areaData,reportInfo:w.reportInfo,originalXML:D,
error:F}}catch(A){return(new h).reject(A)}})}return f(y(),function(B){return!B||B.error?g.runReportTask.secondAttempt?y():B:B},function(B){return g.runReportTask.secondAttempt?y():(new h).reject(B)})})).then(function(v){var y={taskIDs:[],areaData:[],reportInfo:null,originalXMLs:[],errors:[]};v.forEach(function(B){y.taskIDs.push(B.taskID);y.originalXMLs.push(B.originalXML);B.error&&y.errors.push(B.error);y.areaData=y.areaData.concat(B.areaData);y.reportInfo=B.reportInfo});q.cacheResult&&!y.errors.length&&
k.copyAndPut(q,y);return y})}};r=r(null,{execute:function(q){console.log("Creating a new report...");return n.execute(q)}});r.CreateReportResultCache=k;return r})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/DataXMLParser":function(){define("esri/units esri/dijit/geoenrichment/utils/FieldUtil esri/dijit/geoenrichment/utils/JsonXmlConverter ../../data/AreaDataUtil ../../../../core/supportClasses/DocumentOptions ./AttrUtil esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(r,p,m,h,f,e,b,c){function d(n){return n.innerHTML?n.innerHTML:n.tags&&n.tags.length&&n.tags[0].text||""}function a(n){var q={Title:null,Subtitle:null,country:null,hierarchyId:null,exportSettings:null};n.tags&&n.tags.forEach(function(u){"ReportTitle"===u.name&&(q.Title=d(u));"ReportTitle2"===u.name&&(q.Subtitle=d(u));if("CurrencyFormat"===u.name){u=d(u);var t=u.split(";")[0].replace("0","").trim();q.country={id:null,currencySymbol:t,currencyFormat:u}}else if("ReportLayout"===u.name){var v=
q.exportSettings={};u.tags&&u.tags.forEach(function(y){if("Options"===y.name&&y.attributes)v.addHeader=!!y.attributes.header,v.addDataSource=!!y.attributes.dataSource,v.addFooter=!!y.attributes.footer;else if("Page"===y.name&&y.attributes){v.pageSettings={};var B=y.attributes;if(B.width&&B.height&&B.units){y=Number(B.width);var D=Number(B.height);if(B=B.units===r.MILLIMETERS?"mm":B.units===r.CENTIMETERS?"cm":B.units===r.INCHES?"in":B.units===r.POINTS?"pt":null)v.pageSettings.pagesize=f.combineCustomSizeString(y,
D,B)}else B.size&&B.orientation&&(v.pageSettings.pagesize=B.size.toLowerCase(),v.pageSettings.orientation=B.orientation.toLowerCase())}})}});q.exportSettings&&q.Subtitle&&(q.exportSettings.reportSubtitle=q.Subtitle);return q}function g(n){function q(y){y.tags&&y.tags.forEach(function(B,D){D=B.attributes&&B.attributes.STORE_ID||D+"";var E=v[D];E||(E={attributes:null,notes:null,images:null},v[D]=E,t.sites.push(E));B.tags&&B.tags.forEach(function(F){"Attributes"===F.name&&F.tags&&(E.attributes=F.tags.map(function(z){return{name:z.attributes.Name,
alias:z.attributes.Alias,type:z.attributes.Type,value:p.isNumericField(z.attributes.Type)?Number(z.attributes.Value):z.attributes.Value}}));"Notes"===F.name&&F.tags&&(E.notes=F.tags&&F.tags.map(function(z){return{text:z.attributes.Text}}));"Images"===F.name&&F.tags&&(E.images=F.tags&&F.tags.map(function(z){return{url:z.attributes.Source,thumbnail:z.attributes.Thumbnail,description:z.attributes.Description,imageViewType:null}}))})})}function u(y){var B;t.stdLevels=y.tags&&y.tags.map(function(D,E){B=
B||D.attributes.Id.substr(0,D.attributes.Id.indexOf("."));return{id:D.attributes.Id,name:D.attributes.Caption,isWholeCountry:D.attributes.IsWholeCountry||0===E}});"US"===B&&(t.countrId="US");"CAN"===B&&(t.countrId="CA")}var t={sites:[],stdLevels:null,countrId:null},v={};n.tags&&n.tags.forEach(function(y){"StudyAreas"===y.name?q(y):"StandardGeographyLevels"===y.name&&u(y)});return t}function l(n,q){function u(D){if(D=function(F){var z={},w,A;F.tags.forEach(function(I){var N=d(I),M=N,O=B[F.name][I.name];
"string"===(O&&O.type)?N=String(N):(N=Number(N),isNaN(N)&&(N=M),c.emulateErrors.createReportNaN&&(N=NaN),c.emulateErrors.createReportNull&&(N=null));q&&(N=q(I.name,N,F.name));void 0===z[I.name]&&(z[I.name]=N);"AREA_ID"===I.name&&(H=N);"IDFNDFIELD"===I.name&&(w=N);"STORE_ID"===I.name&&(A=N)});var H=H||w;if(!H&&!A)return null;var G;!H&&A&&(G=Number(A));H&&void 0===v[H]&&(v[H]=y++);e.cleanUpAttrs(z,b.isPlayerOnServer?{STORE_ID:1,AREA_ID:1}:null);return{name:F.name,attrs:z,areaIndex:void 0!==G?G:v[H]}}(D)){var E=
t[D.areaIndex]=t[D.areaIndex]||{};E[D.name]?E[D.name].comparisonLevels.push(D.attrs):E[D.name]=h.createCalculator(D.attrs)}}var t=[],v={},y=0,B;n.tags[0].tags.forEach(function(D){"xs:schema"===D.name?B=k.parseSchema(D):u(D)});return{areaData:t,schemaParseResult:B}}var k={parseSchema:function(n){var q={};n.tags.forEach(function(u){"xs:element"===u.name&&u.attributes&&"ReportData"===u.attributes.name&&m.queryJson(u,"xs:element").filter(function(t){return!!t.tags}).forEach(function(t){var v=q[t.attributes.name]=
{};m.queryJson(t,"xs:element").forEach(function(y){v[y.attributes.name]={type:"xs:string"===y.attributes.type?"string":"number",alias:y.attributes["msdata:Caption"]||"",vintage:y.attributes["msdata:Vintage"]||"",source:y.attributes["msdata:Source"]||""}})})});return q}};return{parse:function(n,q){return this._parseDataXmlJson(m.parseXml(n,{saveInnerHTML:!0}),q)},_parseDataXmlJson:function(n,q){if(!n||!n.tags||2>n.tags.length)return[];var u,t,v,y;n.tags.forEach(function(B){"ReportInfo"===B.name?u=
a(B):"ReportArea"===B.name?t=g(B):"ReportData"===B.name&&(B=l(B,q),y=B.areaData,v=B.schemaParseResult)});c.logData&&(console.log("DataXMLPareser.js \x3d\x3e areaData:"),console.log(y));t&&(u.country.id=t.countrId,u.sites=t.sites,u.stdLevels=t.stdLevels);u.variables=v;return{reportInfo:u,areaData:y}}}})},"esri/dijit/geoenrichment/utils/JsonXmlConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(r,p){function m(d,a,g,l){return c(g,l)+"\x3c"+d+(a?b(a):"")+"\x3e"+(l?"\n":"")}function h(d,
a,g){return c(a,g)+"\x3c/"+d+"\x3e"+(g?"\n":"")}function f(d,a,g,l){return c(g,l)+"\x3c"+d+(a?b(a):"")+" /\x3e"+(l?"\n":"")}function e(d,a,g){d=p.encodeXML(d,!1);return c(a,g)+d+(g?"\n":"")}function b(d){var a="",g;for(g in d){var l=d[g];Array.isArray(l)&&(l=l.join(";"));void 0===l||null===l||""===l||"number"===typeof l&&isNaN(l)||(a+=" "+g+'\x3d"'+p.encodeXML(l,!0)+'"')}return a}function c(d,a){if(!a)return"";a="";for(var g=0;g<d;g++)a+="     ";return a}return r(null,{parseJson:function(d,a){function g(n,
q){n.text||"#text"===n.name?k+=e(n.text,q,l):n.name&&(n.tags&&n.tags.length?(k+=m(n.name,n.attributes,q,l),n.tags&&n.tags.forEach(function(u){g(u,q+1)}),k+=h(n.name,q,l)):k+=f(n.name,n.attributes,q,l))}var l=a&&a.prettify,k="";a&&a.addDocumentOptions&&(k+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');g(d,0);return k=decodeURIComponent(encodeURIComponent(k).replace("%19",""))},parseXml:function(d,a){function g(t,v){t.name=v.nodeName;a.saveInnerHTML&&(t.innerHTML=v.innerHTML);if(v.attributes&&
v.attributes.length){t.attributes={};for(var y=0;y<v.attributes.length;y++){var B=v.attributes[y],D=B.value;if(!0===D||"true"===D)D=!0;else if(!1===D||"false"===D)D=!1;else if(l&&D){var E=Number(D);isNaN(E)||(D=E)}t.attributes[B.nodeName]=D}}if(v.childNodes&&v.childNodes.length)for(t.tags=[],y=0;y<v.childNodes.length;y++){if(D=B=v.childNodes[y],"#text"!==D.nodeName||(k?D.nodeValue.trim():D.nodeValue))D={},t.tags.push(D),g(D,B)}else"#text"===v.nodeName&&(delete t.name,t.text=p.decodeXML(v.nodeValue))}
a=a||{};var l=a.parseNumbers,k=a.ignoreWhiteSpacedTextNodes;k=void 0===k?!0:k;var n={};d=(new DOMParser).parseFromString(d,"text/xml").childNodes;for(var q=0;q<d.length;q++)if(1===d[q].nodeType){var u=d[q];break}u&&g(n,u);return n},queryTopJson:function(d,a){return this.queryJson(d,a,!0)},queryJson:function(d,a,g){function l(n,q){n.tags&&n.tags.forEach(function(u){(a.test?a.test(u.name):u.name===a)&&k.push(u);g&&0===q||l(u,q+1)})}var k=[];l(d,0);return k},traverseJson:function(d,a){function g(k){l||
(!0===a(k)?l=!0:k.tags&&k.tags.forEach(g))}var l=!1;g(d)},getInnerHTML:function(d){return d.innerHTML?d.innerHTML.trim():this.parseJson(d).replace(/^<[^<]*>/,"").replace(/<\/[^<]*>$/,"").trim()},_IS_RICH_RE:/<.+>.*<\/.+>|<br\s*\/>|<\/br>/,_UNRICH_RE:/<.*?>/g,isRichText:function(d){return(d=String(d))&&this._IS_RICH_RE.test(d)},unrichHTML:function(d){if(!d)return"";d=p.decodeXML(String(d).trim()).replace(this._UNRICH_RE,"");0===d.indexOf("\x3c")&&-1!==d.indexOf("\x3e")&&(d="");return d}})()})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/PageUnitsConverter","../themes/ThemeLibrary"],function(r,p,m){var h={},f={a:[[841,1189],[594,841],[420,594],[297,420],[210,297],[148,210],[105,148],[74,105],[52,74],[37,52],[26,37]],b:[[1E3,1414],[707,1E3],[500,707],[353,500],[250,353],[176,250],[125,176],[88,125],[62,88],[44,62],[31,44]],c:[[917,1297],[648,917],[458,648],[324,458],[229,324],[162,229],[114,162],[81,114],[57,81],[40,57],[28,40]],letter:[216,279],legal:[216,356],tabloid:[279,432],ledger:[432,279]};h.PAPER_SIZES=
f;var e={};"a3 a4 a5 b4 b5 c4 c5 letter legal tabloid ledger".split(" ").forEach(function(b){var c=2===b.length?f[b[0]][b[1]]:f[b];e[b]={portrait:{w:p.mmToIn(c[0]),h:p.mmToIn(c[1])},landscape:{w:p.mmToIn(c[1]),h:p.mmToIn(c[0])}}});h.SIZE_TYPE_TO_DIM_HASH=e;h.hasStandardSize=function(b){return e[b]};h.getSupportedPageSizes=function(){var b=[],c;for(c in f)1===c.length?f[c].forEach(function(d,a){b.push(c+a)}):b.push(c);return b};h.getPageDim=function(b,c,d){e[b]?b=e[b][c||"portrait"]:(b=b.split("x"),
b={w:p.ptToIn(Number(b[0])),h:p.ptToIn(Number(b[1]))});d&&(b=r.clone(b),p.roundNDigitsObj(b,d.places));return b};h.getPageBox=function(b){if(!b)return null;var c=h.getPageDim(b.pagesize,b.orientation),d=p.inToPx(c.w);c=p.inToPx(c.h);return{w:d,h:c,contentW:d-(b.left||0)-(b.right||0),contentH:c-(b.top||0)-(b.bottom||0)}};h.combineCustomSizeString=function(b,c,d){return p.convert(b,d,"pt",5)+"x"+p.convert(c,d,"pt",5)};h.getDefaultDocumentOptions=function(b){return r.mixin({pagesize:"letter",orientation:"portrait",
left:21.07,right:22.6,top:19.2,bottom:9.6,align:"left",lineSpacing:1.12,fontSize:10,fontFamily:m.DEFAULT_FONT_FAMILY_CLASSIC},b)};h.getDefaultDocumentOptionsGraphicReport=function(b){return r.mixin({pagesize:"letter",orientation:"landscape",left:21.07,right:22.6,top:19.2,bottom:9.6,align:"left",fontSize:10,fontFamily:m.DEFAULT_FONT_FAMILY_GRAPHIC},b)};h.getClosestStandrdSizes=function(b,c){function d(k){var n=k.w/a.w;k=k.h/a.h;return Math.max(1-(1<n?1/n:n),1-(1<k?1/k:k))}c=void 0===c?.4:c;var a=h.getPageDim(b.pagesize,
b.orientation);b=[];for(var g in e){var l=e[g];b.push({pagesize:g,orientation:"portrait",score:d(l.portrait)});b.push({pagesize:g,orientation:"landscape",score:d(l.landscape)})}b=b.filter(function(k){return k.score<=c});b.sort(function(k,n){return k.score-n.score});return b};h.tryGetStandardPageSize=function(b,c){function d(q){var u="portrait"===c?1:0;return q["portrait"===c?0:1]===g&&q[u]===l}if(h.SIZE_TYPE_TO_DIM_HASH[b])return b;var a=b.split("x"),g=p.convert(Number(a[0]),"pt","mm",0),l=p.convert(Number(a[1]),
"pt","mm",0),k;for(k in h.PAPER_SIZES)if(a=h.PAPER_SIZES[k],1===k.length){if(a.some(function(q,u){if(d(q))return n=k+u,!0}))break}else if(d(a)){var n=k;break}return n||b};return h})},"esri/dijit/geoenrichment/utils/PageUnitsConverter":function(){define(["dojo/_base/lang"],function(r){function p(f,e,b){b&&(f=r.mixin({},f));for(var c in f){var d=f[c];null!==d&&""!==d&&"boolean"!=typeof d&&("object"==typeof d?f[c]=p(d,e,b):(d=Number(d),isNaN(d)||(f[c]=e(d))))}return f}var m={},h="px pt mm cm in twip".split(" ");
h.forEach(function(f){h.forEach(function(e){if(f!==e){var b=f+"To"+e.charAt(0).toUpperCase()+e.substr(1);m[b]=function(c,d){return m.convert(c,f,e,void 0!==d?d:5)}}})});m.convert=function(f,e,b,c){f=Number(f)||0;switch(e){case "in":f*=72;break;case "px":f*=.75;break;case "mm":f=f/25.4*72;break;case "cm":f=f/2.54*72;break;case "twip":f/=20}switch(b){case "in":f/=72;break;case "px":f/=.75;break;case "mm":f=f/72*25.4;break;case "cm":f=f/72*2.54;break;case "twip":f=Math.round(20*f)}void 0!==c&&(f=m.roundNDigits(f,
c));return f};m.pxToPtObj=function(f,e){return p(f,m.pxToPt,!e)};m.ptToPxObj=function(f,e){return p(f,m.ptToPx,!e)};m.roundNDigits=function(f,e){return Number(Number(f).toFixed(e))};m.roundNDigitsObj=function(f,e){for(var b in f){var c=f[b];"object"==typeof c?m.roundNDigitsObj(c,e):f[b]=m.roundNDigits(c,e)}};return m})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/AttrUtil":function(){define([],function(){var r={},p="ID OBJECTID AREA_ID STORE_ID HasData aggregationMethod sourceCountry radiusIndex".split(" ");
r.cleanUpAttrs=function(m,h){m&&p.forEach(function(f){h&&h[f]||delete m[f]})};return r})},"esri/dijit/geoenrichment/utils/ArrayUtil":function(){define(["dojo/_base/array"],function(r){var p={},m={}.toString();p.arraysEqual=function(h,f){if(!h&&!f)return!0;if(!h||!f||h.length!==f.length)return!1;for(var e=0;e<h.length;e++)if(h[e]!==f[e])return!1;return!0};p.composeIdentityFunction=function(h,f){var e="function"===typeof h?h:h?function(b){return b[h]}:function(b){return b};return function(b){return(b=
e(b))&&b.toString?b.toString():f&&void 0===b?b:String(b)}};p.removeDuplicates=function(h,f){var e=[],b={};f=p.composeIdentityFunction(f,!0);r.forEach(h,function(c,d){var a=f(c);a===m&&(void 0===c["__ArrayUtil.js_uniqueKey__"]&&(c["__ArrayUtil.js_uniqueKey__"]="__ArrayUtil.js_uniqueKey__"+d),a=c["__ArrayUtil.js_uniqueKey__"]);void 0===a||a in b||(b[a]=c,e.push(c))});return e};p.splitArrayToBunches=function(h,f){f=f||100;for(var e=[],b,c=0,d=h.length;c<d;c++)b&&b.length!==f||(b=[],e.push(b)),b.push(h[c]);
return e};return p})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/AreaCalculatorsUtil":function(){define(["./AreaDataUtil","../../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../tasks/parsers/FeatureSetParser"],function(r,p,m){return{addFeatureAttributesCalculator:function(h,f,e){e=e||p.AREA_ATTRIBUTES_CALCULATOR_NAME;for(var b in h.attributes)r.setAreaDataObjectValue(b,h.attributes[b],f,e)},addAreaInfoCalculator:function(h,f,e){e=e||p.AREA_ATTRIBUTES_CALCULATOR_NAME;
r.setAreaDataObjectValue("SITE_NAME",h.locationName||h.name,f,e);r.setAreaDataObjectValue("STORE_NAME",h.locationName||h.name,f,e);r.setAreaDataObjectValue("AREA_DESC",h.shortName||h.name,f,e);r.setAreaDataObjectValue("AREA_DESC2",h.description||h.name,f,e);r.setAreaDataObjectValue("AREA_DESC3",h.description||h.name,f,e);r.setAreaDataObjectValue("STORE_ADDR",h.address||"",f,e);r.setAreaDataObjectValue("STORE_LAT",h.latitude||"",f,e);r.setAreaDataObjectValue("STORE_LONG",h.longitude||"",f,e)},addEnrichFeatures:function(h,
f,e,b){var c={},d={},a;for(a in f)c[a.toLowerCase()]=f[a],d[a.toUpperCase()]=f[a];h=m.parse(h,e||p.ENRICHED_DATA_NO_LEVELS,function(g){return f[g]||c[g.toLowerCase()]||d[g.toUpperCase()]});r.mergeAreaData(h,b)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/FeatureSetParser":function(){define(["./AttrUtil"],function(r){var p={ID_FIELDS:["ID","AREA_ID","IDFNDFIELD"],KNOWN_ATTRIBUTES:{StdGeographyLevel:1,StdGeographyName:1,StdGeographyID:1},parse:function(m,h,f){if(!m)return[];
m=m.features||m;if(!m.length)return[];var e=[],b={},c=0;m.forEach(function(d){var a=d.attributes[p.ID_FIELDS[0]]||d.attributes[p.ID_FIELDS[1]];if(a){void 0===b[a]&&(b[a]=c++);var g={},l;for(l in d.attributes){var k=p.KNOWN_ATTRIBUTES[l]?l:f?f(l):l;k&&(g[k]=d.attributes[l])}r.cleanUpAttrs(g);d={name:h,attrs:g,areaIndex:b[a]}}else d=null;d&&(a=e[d.areaIndex]=e[d.areaIndex]||{},a[d.name]?a[d.name].comparisonLevels.push(d.attrs):a[d.name]={data:d.attrs,comparisonLevels:[]})});console.log("FeatureSetPareser.js \x3d\x3e areaData:");
console.log(e);return e}};return p})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/VariablesUtil":function(){define(["../dataCollections/DataCollectionsLoader"],function(r){var p={preprocessVariables:function(m,h){var f=p.convertForEnrich(p._splitVariables(m)).filter(function(e){return e.itemid});return r.loadCustomDataVariables(f,{forceLowerCase:!0,portalUrl:h}).then(function(e){return p._splitVariables(m,e)})},_splitVariables:function(m,h){var f=[],e={};m.forEach(function(b){"string"===
typeof b?f.push(b.toLowerCase()):b&&b.outFields&&b.outFields.forEach(function(c,d){d=b.itemid+"."+c;d=d.toLowerCase();f.push(d);e[d]={itemid:b.itemid,url:b.url,token:b.token,variable:h?h.fullNameToVariableCache[d]:{id:c}}})});return{fullNames:f,customDataMapping:e}},convertForEnrich:function(m){var h={},f=[];m.fullNames.forEach(function(e){var b=m.customDataMapping[e];b?(e=h[b.itemid],e||(e={itemid:b.itemid,url:b.url,token:b.token,outFields:[]},e.url||delete e.url,e.token||delete e.token),e.outFields.push(b.variable.id),
h[e.itemid]||(h[e.itemid]=e,f.push(e))):f.push(e)});return f}};return p})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/dataCollections/DataCollectionsLoader":function(){define("esri/dijit/geoenrichment/promise/all ../GEUtil ../ReportTemplateData esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/JsonXmlConverter esri/dijit/geoenrichment/utils/UrlUtil".split(" "),function(r,p,m,h,f,e){return{canLoad:function(){return p.canMakeRequests()},loadVariables:function(b){var c=
h.get("DataCollectionsLoader"),d="*"===b.outFields,a=d?["*"]:b.outFields,g=b.countryID+";"+b.hierarchy+";"+a.join(";")+";"+!!b.forceLowerCase;c[g]||(d||(a=a.slice(),-1===a.indexOf("id")&&a.push("id")),c[g]=p.getDataCollections(b.countryID,b.hierarchy,{f:"json",outFields:d?"*":JSON.stringify(a),suppressNullValues:!0,AddDerivativeVariables:"all"}).then(function(l){var k={dataCollections:l,idToVariableCache:{},fullNameToVariableCache:{}};l.forEach(function(n){n.data.forEach(function(q){function u(y){return b.forceLowerCase?
y.toLowerCase():y}function t(y){if(d)return Object.keys(y).length;var B=0;a.forEach(function(D){void 0!==y[D]&&B++});return B}var v=k.idToVariableCache[u(q.id)];if(!v||t(q)>t(v))k.idToVariableCache[u(q.id)]=q;k.fullNameToVariableCache[u(n.dataCollectionID+"."+q.id)]=q})});return k}));return c[g]},loadCustomDataVariables:function(b,c){c=c||{};var d={idToVariableCache:{},fullNameToVariableCache:{}};return r(b.map(function(a){var g=e.combineMulti([a.url||c.portalUrl,"sharing/rest/content/items",a.itemid,
"resources/metadata.xml"]);return m.loadResource(g,a.token||e.getToken(c.portalUrl)).then(function(l){var k=f.parseXml(l.data);l=[];var n=f.queryJson(k,"Fields")[0];n&&(l=l.concat(f.queryJson(n,"Field")));(k=f.queryJson(k,"CalculatedFields")[0])&&(l=l.concat(f.queryJson(k,"Script")));l.forEach(function(q){function u(t){return c.forceLowerCase?t.toLowerCase():t}q=q.attributes;q={id:q.Name,fullName:a.itemid+"."+q.Name,alias:q.Alias,description:q.Alias,type:"esriFieldType"+q.Type,precision:q.Precision?
Number(q.Precision):void 0,vintage:q.Vintage};d.idToVariableCache[u(q.id)]=q;d.fullNameToVariableCache[u(q.fullName)]=q})})})).then(function(){return d})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportTemplateData":function(){define("dojo/_base/declare dojo/_base/lang dojo/request/xhr esri/dijit/geoenrichment/promise/all esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l){function k(n,q){var u=n.substr(n.lastIndexOf("/")+1),t=b.getProxyRule(n);return m(t&&t.proxyUrl?t.proxyUrl+"?"+n:n,{method:"POST",handleAs:"arraybuffer",data:"token\x3d"+q,headers:{"X-Requested-With":null,"Content-Type":"application/x-www-form-urlencoded; charset\x3dutf-8"}}).then(function(v){var y=!/\.xml$|\.txt$|\.json$/i.test(u);return{name:u,data:y?c.base64FromByteSource(v):decodeURIComponent(escape(c.binaryStringFromByteSource(v)))}})}r=r(null,{id:null,_portalUrl:null,
_baseUrl:null,constructor:function(n,q){this.id=n.id;this._portalUrl=q;this._baseUrl=a.combine(this._portalUrl,"sharing/rest")},getFiles:function(){var n=this;return this._getResources().then(function(q){var u=[];q.map(function(t){t=t.resource;"thumbnail.png"!==t&&u.push(n.getFileByName(t))});return h(u)})},getFileByName:function(n){return k(this.getItemResourceUrl(n,!1),this._getToken())},getItemResourceUrl:function(n,q){n=this._baseUrl+"/"+this._contentItemPath(this.id+"/resources/"+n);return q?
a.addQueryPart(n,"token\x3d"+this._getToken()):n},updateFile:function(n,q){var u=this;return l.request({url:this._baseUrl,urlSuffix:"content/items/"+this.id}).then(function(t){var v=g.fromFileData(n,q);return l.request({url:u._baseUrl,urlSuffix:"content/users/"+t.owner+"/"+t.ownerFolder+"/items/"+u.id+"/updateResources"},{content:{file:v,filename:n}})})},_contentItemPath:function(n){return"content/items/"+n},_getToken:function(){var n=f.id.findCredential(this._portalUrl)||f.id.credentials[0];return n&&
n.token},_getResources:function(){var n=this;return d.query(function(q){return e({url:n._baseUrl+"/"+n._contentItemPath(n.id+"/resources"),content:p.mixin({f:"json",token:n._getToken()},q),handleAs:"json"},{usePost:!0})},null,"resources").then(function(q){return q.resources})},getPortalUrl:function(n){return n?/[^:]+:\/\/(.+)$/i.exec(this._portalUrl)[1]:this._portalUrl}});r.loadResource=k;return r})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/CustomReportsManager":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./PortalManager ./ReportTemplateData ./StandardGraphicReportTemplates esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/PortalQueryUtil esri/dijit/geoenrichment/utils/UrlUtil ../../config ../../countryConfig".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l){var k={TEMPLATE_TYPE:"Report Template",PLAYER_STANDARD_INFOGRAPHIC_TYPEKEYWORD:"esriReportPlayerStandardInfographic",GALLERY_INFOGRAPHIC_TYPEKEYWORD:"esriWebGalleryInfographicReport",MOBILE_INFOGRAPHIC_TYPEKEYWORD:"esriMobileFactsInfographicReport",GALLERY_INFOGRAPHIC_USER:"esri_reports",resetCache:function(){b.set("CustomReportsManager",{})},_getCache:function(){return b.get("CustomReportsManager")},getCustomReports:function(n){var q=this,u=a.getPortalUrl(n.portalUrl);
return m(h.getSignedInPortal(u),function(t){t=t.user.username;t={q:d.combineQueryString({type:"Report Template",typeKeywords:n.typeKeywords,owner:!n.publicOnly&&t}),sortField:"modified",sortOrder:"desc"};return c.queryCommon(a.combine(u,"sharing/rest/search"),t).then(function(v){v=v.map(function(y){return q.prepareCustomReportFromItem(y,u,n)});return q._getCountryReports(v,n.countryID)})})},_getCountryReports:function(n,q){return n&&("*"===q?n:n.filter(function(u){return!u.countries||u.countries.split(",").some(function(t){return q===
t.trim()})}))},prepareCustomReportFromItem:function(n,q,u){function t(y){return"string"===typeof y?"true"===y:!!y}var v=r.mixin({},n.properties||n.details);v.isGraphicReport=t(v.isGraphicReport);v.isMultiFeature=t(v.isMultiFeature);v.reportID=n.id;q={title:n.title,templateData:q&&new f(n,q),modified:n.modified instanceof Date?n.modified.getTime():n.modified};u&&u.attachItemProperty&&(q[u.attachItemProperty]=n);r.mixin(q,v);return q},getCustomReportByID:function(n){var q=this,u=this._getCache()[n.reportID];
if(u)return u;var t=a.getPortalUrl(n.portalUrl);return this._getCache()[n.reportID]=m(h.getSignedInPortal(t),function(v){return v.user.getItem(n.reportID).then(function(y){return y&&q.prepareCustomReportFromItem(y,t,n)})}).otherwise(function(v){delete q._getCache()[n.reportID];return n.ignoreError?null:(new p).reject(v)})},tryFindReportIdByAlias:function(n){var q=this,u=e.aliasToID(n.countryID,n.reportID);if(!u)return null;var t=a.getPortalUrl(n.portalUrl);return m(this.getCustomReportByID({reportID:u,
portalUrl:t,ignoreError:!0,attachItemProperty:n.attachItemProperty}),function(v){return v?v&&(n.returnObject?v:v.reportID):m(q.getCustomReports({portalUrl:t,countryID:n.countryID,typeKeywords:"esriReportPlayerStandardInfographic",publicOnly:!0,attachItemProperty:n.attachItemProperty}),function(y){function B(A){A=A.split(".");return Number((Number(A[0])+Number(A[1])/100).toFixed(2))}var D=B(g.jsapiVersion),E,F,z=-Infinity,w=Infinity;y.forEach(function(A){if(A.playerAlias===n.reportID){var H=B(A.jsapiVersion);
D>=H&&H>z&&(z=H,E=A);D<H&&H<w&&(w=H,F=A)}});y=E||F;n.strictVersionCheck&&y&&y.jsapiVersion!==g.jsapiVersion&&(y=null);return y&&(n.returnObject?y:y.reportID)})})},itemUpdated:function(n){delete this._getCache()[n]},getFakeCustomReportByContext:function(n){return{title:"Generic template",type:"esriReportTemplateStandard",coverage:n.countryID,countries:n.countryID,hierarchy:n.hierarchy||l.getHierarchyID(),isGraphicReport:!0,isMultiFeature:!1,reportID:null}}};k.resetCache();return k})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/PortalManager":function(){define(["dojo/Deferred",
"dojo/on","esri/dijit/geoenrichment/when","esri/arcgis/Portal","../../../utils/CacheUtil"],function(r,p,m,h,f){return{getSignedInPortal:function(e){var b=f.get("PortalManager.portal");if(!b[e]){var c=new h.Portal(e),d=new r;p(c,"load",function(){if(c.user)return b[e]={user:new h.PortalUser({portal:c,credential:{userId:c.user.username,server:c.url,token:"",expires:9999999999999,creationTime:9999999999999,scope:"portal",resources:[c.portalUrl]}}),portal:c},d.resolve(b[e]);b[e]=m(c.signIn(),function(a){d.resolve({user:a,
portal:c});return{user:a,portal:c}})});return d.promise}return b[e]}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/StandardGraphicReportTemplates":function(){define(["dojo/_base/lang","../../config","dojo/i18n!esri/nls/jsapi"],function(r,p,m){function h(){return b?b:b={"3.25":{"US.census":[{id:"e2a6868f979f4e37896b631581ae4918",alias:"demographic-summary"},{id:"88420f4a98bb45cbacacbad67e23266e",alias:"key-facts"},{id:"efb6bee0a80d4801887ec4cf73aa67fc",alias:"marketing-profile"},
{id:"12867e4a89d5461fbbe3b9c6c181993a",alias:"at-risk-population"},{id:"6637be1fbddf4e948fbd09ce6a7a7888",alias:"portrait-property-flyer"},{id:"02c1124e916847249aa91b9ce48c2552",alias:"skyscraper"},{id:"3afd4c5089584b089af5b0037d74a9d1",alias:"transportation-to-work"},{id:"a696eae378974ed5a63510fa70bed011",alias:"health-care"},{id:"c931fc6ebdb440189a8bc6bd34115807",alias:"executive-summary-call-outs"},{id:"96096c8afa4847dea936942b1f89acb5",alias:"tapestry-profile"},{id:"7a20b92b48cc4e63bf7ba956295de948",
alias:"nearby-restaurants"}],"CA.census":[{id:"6c467040a8a64c33972045cf091bca5b",alias:"key-facts"}],"*.census":[{id:"11c4cec3c0d34c4aa51cd8877e2db4ef",alias:"key-facts"}]},"3.26":{"US.census":[{id:"a5161c2ca50d44429daf2bf9dbe73eb5",alias:"demographic-summary"},{id:"693269bfbf6c4851901a3c9c56550294",alias:"key-facts"},{id:"aceee34210e748ba95cb9cae21e196b9",alias:"marketing-profile"},{id:"a7936c5ce77c4d698140db21ab1a7858",alias:"at-risk-population"},{id:"8d42e32b12154bc580af89483c208d56",alias:"portrait-property-flyer"},
{id:"7be44b15e29847a383906aac5699cf00",alias:"skyscraper"},{id:"537230b385fb45d9a8d6e59265e36fbf",alias:"transportation-to-work"},{id:"89c6ff4d96de4acaa024b7a408f186b0",alias:"health-care"},{id:"0fa71e0a74294e7b8265e4cd507c7d17",alias:"executive-summary-call-outs"},{id:"f2754d21223a491798dbc0ef2c71858f",alias:"tapestry-profile"},{id:"866e6a839ee348dfae5a8ee9bdafbfc0",alias:"nearby-restaurants"},{id:"f808dfceddd149ff85a9d8825d4e5a5f",alias:"multi-ring-comparison"}],"CA.census":[{id:"f982018306a34cc58756ce0ed78c6b0c",
alias:"key-facts"},{id:"c47fa8d040364abe80d288bb606da576",alias:"multi-ring-comparison"}],"*.census":[{id:"3813621424fc4443af1dcecab65be89c",alias:"key-facts"},{id:"dd1fa81faaf94541831cae16788393ab",alias:"multi-ring-comparison"}]},"3.27":{"US.census":[{id:"3c6959a7c7c4450f9bdcc7063c9023d5",alias:"demographic-summary"},{id:"4cc0a5e007d946d5909524fcf80bc666",alias:"key-facts"},{id:"fb9b9a501c974540a52ab6d1027a8bcc",alias:"marketing-profile"},{id:"b0f05d5926d6444da40d6bf0c5c9846e",alias:"at-risk-population"},
{id:"5cf609b26ce24633a2edc58d7ebeb3fd",alias:"portrait-property-flyer"},{id:"686d7af60bcb410db051ec8465889231",alias:"skyscraper"},{id:"a79a099ab7be4c34a9b0b28831b1aa9c",alias:"transportation-to-work"},{id:"6f64bb63647246dcb5d268fc301614f6",alias:"health-care"},{id:"99e919a7e9fd4fa2b55779f0dc118da8",alias:"executive-summary-call-outs"},{id:"f32b961757f347e2976ba011ee20cb13",alias:"tapestry-profile"},{id:"a266260cc3ec46c1b66c86f263feb8e4",alias:"nearby-restaurants"},{id:"dab290529fd44063a2d83e03a8dc49eb",
alias:"multi-ring-comparison"},{id:"1499719e83754c81ae1477223c0dde39",alias:"property-details"},{id:"9c441f80f80348c8b5b747e2cf2a2ccd",alias:"employment-overview"},{id:"bb59cd9292ec47a0928900c5fb9c17b8",alias:"office-market-profile"},{id:"6f75892c4a5f4f5ba3d0edb4d8a0b13b",alias:"health-care-and-insurance"},{id:"a7524b019e1f482493e43f32ab9568a0",alias:"demographic-profile"},{id:"45d528a3865547bb89792d4517db2e7a",alias:"commute-profile"},{id:"acf5c12b54b64550ad7f582c9c97ed28",alias:"target-market-summary"},
{id:"489d923d29d44c2681171a590fb37742",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"91d1e8c9d0ea482b9947dfe4bdfbe0ba",alias:"key-facts"},{id:"e05eb227df9b4ceba0ace202b1d0c1e2",alias:"multi-ring-comparison"}],"NL.NLD_4orange":[{id:"77e9461032b24e47b6c6b643cf02381f",alias:"housing-profile"},{id:"b80fd38e5f43448da530521832e0dfba",alias:"insurance-profile"},{id:"d36520d68d8e449c9f300be0e800f698",alias:"media-profile"},{id:"bad567fdf36e48e9a5108b66c96bf0ae",alias:"personicx-segmentation"},{id:"5726fe6cad4c491a863eff64e538231c",
alias:"spending-profile"}],"JP.EsriJapan":[{id:"e4bd37bb10c74798a3600ca7484846ac",alias:"base-demographic-profile"},{id:"a5d7db5138644a9e95d9af1b40b31bb9",alias:"demographic-comparison-profile"},{id:"205b45f626f84650a1ca948be4f97411",alias:"future-population-profile"},{id:"ee12a9d9a2e04fb6b93628f075719bc9",alias:"population-households-profile"},{id:"3f857a2a8d14488abfcec383197e5a0b",alias:"consumer-spending-profile"},{id:"77369125467c4c9a8f3b9a628eda3347",alias:"base-demographic-profile-ja"},{id:"08abfdb8b8174846bd3723f094a88d86",
alias:"demographic-comparison-profile-ja"},{id:"e5db2ced023d4c53a0ef9fe231d7fd15",alias:"future-population-profile-ja"},{id:"4c55f8ddb53345298e59bccfeb45e489",alias:"population-households-profile-ja"},{id:"24c8ef9a8c5d45c78791a84445eed29d",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"7aa819f9816a494ab28ab7604553f488",alias:"base-demographic-profile"},{id:"710051b492c3481a83e01bd6bf3dd3bf",alias:"household-profile"}],"ES.ESP_AIS":[{id:"3d046bf33ce04b598afd391a0dd195c9",alias:"base-demographic-profile"}],
"PR.PRI_ACS_2020":[{id:"d8b9f282034d47db808175fef56a15e2",alias:"at-risk-population"},{id:"eab5646a29324a6282db3b8ca47bf2b3",alias:"commute-profile"},{id:"ed6b5a0736aa4e04862a1a4307c608cc",alias:"demographic-summary"},{id:"a4c64a9006544751ad18ce75a401112e",alias:"health-care-and-insurance"},{id:"96d00aefd766428394d6ee6698a56591",alias:"coronavirus-impact-planning"}],"*.census":[{id:"365d52e6bac147a68a12eee229eb9b6b",alias:"key-facts"},{id:"0f7d2ba850fa40579cae1342001d80d7",alias:"multi-ring-comparison"}]},
"3.28":{"US.census":[{id:"45cb423066194f5f98c6f4ff81124db3",alias:"demographic-summary"},{id:"98d5848a944b4787b2ca038256c7878d",alias:"key-facts"},{id:"879849b937ec4eb0bef31ff2861251f2",alias:"marketing-profile"},{id:"456d7a22adc8439a93d4164ed3846243",alias:"at-risk-population"},{id:"c7e01c953c7e4b70a46ca6408c3ed000",alias:"portrait-property-flyer"},{id:"34330a47546f412d9d09632347da11d3",alias:"skyscraper"},{id:"d349b23334454274ab2a7a20a0a9a55d",alias:"transportation-to-work"},{id:"02086fe6b92b4ff5a9a7a8d172540fc9",
alias:"health-care"},{id:"5d8b51e2b27b4832b193d9932bc6f862",alias:"executive-summary-call-outs"},{id:"1b07c48d4b58423990023b43150d7e99",alias:"tapestry-profile"},{id:"c21dd81cd9064649a4bb454530f12790",alias:"nearby-restaurants"},{id:"4d8c102ca7324d09931cfe65ab3a1168",alias:"multi-area-comparison"},{id:"9ed3b5dba02d4b46a3e063c8405fd0cc",alias:"property-details"},{id:"db0606e41ee7485f88122069e74a9b6b",alias:"employment-overview"},{id:"2a43c204c1dd4a758087372d7d7d786b",alias:"office-market-profile"},
{id:"f59a3621583d44bbafa14035c2ae3947",alias:"health-care-and-insurance"},{id:"ad58f06a480c4b16aadcff789f543cca",alias:"demographic-profile"},{id:"bd7390ab31dc485489733d22475db0ed",alias:"commute-profile"},{id:"38eab30d7e6840da869fee264ca9fc40",alias:"target-market-summary"},{id:"03b420681f6a466fb14e254669583244",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"6c0a945e91d44640a08776e5bed1b297",alias:"key-facts"},{id:"7464708f379b463c8eec8aed1315989f",alias:"multi-area-comparison"},{id:"425150e63a5346659721bfc0be94511b",
alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"e602295128e34ea2b2b50a1aa04253bf",alias:"housing-profile"},{id:"3d0f7e63256b43a59fcf037502380685",alias:"insurance-profile"},{id:"fbc685a8837945eb82cde447acfda982",alias:"media-profile"},{id:"da063bf765e341708fad9eeec07b09c7",alias:"personicx-segmentation"},{id:"5003049227804e5cba6ad3bfdbf2dba7",alias:"spending-profile"}],"JP.EsriJapan":[{id:"bd9685651f484488ba24c2838a6a9000",alias:"base-demographic-profile"},{id:"f36b1cc0b9d84ea4b4db1742e875ff80",alias:"demographic-comparison-profile"},
{id:"99a48ec44af94af290ab0e6d691a31c7",alias:"future-population-profile"},{id:"b29af5c2e6754f61ba38ad3128668095",alias:"population-households-profile"},{id:"d568dd78527c462e83eb68cb9ca02f09",alias:"consumer-spending-profile"},{id:"a29c9143bd044dad9475e6b6ee292e46",alias:"base-demographic-profile-ja"},{id:"3bb56ea4c4bd4a2aaa124e2e3a0fad60",alias:"demographic-comparison-profile-ja"},{id:"28ef1772bd884db5ae8885731318e503",alias:"future-population-profile-ja"},{id:"7896c8adf89e4f47ab6e0acc7759a1cd",alias:"population-households-profile-ja"},
{id:"6c28a650baaa40cda26f4fb372b14d0f",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"31cf6eac0339433f8b4b5f8b62e47554",alias:"base-demographic-profile"},{id:"ccf6bc8472ae4ca8852fec621197fec3",alias:"household-profile"}],"ES.ESP_AIS":[{id:"5b60de05c1694a78b6b6ce8e10a48cd4",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"f1d79448541642648293f4b75d7b595a",alias:"at-risk-population"},{id:"7943a0c2f1ca4cad967bb0bfeb8af3a4",alias:"commute-profile"},{id:"ef0579311aac4d14a771389f23263445",
alias:"demographic-summary"},{id:"4edd44657989475493ca92a69e80f08c",alias:"health-care-and-insurance"},{id:"c440f0c671264732b16c39f6326a5987",alias:"coronavirus-impact-planning"}],"*.census":[{id:"5886dbf41f984a0a8ec4eb4b5e231584",alias:"key-facts"},{id:"41727f86773c4cf2a37fd99446ea83fc",alias:"multi-area-comparison"}]},"3.29":{"US.census":[{id:"368e2bf603fb42c4aa3dac0fce50cdf8",alias:"demographic-summary"},{id:"a32be4a9e51d4affa4cc1ddc812cb629",alias:"key-facts"},{id:"df985e2579004a3292c3d00615d53c39",
alias:"marketing-profile"},{id:"8c56287427f84ae8b59142fc5bf1df4c",alias:"at-risk-population"},{id:"d95e40c3c93d480ab4d1d0b0adbbc5d4",alias:"portrait-property-flyer"},{id:"f989f9b820cd44d390187402447051b4",alias:"skyscraper"},{id:"0d322ac073584079a8cd6a1bda981fe7",alias:"transportation-to-work"},{id:"2b9f186425844ec390584b739ffca026",alias:"health-care"},{id:"3e9ccce6cca64e70be19ed789de5f290",alias:"executive-summary-call-outs"},{id:"2a812da4de404ceba3969472d32c42e7",alias:"tapestry-profile"},{id:"2cc25f7b5f194012b39c90b5f9bdb8d3",
alias:"nearby-restaurants"},{id:"72d1e9e4cdf94bf9a2020f8214bef9ca",alias:"multi-area-comparison"},{id:"27034d31ab124b9bbe4e63b7df2a0d90",alias:"property-details"},{id:"4a59e329df06480eaa534513eb15f465",alias:"employment-overview"},{id:"d4fe343c4d6f4bea840a715f5b033d2d",alias:"office-market-profile"},{id:"cb2224cc9cb24ce288da729f0650ebf0",alias:"health-care-and-insurance"},{id:"484825ed241c49d58eaf718d46772051",alias:"demographic-profile"},{id:"afee0a2eb16e46cc9bc61b5d82133249",alias:"commute-profile"},
{id:"1d32fabd95b446e99049aa0a04f5508e",alias:"target-market-summary"},{id:"783847f3f03f402d855985b45a8bf2df",alias:"population-trends"},{id:"83aef26e61ca41da9b269c06cc418d79",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"73f1c835b1624ff0b29a6a364f7ba6dc",alias:"key-facts"},{id:"84b05aed2d2f478eb6bb1e4749811cf1",alias:"multi-area-comparison"},{id:"ea0737e1e7554c5caf2be381c28369cc",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"3d8cb941742d4fffbaca48c65b4bd5b5",alias:"housing-profile"},{id:"f126395e7bcc494899cfc1a13a34be1f",
alias:"insurance-profile"},{id:"8da901e5729e457683f2e4f7081b1bda",alias:"media-profile"},{id:"f9ba90b373a245e1b8fd14a027cf1ba5",alias:"personicx-segmentation"},{id:"81fc53b93a0c4269848ce2ae22ec19e2",alias:"spending-profile"}],"JP.EsriJapan":[{id:"79b2394ea50d44f3b4c1b4bdabed6cc2",alias:"base-demographic-profile"},{id:"9e824283a8954639ab0c0ac237b9e14d",alias:"demographic-comparison-profile"},{id:"f5812c2f542644368c0ff34eef7b731c",alias:"future-population-profile"},{id:"b51d7dde64c34a9796418c1788a6762d",
alias:"population-households-profile"},{id:"48a993403d30431784b7bf47a06e4261",alias:"consumer-spending-profile"},{id:"531c59f55de646d5a78fef6c903a678f",alias:"base-demographic-profile-ja"},{id:"cf553f2090a64662a1f9efa8a355964c",alias:"demographic-comparison-profile-ja"},{id:"321150c8ac1049fc9cd253cb12c0b0bc",alias:"future-population-profile-ja"},{id:"e0d6dea7667c47b49f159c207fc311e9",alias:"population-households-profile-ja"},{id:"ba5f50bd617e4519a9322ec24b9cd5b1",alias:"consumer-spending-profile-ja"}],
"DE.DEU_Nexiga":[{id:"60ec4173caac4f87a831447d5bf7b450",alias:"base-demographic-profile"},{id:"98d3d99aadba47a8ab53b0dcd4eebf22",alias:"household-profile"}],"ES.ESP_AIS":[{id:"3978b02fbc354acca14d4e959fa5b531",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"e2141ddd911c4aadb403db1e858edb51",alias:"at-risk-population"},{id:"78360505668743e0a39ac0d085612dfa",alias:"commute-profile"},{id:"f296deceb6204f85853ac85e98ba3552",alias:"demographic-summary"},{id:"8a1c4d55a77c4cf9805cec380727fc5a",
alias:"health-care-and-insurance"},{id:"8dd9de996ba0491d82a2ee8f01cd55b0",alias:"coronavirus-impact-planning"}],"*.census":[{id:"5645a1d6023c4d8a9d02943ad57a7ab2",alias:"key-facts"},{id:"e29f56b6d67447e08a45d08981db987c",alias:"multi-area-comparison"}]},"3.30":{"US.census":[{id:"981382ffe90c40bbb60318b1ce338ba4",alias:"demographic-summary"},{id:"f62dec6c9750496796fdc0619c4c107f",alias:"key-facts"},{id:"f737236a8b644f1597a4457862fa169c",alias:"marketing-profile"},{id:"4746caa1254e4d93af121ce74e9aa8d6",
alias:"at-risk-population"},{id:"0bcd882dd7a34fd39ace173243534df0",alias:"portrait-property-flyer"},{id:"4a340b8e642945f6bb7a381d07fb26b6",alias:"skyscraper"},{id:"3e2a42b2d03e42cf91e9727f67273ec3",alias:"transportation-to-work"},{id:"c26e9577d48b4499a07b75215c97c394",alias:"health-care"},{id:"cbc348e601104d0c9bbe971c0297142a",alias:"executive-summary-call-outs"},{id:"d65aaa42b9824864b40eb1a75f2e4cbd",alias:"tapestry-profile"},{id:"d6242e8dd02142bdb98b85f094d5cd9b",alias:"nearby-restaurants"},{id:"aed9e00873fa4010881daaa90e7e8d71",
alias:"multi-area-comparison"},{id:"eb0e0df0856e43cdb874f96945c566ac",alias:"property-details"},{id:"e29ebec17c2c4f42a1a929c40163bb90",alias:"employment-overview"},{id:"b84d0f0f5c69461ea52ce2702f7327d6",alias:"office-market-profile"},{id:"5eba537af36e4490869917ee888bacc4",alias:"health-care-and-insurance"},{id:"afb01a3f91374f65ba4c6be9229f2c15",alias:"demographic-profile"},{id:"8074d1bbbfed4858bb24400a0c7bf224",alias:"commute-profile"},{id:"33621d85b1df4547851c904aaa7d44d2",alias:"target-market-summary"},
{id:"440170eaae5240e79abbb0bb7de22b27",alias:"population-trends"},{id:"0576deee38714cc69357de9675ab39ae",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"e054928366604fc7b401dcb4a343cd4c",alias:"key-facts"},{id:"986bc92490234c2697d5771b9771166e",alias:"multi-area-comparison"},{id:"52233708250449bc84f906d86616cace",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"22a86d0f982d4b10934f32129f2674f9",alias:"housing-profile"},{id:"9811b2babd5f4283822782867476b92c",alias:"insurance-profile"},{id:"59957cc0524344449fc6035053bb6c4a",
alias:"media-profile"},{id:"2511035fed0140b8a7eb7ec7240e41eb",alias:"personicx-segmentation"},{id:"defc390648e543508be22704f1db659c",alias:"spending-profile"}],"JP.EsriJapan":[{id:"91a180442f614c4d96fb40e33aa30948",alias:"base-demographic-profile"},{id:"e7415b6c9ff74922850851eac65ddbc6",alias:"demographic-comparison-profile"},{id:"12e9eb63e4834d3681e15196bfc64642",alias:"future-population-profile"},{id:"291cc1bc2cee455483c96f50e5916f1d",alias:"population-households-profile"},{id:"217c72b7d0534ebc81658c71917c3e15",
alias:"consumer-spending-profile"},{id:"48d5baf8e5574abda8fd776219fa0eb6",alias:"base-demographic-profile-ja"},{id:"01a7a0cbacf948b3b715e4f6c55aa5f2",alias:"demographic-comparison-profile-ja"},{id:"0317412d6fb541c9b4067923e314cad3",alias:"future-population-profile-ja"},{id:"0c826ce1e2de415aa2f7af3e615b1fe8",alias:"population-households-profile-ja"},{id:"201211e23758432db4a841dae8ba9428",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"ec6477ce41fa464fb38a360cad0d3da3",alias:"base-demographic-profile"},
{id:"e53b2c145f544efaa7d7b4e802c3d747",alias:"household-profile"}],"ES.ESP_AIS":[{id:"4483924cb42043ec85486c58e61a99ef",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"7e3b955c4d904624b4cea5d015e693a0",alias:"at-risk-population"},{id:"8927492627124fd0845de8c0dc02bd3f",alias:"commute-profile"},{id:"a308a300f3b4482ea57b4ea4a54ea5ef",alias:"demographic-summary"},{id:"5800acd3784e4a6d88e3228e1af1164f",alias:"health-care-and-insurance"},{id:"d40e2ba95fec40c6ad68ceddde4e160b",alias:"coronavirus-impact-planning"}],
"*.census":[{id:"b9d1ca815d9a4a3ab35196ec299f0917",alias:"key-facts"},{id:"6f6d601c2eef4bd1a87baa2652e7bb0b",alias:"multi-area-comparison"}]},"3.31":{"US.census":[{id:"784d0b69c02c4cac862b89b0e44cd8fb",alias:"demographic-summary"},{id:"f1bb3a222fab470dbb96a79a51496b2b",alias:"key-facts"},{id:"1780d5b264734757b86e4655d779b213",alias:"at-risk-population"},{id:"8c34121585894e91a50c493c360912f0",alias:"skyscraper"},{id:"1c314d9d06844d44b408caba6099b56b",alias:"executive-summary-call-outs"},{id:"4ee838a250084c9bad84f094895c793c",
alias:"tapestry-profile"},{id:"dfba27ac04694513aee257cdd185c8c2",alias:"nearby-restaurants"},{id:"d7cfb836282747199cf0febea42627cc",alias:"multi-area-comparison"},{id:"3a34213116a340a0bbd0d463025444a2",alias:"property-details"},{id:"b277b8572469425fa54c5506c3dbcdf3",alias:"employment-overview"},{id:"eaf35c41f5714f48a1aa61fcbd6ae05f",alias:"office-market-profile"},{id:"688f86931cc345f796154717dc6d0a15",alias:"health-care-and-insurance"},{id:"cb4edb43a1ae473ca651388b5c3fa54f",alias:"demographic-profile"},
{id:"49224c10d4ac4c7ab0f8e016165ce235",alias:"commute-profile"},{id:"db67445e4dfa4b6c8c1e5fd30b229c92",alias:"target-market-summary"},{id:"6c9360bfec9041ddba0f03440cb446ca",alias:"population-trends"},{id:"2ae07567c78847abacb14773ffe9dede",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"0704defc6960439ea5b9c484af15eb4c",alias:"key-facts"},{id:"ee01fe05db964878bc6fb627e55dc9b1",alias:"multi-area-comparison"},{id:"a426bb6d944a46658640aee2ba480866",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"710037ca0f024ec5abbe4cf9fecad23f",
alias:"housing-profile"},{id:"83bc643ea48344c892a8e9636e3677dd",alias:"insurance-profile"},{id:"53f63e3a9e854a8fa5e2c0222df6f848",alias:"media-profile"},{id:"ca9d66bf4bf940918129d0d5c97e0b50",alias:"personicx-segmentation"},{id:"ab19f90750fd469aa702f961b12eaee8",alias:"spending-profile"}],"JP.EsriJapan":[{id:"7f7c37e8f1fa4ab18b88368c12058eff",alias:"base-demographic-profile"},{id:"25a71f196b7e4db182be346264b442dd",alias:"demographic-comparison-profile"},{id:"e1075eaada7744a59ecabfc445dcd877",alias:"future-population-profile"},
{id:"8e2746d993584a7d94d0e66ca6dabdaa",alias:"population-households-profile"},{id:"bc9b91d7ae2c41a5bdece1d322ef6b88",alias:"consumer-spending-profile"},{id:"4f4736d5b2f842faaee83c57417c56b6",alias:"base-demographic-profile-ja"},{id:"bc400448bf3347619349cb7d4ccb3d87",alias:"demographic-comparison-profile-ja"},{id:"00ad3ad05e384d7ea764b356a950356d",alias:"future-population-profile-ja"},{id:"db94d6af598f48778c4471f9fa0d6e4f",alias:"population-households-profile-ja"},{id:"c5f602a9d6714dd6bd6a2b720eced874",
alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"b0cd9df36d0747ecac2bc34f055f5583",alias:"base-demographic-profile"},{id:"1751ab1998db4e6fb79f484069605cfd",alias:"household-profile"}],"ES.ESP_AIS":[{id:"3d17356c9a5549dbaa4096365e7eb703",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"7923818907d248ff8dcd7a5941e89b57",alias:"at-risk-population"},{id:"c0b28d710379405eac4ecb6a64d817b4",alias:"commute-profile"},{id:"4b64ec164a3d4830ae8a4cedf067f55a",alias:"demographic-summary"},
{id:"5e47986d4c4644a29a28c92c077919f2",alias:"health-care-and-insurance"},{id:"11c43309216b4d4a8fbd9a03cbcc22ec",alias:"coronavirus-impact-planning"}],"*.census":[{id:"f2d46b136acc46e2a2220388ddc43be0",alias:"key-facts"},{id:"228155af0095410c961cc82f33cdcf49",alias:"multi-area-comparison"}]},"3.32":{"US.census":[{id:"2ff58abf55554be4b19006c1e607afaa",alias:"demographic-summary"},{id:"a19b321e3adc441886e706bb9704005c",alias:"key-facts"},{id:"f1e3b0c93e1d44e299eb0b752f93b7db",alias:"at-risk-population"},
{id:"3bbc96da4ca142c7b80b082b0f986110",alias:"skyscraper"},{id:"1302184a2f584b86943b6c51d40acace",alias:"executive-summary-call-outs"},{id:"58035dcee74b4875bcd951b9174155d1",alias:"tapestry-profile"},{id:"4da5867dfda046ddb4b82ab01b7cb568",alias:"nearby-restaurants"},{id:"4498b9e35665480cafe3985f788ca61d",alias:"multi-area-comparison"},{id:"83a11d5f38f84e709ff1e24786e963b4",alias:"property-details"},{id:"0a0354d2d0d842d8bd8e05d40545fc5b",alias:"employment-overview"},{id:"400924aa9d5f4bee8b9dd0c0af21dfbb",
alias:"office-market-profile"},{id:"0a502ea9be8a43fdb6cd2fb5ff7503bc",alias:"health-care-and-insurance"},{id:"6147ac21718149a69ce15831f12181ed",alias:"demographic-profile"},{id:"4cdaddd947064ca690ebc06eec06ea57",alias:"commute-profile"},{id:"a8fe08a9c5114260a2a6f7ca436d36f6",alias:"target-market-summary"},{id:"34a17e1fceb646228e94089ec5e0890f",alias:"population-trends"},{id:"eb5d984d78364a6596cd97e0bf7901a5",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"5f6e17f3729145959fb38ed2cd508970",
alias:"key-facts"},{id:"c86709cbd72043708e09e4a641adfbd0",alias:"multi-area-comparison"},{id:"bd9e3a17678843d4b1fa0716af91c231",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"470686f333d140c7b516294465eea037",alias:"housing-profile"},{id:"ab11f2f11ea3439197769a8189451bea",alias:"insurance-profile"},{id:"f0e6736d0f364d4b88ea613746e57c81",alias:"media-profile"},{id:"bfe0814bc0604a8faa48d01b026ef7a5",alias:"personicx-segmentation"},{id:"bd1d4c7be5ad41ae909267b5e9c5f2dc",alias:"spending-profile"}],"JP.EsriJapan":[{id:"b9dcbb9f31fd4be7bd96a2f89ce66a1c",
alias:"base-demographic-profile"},{id:"830ddad066c14c0dad27367a1b2ef132",alias:"demographic-comparison-profile"},{id:"7574f89d591f432da6ffdb94dcfdac52",alias:"future-population-profile"},{id:"ec8785d4c9cb446394e07fa7dd8451fd",alias:"population-households-profile"},{id:"9ac85d73187548b2bb0d0b4a73f88199",alias:"consumer-spending-profile"},{id:"e99eee823684452fbe564fe42dac9535",alias:"base-demographic-profile-ja"},{id:"8598d6a8550d46aebd3fd598ceaefae7",alias:"demographic-comparison-profile-ja"},{id:"fdf81ddffb374e3f898006ffa59e259e",
alias:"future-population-profile-ja"},{id:"f2468c2fef314427bd0865b460ef554f",alias:"population-households-profile-ja"},{id:"a96f28fb67024109b7c33161f3c9b308",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"40a5ba79d1204e78ac6deaa633ccd59b",alias:"base-demographic-profile"},{id:"2e647098c613476bbd92b1e07331cb86",alias:"household-profile"}],"ES.ESP_AIS":[{id:"7d82cae4b3fc4575bab56ec82f51c368",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"aa65005b75ba4e158afe63baa4bc5fe2",alias:"at-risk-population"},
{id:"292a269a813e4d7797baf88a76c11a8c",alias:"commute-profile"},{id:"b1d50628f2484689b9e39d49fc2e16a0",alias:"demographic-summary"},{id:"64839b7a81be45e287e805afc145652e",alias:"health-care-and-insurance"},{id:"44be3c42b70c4aee840fdeb4656b7922",alias:"coronavirus-impact-planning"}],"*.census":[{id:"ce57630d5cc24759809dd54bc1f82c91",alias:"key-facts"},{id:"c48ee0f58c8645bf8d689eb0db2d2936",alias:"multi-area-comparison"}]},"3.33":{"US.census":[{id:"55689c3ee7c1490e83accae002a8d164",alias:"demographic-summary"},
{id:"173e40bebc9d426a8e4680242acafea4",alias:"key-facts"},{id:"218eba57314e476ba16d1d5d40bb0182",alias:"at-risk-population"},{id:"3d470c82d8664e34b5026675596a7a87",alias:"skyscraper"},{id:"b9381f481f9f417f9647e0a2c8686979",alias:"executive-summary-call-outs"},{id:"d2800b578d1c4dd38ac95ce36882d881",alias:"tapestry-profile"},{id:"d9d8109c537943a78a24d65110291b43",alias:"nearby-restaurants"},{id:"2e835e58629a4f1e8192a729792b638f",alias:"multi-area-comparison"},{id:"6f3c32ed18834a4ea34b200e32ad7c33",
alias:"property-details"},{id:"6b1267be3fcb401bbcb49afd221713cf",alias:"employment-overview"},{id:"67e6efc15cb142c2a7cc30a48a59c769",alias:"office-market-profile"},{id:"9d8b447adc634228b24deb315107c0f0",alias:"health-care-and-insurance"},{id:"e45f96db738140869981b7443b6e2658",alias:"demographic-profile"},{id:"88d896eada3340dc8f8f1a2406bd48f9",alias:"commute-profile"},{id:"61492956f89a43ee86d245fca92858a2",alias:"target-market-summary"},{id:"91de69dede414856892dfdd94d2c4bab",alias:"population-trends"},
{id:"ee9c6fdc902e4ea09509e4d1bf1582b5",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"dfb663da790248fe89504c662c42aae3",alias:"key-facts"},{id:"9873fcafe7194fcf9dffa8bbb8e001a1",alias:"multi-area-comparison"},{id:"4766ad797ef84968be4b4d0d54b98416",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"2212ff30c72143e6bcd9b8f26b01c47f",alias:"housing-profile"},{id:"c5efcef364ac4d8f82a6d54010ff75c7",alias:"insurance-profile"},{id:"e00894c000a94c42aefce551fe4e48c2",alias:"media-profile"},{id:"9d1da1c80e93407cb94589cee43a0f5a",
alias:"personicx-segmentation"},{id:"578199262aa646bf8b0713f3f2160af6",alias:"spending-profile"}],"JP.EsriJapan":[{id:"00bd747c0e48477d8df692848560a8a2",alias:"base-demographic-profile"},{id:"8ac4bd99dd1848dc98967419ab8d299c",alias:"demographic-comparison-profile"},{id:"88f94b5e3b6d414d913957b46e9f8394",alias:"future-population-profile"},{id:"41864cea64f3432a90006eb9a1f97608",alias:"population-households-profile"},{id:"44333ddcda38473d9a24010ed387eda7",alias:"consumer-spending-profile"},{id:"c35ebbeffb3b47fc9bbe3fc6283aaa7b",
alias:"base-demographic-profile-ja"},{id:"6c8a565d12954927b83daaad81409a25",alias:"demographic-comparison-profile-ja"},{id:"fcba5d5750514c9c93b2cb5222609d98",alias:"future-population-profile-ja"},{id:"7ad858351b6b4268b791b6cc24bf4e0f",alias:"population-households-profile-ja"},{id:"7d94fec6df6b4bff9ad14f5b711f18c6",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"571f323738c44d5a8b85d6d1e78d9c52",alias:"base-demographic-profile"},{id:"ef7624e051b6407488d8ad59b7979fc4",alias:"household-profile"}],
"ES.ESP_AIS":[{id:"46e9329c7b2042fa84dfc1444f7decc0",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"0cb7ba4d407640ff967829ae7dd39396",alias:"at-risk-population"},{id:"7598826f28124abf9134801a607d56ce",alias:"commute-profile"},{id:"848c5cc8a4284065a0055b047a106adf",alias:"demographic-summary"},{id:"ecfc8db522004ea6848667e43589efd9",alias:"health-care-and-insurance"},{id:"4685d4c6c51e4ef392bdab89c0af8979",alias:"coronavirus-impact-planning"}],"*.census":[{id:"e4d3d1675d0044089f98a0f85ea16c8b",
alias:"key-facts"},{id:"33b6e27f43644811b8a58f15c0832a67",alias:"multi-area-comparison"}]},"3.34":{"US.census":[{id:"13cd4abfa97e43b9a5f9d4ddcb43f492",alias:"demographic-summary"},{id:"8861429ac06948f79cdcaaadb39d597f",alias:"key-facts"},{id:"1056cbef133f49a18409a192fbdc221a",alias:"at-risk-population"},{id:"25145b3ca4284dcc999c8d05182588cd",alias:"skyscraper"},{id:"7db2109b9f844be48f3e9154e992699f",alias:"executive-summary-call-outs"},{id:"f43c00c7b10241c097fb71fd5acf1ec2",alias:"tapestry-profile"},
{id:"5fb04926a70345c18d6e21d9972ea347",alias:"nearby-restaurants"},{id:"fdd0406e7815402cbf70716c68f4f7d6",alias:"multi-area-comparison"},{id:"7b716975146743b3a56762befaca71ad",alias:"property-details"},{id:"2c0be4fe4d7245e39b4afd9b8eb607a9",alias:"employment-overview"},{id:"c7f42910bc4b49209835e333c6078e71",alias:"office-market-profile"},{id:"7517a7a0409d42748c7ad94f81322bc2",alias:"health-care-and-insurance"},{id:"9919270d8b4846cb86761103def73e76",alias:"demographic-profile"},{id:"0bb0cc183ae145febbf3585518eeaae6",
alias:"commute-profile"},{id:"27853eda823e4574b0666d533ba39061",alias:"target-market-summary"},{id:"1df7c5b56b6e431982ef2da037c081c8",alias:"population-trends"},{id:"aaf4cc69e58f43ea87a0c1e493431dd8",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"3a2fb82b034d48bbb9474f8c158c32a8",alias:"key-facts"},{id:"100f5b4d3cca46b38fd651e39cce97b1",alias:"multi-area-comparison"},{id:"41f7b7cfe9cb490593ace88aa627c6ca",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"f5b0ec07181f4b58a01ee0ca1df8201a",alias:"housing-profile"},
{id:"a5e0b9b228da4ba5baaa5811c57f6552",alias:"insurance-profile"},{id:"5d24250e3cc14b0db3b3f9884462efbf",alias:"media-profile"},{id:"f216c6574ae0453c951e66ee8fb6b20f",alias:"personicx-segmentation"},{id:"267c816948334e72ab9ed94253790e22",alias:"spending-profile"}],"JP.EsriJapan":[{id:"434e01eacc8e432c8400f5a5aef6f3e4",alias:"base-demographic-profile"},{id:"c44be13f1f8e412288e58048136681d6",alias:"demographic-comparison-profile"},{id:"35c0c12ce88645e7b7cbc0ffe73af85d",alias:"future-population-profile"},
{id:"e87fb84cffaa49dba14b104d5b994aa5",alias:"population-households-profile"},{id:"31a4988db08c41d6b9ce755b21ea0b26",alias:"consumer-spending-profile"},{id:"bf9f0203a4c14d03823beadb3f7ac043",alias:"base-demographic-profile-ja"},{id:"fdbe0d4286ab419981bc80a96b46bdb1",alias:"demographic-comparison-profile-ja"},{id:"7541a90960e345308f73e99e4da5c0a8",alias:"future-population-profile-ja"},{id:"f17ecec5cb8d4baeab7af68e1e9ce683",alias:"population-households-profile-ja"},{id:"ddaf4fb6c09447f6beaf4218139bfa20",
alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"80c74804e91440f08695ba11456f96af",alias:"base-demographic-profile"},{id:"eb49e7ee98f04e1e914a4ce29bbfc7d3",alias:"household-profile"}],"ES.ESP_AIS":[{id:"2e82d587530548569ad792556044342b",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"b473aa30469e4e2eabcca3da3f306e94",alias:"at-risk-population"},{id:"4e91594fb4fe4bf3be24380408f1b0c6",alias:"commute-profile"},{id:"321c818398684510ac62e3403ad6628f",alias:"demographic-summary"},
{id:"1c3d60191b12460ca9a23dfcbce0c1db",alias:"health-care-and-insurance"},{id:"5e6d78b1c4aa4168b7a3af5751d92261",alias:"coronavirus-impact-planning"}],"*.census":[{id:"530b6aa054664166a7a3ab5f1e82e19b",alias:"key-facts"},{id:"4b8ddef8e8f0406ea9b0a6c3d062186a",alias:"multi-area-comparison"}]},"3.35":{"US.census":[{id:"167425f5e12d421eb5784cd3681eab45",alias:"demographic-summary"},{id:"a1ab8710e1104385941825fe772d58fa",alias:"key-facts"},{id:"b3103dee1c994fa0916bd2b5c8ad2cab",alias:"at-risk-population"},
{id:"0d261009a37247b4913266bc7093fedb",alias:"skyscraper"},{id:"2e7b01260b7840c196f30be52bf0b57e",alias:"executive-summary-call-outs"},{id:"f47aebc28aa64c7f924053a8c1ee16bd",alias:"tapestry-profile"},{id:"36e6e303ebd943d4aa55604ba7dc0bc0",alias:"nearby-restaurants"},{id:"2f6307fad95f43b193ac74f236fa82d3",alias:"multi-area-comparison"},{id:"1ac99acae7cf44c182727aca1387acc9",alias:"property-details"},{id:"33cb09681a2147a5a07ae801596568c3",alias:"employment-overview"},{id:"8abaef7ba033448693dc6e6db55667c7",
alias:"office-market-profile"},{id:"d29fcd15f66f46edad86499675b0ec03",alias:"health-care-and-insurance"},{id:"e631e96f389b4075bc249c01d7f4d1b7",alias:"demographic-profile"},{id:"f97c7b4c8bf84390ad5a5807fb6ca417",alias:"commute-profile"},{id:"c9aef7db1d56495eaf0765e1f3a2d87d",alias:"target-market-summary"},{id:"b0f42ee46e80440cbb567a9a754ba7d4",alias:"population-trends"},{id:"ac36af7d86b74071a1cff5dc11f52ae8",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"e1b06b3915bc4e9ba702a604931390f2",
alias:"key-facts"},{id:"aabeb118af9d4d0ba61177b82ff20e6c",alias:"multi-area-comparison"},{id:"d91115c92b96414b8bebd5d5bee75feb",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"dc94c7a6946a49b5a2f3997a1d751b5d",alias:"housing-profile"},{id:"caaaf49e014840a2a7b2497a970fabc0",alias:"insurance-profile"},{id:"67e0ad06a076477d81f853755fe34fd9",alias:"media-profile"},{id:"2b777fe129f149e9830fa5659d83d164",alias:"personicx-segmentation"},{id:"109338143a024b8eb70a1afcad567363",alias:"spending-profile"}],"JP.EsriJapan":[{id:"1f22c748ad5441a197c4c35ec3b88c6e",
alias:"base-demographic-profile"},{id:"3321fc47d60b465bbf1f8312a2656c9d",alias:"demographic-comparison-profile"},{id:"44f656e0dd634f248501030bec1e4e56",alias:"future-population-profile"},{id:"10bee112cd5c452db06145cc97739272",alias:"population-households-profile"},{id:"9d50b931700f4d7e8bfff04362baf2b7",alias:"consumer-spending-profile"},{id:"6f15e753e76741e5b11443d987f9e31b",alias:"base-demographic-profile-ja"},{id:"c89ff30c389b4af28c5e95d56b8b8a2b",alias:"demographic-comparison-profile-ja"},{id:"82cf4d90d4444a9fab0db12c38398ddb",
alias:"future-population-profile-ja"},{id:"de0f4294ae8548f8852d3cfc44689262",alias:"population-households-profile-ja"},{id:"aa60be09466d494dab06b7fd3f227838",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"f65d4ab5669541eb82f8cfa44892076d",alias:"base-demographic-profile"},{id:"8f24b985758840bc865eb510c3a096c4",alias:"household-profile"}],"ES.ESP_AIS":[{id:"19973b06ff48411cbe8da96db2201889",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"08263fc5aa27402284ad1dd80de03ffe",alias:"at-risk-population"},
{id:"1386ceb53e0741428b78182d5ad1295c",alias:"commute-profile"},{id:"52ca001ddcf54d4eab0bbc476a962486",alias:"demographic-summary"},{id:"79480fbe1f5048b69bc0611a2828d74b",alias:"health-care-and-insurance"},{id:"4a9c5dbf1ee6480bbed9a48bdb8aa2ed",alias:"coronavirus-impact-planning"}],"*.census":[{id:"de0d25e45d4549439c440d9f893afe18",alias:"key-facts"},{id:"19f9971696f74bae8c8fd383a61abac3",alias:"multi-area-comparison"}]}}}function f(a){a=a||p.jsapiVersion;var g={};a=h()[a];for(var l in a){var k={};
a[l].forEach(function(q){k[q.alias]=q.id});var n=l.substr(0,l.indexOf("."));g[n]=k}return g}function e(a,g){g=f(g);return r.mixin({},g["*"],g[a])}m=m.geoenrichment.dijit.ReportPlayer.StandardTemplates;var b,c={"demographic-summary":m.demographicSummary,"key-facts":m.keyFacts,"marketing-profile":m.marketingProfile,"at-risk-population":m.atRiskPopulation,"portrait-property-flyer":m.portraitPropertyFlyer,skyscraper:m.skyscraper,"transportation-to-work":m.transportationToWork,"health-care":m.healthCare,
"executive-summary-call-outs":m.executiveSummaryCallOuts,"tapestry-profile":m.tapestryProfile,"nearby-restaurants":m.nearbyRestaurants,"multi-area-comparison":m.multiAreaComparison,"property-details":m.propertyDetails,"employment-overview":m.employmentOverview,"office-market-profile":m.officeMarketProfile,"health-care-and-insurance":m.healthCareAndInsuranceStatistics,"demographic-profile":m.demographicProfile,"commute-profile":m.commuteProfile,"target-market-summary":m.targetMarketSummary,"population-trends":m.populationTrends,
"coronavirus-impact-planning":m.coronavirusImpactPlanning,"prizm-profile":m.prizmProfile,"housing-profile":m.housingProfile,"insurance-profile":m.insuranceProfile,"media-profile":m.mediaProfile,"personicx-segmentation":m.personicxSegmentation,"spending-profile":m.spendingProfile,"base-demographic-profile":m.baseDemographicProfile,"demographic-comparison-profile":m.demographicComparisonProfile,"future-population-profile":m.futurePopulationProfile,"population-households-profile":m.populationHouseholdsProfile,
"consumer-spending-profile":m.consumerSpendingProfile,"base-demographic-profile-ja":"\u57fa\u672c\u7d71\u8a08\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","demographic-comparison-profile-ja":"\u4eba\u53e3\u7d71\u8a08\u6bd4\u8f03\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","future-population-profile-ja":"\u5c06\u6765\u4eba\u53e3\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","population-households-profile-ja":"\u4eba\u53e3\u30fb\u4e16\u5e2f\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","consumer-spending-profile-ja":"\u6d88\u8cbb\u984d\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb",
"household-profile":m.householdProfile},d={portalUrl:"http://www.arcgis.com",user:"esri_reports",query:"http://www.arcgis.com/home/search.html?q\x3downer%3Aesri_reports",aliasToID:function(a,g,l){return e(a,l)[g]},aliasToLabel:function(a){return c[a]},getAliases:function(a,g){a=Object.keys(e(a,g));a.sort(function(l,k){return l.localeCompare(k)});return a},getListOptions:function(a,g){return d.getAliases(a,g).map(function(l){return{value:d.aliasToID(a,l,g),label:c[l]}})},getSupportedCountries:function(a){return Object.keys(f(a)).map(function(g){return"*"===
g?"AU":g})},getLibrary:function(){var a=r.clone(h()),g;for(g in a){var l=a[g];l["AU.census"]=l["*.census"];delete l["*.census"]}return a}};return d})},"esri/dijit/geoenrichment/utils/PortalQueryUtil":function(){define([],function(){var r={combineQueryString:function(p){var m="";p.type&&(m+='type:"'+p.type+'"');p.typeKeywords?m=Array.isArray(p.typeKeywords[0])?m+(" typekeywords:("+p.typeKeywords.map(function(h){return r.combineTypeKeywords(h)}).join(" OR ")+")"):m+(" typekeywords:"+r.combineTypeKeywords(p.typeKeywords,
p.typeKeywordsNot)):p.typeKeywordsNot&&(m+=" typekeywords:"+r.combineTypeKeywords(null,p.typeKeywordsNot));p.owner&&(m+=" owner:"+p.owner);p.isShared&&(m+=p.orgId?" ((orgid:"+p.orgId+' AND access:"public") OR access:"shared" OR access:"org")':' (access:"shared" OR access:"org")');p.ownerNot&&(m+=" NOT owner:"+p.ownerNot);return m},combineTypeKeywords:function(p,m){p=p?r._combineArray(p):"";return m?(m=r._combineArray(m," OR "),"("+p+" NOT "+m+")"):p},_combineArray:function(p,m){var h="string"===typeof p?
p:1===p.length?p[0]:null;return h?"("===h.charAt(0)||'"'===h.charAt(0)?h:'"'+h+'"':"("+p.map(function(f){return'"'+f+'"'}).join(m||" ")+")"}};return r})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer":function(){define(["./query/TemplateJsonQueryUtil"],function(r){return{collectVariablesStats:function(p){var m={};r.processTemplateFieldInfos(p,function(h){h.infographicJson&&h.infographicJson.variables?h.infographicJson.variables.forEach(function(f){m[f]=
1}):h.hasVariable&&(h.usedMapTos?h.usedMapTos.forEach(function(f){m[f]=1}):h.fullName&&(m[h.fullName]=1))});return m},collectMapItemIdsAndNames:function(p){var m={},h={};r.calcNumberOfMaps(p,function(b){b.defaultBasemapId&&(m[b.defaultBasemapId]=1);b.defaultBasemapName&&(h[b.defaultBasemapName]=1);b.webMapId&&(m[b.webMapId]=1);b.webMapName&&(h[b.webMapName]=1)});p=[];for(var f in m)p.push(f);var e=[];for(f in h)e.push(f);return{itemIds:p,mapNames:e}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicJsonUtil":function(){define(["esri/dijit/geoenrichment/config",
"esri/dijit/geoenrichment/utils/ArrayUtil"],function(r,p){var m={getDefaultLevels:function(){var h=r.levels.slice();h.push(r.highestLevel);return h},getLevels:function(h){h=h.levels&&h.levels.length?h.levels:m.getDefaultLevels();return p.removeDuplicates(h)},getSubLevels:function(h){h=m.getLevels(h);h.pop();return h},getHighestLevel:function(h){h=m.getLevels(h);return h[h.length-1]},setLevels:function(h,f){f=p.removeDuplicates(f||[]);h.levels=f.length?f:m.getDefaultLevels()},getDataDrilling:function(h,
f){"string"!==typeof f&&(f=(f=h.variableTables&&h.variableTables[f])&&f.variable.fieldInfo&&f.variable.fieldInfo.templateName);return h.dataDrilling&&h.dataDrilling[f]},setDataDrilling:function(h,f,e){f&&(h.dataDrilling=h.dataDrilling||{},e?h.dataDrilling[f]=e:delete h.dataDrilling[f])},validateDataDrilling:function(h){var f=h.dataDrilling;if(f){var e={};h.variableTables.forEach(function(b){b.variable&&b.variable.fieldInfo&&b.variable.fieldInfo.templateName&&(e[b.variable.fieldInfo.templateName]=
!0)});Object.keys(f).forEach(function(b){e[b]||delete f[b]})}},analyzeVariables:function(h){h=h.fieldInfos?h.fieldInfos.map(function(c){return c.fullName}):h.variables;if(1===h.length&&-1!==h[0].indexOf(".*"))return{dataCollectionID:h[0].substr(0,h[0].indexOf("."))};var f={},e,b;h.forEach(function(c,d){f[c.substr(0,c.indexOf("."))]=1;e=c.substr(c.indexOf(".")+1);b=c});return{dataCollectionID:1===Object.keys(f).length?Object.keys(f)[0]:null,variableID:1===h.length?e:null,fullName:1===h.length?b:null}}};
return m})},"esri/dijit/geoenrichment/config":function(){define(["esri/urlUtils"],function(r){r=r.getProtocolForWebResource();return{portalUrl:r+"//arcgis.com",server:r+"//geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer",levels:["Admin3","Admin2"],highestLevel:"Admin1",locatorUrl:r+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",addressFormat:"${Address}, ${City}, ${Region} ${Postal}"}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AreasPreprocessor":function(){define("dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/string esri/graphic esri/symbols/jsonUtils ./FeatureNameUtil ../tasks/EnrichAreasTask esri/dijit/geoenrichment/utils/GeometryUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/i18n!esri/nls/jsapi".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g){var l={preprocessAreas:function(u,t){t=t||{};u.analysisAreas=u.analysisAreas.filter(function(v){return v.feature&&v.feature.geometry&&"polygon"===v.feature.geometry.type||v.geographies&&v.geographies.length||v.buffer});-1!==t.analysisAreasLimit&&(t.analysisAreasLimit=t.analysisAreasLimit||20,u.analysisAreas.length=Math.min(u.analysisAreas.length,t.analysisAreasLimit));l.provideAreasIndexes(u);u.analysisAreas.forEach(function(v){v.feature&&!v.feature.attributes&&(v.feature.attributes=
{})});u.analysisAreas.forEach(function(v){v.name=v.name||v.shortName;if(!v.name&&v.feature){var y=b.guessFeatureName(v.feature);y&&(v.name=v.shortName=y)}});return p(k.generalize(u.analysisAreas),function(){return m([n.provideGeographyFeatures(u),q.provideBufferFeatures(u)])})},provideAreasIndexes:function(u){var t=u.combinedAreasInfo.groups,v=t&&t.length;u.analysisAreas.forEach(function(y,B){y.index=B;t&&(t.forEach(function(D,E){-1!==D.indexes.indexOf(B)&&(y.isGrouped=!0,y.groupIndex=E)}),"number"!==
typeof y.groupIndex&&(y.isGrouped=!1,y.groupIndex=v++))})},removeGroupInfo:function(u){u.forEach(function(t){delete t.isGrouped;delete t.groupIndex})}},k={generalize:function(u){var t=[],v=[];u.forEach(function(y,B){!y.feature||y.geographies&&y.geographies.length||(t.push(y.feature),v.push(B))});return p(function(y){function B(w){var A=0;w.geometry.rings.forEach(function(H){A+=H.length});return A}var D=d.needGeneralizeGeometry(y,a.generalization.factor,a.generalization.maxVerticesInAllFeatures,a.generalization.numVerticesPerFeature);
if(D){var E=!0;var F=[];y=y.map(function(w){F.push(B(w));return new f(w.geometry,w.symbol,w.attributes)});var z=d.generalizeGeometry(y,D,a.generalization.numVerticesPerFeature,!0)}return p(z,function(){E&&(console.log("Generalize features:"),y.forEach(function(w,A){console.log("#"+A+" "+F[A]+" \x3d\x3e "+B(w))}));return y})}(t),function(y){v.forEach(function(B){u[B].feature=y.shift()})})}},n={provideGeographyFeatures:function(u){return m(u.analysisAreas.map(function(t){if(!t.feature&&t.geographies&&
t.geographies.length)return(new c).createFeatureForGeographies(t.geographies,{countryID:u.countryID,hierarchy:u.hierarchy}).then(function(v){t.feature=v;t.name=t.name||t.feature.attributes.StdGeographyName;t.description=t.description||g.geoenrichment.dijit.ReportPlayer.ReportPlayer.geography;t.address=t.address||t.name;t.geographies[0].attributes&&r.mixin(t.feature.attributes,t.geographies[0].attributes);if(v=t.geographies[0].symbol)v=v.toJson?v:e.fromJson(v),t.feature.setSymbol(v)})}))}},q={provideBufferFeatures:function(u){var t=
this,v=u.analysisAreas.filter(function(B){return!B.feature&&B.buffer}),y=v.map(function(B){return B.buffer});return(new c).createFeaturesForBuffers(y,{countryID:u.countryID}).then(function(B){B.forEach(function(D,E){E=v[E];E.feature=D;t._applyBufferParamsToArea(E)})})},_applyBufferParamsToArea:function(u){var t=u.buffer;if(!u.name){var v=g.geoenrichment.dijit.bufferTitle.pointRing;v[t.units]&&(u.name=h.substitute(v[t.units],{radius:t.radius}))}u.description=u.description||"Ring";t.attributes&&r.mixin(u.feature.attributes,
t.attributes);if(t=t.symbol)t=t.toJson?t:e.fromJson(t),u.feature.setSymbol(t)}};return l})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/FeatureNameUtil":function(){define([],function(){return{_nameScores:[/^name$/i,/^title$/i,/(^name)|(name$)/i,/(^title)|(title$)/i],guessFeatureName:function(r){var p=Object.keys(r.attributes),m;this._nameScores.some(function(h){return p.some(function(f){if(h.test(f))return m=f,!0})});return r.attributes[m]||""}}})},"esri/dijit/geoenrichment/utils/GeometryUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/geometry/Polygon esri/workers/WorkerClient ./PolygonUtil ./GeometryUtil_base".split(" "),
function(r,p,m,h,f,e){function b(d,a,g){var l=new p,k=new h("./mutableWorker",function(){k.importScripts(["../dijit/geoenrichment/utils/GeometryUtil_worker","../dijit/geoenrichment/utils/GeometryUtil_base"]).then(function(){k.postMessage({rings:d,maxAllowableOffset:g}).then(function(n){var q=n.rings;a.forEach(function(u){for(var t=u.source.length=0;t<u.count;t++)u.source.push(q.shift())});l.resolve();k.terminate()})})},!0);return l.promise}var c=r.mixin({},e);c.calculateMaxAllowableOffset=function(d,
a,g){"number"!==typeof a&&(a=1);a*=d.extent.getWidth()/d.width;g&&(a*=Math.min(g.getWidth()/d.extent.getWidth(),g.getHeight()/d.extent.getHeight()));return a};c.getNumberOfPoints=f.getNumberOfPoints;c.needGeneralizeGeometry=function(d,a,g,l){if(!d||!a)return!1;l=l||(g?g/10:500);g=g||5E3;Array.isArray(d)||(d=[d]);var k=0>a,n=0,q=Math.abs(a)/100,u=0,t=0,v;d.forEach(function(y){y=y.geometry||y;if(!y.rings||!y.getExtent)return!1;var B=y.getExtent();if(B=B.getWidth()*B.getHeight())B=Math.sqrt(B),y=c.getNumberOfPoints(y),
u+=y,t=Math.max(t,y),k&&(n=Math.max(n,B*q)),v||(v=k?u>g:y*a>4*B)});return v&&t>l?n||a:0};c.generalizeGeometry=function(d,a,g,l){if(!d||!a||0>a)return!1;g=g||500;Array.isArray(d)||(d=[d]);var k=[],n=[];d.map(function(q){var u=q.geometry||q;if(u!=q&&u.rings){q.geometry=new m;q.geometry.setSpatialReference(u.spatialReference);var t=q.geometry.rings}t&&u.rings.forEach(function(v){t.push(v.slice())});c.getNumberOfPoints(u)>g&&(q=t||u.rings,k=k.concat(q),n.push({source:q,count:q.length}))});if(l&&window.Worker)return b(k,
n,a);k.forEach(function(q){(new c.RingInfo(q)).generalize(a,.8)})};return c})},"esri/workers/WorkerClient":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/request ../sniff ../kernel ../urlUtils require".split(" "),function(r,p,m,h,f,e,b,c,d){var a=window.Blob||window.webkitBlob||window.mozBlob,g=window.URL||window.webkitURL||window.mozURL;r=p([r],{declaredClass:"esri.workers.WorkerClient",worker:null,returnDeferreds:!1,_queue:null,constructor:function(l,k,n){this._isIE=
e("ie");this.returnDeferreds=!!n;this._queue={};this._acceptMessage=h.hitch(this,this._acceptMessage);this._errorMessage=h.hitch(this,this._errorMessage);l&&this.setWorker(l,h.hitch(this,function(q){this.worker=q;k(q)}))},setWorker:function(l,k){if(l instanceof Array){var n=l;l=n.shift()}var q=this._getUrl(l);q=c.normalize(q);l=!c.hasSameOrigin(q,location.href);if(!1===q)return console.log("Can not resolve worker path"),!1;if(this.worker){var u=this.worker;u.removeEventListener("message",this._acceptMessage,
!1);u.removeEventListener("error",this._errorMessage,!1);u.terminate();u=null}if(l){l=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(l,h.hitch(this,function(t){t=g.createObjectURL(new a([t],{type:"text/javascript"}));k(this._createWorker(t,q))}))}catch(t){try{l=c.getProxyUrl(l).path+"?"+encodeURI(l),this._useProxy=!0,k(this._createWorker(l,n))}catch(v){return console.log("Can not create worker"),!1}}}else setTimeout(h.hitch(this,function(){k(this._createWorker(q,n))}),0)},_createWorker:function(l,
k){l=new Worker(l);l.addEventListener("message",this._acceptMessage,!1);l.addEventListener("error",this._errorMessage,!1);this.worker=l;k&&this.importScripts(k);return l},postMessage:function(l,k){if(l instanceof Array||"object"!=typeof l)l={data:l};var n=Math.floor(64E9*Math.random()).toString(36);l.msgId=n;n=this._queue[n]=new m;this.worker?(k?this.worker.postMessage(l,k):this.worker.postMessage(l),this.emit("start-message",{target:this,message:l})):n.reject({message:"No worker was set."});return this.returnDeferreds?
n:n.promise||n},terminate:function(){var l=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var k=l.length-1;0<=k;k--)this._queue[l[k]].cancel("terminated"),delete this._queue[l[k]]},addWorkerCallback:function(l,k){var n=this._getUrl(l,!0);!1===n?(k=new m,k.reject({message:"Could not load text from "+l})):(k=this.postMessage({action:"add-callback",url:n,cbName:k||"main"}),k.then(h.hitch(this,function(q){q.target=this;this.emit("callback-added",q)})));return k},importScripts:function(l){Array.isArray(l)||
(l=[l]);l=l.map(function(k){k=this._getUrl(k,!0);this._useProxy&&!c.hasSameOrigin(k,location.href)&&(k=c.getProxyUrl(k).path+"?"+encodeURI(k));return k},this);l=this.postMessage({action:"import-script",url:l});l.then(h.hitch(this,function(k){k.target=this;this.emit("scripts-imported",k)}));return l},_acceptMessage:function(l){var k=l.data,n=k.msgId;if(k.status&&"debug"==k.status)console[k.showAs||"debug"](k);else if(n&&n in this._queue){var q=this._queue[n];"progress"==k.status?q.progress(l.data):
("error"==k.status?q.reject(l.data):q.resolve(l.data),delete this._queue[n])}this.emit("message",{message:l.data,event:l,target:this})},_errorMessage:function(l){this.onerror||this.onError?this.onerror?this.onerror(l):this.onError(l):console.log("Worker Error: "+l.message+"\nIn "+l.filename+" on "+l.lineno)},_getUrl:function(l,k){if(!l)return console.error("can not resolve empty path"),!1;l.match(/\.js$/)||(l+=".js");l=d.toUrl(l);return k?c.getAbsoluteUrl(l):l},_getRemoteText:function(l,k){(l=this._getUrl(l))&&
f.get(l,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(n){k(n)})},_startBlobWorker:function(){var l=this._xdSource;l||(l=this._getUrl("./mutableWorker"),l=new a(["if(!self._mutable){importScripts('"+l+"');}"],{type:"text/javascript"}),l=this._xdSource=g.createObjectURL(l));try{return new Worker(l)}catch(k){return console.log(k.message),!1}}});e("extend-esri")&&h.setObject("workers.WorkerClient",r,b);return r})},"esri/dijit/geoenrichment/utils/GeometryUtil_base":function(){(function(r){function p(c,
d){var a=c.length;if(3>a)return 0;d||(d=c[0]);var g=d[0];d=d[1];var l=c[a-1];a=l[0]-g;for(var k=l[1]-d,n=0,q=0,u=c.length;q<u;q++){l=c[q];var t=l[0]-g;l=l[1]-d;n+=t*k-a*l;a=t;k=l}return n/2}var m={};m.calculateRingArea=p;m.calculateRingCentroid=function(c,d){var a=c.length;if(!a)return null;d||(d=c[0]);var g=d[0];d=d[1];var l=0,k=0,n=0;if(2<a){var q=c[a-1];a=q[0]-g;for(var u=q[1]-d,t=0,v=c.length;t<v;t++){q=c[t];var y=q[0]-g;q=q[1]-d;var B=y*u-a*q;l+=B;k+=(a+y)*B;n+=(u+q)*B;a=y;u=q}}0==l?k=n=0:(k/=
3*l,n/=3*l);return[g+k,d+n]};m.INTERIOR=1;m.EXTERIOR=-1;m.BOUNDARY=0;m.createRingInfo=function(c,d){return new e(c,d)};m.createSegmentCoordinates=function(c){return new b(null,0,0,c)};var h=function(c){return function(){for(var d in c){var a=c[d];this[d]="function"===typeof a?a.bind(this):a}c.ctr.bind(this).apply(this,arguments)}},f=h({xmin:null,ymin:null,xmax:null,ymax:null,spatialReference:null,ctr:function(c,d,a,g,l){this.xmin=c;this.ymin=d;this.xmax=a;this.ymax=g;this.spatialReference=l},printOut:function(){console.log([this.xmin,
this.xmax,this.ymin,this.ymax].join(" "))}}),e=h({ring:null,origin:null,area:0,clockwise:!1,extent:null,_coords:null,ctr:function(c,d){this.ring=c;this.origin=d;c=this.ring.length-1;if(!(0>c)){if(!c)c++;else if(this.ring[c][0]!=this.ring[0][0]||this.ring[c][1]!=this.ring[0][1])c++,this.ring.push(this.ring[0].slice());var a=0,g=0;d=!d;this.extent=new f(this.ring[0][0],this.ring[0][1],this.ring[0][0],this.ring[0][1]);for(var l=0;l<c;l++){var k=this.ring[l],n=k[0];d&&(a+=n);n<this.extent.xmin?this.extent.xmin=
n:n>this.extent.xmax&&(this.extent.xmax=n);n=k[1];d&&(g+=n);n<this.extent.ymin?this.extent.ymin=n:n>this.extent.ymax&&(this.extent.ymax=n)}d&&(this.origin=[a/c,g/c]);this.area=p(this.ring,this.origin);0>=this.area?this.area=-this.area:this.clockwise=!0}},setDirection:function(c){this.clockwise==!c&&(this.ring.reverse(),this.clockwise=!this.clockwise,this._coords=null)},testPoint:function(c,d){c=this.getRingCoordinates(d).testPoint(c[0]-this.origin[0],c[1]-this.origin[1]);return this.clockwise?c:-c},
generalize:function(c,d,a){function g(I,N,M){y=I;B=N;if(M||F<v)v=c,D=y-u,E=B-u,F=Math.sqrt(D*D+E*E),F>c*d?(D/=F,E/=F):F=0;v*=d}function l(){if(!F)return!0;var I=k.dx,N=k.dy,M=Math.sqrt(I*I+N*N);return M-I*D-N*E>=.9*M}d=d||.75;var k=this.getRingCoordinates(c),n=k.xs,q=k.ys,u=n[0],t=q[0],v,y,B,D,E,F=0,z=n.length-1;g(n[z],q[z],!0);for(var w=this,A=this.clockwise?function(I){w.ring.splice(I,1)}:function(I){w.ring.splice(-I-1,1)};0<z--&&4<n.length;){var H=n[z],G=q[z];k.setSegment(u,t,H,G)&&k.testPointOnTouch(y,
B,v)&&l()?(n.splice(z+1,1),q.splice(z+1,1),A(z+1),g(H,G)):(u=y,t=B,g(H,G,!0))}this._coords=null;a&&(this.area=p(this.ring,this.origin),this.clockwise||(this.area=-this.area))},getRingCoordinates:function(c,d){if(d)return new b(this.ring,d[0],d[1],c,this.extent,this.clockwise);this._coords&&this._coords.eps==c||(this._coords=new b(this.ring,this.origin[0],this.origin[1],c,this.extent,this.clockwise));return this._coords}});m.RingInfo=e;var b=h({xs:null,ys:null,extent:null,eps:NaN,dx:null,dy:null,_sx:null,
_sy:null,ctr:function(c,d,a,g,l,k){this.xs=[];this.ys=[];c||(c=[]);void 0===d&&(d=0);void 0===a&&(a=0);void 0===g&&(g=0);this.eps=Math.max(g,0);l&&(g=this.eps/2,this.extent=new f(l.xmin-d-g,l.ymin-a-g,l.xmax-d+g,l.ymax-a+g));var n=c.length-1;if(!(0>n))for(l=n?c[n][0]==c[0][0]&&c[n][1]==c[0][1]?n:n+1:1,g=k?1:-1,k=k?0:n;l--;k+=g)n=c[k],this.xs.push(n[0]-d),this.ys.push(n[1]-a)},testPoint:function(c,d){if(!this._pointBelongsToExtent(c,d))return-1;var a=this.xs.length,g=!1;this.dy=this.ys[0]-this.ys[a-
1];if(0==this.dy){for(g=a;1<g--&&(this.dy=this.ys[g]-this.ys[g-1],0==this.dy););if(0==this.dy)return 0}g=0<this.dy;for(var l=0,k=this.xs[0],n=this.ys[0],q,u,t=1;t<=a;t++,k=q,n=u)if(u=t==a?0:t,q=this.xs[u],u=this.ys[u],this.setSegment(k,n,q,u)){var v=n-d,y=u-d,B=!1;0>v&&(v=-v,y=-y,B=!0);if(!(v>this.eps&&y>this.eps)){if(this.testPointOnTouch(c,d,this.eps))return 0;0==v?0!==y&&(0>y&&(g=!g),c<k&&g&&l++):0==y?g=B:0>y&&c<k+this.dx/this.dy*(d-n)&&l++}}return 0!=l%2?1:-1},testPointOnTouch:function(c,d,a){var g=
this.findIntersectionDelta(c,d,c-this.dy,d+this.dx);c=this._sx+g*this.dx-c;d=this._sy+g*this.dy-d;return c*c+d*d<=a*a},_pointBelongsToExtent:function(c,d){return c>=this.extent.xmin&&c<=this.extent.xmax&&d>=this.extent.ymin&&d<=this.extent.ymax},setSegment:function(c,d,a,g){this._sx=c;this.dx=a-c;this._sy=d;this.dy=g-d;return 0!=this.dx||0!=this.dy},findIntersectionDelta:function(c,d,a,g,l){void 0===l&&(l=!0);a-=c;g-=d;var k=this.dy*a-this.dx*g;if(0==k)return 0;var n=c-this._sx,q=d-this._sy,u=q*a-
n*g;n=l?0:q*this.dx-n*this.dy;0>k&&(k=-k,u=-u,n=-n);return l||(n=0>n?0:n<k?n/k:1,this.testPointOnTouch(c+n*a,d+n*g,this.eps))?0>=u?0:u<k?u/k:1:-1},addPointOfSegmentAt:function(c){this.xs.push(this._sx+c*this.dx);this.ys.push(this._sy+c*this.dy)}});m.RingCoordinates=b;r.document?define(function(){return m}):r.GeometryUtil_base=m})(this)},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ReportTemplateTypes":function(){define([],function(){return{STANDARD:"esriReportTemplateStandard",MULTICOLUMN:"esriReportTemplateMultiColumn",
MAP:"esriReportTemplateMapReport",FUSION:"esriReportTemplateFusion"}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/config ./portalToEditorUtils/layout/LayoutParser ./portalToEditorUtils/metadata/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ./portalToEditorUtils/variables/PlayerVariableProvider ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l){return{provideEditorJson:function(k,n){function q(){function D(w,A,H){return r(n.preProcessFile&&n.preProcessFile(w,A,u),function(G){if(!1!==G)return r(H&&H(),function(){return n.postProcessFile&&n.postProcessFile(w,A,u)})})}if(t&&t.files&&t.files){var E=n.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],F={"theme.css.txt":function(w){return D(w,"theme.css.txt",function(){u.theme=a.fromCssText(w.data,n)})},"metadata.xml":function(w){return D(w,"metadata.xml",
function(){return h.parseMetadataXML(w,u,n)})},"report.xml":function(w){return D(w,"report.xml",function(){return m.parseReportXML({report:k,parsers:e,file:w,templateJson:u,variableProvider:n.variableProvider,useVariableProviderToCollectOnly:n.useVariableProviderToCollectOnly,tableDefaultStyles:n.tableDefaultStyles,processFileName:y,putImageData:function(A,H){A=y(A);H=H||v[A];d.putImageData(A,H);return H},log:B,queryMetaDataFunc:function(A){return n.queryMetaDataFunc&&n.queryMetaDataFunc(A,u)},postProcessChartJson:function(A,
H){n.postProcessChartJson&&n.postProcessChartJson(u,A,H)},postProcessMapJson:function(A,H){n.postProcessMapJson&&n.postProcessMapJson(u,A,H)},postProcessInfographicJson:function(A,H){n.postProcessInfographicJson&&n.postProcessInfographicJson(u,A,H)},postProcessTableInSection:function(A,H){n.postProcessTableInSection&&n.postProcessTableInSection(u,A,H)}})})},generic:function(w,A){return D(w,A)}},z=new g;E.forEach(function(w){var A=t.files.filter(function(G){return G.name===w})[0],H=A&&(F[w]||F.generic);
H&&z.add(function(){return r(p.isPlayerOnServer?r():l.delay(50)).then(function(){return H(A,w)}).otherwise(function(G){u.metadata.parseErrors.push(G);console.log(G)})})});return z.getPromise()}}n=n||{};n.variableProvider=n.variableProvider||new b;n.tableDefaultStyles=n.tableDefaultStyles||new c;var u={documentOptions:{},metadata:{specialTradeAreaCalculatorName:null,parseErrors:[],mapImageInfosHash:{},comparisonCalculatorsHash:{},locatorCalculatorsHash:{}},theme:null},t=k.portalJson,v={};n.getImageData=
function(D){return v[y(D)]};var y=function(D){return D?D.toLowerCase():""},B=n.log||function(D){};return r(e.initialize(),function(){return r(f.collectImageResources(t,v,y),function(){for(var D in v)d.putImageData(D,v[D]);return r(q(),function(){u.metadata.parseErrors.length||(k.templateJson=u)})})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/LayoutParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./GraphicReportSectionsParser",
"./ClassicReportSectionsParser"],function(r,p,m){return{parseReportXML:function(h){h.log(h.file.data);var f=r.parseXml(h.file.data);h.parsers.getParser("document").parseDocument(f,h);h.report.isGraphicReport?(h.templateJson.sectionsTables=[],p.parseSectionsGraphic(f,h)):(h.templateJson.sections=[],m.parseSectionsClassic(f,h))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/GraphicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],
function(r){return{parseSectionsGraphic:function(p,m){r.queryTopJson(p,"table").forEach(function(h){try{m.templateJson.sectionsTables.push(m.parsers.getParser("section").parseTable(h,m,{fixTableWidthsForPage:!0}))}catch(f){console.log(f)}})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/ClassicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(r){return{parseSectionsClassic:function(p,m){r.queryTopJson(p,"section").forEach(function(h){m.templateJson.sections.push(m.parsers.getParser("section").parseSection(h,
m,{fixTableWidthsForPage:!0}))});this._splitSections(m)},_splitSections:function(p){p=p.templateJson;var m=[];p.sections.forEach(function(h){function f(){e={type:h.type,stack:[]};m.push(e)}var e;f();h.stack.forEach(function(b){if("hr"===b.id){var c=!!e.stack.length;e.stack.push(b);c&&f()}else"table"===b.id?(e.stack.some(function(d){return"table"===d.id})&&f(),e.stack.push(b)):"pageBreak"===b.id?(e.stack.length&&f(),e.stack.push(b),f()):e.stack.push(b)})});m=m.filter(function(h){return!!h.stack.length});
p.sections=m}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/MetadataParser":function(){define("esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/utils/JsonXmlConverter ./DataCollectionsCalculatorsParser ./ScriptsCalculatorsParser ./LocatorCalculatorsParser ./map/MapCalculatorsParser ./TradeAreaCalculatorsParser".split(" "),function(r,p,m,h,f,e,b){return{parseMetadataXML:function(c,d,a){a.log&&a.log(c.data);var g=p.parseXml(c.data);if(g&&g.tags)return r([b.parseTradeAreaCalculators(g,
d,a),m.parseDataCollectionsCalculators(g,d,a),h.parseScriptsCalculators(g,d,a),f.parseLocatorCalculators(g,d,a)]).then(function(){return e.parseMapCalculators(g,d,a)})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/DataCollectionsCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector","../../../../_devConfig"],function(r,p,m){return{parseDataCollectionsCalculators:function(h,f,e){r.queryJson(h,"DataCollections").forEach(function(b){var c=
r.queryJson(b,"ComparisonLevel");if(m.emulateErrors.metadataParseError)throw Error("Error test: something crashed during the parsing of the metadata!");if(e.variableProvider.isPlayerOnly||c.length)var d=p.getObjects(b);c.length&&(b={calculatorName:b.attributes.Name,levels:c.map(function(a){return a.attributes.Name}).filter(function(a){return!e.validateGeographyLevelFunc||e.validateGeographyLevelFunc(a)}),variableObjects:d.variableObjects},f&&(f.metadata.comparisonCalculatorsHash[b.calculatorName]=
b));e.variableProvider.isPlayerOnly&&(d.variableObjects.forEach(function(a){e.variableProvider.addVariable(a)}),d.scriptObjects.forEach(function(a){e.variableProvider.addScriptVariable(a)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/VariableScriptCollector":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(r,p){var m={getObjects:function(h,f){f=m._getVariableInfo(h,f);h=m._getScriptObjects(h,
f.fieldNameToVariableCache);return{variables:f.variables,variableObjects:f.variableObjects,scriptObjects:h}},_getVariableInfo:function(h,f){var e=[];r.queryJson(h,f?/^(RawFields|Fields)$/:"Fields").forEach(function(a){e=e.concat(r.queryJson(a,/^(Field|PortalField)$/))});var b=[],c=[],d={};e.forEach(function(a){b.push(a.attributes.MapTo);if(a=p.fieldTagToVariable(a,h.attributes.Name))d[a.fieldName]=a,c.push(a)});return{variables:b,variableObjects:c,fieldNameToVariableCache:d}},_getScriptObjects:function(h,
f){var e=r.queryJson(h,"Scripts"===h.name?"Fields":"CalculatedFields")[0];e=e&&r.queryJson(e,"Script")||[];"Scripts"===h.name&&(e=e.filter(function(b){return!("STORE_ID"===b.attributes.Name||"AREA_ID"===b.attributes.Name)}));return e.map(function(b){var c=p.scriptTagToVariable(b,h.attributes.Name);c.usedFields&&(c.usedMapTos=[],c.usedFields.forEach(function(d){var a=f[d];a?a.usedMapTos?c.usedMapTos=c.usedMapTos.concat(a.usedMapTos):c.usedMapTos.push(a.fullName):console.log("Error parsing used fields for "+
d)}),f[c.fieldName]=c);return c})}};return m})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/VariableUtil":function(){define([],function(){var r={getType:function(p,m){return p?0===p.indexOf("esriFieldType")?p:"esriFieldType"+p:m},fieldTagToVariable:function(p,m){return p.attributes.MapTo&&"AREA_ID"!==p.attributes.Name?{id:p.attributes.MapTo.substr(p.attributes.MapTo.lastIndexOf(".")+1),fullName:p.attributes.MapTo,alias:p.attributes.Alias,fieldName:p.attributes.Name,
precision:Number(p.attributes.Decimals)||0,calculatorName:m,templateName:m+"."+p.attributes.Name,type:r.getType(p.attributes.Type,p.attributes.Decimals?"esriFieldTypeDouble":"esriFieldTypeString"),vintage:null,source:null}:null},scriptTagToVariable:function(p,m){return{id:p.attributes.Name,fullName:m+"."+p.attributes.Name,fieldName:p.attributes.Name,alias:p.attributes.Alias,precision:Number(p.attributes.Decimals)||0,usedFields:p.attributes.usedFields?p.attributes.usedFields.split(","):[],usedMapTos:null,
expressionText:p.tags[0].text,calculatorName:m,templateName:m+"."+p.attributes.Name,type:r.getType(p.attributes.Type,p.attributes.Decimals?"esriFieldTypeDouble":"esriFieldTypeString")}}};return r})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/ScriptsCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector"],function(r,p){return{parseScriptsCalculators:function(m,h,f){r.queryJson(m,"Scripts").forEach(function(e){f.variableProvider.isPlayerOnly&&
(e=p.getObjects(e),e.variableObjects.forEach(function(b){f.variableProvider.addVariable(b)}),e.scriptObjects.forEach(function(b){f.variableProvider.addScriptVariable(b)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/LocatorCalculatorsParser":function(){define(["esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(r,p,m,h){return{parseLocatorCalculators:function(f,
e,b){f=m.queryJson(f,"Locator");return r(f.map(function(c){var d=[];m.queryJson(c,/^(PointFields|Fields)$/).forEach(function(l){d=d.concat(m.queryJson(l,/^(Field|Direction|Distance)$/))});var a=[];d.forEach(function(l){"Direction"===l.name?l.attributes.MapTo="DIRECTION":"Distance"===l.name&&(l.attributes.MapTo="DISTANCE");(l=h.fieldTagToVariable(l,c.attributes.Name))&&a.push(l)});var g={calculatorName:c.attributes.Name,variableObjects:a,layerID:null,layerUrl:null,layerName:c.attributes.LayerName};
c.attributes.Points&&0===c.attributes.Points.indexOf("std:")?g.layerID=c.attributes.Points.replace("std:",""):g.layerUrl=c.attributes.Layer;e.metadata.locatorCalculatorsHash[c.attributes.Name]=g;b.variableProvider.isPlayerOnly&&a.forEach(function(l){b.variableProvider.addVariable(l)});return p(!b.validateLocatorCalculator||b.validateLocatorCalculator(g.layerID,g.layerUrl),function(l){g.isValid=l})}))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MapCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter",
"./MetadataToRendererParser","./MapTagsUtil","esri/dijit/geoenrichment/utils/ImageUtil"],function(r,p,m,h){var f={parseMapCalculators:function(e,b,c){r.queryJson(e,"Maps").forEach(function(d){r.queryJson(d,"Map").forEach(function(a){var g=f._parsePortalLayers(a),l=f._parseStudyAreas(a);g={fieldName:a.attributes.Name,width:Number(a.attributes.Width),height:Number(a.attributes.Height),defaultBasemapId:g.defaultBasemapId,defaultBasemapName:g.defaultBasemapName,webMapId:g.webMapId,webMapName:g.webMapName,
additionalLayerInfos:f._parseAdditionalLayers(a,b),pinSymbolJson:f._parseSiteLayerPinSymbol(a,c),areaSymbolJsons:l.symbolJsons,areaSymbolRamp:l.ramp,mapScale:Number(a.attributes.Scale)||null};b&&(b.metadata.mapImageInfosHash[d.attributes.Name+"."+a.attributes.Name]=g)})})},_parsePortalLayers:function(e){var b;e=r.queryJson(e,"Layer").filter(function(c){return!(!c.attributes.PortalItemId&&!c.attributes.MapName)});1<e.length&&(b=e.shift());e=e.shift();return{defaultBasemapId:b&&b.attributes.PortalItemId,
defaultBasemapName:b&&b.attributes.MapName,webMapId:e&&e.attributes.PortalItemId,webMapName:e&&e.attributes.MapName}},_parseAdditionalLayers:function(e,b){var c=[];r.queryJson(e,/^(Layer|LocatorResultsLayer|ComparisonResultsLayer)$/).filter(function(d){return!!d.attributes.ServiceUrl||"LocatorResultsLayer"===d.name||"ComparisonResultsLayer"===d.name}).forEach(function(d){if(d.attributes.ServiceUrl)c.push({url:d.attributes.ServiceUrl});else if("LocatorResultsLayer"===d.name){var a=d.tags&&d.tags.filter(function(l){return"Renderer"===
l.name})[0],g=b.metadata.locatorCalculatorsHash[d.attributes.CalculatorName];g&&g.isValid&&c.push({isLocatorLayer:!0,layerName:d.attributes.LayerName,calculatorName:d.attributes.CalculatorName,calculatorInfo:g,rendererJson:a&&p.parseRendererJson(a)})}else"ComparisonResultsLayer"===d.name&&((a=(a=d.tags&&d.tags.filter(function(l){return"Renderer"===l.name})[0])&&p.parseRendererJson(a))&&"esriTS"===a.uniqueValueInfos[0].symbol.type?c[c.length-1].labelRendererJson=a:(g=(g=d.tags&&d.tags.filter(function(l){return"LabelingInfo"===
l.name})[0])&&p.parseLabelRendererJson(g),c.push({isComparisonLayer:!0,calculatorName:d.attributes.CalculatorName,rendererJson:a,labelRendererJson:g})))});return c.length&&c},_parseSiteLayerPinSymbol:function(e,b){var c;if(e=r.queryJson(e,"SiteLayer")[0])if((e=r.queryJson(e,"Symbol")[0])&&"Image"===e.attributes.Type)(b=b.getImageData(e.attributes.Name))&&(c={type:"esriPMS",contentType:h.getContentType(b),imageData:h.base64DataFromDataURL(b),url:e.attributes.Url,width:Number(e.attributes.Width),height:Number(e.attributes.Height),
angle:Number(e.attributes.Angle)||0,xoffset:Number(e.attributes.XOffset)||0,yoffset:Number(e.attributes.YOffset)||0});else if(e&&"Marker"===e.attributes.Type){c=(c=r.queryJson(e,"Fill")[0])&&r.queryJson(c,"Color")[0];var d=(b=r.queryJson(e,"Outline")[0])&&r.queryJson(b,"Color")[0];c={type:"esriSMS",style:"esriSMS"+(e.attributes.Style||"Circle"),size:Number(e.attributes.Size),angle:Number(e.attributes.Angle)||0,xoffset:Number(e.attributes.XOffset)||0,yoffset:Number(e.attributes.YOffset)||0,color:m.parseColorTag(c),
outline:b&&{type:"esriSLS",color:m.parseColorTag(d),style:"esriSLS"+(b.attributes.Style||"Solid"),width:void 0===b.attributes.Width?0:Number(b.attributes.Width)}}}return c},_parseStudyAreas:function(e){var b=(e=r.queryJson(e,"StudyAreasLayer")[0])&&r.queryTopJson(e,"SymbolsPalette")[0];e=(b&&r.queryTopJson(b,"Symbol")||[]).map(f._parseAreaSymbol);var c=b&&r.queryTopJson(b,"SymbolRamp")[0],d;c&&(b=r.queryTopJson(c,"First")[0],c=r.queryTopJson(c,"Last")[0],b=b&&r.queryTopJson(b,"Symbol")[0],c=c&&r.queryTopJson(c,
"Symbol")[0],b&&c&&(d=[b,c].map(f._parseAreaSymbol)));return{ramp:d,symbolJsons:e}},_parseAreaSymbol:function(e){var b=r.queryJson(e,"Fill")[0];b=b&&r.queryJson(b,"Color")[0];var c=(e=r.queryJson(e,"Outline")[0])&&r.queryJson(e,"Color")[0];return{type:"esriSFS",style:"esriSFSSolid",color:m.parseColorTag(b)||[0,0,0,1],outline:e&&{type:"esriSLS",color:m.parseColorTag(c),style:"esriSLS"+(e.attributes.Style||"Solid"),width:void 0===e.attributes.Width?0:Number(e.attributes.Width)}}}};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MetadataToRendererParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlTypedConverter",
"esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(r,p){return{parseRendererJson:function(m){return r.parseXml(p.parseJson(m))},parseLabelRendererJson:function(m){return{type:"uniqueValue",field1:"StdGeographyLevel",uniqueValueInfos:r.parseXml(p.parseJson(m)).map(function(h){return{value:h.where.match(/StdGeographyLevel='(.*?)'/)[1],symbol:h.symbol}})}}}})},"esri/dijit/geoenrichment/utils/JsonXmlTypedConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(r,p){return r(null,
{parseJson:function(m,h){function f(d,a){if("string"===typeof d)c+="\x3c"+a+' type\x3d"string"\x3e'+p.encodeXML(d,!1)+"\x3c/"+a+"\x3e";else if("number"===typeof d)c+="\x3c"+a+' type\x3d"number"\x3e'+d+"\x3c/"+a+"\x3e";else if("boolean"===typeof d)c+="\x3c"+a+' type\x3d"boolean"\x3e'+d+"\x3c/"+a+"\x3e";else if(Array.isArray(d))e(d,a);else if(d&&"object"===typeof d){c+="\x3c"+a+' type\x3d"object"\x3e';for(var g in d)f(d[g],g);c+="\x3c/"+a+"\x3e"}}function e(d,a){c+="\x3c"+a+' type\x3d"array"\x3e';d.forEach(function(g){f(g,
"item")});c+="\x3c/"+a+"\x3e"}var b=h&&h.rootName||"root",c="";h&&h.addDocumentOptions&&(c+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');f(m,b);return c=decodeURIComponent(encodeURIComponent(c).replace("%19",""))},parseXml:function(m){function h(g){if(!g.attributes)return null;for(var l=0;l<g.attributes.length;l++){var k=g.attributes[l];if("type"===k.name)return k.value}return null}function f(g,l){if(l.childNodes)for(var k=0,n=l.childNodes.length;k<n;k++){var q=l.childNodes[k],u=e(q);void 0!==
u&&(g[q.nodeName]=u)}return g}function e(g){var l=h(g);if(g.nodeName&&l)switch(l){case "string":return g.childNodes[0]?p.decodeXML(g.childNodes[0].nodeValue):"";case "number":return Number(g.childNodes[0].nodeValue);case "boolean":return"true"===g.childNodes[0].nodeValue;case "object":return f({},g);case "array":return b([],g)}}function b(g,l){if(l.childNodes)for(var k=0,n=l.childNodes.length;k<n;k++)g[k]=e(l.childNodes[k]);return g}var c;m=(new DOMParser).parseFromString(m,"text/xml").childNodes;
for(var d=0;d<m.length;d++)if(1===m[d].nodeType){var a=m[d];break}a&&(m=h(a),"object"===m?f(c={},a):"array"===m&&b(c=[],a));return c}})()})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MapTagsUtil":function(){define([],function(){return{parseColorTag:function(r){if(!r)return null;r=r.attributes;return[Number(r.Red)||0,Number(r.Green)||0,Number(r.Blue)||0,r.Transparency?255*(1-Number(r.Transparency)/100):255]}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/TradeAreaCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter",
"./VariableScriptCollector","../../../supportClasses/templateJsonUtils/fieldInfo/FieldLibrary"],function(r,p,m){return{parseTradeAreaCalculators:function(h,f,e){h=r.queryJson(h,"SpecialTradeAreaFields");f.metadata.specialTradeAreaCalculatorName=h[0]&&h[0].attributes&&h[0].attributes.Name;h.forEach(function(b){e.variableProvider.isPlayerOnly&&p.getObjects(b,!0).variableObjects.forEach(function(c){c.alias=c.alias||m.getFieldLabel(c.id);e.variableProvider.addVariable(c)})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/ImageCollector":function(){define(["esri/dijit/geoenrichment/when",
"esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/DataUtil","esri/dijit/geoenrichment/utils/ImageUtil","esri/dijit/geoenrichment/utils/ImageInfoUtil"],function(r,p,m,h,f){return{collectImageResources:function(e,b,c){function d(g){return r(f.getImageInfo(b[g],g),null,function(){delete b[g]})}e&&e.files&&e.files.forEach(function(g){var l=m.getContentType(g.name);l&&"image/"===l.substr(0,6)&&(b[c(g.name)]=h.base64DataToDataURL(g.data,l))});e=[];for(var a in b)e.push(d(a));return p(e)}}})},
"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/Parsers":function(){define(["esri/dijit/geoenrichment/Deferred","require"],function(r,p){var m={},h={},f;m.initialize=function(){if(f)return f.promise;f=new r;p("./DocumentParser ./ChartConverterPtoE ./InfographicConverterPtoE ./SectionParser ./FieldParser ./FilterParser ./SortingParser ../../../supportClasses/templateJsonUtils/fieldInfo/utils".split(" "),function(e,b,c,d,a,g,l,k){h.document=e;h.chart=b;h.infographic=
c;h.section=d;h.field=a;h.filter=g;h.sorting=l;k.init().then(f.resolve)});return f.promise};m.getParser=function(e){return h[e]};return m})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/PlayerVariableProvider":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/string","dojo/i18n!esri/nls/jsapi"],function(r,p,m,h){h=h.geoenrichment.dijit.ReportPlayer.Variables;var f=r(null,{variable:null,constructor:function(e){this.variable=e},calculate:function(e){return 0},
getCalcType:function(){return"n/"},getAliasWithType:function(){return this.variable.alias},getDescriptionWithType:function(){return this.variable.alias},getDecimals:function(){return this.variable.precision||0}});return r(null,{isPlayerOnly:!0,_fieldNameToVariableCache:null,_templateNameToVariableCache:null,constructor:function(e){this._templateNameToVariableCache=e&&e.templateNameToVariableCache||{};this._fieldNameToVariableCache={};for(var b in this._templateNameToVariableCache)e=this._templateNameToVariableCache[b],
this._fieldNameToVariableCache[e.fieldName]=e},get:function(e){return this._templateNameToVariableCache[e]||this._fieldNameToVariableCache[e]},toCalculator:function(e){return(e=this.get(e))&&new f(e)},addVariable:function(e){this._fieldNameToVariableCache[e.fieldName]=e;this._templateNameToVariableCache[e.templateName]=e},addScriptVariable:function(e){this._fieldNameToVariableCache[e.fieldName]=e;this._templateNameToVariableCache[e.templateName]=e},getVariables:function(){return Object.keys(this._fieldNameToVariableCache).map(function(e){return this._fieldNameToVariableCache[e]},
this)},getVariablesDataVintageDescription:function(e){var b={},c={},d={};this.getVariables().forEach(function(g){g.fullName&&(d[g.fullName.toLowerCase()]=g)});for(var a in e.usedVariablesCache)if(e=d[a.toLowerCase()])e.vintage&&(c[e.vintage]=1),e.source&&(b[e.source]=1);if(!Object.keys(b).length&&!Object.keys(c).length)return"";a=[];Object.keys(b).length&&a.push(m.substitute(h.sourcePattern,{source:Object.keys(b).join(", ")}));Object.keys(c).length&&a.push(m.substitute(h.vintagePattern,{vintage:Object.keys(c).join(", ")}));
return a.join(" ")},toJson:function(){return{templateNameToVariableCache:p.clone(this._templateNameToVariableCache)}}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DefaultStyles":function(){define(["dojo/_base/declare","dojo/_base/lang","esri/dijit/geoenrichment/utils/ColorUtil"],function(r,p,m){return r(null,{_styles:null,_stylesArray:null,constructor:function(h){this._styles={Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"}};p.mixin(this._styles,h);this._stylesArray=[];for(var f in this._styles)this._stylesArray.push(f)},
getStyle:function(h){return this._styles[h]},getStylesArray:function(){return this._stylesArray},tryApplyStyle:function(h,f,e){if(f=this.getStyle(f))for(var b in f)e&&void 0!==h[b]||(h[b]=f[b])},findDefaultStyle:function(h){var f,e=this;this.getStylesArray().some(function(b){var c=e.getStyle(b),d;for(d in c){if(!h[d])return!1;if("color"===d||"backgroundColor"===d){if(!m.colorsEqual(h[d],c[d]))return!1}else if(h[d]!==c[d])return!1}f=b;return!0});return f}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/images/ImageDataHolder":function(){define(["esri/dijit/geoenrichment/utils/CacheUtil"],
function(r){function p(){return r.get("ImageDataHolder.imageData")}function m(){return r.get("ImageDataHolder.fileNameToOriginal")}return{putImageData:function(h,f){if("string"===typeof h&&f){var e=h.toLowerCase();m()[e]=h;p()[e]=f}else console.error("Invalid image filename or data!")},getImageData:function(h){return"string"!==typeof h?null:p()[h.toLowerCase()]},findFileNameByData:function(h){var f=p(),e;for(e in f)if(h===f[e])return m()[e];return null}}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/conversion/CssParser":function(){define(["../PageBorderStyles",
"../ThemeUpdateUtil","../../../_devConfig"],function(r,p,m){var h={"font-size":"fontSize","font-family":"fontFamily","font-style":"fontStyle","font-weight":"fontWeight","text-decoration":"textDecoration",color:"color","background-color":"backgroundColor",opacity:"opacity",url:"data","background-position":"position","background-repeat":"repeat","background-size":"scale"},f={colors:1,colors3series:1};return{fromCssText:function(e){function b(n){var q=g;n.split("@").forEach(function(u){q=q[u]=q[u]||
{}});return q}function c(n,q){if(q.borderStyle||q.border)if(n.border={},n.border.style=r.toSupportedValue(q.borderStyle),"string"===typeof q.border){var u=q.border.split(" ");3===u.length&&(n.border.thickness=Number(u[0].replace("px","")),n.border.lineStyle=u[1],n.border.color=u[2])}for(var t in q)if("border"!==t&&"borderStyle"!==t){u=q[t];var v=t;var y=u,B=n;"font-size"===v?(B[h[v]]=d(y.replace("px","")),v=!0):"background-repeat"===v?(B[h[v]]=d("repeat"===y),v=!0):"background-size"===v?(B[h[v]]=
d("contain"===y||"cover"===y),B.size="auto"===y?null:y,v=!0):v=!1;v||(n[h[t]||t]=d(u))}}function d(n){if(void 0===n||null===n||"null"===n||"undefined"===n)return"";if("true"===n)return!0;if("false"===n)return!1;if(!0===n)return!0;if(!1===n)return!1;var q=Number(n);return isNaN(q)?n:q}function a(n){if(m.emulateErrors.themeParseError)throw Error("Error test: something crashed during the parsing of the theme!");if("object"===typeof n)for(var q in n){var u=n[q];if(f[q]){var t=[],v=Object.keys(u);if(v.length){var y=
v.every(function(B){return-1!==B.indexOf("_")});v.forEach(function(B,D){t[y?B.split("_")[1]:D]=u[B]})}n[q]=t}else a(u)}}var g={};e=e.replace(/\r?\n|\r/g,"");e=e.replace(/(\w|\d)_(\w|\d)/g,"$1@$2");e=e.replace("data:","dataM");e=e.replace(";base64","Mbase64");var l=function(){var n={};(e.match(/\..*?\}/g)||[]).forEach(function(q){var u=q.substring(1,q.indexOf("{")).trim(),t={};q.substring(q.indexOf("{")+1,q.indexOf("}")).trim().split(";").forEach(function(v){if(v=v.trim()){v=v.split(":");var y=v[1].trim();
y=y.replace("dataM","data:");y=y.replace("Mbase64",";base64");t[v[0].trim()]=y}});n[u]=t});return n}(),k;for(k in l)c(b(k),l[k]);delete g.themeMetadata;a(g);p.populateMissingStyles(g);return g}}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUpdateUtil":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/ObjectUtil","./ThemeLibrary","./ThemeUtil"],function(r,p,m,h){return{populateMissingStyles:function(f){if(f){f.table&&f.table.overrideStyles||(f.table={overrideStyles:r.mixin({},
f.table)});f.icon||(f.icon=r.clone(f.infographic.staticInfographic.icon),f.highlightedIcon=r.clone(f.infographic.staticInfographic.highlightedIcon));f.chart.icon||(f.chart.icon=r.clone(f.infographic.staticInfographic.icon));f.chart.xAxis.lineColor||(f.chart.xAxis.lineColor=f.chart.xAxis.axisStyle.color,f.chart.yAxis.lineColor=f.chart.yAxis.axisStyle.color);var e=h.getThemeColors(f),b=f.chart.colors.slice(),c=f.chart.colors3series&&f.chart.colors3series.slice(),d=m.getDefaultTheme({defaultFontFamilty:f.document.fontFamily,
defaultFontSize:f.document.fontSize});h.applyThemeColorsToTheme({theme:d,colors:e,chartColors:b,colors3series:c});p.populateObject(f,d,!1)}}}})},"esri/dijit/geoenrichment/utils/async/AsyncQueue":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dijit/Destroyable ../DelayUtil".split(" "),function(r,p,m,h,f,e){var b=r(f,{_lastPromise:null,_isFinished:!1,_isDestroyed:!1,_lastDfd:null,_lastResult:null,constructor:function(c){p.mixin(this,
c)},add:function(c,d){d=d||{};var a=this;if(!this._isDestroyed){this._lastDfd||(this.onStarted(),this._lastDfd=new m);this._isFinished=!1;var g=function(){var k=function(){if(!a._isDestroyed)try{return"function"===typeof c?c():c}catch(q){return(new m).reject(q)}},n=0<=d.delayBefore?function(){return e.delay(k,d.delayBefore)}:k;return(0<=d.delayAfter?function(){return h(n(),function(q){return e.delay(function(){return q},d.delayAfter)})}:n)()};!this._lastPromise||this._lastPromise.isFulfilled()?this._lastPromise=
h(g()):this._lastPromise=h(this._lastPromise).then(g);var l=this._lastPromise;h(l,function(k){l!==a._lastPromise||a._isDestroyed||a._isFinished||l&&!l.isFulfilled()||(a._isFinished=!0,a._lastDfd.resolve(k),a._lastResult=k,a._lastDfd=null,a.onFinished(k))},this._lastDfd.reject);return this.getPromise()}},getPromise:function(){return this._isDestroyed?null:this._lastDfd&&this._lastDfd.promise||this._lastResult},isFinished:function(){return this._isFinished},isDestroyed:function(){return this._isDestroyed},
destroy:function(){this._isDestroyed=!0},onStarted:function(){},onFinished:function(c){}});b.executeFunctions=function(c,d,a){a=a||{};var g=new b,l=[];c.forEach(function(k,n){g.add(function(){return h(k(),function(q){l.push(q);return q})},{delayBefore:0===n?void 0:d})});a.onQueueReady&&a.onQueueReady(g);return h(g.getPromise(),function(k){return a.collectResults?l:k})};b.processArrayInBatches=function(c,d){function a(){if(c.length){for(var l=[],k=0;k<d.batchSize&&c.length;k++)l.push(c.shift());d.processBatch?
d.callback(l):l.forEach(d.callback);setTimeout(a,d.timeout||0)}else g.resolve()}c=c.slice();var g=new m;a();return g.promise};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/WebMapJsonUtil":function(){define([],function(){return{processWebMapJson:function(r,p){function m(f,e,b){f=f.featureCollection.layers[0].featureSet.features[0];f.attributes=f.attributes||{};f.attributes[e]=b}var h=JSON.parse(p);h.operationalLayers.forEach(function(f){var e=f.featureCollection&&f.featureCollection.layers&&
1===f.featureCollection.layers.length?f.featureCollection.layers[0].id:void 0;"string"===typeof e&&0===e.indexOf("SiteLayer")?(f.isSiteLayer=!0,(e=0===e.indexOf("SiteLayer.")?e.replace("SiteLayer.",""):void 0)&&m(f,"STORE_ID",e)):"string"===typeof e&&0===e.indexOf("StudyAreasLayer.")?(f.isSiteLayer=!0,m(f,"AREA_ID",e.replace("StudyAreasLayer.",""))):"string"===typeof e&&0===e.indexOf("LocatorResultsLayer.")?(f.isLocatorLayer=!0,f.calculatorName=e.replace("LocatorResultsLayer.","")):"string"===typeof e&&
0===e.indexOf("ComparisonResultsLayer.")?(f.isComparisonLayer=!0,f.calculatorName=e.replace("ComparisonResultsLayer.","")):f.isOtherLayer=!0});return{fileName:r,originalString:p,webMapJson:h}}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsStoreSerializer":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./AttributesUtil ./NotesUtil ./CustomAttachmentsStore esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),
function(r,p,m,h,f,e){return{getAttachmentsStoreJson:function(b,c){function d(u){if(c.noCache)return u;l=l||{};for(var t in l)if(l[t]===u)return t;t="image_"+g++;l[t]=u;return t}function a(){return p([c.saveImages&&b.getImages(),b.getAttributes(),b.getNotes()]).then(function(u){var t=u[0]||[],v=u[1]||[],y=u[2]||[];return p(t.map(function(B){return p([r(B.getThumbnail(),function(D){return e.ensureDataUrlForRemoveImage(D)}),r(B.getUrl(),function(D){return e.ensureDataUrlForRemoveImage(D)})]).then(function(D){B.__thumbnail=
d(D[0]);B.__url=d(D[1])})})).then(function(){return{images:t.map(function(B){var D=B.__thumbnail,E=B.__url;delete B.__thumbnail;delete B.__url;return{description:B.description,thumbnail:D,url:E,filename:B.filename,imageViewType:B.imageViewType}}),attributes:v.map(function(B){return m.attributeToJson(B)}),notes:y.map(function(B){return h.noteToJson(B)})}})})}if(!b)return null;var g=0,l,k=[],n=[];if(b.supportsMultipleAreas)for(var q=0;q<c.numAreas;q++)b.setCurrentAnalysisAreaIndex(q),n.push(r(a(),function(u){k.push(u)}));
else n.push(r(a(),function(u){k.push(u)}));return p(n).then(function(){return{supportsMultipleAreas:b.supportsMultipleAreas,areaAttachments:k,imageDataCache:l}})},getAttachmentsStoreFromJson:function(b){return b&&new f(b)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/NotesUtil":function(){define([],function(){return{noteToJson:function(r){return{text:r.text}},noteFromJson:function(r){return{text:r.text}}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/CustomAttachmentsStore":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/when"],function(r,p){var m={fromJson:function(h){function f(e){return h.imageDataCache&&h.imageDataCache[e]||e}h.areaAttachments=h.areaAttachments||h.areaAttachements;delete h.areaAttachements;return{getImagesForAreaAt:function(e){e=h.supportsMultipleAreas?e:0;return(h.areaAttachments[e]&&(h.areaAttachments[e].images||h.areaAttachments[e].attachments)||[]).map(function(b){return{description:b.description,filename:b.filename,imageViewType:b.imageViewType,getThumbnail:function(){return f(b.thumbnail)},
getUrl:function(){return f(b.url)}}})},getAttributesForAreaAt:function(e){e=h.supportsMultipleAreas?e:0;return h.areaAttachments[e]&&h.areaAttachments[e].attributes||[]},getNotesForAreaAt:function(e){e=h.supportsMultipleAreas?e:0;return h.areaAttachments[e]&&h.areaAttachments[e].notes||[]}}}};return r(null,{supportsMultipleAreas:!1,_currentAreaIndex:0,_provider:null,constructor:function(h){(this._provider=h.getAttachmentsForAreaAt||h.getImagesForAreaAt||h.getAttributesForAreaAt||h.getNotesForAreaAt?
h:m.fromJson(h))&&this._provider.getAttachmentsForAreaAt&&(h.getImagesForAreaAt=function(f){return h.getAttachmentsForAreaAt(f)});this.supportsMultipleAreas=h.supportsMultipleAreas},initialize:function(){},getImages:function(){function h(e){e.forEach(function(b){!b.getUrl&&b.getAttachmentUrl&&(b.getUrl=function(){return b.getAttachmentUrl()})})}var f=this._provider.getImagesForAreaAt?this._provider.getImagesForAreaAt(this._currentAreaIndex):[];return f?Array.isArray(f)?(h(f),f):p(f,function(e){h(e);
return e}):f},getAttributes:function(){return this._provider.getAttributesForAreaAt?this._provider.getAttributesForAreaAt(this._currentAreaIndex):[]},getNotes:function(){return this._provider.getNotesForAreaAt?this._provider.getNotesForAreaAt(this._currentAreaIndex):[]},setCurrentAnalysisAreaIndex:function(h){this._currentAreaIndex=h}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonSerializer":function(){define(["./query/TemplateJsonQueryUtil","../images/ImageDataHolder",
"../conditionalStyling/ConditionalStyleUtil"],function(r,p,m){return{serialize:function(h){this._attachImagesToTemplateJson(h);return h},_attachImagesToTemplateJson:function(h){function f(b){var c=p.getImageData(b);c&&(e[b]=c)}var e={};r.processTemplateFieldInfos(h,function(b){b.isImage?(f(b.imageJson.fileName),b.triggerJson&&m.collectImageFileNames(b.triggerJson).forEach(f)):b.isInfographic&&b.infographicJson.variableTables&&b.infographicJson.variableTables.forEach(function(c){c.image&&f(c.image.imageJson.fileName)})});
r.processSectionElements(h,function(b){"img"===b.id&&f(b.fileName)});h.imageData=e},deserialize:function(h){this._takeImagesFromTemplateJson(h);return h},_takeImagesFromTemplateJson:function(h){for(var f in h.imageData)p.putImageData(f,h.imageData[f]);delete h.imageData}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/conditionalStyling/ConditionalStyleUtil":function(){define(["esri/dijit/geoenrichment/utils/PageUnitsConverter"],function(r){var p={},m={FontSize:"fontSize",FontColor:"fontColor",
FontFamily:"fontFamily",ForeColor:"color",BackColor:"backgroundColor"},h={},f;for(f in m)h[m[f]]=f;p.getConditionalStyle=function(b,c){return(b=p.getMatchedCase(b,c))?p.styleFromSetters(b.setters):null};p.getMatchedCase=function(b,c){if(null!==b&&""!==b&&(b=Number(b),c&&!isNaN(b))){var d;c.cases.some(function(a){if(p._checkValueMatchesCase(b,a))return d=a,!0});return d}};p._checkValueMatchesCase=function(b,c){function d(a,g,l){switch(g){case "\x3d":return a===l;case "\x3c":return a<l;case "\x3e":return a>
l;case "\x3c\x3d":return a<=l;case "\x3e\x3d":return a>=l}return!1}return c.compareInfos.length&&c.compareInfos.every(function(a){return d(b,a.operator,Number(a.value))})};p.styleFromSetters=function(b){if(!b)return null;var c={};b.forEach(function(d){m[d.property]&&(c[m[d.property]]=d.value);"IsBold"===d.property&&(c.fontWeight="True"===d.value?"bold":"normal");"IsItalic"===d.property&&(c.fontStyle="True"===d.value?"italic":"normal");"IsUnderlined"===d.property&&(c.textDecoration="True"===d.value?
"underline":"none")});r.ptToPxObj(c);return c};p.settersFromStyle=function(b){var c=[];b=r.pxToPtObj(b,!0);for(var d in b){var a=h[d],g=b[d];!a||"string"!==typeof g&&isNaN(g)||c.push({property:a,value:g});"fontWeight"===d?c.push({property:"IsBold",value:"bold"===g?"True":"False"}):"fontStyle"===d?c.push({property:"IsItalic",value:"italic"===g?"True":"False"}):"textDecoration"===d&&c.push({property:"IsUnderlined",value:"underline"===g?"True":"False"})}return c};p.processImageJsonForTrigger=function(b,
c,d){var a=p.getMatchedCase(c,d);a||d.cases.some(function(g){if("default"===g.compareInfos[0].value)return a=g,!0});a&&(b.fileName=a.setters[0].value)};p.getStatistics=function(b){var c=Infinity,d=-Infinity,a,g,l;b&&b.cases.forEach(function(k){k.compareInfos&&k.compareInfos.forEach(function(n){var q=Number(n.value);isNaN(q)||(q<c&&(c=q,g="\x3c"===n.operator||"\x3c\x3d"===n.operator),q>d&&(d=q,l="\x3e"===n.operator||"\x3e\x3d"===n.operator),a=!0)})});return a&&-1E12<c&&1E12>c&&-1E12<d&&1E12>d?{min:c,
max:d,canFallBelowMin:g,canFallAboveMax:l}:null};var e=/\.png$/i;p.collectImageFileNames=function(b){var c=[];b&&b.cases&&b.cases.forEach(function(d){d.setters&&d.setters.forEach(function(a){"Source"===a.property&&e.test(a.value)&&c.push(a.value)})});return c};return p})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/MetadataFromDataBuilder":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./map/RendererToMetadataConverter"],function(r,p){var m=
{},h={STORE_ID:1,AREA_ID:1,StdGeographyName:1,StdGeographyID:1,StdGeographyLevel:1};m.recoverMetadataFromAreaData=function(f,e){f=f[0];var b={name:"DataCollection",tags:[{name:"Calculators",tags:[]}]},c={},d;for(d in f){var a=f[d].data,g=f[d].comparisonLevels,l=e.map[d],k=!!l;l=k&&"object"===typeof l&&l.webMapJson||null;var n=e.locator[d];n={name:k?"Maps":n?"Locator":"DataCollections",attributes:{Name:d},tags:[]};b.tags[0].tags.push(n);var q=[];if(k)for(var u in a){if(!h[u]){var t={name:"Map",attributes:{Name:u},
tags:[{name:"Layers",tags:[]}]};l&&l.operationalLayers.forEach(function(B){if(B.isLocatorLayer){var D={name:"LocatorResultsLayer",attributes:{CalculatorName:B.calculatorName},tags:[p.convertRendererJson(B.featureCollection.layers[0].layerDefinition.drawingInfo.renderer)]};c[B.calculatorName]=B.featureCollection.layers[0].title;t.tags[0].tags.push(D)}B.isComparisonLayer&&(D=B.featureCollection.layers[0].layerDefinition.drawingInfo,B={name:"ComparisonResultsLayer",attributes:{CalculatorName:B.calculatorName},
tags:[p.convertRendererJson(D.renderer)]},D.labelingInfo&&B.tags.push(p.convertLabelingInfo(D.labelingInfo)),t.tags[0].tags.push(B))});q.push(t)}}else for(u in a)q.push({name:"Field",attributes:{Name:u,Alias:u,MapTo:"DC."+u,Type:"number"===typeof a[u]?"Double":"String"}});n.tags.push({name:"Fields",tags:q});if(g&&g.length){var v=[],y={};g.forEach(function(B){B.StdGeographyLevel&&!y[B.StdGeographyLevel]&&(y[B.StdGeographyLevel]=1,v.push(B.StdGeographyLevel))});v.length&&n.tags.push({name:"ComparisonLevels",
tags:v.map(function(B){return{name:"ComparisonLevel",attributes:{Name:B}}})})}}b.tags[0].tags.forEach(function(B){if("Locator"===B.name){var D=c[B.attributes.Name];D&&(B.attributes.LayerName=D)}});return r.parseJson(b)};return m})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/RendererToMetadataConverter":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/JsonXmlTypedConverter","esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(r,
p,m){var h={convertRendererJson:function(f){switch(f.type){case "simple":"esriPMS"===f.symbol.type&&(f=r.clone(f),delete f.symbol.url)}return m.parseXml(p.parseJson(f,{rootName:"Renderer"}))},convertLabelRendererJson:function(f){f=f.uniqueValueInfos.map(function(e){return{labelExpressionInfo:{expression:"$feature.StdGeographyName"},where:"StdGeographyLevel\x3d'"+e.value+"'",labelPlacement:"esriServerPolygonPlacementAlwaysHorizontal",symbol:e.symbol}});return h.convertLabelingInfo(f)},convertLabelingInfo:function(f){return m.parseXml(p.parseJson(f,
{rootName:"LabelingInfo"}))}};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/TemplateJsonLoader":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/utils/CacheUtil ./CustomReportsManager ./GenericTemplateGenerator ./dataCollections/DataCollectionsLoader ../../core/conversion/PortalToEditorConverter ../../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g){var l={_getCache:function(){return h.get("TemplateJsonLoader")},getCachedTemplateJsonPromise:function(k,n){k=k+";"+n.reportID;return(k=this._getCache()[k])&&k.modified===n.modified?k.promise.then(function(q){return{templateJson:r.clone(q.templateJson),templateVariableProvider:q.templateVariableProvider}}):null},putCachedTemplateJsonPromise:function(k,n,q){n=n+";"+q.reportID;this._getCache()[n]={modified:q.modified,promise:k}}};return{getTemplateJsonByID:function(k,
n){var q=this,u=new p;m(f.getCustomReportByID(k),function(t){if(t){var v=n&&l.getCachedTemplateJsonPromise(k.countryID,t);v?v.then(u.resolve,u.reject):(v=q._loadCustomReportData(t).then(function(){var y=new d;return m(c.provideEditorJson(t,{variableProvider:y}),function(){var B=t.templateJson;t.portalJson=null;t.templateJson=null;return{templateJson:B,templateVariableProvider:y}})}),n?(l.putCachedTemplateJsonPromise(v,k.countryID,t),l.getCachedTemplateJsonPromise(k.countryID,t).then(u.resolve,u.reject)):
v.then(u.resolve,u.reject))}else u.reject("Can't find a report")},u.reject);return u.promise},_loadCustomReportData:function(k){k.portalJson=null;return k.templateData.getFiles().then(function(n){k.portalJson={files:n}})},createTemplateJsonFromVariables:function(k){return b.loadVariables({countryID:k.countryID,outFields:["description","precision","type","vintage"],forceLowerCase:!0}).then(function(n){var q=new d,u=n.fullNameToVariableCache;n=k.variables.fullNames.map(function(t){var v=a.createFieldNameFromSource(t),
y=k.variables.customDataMapping[t];y=y?y.variable:u[t];t={id:y.id.toLowerCase(),fullName:t,alias:y.description,fieldName:v,precision:y.precision,calculatorName:a.DATA_COLLECTIONS_CALCULATOR_NAME,templateName:a.DATA_COLLECTIONS_CALCULATOR_NAME+"."+v,type:y.type,vintage:y.vintage};q.addVariable(t);return g.getCalculatorOrScriptFieldInfo(t.templateName,{variableProvider:q})});return{templateJson:e.generateTemplatesFromFieldInfos(n,{comparisonLevels:k.comparisonLevels}),templateVariableProvider:q}})}}})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GenericTemplateGenerator":function(){define("../../core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../../core/supportClasses/tableJson/TableJsonUtil ../../core/sections/sectionUtils/SectionJsonUtil ../../core/infographics/InfographicTypes ../../core/infographics/utils/InfographicJsonUtil".split(" "),function(r,p,m,h,f,e){var b={},c={calcNumRowsColumns:function(g){var l=
2>=g?1:6>=g?2:12>=g?3:Math.ceil(g/4);var k=1===g?1:4>=g?2:9>=g?3:4;return{numRows:l,numColumns:k,numVarsInLastRow:k-(l*k-g),lastRowCellIndexes:null,lastRowCellWidths:null}}},d={mergeLastRow:function(g,l,k){2===l.numColumns?1===l.numVarsInLastRow&&(m.modifyTableJson(g,l.numRows-1,0,{columnSpan:2}),l.lastRowCellWidths=[2*k]):3===l.numColumns?1===l.numVarsInLastRow?(m.modifyTableJson(g,l.numRows-1,0,{columnSpan:3}),l.lastRowCellWidths=[3*k]):2===l.numVarsInLastRow&&(m.modifyTableJson(g,l.numRows-1,0,
{cellStyle:{width:1.5*k}}),m.modifyTableJson(g,l.numRows-1,1,{columnSpan:2,cellStyle:{width:.5*k}}),l.lastRowCellWidths=[1.5*k,1.5*k]):4===l.numColumns&&(1===l.numVarsInLastRow?(m.modifyTableJson(g,l.numRows-1,0,{columnSpan:4}),l.lastRowCellWidths=[4*k]):2===l.numVarsInLastRow?(m.modifyTableJson(g,l.numRows-1,0,{columnSpan:2}),m.modifyTableJson(g,l.numRows-1,2,{columnSpan:2}),l.lastRowCellIndexes=[0,2],l.lastRowCellWidths=[2*k,2*k]):3===l.numVarsInLastRow&&(m.modifyTableJson(g,l.numRows-1,0,{cellStyle:{width:4*
k/3}}),m.modifyTableJson(g,l.numRows-1,1,{columnSpan:2,cellStyle:{width:2*k/3}}),m.modifyTableJson(g,l.numRows-1,2,{cellStyle:{width:2*k/3}}),m.modifyTableJson(g,l.numRows-1,3,{cellStyle:{width:4*k/3}}),l.lastRowCellIndexes=[0,1,3],l.lastRowCellWidths=[4*k/3,4*k/3,4*k/3]))}},a={insertNextPanel:function(g,l,k){void 0===l.currentRowIndex&&(l.currentRowIndex=0,l.currentColumnIndex=0);var n=l.currentRowIndex===l.numRows-1;g.data.data[l.currentRowIndex].fieldInfos["field"+(n&&l.lastRowCellIndexes?l.lastRowCellIndexes[l.currentColumnIndex]:
l.currentColumnIndex)]=k(n&&l.lastRowCellWidths&&l.lastRowCellWidths[l.currentColumnIndex]);l.currentColumnIndex++;l.currentColumnIndex>l.numColumns-1&&(l.currentColumnIndex=0,l.currentRowIndex++)}};b.generateTemplatesFromFieldInfos=function(g){var l=c.calcNumRowsColumns(g.length),k=r.createBlankTemplate({elementWidth:500,elementHeight:250,layout:{numRows:l.numRows,numColumns:l.numColumns}}),n=k.sectionsTables[0];d.mergeLastRow(n,l,500);g.forEach(function(q){a.insertNextPanel(n,l,function(u){var t=
b._createInfographicJson(q,u||500,250);u=m.createSingleCellTable({width:u||500,height:250,fieldInfo:p.createFieldInfoFromInfographic(t)});return p.createFieldInfoFromSection(h.wrapInDetailsSectionJson(u))})});return k};b._createInfographicJson=function(g,l,k){return{type:f.ONE_VAR,title:g.alias,style:{width:l,height:k},levels:e.getDefaultLevels(),fieldInfos:[g],calcData:{calculatorName:g.templateName.substr(0,g.templateName.indexOf(".")),variables:[g.fullName]}}};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions",
"./TemplateJsonModificationUtil"],function(r,p){return{createBlankTemplate:function(m){var h={},f=m.documentOptions||r.getDefaultDocumentOptionsGraphicReport();f.pagesize=r.combineCustomSizeString(f.left+f.right+m.layout.numColumns*m.elementWidth,f.top+f.bottom+m.layout.numRows*m.elementHeight,"px");h.documentOptions=f;f={style:{width:m.layout.numColumns*m.elementWidth},data:{columns:[],data:[]}};for(var e=0;e<m.layout.numColumns;e++)f.data.columns.push({field:"field"+e,style:{width:m.elementWidth}});
for(e=0;e<m.layout.numRows;e++)f.data.data.push({style:{height:m.elementHeight},fieldInfos:{}});h.sectionsTables=[f];p.adjustDocumentOptions(h);return h}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonModificationUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions","esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator"],function(r,p){var m={},h={getJsonStat:function(e){var b=0,c=
0,d=[];e.sectionsTables.forEach(function(a){var g=0;a.data.columns.forEach(function(k){g+=f.getFieldWidth(a,a.data.data[0],k)});b=Math.max(b,g);var l=0;a.data.data.forEach(function(k){l+=f.getDataHeight(a,k,a.data.columns[0])});c=Math.max(c,l);d.push({totalW:g,totalH:l})});return{tableInfos:d,totalWMax:b,totalHMax:c}}},f={getFieldWidth:function(e,b,c){return p.getFieldWidth({looseResize:!0},b,c)||c.style.width},getDataHeight:function(e,b,c){return p.getDataHeight({looseResize:!0},b,c.field)},getAverageFieldWidth:function(e,
b){var c=0;e.data.data.forEach(function(d){c+=f.getFieldWidth(e,d,b)});return c/e.data.data.length},getAverageDataHeight:function(e,b){var c=0;e.data.columns.forEach(function(d){c+=f.getDataHeight(e,b,d)});return c/e.data.columns.length}};m.adjustDocumentOptions=function(e){if(e.documentOptions){var b=h.getJsonStat(e);b.totalWMax&&b.totalHMax&&!isNaN(b.totalWMax)&&!isNaN(b.totalHMax)&&(e=e.documentOptions,e.pagesize=r.combineCustomSizeString(e.left+e.right+b.totalWMax,e.top+e.bottom+b.totalHMax,"px"),
(b=r.getClosestStandrdSizes(e)[0])&&.001>b.score&&b.orientation===e.orientation&&(e.pagesize=b.pagesize))}};m.JsonStatCollector=h;m.DataUtil=f;return m})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator":function(){define("dojo/_base/lang ./gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil ./gridLayoutCalcUtils/GridElementBoxCalculator ./gridLayoutCalcUtils/GridCellNodePlacer ./gridLayoutCalcUtils/rows/GridLayoutRowsCalculator ./gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator ./gridLayoutCalcUtils/GridLayoutSnapper ../../supportClasses/tableJson/TableJsonUtil".split(" "),
function(r,p,m,h,f,e,b,c){var d={};m.calculator=d;d.markAsDirty=p.markAsDirty;d.fieldToColumn=p.fieldToColumn;d.dataIdToData=p.dataIdToData;d.getSpannedColumns=p.getSpannedColumns;d.recalcRows=f.recalcRows;d.recalcColumns=e.recalcColumns;d.recalcColumnsTableJson=e.recalcColumnsTableJson;d.recalcRowsToFitHeight=f.recalcRowsToFitHeight;d.adjustColumnWidth=e.adjustColumnWidth;d.getAffectedCellsForColumnAdjust=e.getAffectedCells;d.adjustRowHeight=f.adjustRowHeight;d.getAffectedCellsForRowAdjust=f.getAffectedCells;
d.recalcGridWidth=e.recalcGridWidth;d.calcFieldWidth=e.calcFieldWidth;d.getFieldWidth=e.getFieldWidth;d.setFieldWidth=e.setFieldWidth;d.calcDataHeight=f.calcDataHeight;d.getDataHeight=f.getDataHeight;d.setDataHeight=f.setDataHeight;d.autoSnapLayout=b.autoSnapLayout;d.positionCells=h.positionCells;d.calcFeatureCount=function(a,g,l){return(a-g)/l};d.calcRingIndexForCell=function(a){var g=a.parentGrid;if(!g)return-1;if(g.getNumDynamicRows())return void 0!==a.gridData.currentFeatureIndex?a.gridData.currentFeatureIndex:
a.gridData.index-g.getNumFixedRows();var l=g.getNumFixedColumns();return a.column.index<l?-1:Math.floor((a.column.index-l)/g.getNumDynamicColumns())};d.trimColumnsForNumberOfFeatures=function(a){for(var g=a.viewModel.dynamicReportInfo.fieldData.areaData.length,l=d.recalcGridWidth(a),k=0,n=0;n<a.getNumFixedColumns();n++)k+=a.columns[n].style.width;l-=k;k=d.calcFeatureCount(a.columns.length,a.getNumFixedColumns(),a.getNumDynamicColumns())-g;if(!(0>k)){var q=a.columns.slice();n=q.length=a.getNumFixedColumns();
for(var u=[],t=0;a.columns[n];){for(var v=0;v<g;v++){var y=a.columns[n++];t+=y.style.width;u.push(y)}n+=k}var B=l/t;u.forEach(function(D){D.style.width*=B});a.columns=q.concat(u)}};d.adjustRowsForNumberOfFeatures=function(a){var g=a.viewModel.dynamicReportInfo.fieldData.areaData.length;if(!(1>=g)){var l=a.store.data[a.getNumFixedRows()];l.currentFeatureIndex=0;for(var k=1;k<g;k++){var n=r.clone(l);n.currentFeatureIndex=k;a.store.data.push(n)}c.applyDefaultStyling({data:{data:a.store.data,columns:a.columns}})}};
return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil":function(){define([],function(){var r={markAsDirty:function(p){p._fieldToColumnHash=null;p._dataIdToDataHash=null},_calcGridHashes:function(p){p._fieldToColumnHash={};p.columns.forEach(function(m){p._fieldToColumnHash[m.field]=m});p._dataIdToDataHash={};p.store.data.forEach(function(m){p._dataIdToDataHash[m.id]=m})},fieldToColumn:function(p,m){p._fieldToColumnHash||r._calcGridHashes(p);
return p._fieldToColumnHash&&p._fieldToColumnHash[m]},dataIdToData:function(p,m){p._dataIdToDataHash||r._calcGridHashes(p);return p._dataIdToDataHash&&p._dataIdToDataHash[m]},getSpannedColumns:function(p,m,h){var f=[];if(1>h)return[];var e;p.columns.some(function(b){if(e||b.field===m)f.push(b),e=!0;if(f.length===h)return!0});return f},getColumnSpannedFields:function(p,m,h){var f=null,e=m.fieldToRowSpanSourceDataIndex&&m.fieldToRowSpanSourceDataIndex[h];m=void 0!==e?p.store.data[e]:m;m=m.columnSpans&&
m.columnSpans[h];if(1<m)for(f=[],h=r.fieldToColumn(p,h),e=h=p.columns.indexOf(h);e<h+m;e++)f.push(p.columns[e].field);return f},getRowSpannedData:function(p,m,h){var f=null;h=m.fieldToColumnSpanSourceField&&m.fieldToColumnSpanSourceField[h]||h;h=m.rowSpans&&m.rowSpans[h];if(1<h){f=[];for(var e=m=p.store.data.indexOf(m);e<m+h;e++)f.push(p.store.data[e])}return f},getMovableData:function(p,m,h){return(m=m.movableIndexHashVertical&&m.movableIndexHashVertical[h])&&p.store.data[m]},getMovableColumn:function(p,
m,h){return(m=m.movableFieldsHashHorizontal&&m.movableFieldsHashHorizontal[h])&&r.fieldToColumn(p,m)}};return r})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridElementBoxCalculator":function(){define([],function(){function r(m,h,f,e,b){function c(n){return e&&void 0!==e.places?Number(n.toFixed(e.places)):n}if(!h||!f)return null;var d=p.calculator[b?"getFieldWidth":"calcFieldWidth"](m,h,f);b=p.calculator[b?"getDataHeight":"calcDataHeight"](m,h,f);for(var a=0,g=
0,l=p.calculator.fieldToColumn(m,f),k=0;k<l.index;k++)a+=p.calculator.getFieldWidth(m,h,m.columns[k].field);for(k=0;k<h.index;k++)g+=p.calculator.getDataHeight(m,m.store.data[k],f);return{x:c(a),y:c(g),w:c(d),h:c(b)}}var p={calculator:null,calcCellBox:function(m,h){return r(m.parentGrid,m.gridData,m.column.field,h,!1)},calcDataBox:function(m,h,f,e){return r(m,h,f,e,!0)}};return p})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridCellNodePlacer":function(){define(["./rows/GridLayoutRowsCalculator",
"./columns/GridLayoutColumnsCalculator"],function(r,p){return{positionCells:function(m){var h={},f={},e={},b={};if(m.store.data.length){m.store.data.forEach(function(g,l){m.columns.forEach(function(k,n){var q=e[n]||0,u=b[l]||0,t=r.getDataHeight(m,g,k.field);k=p.getFieldWidth(m,g,k.field);q+=t;u+=k;f[n+"_"+l]=q;h[n+"_"+l]=u;e[n]=q;b[l]=u})});m.getFieldCells().forEach(function(g){g.domNode.style.left=(h[g.column.index-1+"_"+g.gridData.index]||0)+"px";g.domNode.style.top=(f[g.column.index+"_"+(g.gridData.index-
1)]||0)+"px"});var c=0,d;for(d in e)c=Math.max(c,e[d]);var a=0;for(d in b)a=Math.max(a,b[d]);m.mainNode.style.width=a+"px";m.mainNode.style.height=c+"px";m.domNode.style.width=a+"px";m.domNode.style.height=c+"px";m._width=a;m._height=c}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/GridLayoutRowsCalculator":function(){define(["./RowsProcessor","./RowsScaler","./RowDataUtil","./RowModifier"],function(r,p,m,h){var f={};f.recalcRows=r.recalcRows;f.recalcRowsToFitHeight=
p.recalcRowsToFitHeight;f.adjustRowHeight=h.adjustRowHeight;f.getAffectedCells=h.getAffectedCells;f.getDataHeight=m.getDataHeight;f.setDataHeight=m.setDataHeight;f.calcDataHeight=m.calcDataHeight;return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./RowDataUtil","../GridLayoutCalculatorQueryUtil"],function(r,p,m){function h(e,b){var c=[],d,a=0;b&&Object.keys(b).forEach(function(g){m.fieldToColumn(e,
g)?a++:delete b[g]});a&&e.columns.some(function(g){if(d||b[g.field])c.push(g),d=!0;b[g.field]&&a--;if(!a)return!0});return c}function f(e,b){var c=[],d,a=0;b&&Object.keys(b).forEach(function(g){m.dataIdToData(e,g)?a++:delete b[g]});a&&e.store.data.some(function(g){if(d||b[g.id])c.push(g),d=!0;b[g.id]&&a--;if(!a)return!0});return c}return{recalcRows:function(e){var b={};e.columns.forEach(function(g,l){b[g.field]=l});var c;e.store.data.forEach(function(g,l){g.index=l;g.style=g.style||{};g.style.fields=
g.style.fields||{};void 0===g.id&&(g.id=r());void 0===g.style.height&&(g.style.height=e.layoutDefaults.defaultRowHeight);delete g.excludedIndexHorizontal;delete g.movableFieldsHashHorizontal;delete g.fieldToColumnSpanSourceField;if(g.columnSpans){g.excludedIndexHorizontal={};g.movableFieldsHashHorizontal={};g.fieldToColumnSpanSourceField={};g._columnSpans=g._columnSpans||{};for(c in g.columnSpans){l=g._columnSpans[c];var k={};l=l?h(e,l):m.getSpannedColumns(e,c,g.columnSpans[c]);1<l.length&&(l.forEach(function(q){k[q.field]=
!0;q.field!==c&&(g.excludedIndexHorizontal[b[q.field]]=!0,g.fieldToColumnSpanSourceField[q.field]=c)}),g.movableFieldsHashHorizontal[c]=l[l.length-1].field);g.columnSpans[c]=l.length;g._columnSpans[c]=k}var n=0;Object.keys(g.columnSpans).forEach(function(q){2>g.columnSpans[q]?(delete g.columnSpans[q],delete g._columnSpans[q]):n++});n||(delete g.columnSpans,delete g._columnSpans)}delete g.excludedIndexVertical;delete g.movableIndexHashVertical;delete g.fieldToRowSpanSourceDataIndex;g.fieldInfos=g.fieldInfos||
{}});e.store.data.forEach(function(g,l){if(g.rowSpans)for(c in g._rowSpans=g._rowSpans||{},g.rowSpans){var k=g._rowSpans[c],n={};n[g.id]=!0;var q=b[c],u=g.rowSpans[c];if(k)k=f(e,k);else{k=[];for(var t=l;t<l+u;t++)k.push(e.store.data[t])}1<k.length&&(k.forEach(function(v){if(v.id!==g.id){v.excludedIndexVertical=v.excludedIndexVertical||{};v.excludedIndexVertical[q]=!0;v.fieldToRowSpanSourceDataIndex=v.fieldToRowSpanSourceDataIndex||{};v.fieldToRowSpanSourceDataIndex[c]=g.index;var y=g.columnSpans&&
g.columnSpans[c];if(y)for(var B=1;B<y;B++)v.excludedIndexVertical[q+B]=!0,v.fieldToRowSpanSourceDataIndex[e.columns[q+B].field]=g.index}n[v.id]=!0}),g.movableIndexHashVertical=g.movableIndexHashVertical||{},g.movableIndexHashVertical[c]=l+k.length-1);g.rowSpans[c]=k.length;g._rowSpans[c]=n}});e.store.data.forEach(function(g,l){if(g.rowSpans){for(c in g.rowSpans)g.rowSpans[c]=Math.min(g.rowSpans[c],e.store.data.length-l);var k=0;Object.keys(g.rowSpans).forEach(function(n){2>g.rowSpans[n]?(delete g.rowSpans[n],
g._rowSpans&&delete g._rowSpans[n]):k++});k||(delete g.rowSpans,delete g._rowSpans)}});e.store.data.forEach(function(g,l){g.fieldInfos&&Object.keys(g.fieldInfos).forEach(function(k){void 0===b[k]&&delete g.fieldInfos[k]});g.style&&g.style.fields&&Object.keys(g.style.fields).forEach(function(k){void 0===b[k]&&delete g.style.fields[k]})});if(e.looseResize){e.store.data.forEach(function(g){e.columns.some(function(l){p.getDataHeightOwn(e,g,l.field)||p.setDataHeight(e,g,l.field,g.style.height)})});var d=
e.store.data[e.store.data.length-1],a=p.recalcGridHeight(e);e.columns.some(function(g){var l=0;e.store.data.forEach(function(n){l+=p.getDataHeightOwn(e,n,g.field)});var k=a-l;0!==k&&p.setDataHeight(e,d,g.field,p.getDataHeightOwn(e,d,g.field)+k)})}p.recalcGridHeight(e)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(r){var p={getDataHeight:function(m,h,f){return m.looseResize?p.getDataHeightOwn(m,
h,f)||h.style.height||0:h.style.height||0},getDataHeightOwn:function(m,h,f){if(m.looseResize)return h.style.fields=h.style.fields||{},(h.style.fields[f]=h.style.fields[f]||{}).height},setDataHeight:function(m,h,f,e,b){m.looseResize?(b?r.getColumnSpannedFields(m,h,f)||[f]:[f]).forEach(function(c){h.style.fields=h.style.fields||{};(h.style.fields[c]=h.style.fields[c]||{}).height=e}):h.style.height=e},calcDataHeight:function(m,h,f,e){var b=0,c=h.rowSpans&&h.rowSpans[f];if(1<c)for(var d=h.index;d<h.index+
c;d++)d!==e&&(b+=p.getDataHeight(m,m.store.data[d],f));else b=p.getDataHeight(m,h,f);return b},recalcGridHeight:function(m){m._height=0;var h=m.columns[0].field;m.store.data.forEach(function(f){m._height+=p.getDataHeight(m,f,h)});return m._height}};return p})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsScaler":function(){define(["./RowDataUtil"],function(r){return{recalcRowsToFitHeight:function(p,m){function h(b){b.forEach(function(c){p.columns.some(function(d,
a){if(!p.looseResize&&a)return!0;r.setDataHeight(p,c,d.field,r.getDataHeight(p,c,d.field)*e)})})}var f=r.recalcGridHeight(p),e=m/f;1!==e&&(h(p.store.data),p._getSavedOriginalData()&&h(p._getSavedOriginalData()),r.recalcGridHeight(p))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowModifier":function(){define(["../GridLayoutCalculatorQueryUtil","./RowDataUtil","./_RowModifierLoose","./_RowModifierNormal"],function(r,p,m,h){var f={},e={checkHeightLimit:function(d,
a,g,l){if(d.getMaxHeight()){var k=0;d.store.data.forEach(function(n){n!==a&&(k+=p.getDataHeight(d,n,g))});l=Math.min(d.getMaxHeight()-k,l)}return l}},b={findDataToMove:function(d,a,g,l){var k=r.getMovableData(d,a,g);k&&(d=p.calcDataHeight(d,a,g,k.index),l-=d);return{data:k||a,height:l}}},c={finalResizeGridCells:function(d){d.getFieldCells().forEach(function(a){a.setHeight(p.calcDataHeight(d,a.gridData,a.column.field))})}};f.adjustRowHeight=function(d,a,g,l){l=e.checkHeightLimit(d,a,g,l);a=b.findDataToMove(d,
a,g,l);(d.looseResize?m:h).adjustRowHeight(d,a.data,g,a.height);c.finalResizeGridCells(d)};f.getAffectedCells=function(d,a,g){return d.looseResize?m.getAffectedCells(d,b.findDataToMove(d,a,g).data,g):null};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./RowDataUtil ../../GridQueryUtil".split(" "),function(r,
p,m,h,f,e){var b={collectRowBoxes:function(g,l){for(var k=[],n=0;n<g.columns.length;){var q=g.columns[n],u=this._createEmptyBox();q=m.getColumnSpannedFields(g,l,q.field)||[q.field];u.elements=this._getFieldsElements(g,l,q);this._measureBox(u);var t=k[k.length-1];t&&(t.nextSibling=u,u.prevSibling=t);k.push(u);n+=q.length}return k},_createEmptyBox:function(){return{id:p(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getFieldsElements:function(g,
l,k){var n=[];k.forEach(function(q){q={data:l,dataIndex:l.index,field:q,box:h.calcDataBox(g,l,q,{places:2})};n.push(q)});return n},_measureBox:function(g){var l=0;g.elements.forEach(function(k){l+=k.box.w});g.box={x:g.elements[0].box.x,y:g.elements[0].box.y,h:g.elements[0].box.h,w:l}},mergeBoxesForBottomRow:function(g){var l=this._createEmptyBox();g.forEach(function(k){k.elements.forEach(function(n){l.elements.push({data:null,field:n.field,box:r.clone(n.box)})})});this._measureBox(l);l.box.h=1E6;
return[l]},getBoxAtField:function(g,l){return g.filter(function(k){return k.elements[0].field===l})[0]}},c={buildInfluenceTree:function(g,l,k){function n(q,u){(u?l:g).forEach(function(t){var v;if(v=!t.overlappingBoxesCache[q.id]){v=q.box;var y=t.box;v=!(v.x+.5>=y.x+y.w||v.x+v.w<=y.x+.5)}v&&(q.overlappingBoxes.push(t),q.overlappingBoxesCache[t.id]=!0)});q.overlappingBoxes.forEach(function(t){n(t,!u)})}k=b.getBoxAtField(g,k);n(k,!0);return k}},d={applyForce:function(g,l,k){function n(u,t){var v=u.elements[0];
v.data&&f.setDataHeight(g,v.data,v.field,f.getDataHeight(g,v.data,v.field)+(t?-1:1)*q,!0);u.overlappingBoxes.forEach(function(y){n(y,!t)})}var q=this._checkDelta(g,l,k);n(l,!1)},_checkDelta:function(g,l,k){function n(t,v){0!==u&&(v?0>u||(u=Math.min(u,t.box.h-q),t.prevSibling&&(u=Math.min(u,t.prevSibling.box.y+t.prevSibling.box.h-q-t.box.y)),t.nextSibling&&(u=Math.min(u,t.nextSibling.box.y+t.nextSibling.box.h-q-t.box.y))):0<u||(u=Math.max(u,-(t.box.h-q)),t.prevSibling&&(u=Math.max(u,-(t.box.y+t.box.h-
(t.prevSibling.box.y+q)))),t.nextSibling&&(u=Math.max(u,-(t.box.y+t.box.h-(t.nextSibling.box.y+q))))),t.overlappingBoxes.forEach(function(y){n(y,!v)}))}var q=g.layoutDefaults.rowMinHeight;k=Math.max(k,q);var u=k-l.box.h;n(l,!1);return u}},a={_getInluencedStartBox:function(g,l,k){var n=g.store.data[l.index+1];l=b.collectRowBoxes(g,l);g=n?b.collectRowBoxes(g,n):b.mergeBoxesForBottomRow(l);return c.buildInfluenceTree(l,g,k)},getAffectedCells:function(g,l,k){function n(u){if(u.elements[0].data){var t=
e.querySingleCell(g,{rowIndex:u.elements[0].data.index,columnField:u.elements[0].field,considerSpans:!0});t&&q.push(t)}u.overlappingBoxes.forEach(n)}var q=[];l=this._getInluencedStartBox(g,l,k);n(l);return q},adjustRowCell:function(g,l,k,n){l=this._getInluencedStartBox(g,l,k);d.applyForce(g,l,n)}};return{adjustRowHeight:function(g,l,k,n){a.adjustRowCell(g,l,k,n)},getAffectedCells:function(g,l,k){return a.getAffectedCells(g,l,k)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridQueryUtil":function(){define(["dojo/dom-geometry",
"./GridDataUtil","esri/dijit/geoenrichment/utils/ArrayUtil","esri/dijit/geoenrichment/utils/DomUtil","esri/dijit/geoenrichment/utils/MouseUtil"],function(r,p,m,h,f){var e={querySingleCell:function(b,c){c.fieldCell&&(c={rowId:c.fieldCell.rowId,columnId:c.fieldCell.columnId});var d;b.getFieldCells().some(function(n){if(n.parentGrid&&n.column&&n.gridData&&!(n.columnId!==c.columnId&&n.column.index!==c.columnIndex&&n.column.field!==c.columnField||n.rowId!==c.rowId&&n.gridData.index!==c.rowIndex))return d=
n,!0});if(d)return d;if(c.considerSpans){var a=e.queryColumn(b,c),g=e.queryData(b,c);if(!a||!g)return null;var l=a.index,k=g.index;b.store.data.some(function(n){return b.columns.some(function(q){var u=q.index,t=q.index+(n.columnSpans&&n.columnSpans[q.field]||0),v=n.index;q=n.index+(n.rowSpans&&n.rowSpans[q.field]||0);if(u<=l&&t>=l&&v<=k&&q>=k)return d=e.querySingleCell(b,{columnIndex:u,rowIndex:v}),!0})})}return d},queryColumn:function(b,c){var d;b.columns.some(function(a){if(a.id===c.columnId||a.index===
c.columnIndex||a.field===c.columnField)return d=a,!0});return d},queryData:function(b,c){var d;b.store.data.some(function(a){if(a.id===c.rowId||a.index===c.rowIndex)return d=a,!0});return d},queryCells:function(b,c){if(c.fieldCell){var d=[],a=c.rowSpan||1,g=c.columnSpan||1;if(c=e.querySingleCell(b,c))for(var l=c.gridData.index;l<c.gridData.index+a;l++)for(var k=c.column.index;k<c.column.index+g;k++){var n=e.querySingleCell(b,{rowIndex:l,columnIndex:k});n&&d.push(n)}return d}return this.queryCellsInArray(b.getFieldCells(),
c)},queryCellsInArray:function(b,c){var d=[];if(!Object.keys(c).length)return d;b.forEach(function(a,g){void 0!==c.cellIndex&&g!==c.cellIndex||void 0!==c.cellIndexes&&-1===c.cellIndexes.indexOf(g)||void 0!==c.columnId&&a.columnId!==c.columnId||void 0!==c.columnIds&&-1===c.columnIds.indexOf(a.columnId)||void 0!==c.columnIndex&&a.column.index!==c.columnIndex||void 0!==c.columnIndexes&&-1===c.columnIndexes.indexOf(a.column.index)||void 0!==c.columnField&&a.column.field!==c.columnField||void 0!==c.columnFields&&
-1===c.columnFields.indexOf(a.column.field)||void 0!==c.rowId&&a.rowId!==c.rowId||void 0!==c.rowIds&&-1===c.rowIds.indexOf(a.rowId)||void 0!==c.rowIndex&&a.gridData.index!==c.rowIndex||void 0!==c.rowIndexes&&-1===c.rowIndexes.indexOf(a.gridData.index)||d.push(a)});return d},getTitleCell:function(b){var c=e.querySingleCell(b,{rowIndex:0,columnIndex:0});if(c&&!p.getFieldInfo(c)&&(1===b.columns.length||p.getColumnSpan(c)===b.columns.length))return c},isDynamicFieldCell:function(b,c){return b._dynamicBindings&&
b._dynamicBindings[c.column.field]},getDynamicallyBoundColumns:function(b,c){return b._dynamicBindings&&b._dynamicBindings[c.field]},getDynamicallyBoundFieldCells:function(b,c){if(c.column){var d=b._dynamicBindings&&b._dynamicBindings[c.column.field];if(!d)return null;var a=[];d.forEach(function(g){(g=g&&e.querySingleCell(b,{columnId:g.id,rowId:c.rowId}))&&a.push(g)});return a}},getAllBoundCells:function(b,c,d){var a=[],g={};c&&c.forEach(function(l){if((!d||d(l))&&!g[l.uniqueId]){g[l.uniqueId]=!0;
var k=e.getDynamicallyBoundFieldCells(b,l);k?k.forEach(function(n){a.push(n);g[n.uniqueId]=!0}):a.push(l)}});return m.removeDuplicates(a,"uniqueId")},trimDynamicBindings:function(b,c){var d=[],a={};c&&c.forEach(function(g){var l=e.getDynamicallyBoundFieldCells(b,g);l&&l.length?(a[l[0].uniqueId]||d.push(l[0]),l.forEach(function(k){a[k.uniqueId]=!0})):d.push(g)});return d},collectFieldInfos:function(b,c){var d=[];c=c||{};var a=c.fieldCells||b.getFieldCells();c.trimDynamicBinding&&a&&(a=e.trimDynamicBindings(b,
a));a&&a.forEach(function(g){(g=p.getFieldInfo(g))&&d.push(g)});return d},cellHasFloatingTableParent:function(b){function c(d){return d.isSection&&d.isDataDrillingView?!1:d.isFloatingTable?!0:d.parentWidget?c(d.parentWidget):!1}return b&&b.parentGrid?c(b.parentGrid):!1},isMouseOver:function(b){return f.isMouseOverBox(e.getBBox(b))},getOverFieldCell:function(b,c){c=c||{};var d=c.cellFilter||function(){return!0},a;b.getForegroundFloatingCells({topFirst:!0}).some(function(g){if(d(g)&&g.isMouseOver())return a=
g,!0});a||b.getFieldCells().some(function(g){if(d(g)&&g.isMouseOver())return a=g,!0});a||b.getBackgroundFloatingCells({topFirst:!0}).some(function(g){if(d(g)&&g.isMouseOver())return a=g,!0});return a},getBBox:function(b,c){var d=b.isSingleCelledTable()&&b.getFirstCell().getAngle();return"number"===typeof d&&0!==d?b.getFirstCell().getBBox(c):c&&c.noTransformation?h.noTransformPosition(b.domNode):r.position(b.domNode)}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierNormal":function(){define(["./RowDataUtil"],
function(r){return{adjustRowHeight:function(p,m,h,f){var e=p.layoutDefaults.rowMinHeight;f=Math.max(f,e);var b=f-r.getDataHeight(p,m,h);if(p.keepGridHeightWhenResized){var c=p.store.data[m.index+1];c&&(b=r.getDataHeight(p,c,h)-b,b<e&&(f-=e-b,b=e),r.setDataHeight(p,c,h,b,!0))}r.setDataHeight(p,m,h,f,!0)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator":function(){define(["./ColumnDataUtil","./ColumnModifier","./ColumnsProcessor"],
function(r,p,m){var h={};h.recalcColumns=m.recalcColumns;h.recalcColumnsTableJson=m.recalcColumnsTableJson;h.adjustColumnWidth=p.adjustColumnWidth;h.getAffectedCells=p.getAffectedCells;h.getFieldWidth=r.getFieldWidth;h.setFieldWidth=r.setFieldWidth;h.calcFieldWidth=r.calcFieldWidth;h.recalcGridWidth=r.recalcGridWidth;return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(r){var p=
{getFieldWidth:function(m,h,f){var e="string"===typeof f?r.fieldToColumn(m,f):f;f=e?e.field:"string"===typeof f?f:null;return m.looseResize?p.getFieldWidthOwn(m,h,f)||e&&e.style.width||0:e&&e.style.width||0},getFieldWidthOwn:function(m,h,f){if(m.looseResize)return h.style.fields=h.style.fields||{},(h.style.fields[f]=h.style.fields[f]||{}).width},setFieldWidth:function(m,h,f,e,b){var c="string"===typeof f?r.fieldToColumn(m,f):f,d=c?c.field:"string"===typeof f?f:null;m.looseResize?(b?r.getRowSpannedData(m,
h,d)||[h]:[h]).forEach(function(a){a.style.fields=a.style.fields||{};(a.style.fields[d]=a.style.fields[d]||{}).width=e}):c&&(c.style.width=e)},calcFieldWidth:function(m,h,f,e){var b=0;1<(h.columnSpans&&h.columnSpans[f])?r.getSpannedColumns(m,f,h.columnSpans[f]).forEach(function(c){e!==c.field&&(b+=p.getFieldWidth(m,h,c.field))}):b=p.getFieldWidth(m,h,f);return b},recalcGridWidth:function(m){m._width=0;var h=m.store.data[0];m.columns.forEach(function(f){m._width+=p.getFieldWidth(m,h,f.field)});return m._width},
getAllowedWidth:function(m){return m.fitParentWhenResized?m.getAllowedWidthFromParent():m.getAllowedWidth()}};return p})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnModifier":function(){define(["../GridLayoutCalculatorQueryUtil","./ColumnDataUtil","./_ColumnModifierNormal","./_ColumnModifierLoose"],function(r,p,m,h){var f={},e={getColumnToChange:function(d,a,g,l){var k=r.getMovableColumn(d,a,g.field);k&&(d=p.calcFieldWidth(d,a,g.field,k.field),l-=
d);return{column:k||g,width:l}}},b={finalResizeGridCells:function(d){d.getFieldCells().forEach(function(a){a.setWidth(p.calcFieldWidth(d,a.gridData,a.column.field))});p.recalcGridWidth(d)}},c={recalcToStick:function(d){var a=d.columns[d.columns.length-1];d.store.data.some(function(g,l){if(!d.looseResize&&l)return!0;var k=0;d.columns.forEach(function(n){n!==a&&(k+=p.getFieldWidth(d,g,n.field))});p.setFieldWidth(d,g,a.field,p.getAllowedWidth(d)-k)})}};f.adjustColumnWidth=function(d,a,g,l){g=e.getColumnToChange(d,
a,g,l);(d.looseResize?h:m).adjustColumnWidth(d,a,g.column,g.width);d.stickToRight&&c.recalcToStick(d);b.finalResizeGridCells(d)};f.getAffectedCells=function(d,a,g){return d.looseResize?h.getAffectedCells(d,a,e.getColumnToChange(d,a,g).column):null};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierNormal":function(){define(["./ColumnDataUtil"],function(r){var p={},m={adjustColumnWidth:function(h,f,e,b,c){function d(u,t){return r.setFieldWidth(h,
f,u.field,t,!0)}var a=h.layoutDefaults.columnMinWidth,g=function(){if(!e)return null;var u=r.getFieldWidth(h,f,e.field);void 0!==c&&(b=u+c);b=Math.max(a,b);var t,v=0,y=!1;h.columns.forEach(function(D){v+=r.getFieldWidth(h,f,D.field);y&&!t?t=D:D===e&&(y=!0)});var B=r.getAllowedWidth(h)-(v-u);return isNaN(B)?null:{width:b,widthMemo:u,maxAllowedColumnWidth:B,nextColumn:t}}();if(g){b=g.width;var l=g.widthMemo,k=g.maxAllowedColumnWidth,n=(g=g.nextColumn)&&r.getFieldWidth(h,f,g.field);l=b-l;var q=0;h.keepGridWidthWhenResized?
(g&&(l=n-l,l<a&&(b-=a-l,l=a),l<n&&(k+=n-l),d(g,l)),d(e,Math.min(k,b))):(g&&k<b&&n>a?(d(e,b),q=k-b):d(e,Math.min(k,b)),0!==q&&m.adjustColumnWidth(h,f,g,null,q))}}};p.adjustColumnWidth=function(h,f,e,b){m.adjustColumnWidth(h,f,e,b)};return p})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./ColumnDataUtil ../../GridQueryUtil".split(" "),
function(r,p,m,h,f,e){var b={collectColumnBoxes:function(g,l){for(var k=[],n=0;n<g.store.data.length;){var q=g.store.data[n],u=this._createEmptyBox();q=m.getRowSpannedData(g,q,l.field)||[q];u.elements=this._getSpannedDataElements(g,l,q);this._measureBox(u);var t=k[k.length-1];t&&(t.nextSibling=u,u.prevSibling=t);k.push(u);n+=q.length}return k},_createEmptyBox:function(){return{id:p(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getSpannedDataElements:function(g,
l,k){var n=[];k.forEach(function(q){q={data:q,dataIndex:q.index,field:l.field,box:h.calcDataBox(g,q,l.field)};n.push(q)});return n},_measureBox:function(g){var l=0;g.elements.forEach(function(k){l+=k.box.h});g.box={x:g.elements[0].box.x,y:g.elements[0].box.y,w:g.elements[0].box.w,h:l}},mergeBoxesForRightColumn:function(g){var l=this._createEmptyBox();g.forEach(function(k){k.elements.forEach(function(n){l.elements.push({data:n.data,field:null,box:r.clone(n.box)})})});this._measureBox(l);l.box.w=1E6;
return[l]},getBoxAtDataIndex:function(g,l){return g.filter(function(k){return k.elements[0].dataIndex===l})[0]}},c={buildInfluenceTree:function(g,l,k){function n(q,u){(u?l:g).forEach(function(t){var v;if(v=!t.overlappingBoxesCache[q.id]){v=q.box;var y=t.box;v=!(v.y+.5>=y.y+y.h||v.y+v.h<=y.y+.5)}v&&(q.overlappingBoxes.push(t),q.overlappingBoxesCache[t.id]=!0)});q.overlappingBoxes.forEach(function(t){n(t,!u)})}k=b.getBoxAtDataIndex(g,k.index);n(k,!0);return k}},d={applyForce:function(g,l,k){function n(u,
t){var v=u.elements[0];v.field&&f.setFieldWidth(g,v.data,v.field,f.getFieldWidth(g,v.data,v.field)+(t?-1:1)*q,!0);u.overlappingBoxes.forEach(function(y){n(y,!t)})}var q=this._checkDelta(g,l,k);n(l,!1)},_checkDelta:function(g,l,k){function n(v,y){0!==u&&(y?0>u||(u=Math.min(u,v.box.w-q),v.prevSibling&&(u=Math.min(u,v.prevSibling.box.x+v.prevSibling.box.w-q-v.box.x)),v.nextSibling&&(u=Math.min(u,v.nextSibling.box.x+v.nextSibling.box.w-q-v.box.x))):0<u||(u=Math.max(u,-(v.box.w-q)),v.prevSibling&&(u=Math.max(u,
-(v.box.x+v.box.w-(v.prevSibling.box.x+q)))),v.nextSibling&&(u=Math.max(u,-(v.box.x+v.box.w-(v.nextSibling.box.x+q))))),v.overlappingBoxes.forEach(function(B){n(B,!y)}))}var q=g.layoutDefaults.columnMinWidth;k=Math.max(k,q);var u=k-l.box.w;if(0<u&&l.elements[0].field===g.columns[g.columns.length-1].field){var t=0;g.columns.forEach(function(v){t+=f.getFieldWidth(g,l.elements[0].data,v.field)});u=Math.min(u,f.getAllowedWidth(g)-t)}n(l,!1);return u}},a={_getInluencedStartBox:function(g,l,k){var n=g.columns[k.index+
1];k=b.collectColumnBoxes(g,k);g=n?b.collectColumnBoxes(g,n):b.mergeBoxesForRightColumn(k);return c.buildInfluenceTree(k,g,l)},getAffectedCells:function(g,l,k){function n(u){if(u.elements[0].data){var t=e.querySingleCell(g,{rowIndex:u.elements[0].data.index,columnField:u.elements[0].field,considerSpans:!0});t&&q.push(t)}u.overlappingBoxes.forEach(n)}var q=[];l=this._getInluencedStartBox(g,l,k);n(l);return q},adjustColumnCell:function(g,l,k,n){l=this._getInluencedStartBox(g,l,k);d.applyForce(g,l,n)}};
return{adjustColumnWidth:function(g,l,k,n){a.adjustColumnCell(g,l,k,n)},getAffectedCells:function(g,l,k){return a.getAffectedCells(g,l,k)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./ColumnDataUtil"],function(r,p){function m(f){f._dynamicBindings={};if(f.getNumDynamicColumns()){for(var e=f.getNumDynamicColumns(),b=f.getNumFixedColumns(),c=0;c<b;c++)f.columns[c].isFixed=!0;c=[];for(var d=
0;d<e;d++){for(var a=b,g=[];a<f.columns.length;){var l=f.columns[a+d];l.isDynamic=!0;g.push(l);a+=e}c.push(g)}c.forEach(function(k){k.forEach(function(n){f._dynamicBindings[n.field]=k})})}}var h={recalcColumns:function(f,e){var b=e&&e.resetWidth,c=e&&e.columnsToPreserve,d=e&&e.stickToRight,a=e&&e.newWidth,g=e&&e.rightOffsetWeight;e=e&&e._isJson;var l={},k=0;f.columns.every(function(B,D){if(!B.style||!B.style.width||isNaN(B.style.width)||"number"!==typeof B.style.width)return k=0,!1;k+=B.style.width;
l[D]=B.style.width;return!0});var n=a?a:d?f.getAllowedWidth():k?Math.min(k,f._width):f._width;n-=0<g?n*g:0;var q=n/f.columns.length,u=n;if(c){var t=c.length*q,v=0;c.forEach(function(B){v+=B.style.width});c.forEach(function(B){B.style.width=t/v*B.style.width/u*100+"%"})}f.columns.forEach(function(B,D,E){B.index=D;B.style=B.style||{};if("number"!==typeof B.style.width||b)if(D===E.length-1)B.style.width=u;else{var F=B.style.width;"string"===typeof F&&-1!==F.indexOf("%")?B.style.width=parseFloat(F.substr(0,
F.length-1))/100*n:B.style.width=q}u-=B.style.width;D===E.length-1&&0>u&&(B.style.width+=u);void 0===B.id&&(B.id=r())});if(f.looseResize){f.columns.some(function(B,D){var E=l[D]?B.style.width/l[D]:void 0;f.store.data.forEach(function(F){var z=p.getFieldWidthOwn(f,F,B.field);z?E&&1!==E&&p.setFieldWidth(f,F,B.field,z*E):p.setFieldWidth(f,F,B.field,B.style.width)})});var y=f.columns[f.columns.length-1].field;f.store.data.forEach(function(B){var D=0;f.columns.some(function(F){D+=p.getFieldWidthOwn(f,
B,F.field)});var E=n-D;0!==E&&p.setFieldWidth(f,B,y,p.getFieldWidthOwn(f,B,y)+E)})}e||(m(f),p.recalcGridWidth(f));return n},recalcColumnsTableJson:function(f){h.recalcColumns(f.data,{resetWidth:!0,newWidth:f.style.width,_isJson:!0})}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutSnapper":function(){define(["dojo/_base/lang","./rows/RowDataUtil","./columns/ColumnDataUtil","./GridElementBoxCalculator"],function(r,p,m,h){return{autoSnapLayout:function(f){function e(){var n=
[];f.store.data.forEach(function(q){f.columns.forEach(function(u){n.push(r.mixin({id:q.index+"_"+u.field,data:q,dataIndex:q.index,column:u,field:u.field},h.calcDataBox(f,q,u.field)))})});return n}if(f.looseResize)for(var b=f.store.data.length*f.columns.length,c={},d=0;d<b;d++){var a=e(),g=a[d],l=g.x+g.w,k=g.y+g.h;c[g.id]=!0;a.forEach(function(n){if(!c[n.id]){var q=l-(n.x+n.w);.5>=Math.abs(q)&&m.setFieldWidth(f,n.data,n.field,n.w+q);q=k-(n.y+n.h);.5>=Math.abs(q)&&p.setDataHeight(f,n.data,n.field,n.h+
q)}})}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/sectionUtils/SectionJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder","esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes","../../supportClasses/tableJson/TableJsonUtil"],function(r,p,m){var h={wrapInDetailsSectionJson:function(f,e){f=Array.isArray(f)?f:[f];var b=f.some(function(c){return"table"===c.id&&c.attributes&&(0<c.attributes.dynamicColumns||
0<c.attributes.dynamicRows)});return{type:e||(b?p.GROUP:p.DETAILS),stack:f}},createSectionJsonFromInfographicJson:function(f,e,b){f=m.createSingleCellTable({width:e,height:b,fieldInfo:r.createFieldInfoFromInfographic(f)});return h.wrapInDetailsSectionJson(f)},getSectionJsonInfographic:function(f){var e;f.stack&&f.stack.some(function(b){e="table"===b.id&&m.getTableJsonInfographic(b);return!!e});return e},getSectionJsonInfographicTable:function(f){var e;f.stack&&f.stack.some(function(b){if("table"===
b.id&&m.getTableJsonInfographic(b))return e=b,!0});return e},calcSectionJsonBox:function(f){var e,b;function c(g){e=Math.min(e,g.l);d=Math.min(d,g.t);b=Math.max(b,g.l+g.w);a=Math.max(a,g.t+g.h)}var d=e=Infinity;var a=b=0;f.stack&&f.stack.forEach(function(g){switch(g.id){case "table":var l=0;g.data.data.forEach(function(k){l+=k.style.height});c({l:g.style.left||0,t:g.style.top||0,w:g.style.width,h:l});break;case "img":case "map":c({l:g.style.left||0,t:g.style.top||0,w:g.style.width,h:g.style.height})}});
f=f.style||{};return{x:f.left,y:f.top,w:f.width||e+b,h:f.height||d+a,contentLeft:e,contentTop:d,contentW:b-e,contentH:a-d}}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder":function(){define(["../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder","dojo/i18n!esri/nls/jsapi"],function(r,p){p=p.geoenrichment.dijit.ReportPlayer.ReportPlayer;return{getCalculatorOrScriptFieldInfo:function(m,h,f){if(!m)return null;if(h.variableProvider.isPlayerOnly&&
!h.useVariableProviderToCollectOnly){var e=h.variableProvider.toCalculator(m);if(!e)return console.log("Can't create a dummy calculator for \x3d\x3e "+m),null;f=f||{};f.calculatorName=e.variable.calculatorName;m=r.createFieldInfoFromCalculator(e,h.variableProvider,f);m.name=e.variable.fieldName;m.templateName=e.variable.templateName;return m}e=h.queryMetaDataFunc(m);var b=m.substr(0,m.indexOf("."));f=f||{};f.calculatorName=b;if(e)return e.isScript?r.createFieldInfoFromScript(e,f):r.createFieldInfoFromCalculator(e,
h.variableProvider,f);f=r.createFieldInfoFromMissingVariable(m);h.variableProvider.isPlayerOnly&&(e=h.variableProvider.toCalculator(m),f.alias=e&&e.variable.alias);f.alias=f.alias?f.alias+" ("+p.missingVariable+")":p.missingVariable;return f}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/DefaultAttachmentsStore":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","./WebMapAttachmentStore"],function(r,p,
m,h){return r(null,{supportsMultipleAreas:!0,_analysisAreas:null,_currentAreaIndex:-1,_webMapStores:null,constructor:function(f){this._analysisAreas=f},initialize:function(){var f=this;this._webMapStores={};return p(this._analysisAreas.map(function(e,b){if(e=e.feature||e.location||e.additionalFeatures&&e.additionalFeatures[0])return(f._webMapStores[b]=new h(e)).initialize()})).then(function(){return f})},_callStoreMethod:function(f){var e=this._webMapStores[this._currentAreaIndex];return e?m(e[f](),
function(b){return b?b.slice():[]}):[]},getImages:function(){return this._callStoreMethod("getImages")},getAttributes:function(){return this._callStoreMethod("getAttributes")},getNotes:function(){return this._callStoreMethod("getNotes")},setCurrentAnalysisAreaIndex:function(f){this._currentAreaIndex=f}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/WebMapAttachmentStore":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/ImageUtil ./AttachmentsUtil".split(" "),
function(r,p,m,h,f,e,b,c){var d={getThumbnail:function(a){var g=e.get("WebMapAttachmentStore");g[a.url]||(g[a.url]=this._getDataURL(a));return g[a.url]},_getDataURL:function(a){return 0===a.url.indexOf("data:")?a.url:f.request(a.url).then(function(g){return g&&g.Attachment&&b.base64DataToDataURL(g.Attachment,a.contentType)}).otherwise(function(){return null})}};return r(null,{supportsMultipleAreas:!1,_attachmentInfos:null,_feature:null,_fieldInfos:null,_attributes:null,constructor:function(a,g){this._feature=
a;this._attachmentInfos=g},initialize:function(){this._tryGetFieldInfosAndAttributes();return m(this._attachmentInfos||this._tryGetAttachmentInfos()).always(function(){return!!this._attachmentInfos}.bind(this))},_tryGetFieldInfosAndAttributes:function(){var a=this._feature.getLayer();this._fieldInfos=(a=this._feature.infoTemplate||a&&a.infoTemplate)&&a.info.fieldInfos||[];this._attributes=p.mixin({},this._feature.attributes)},_tryGetAttachmentInfos:function(){return m(c.getFeatureAttachmentInfos(this._feature),
function(a){this._attachmentInfos=a}.bind(this))},getImages:function(){return this._attachmentInfos?this._attachmentInfos.map(function(a){return{getThumbnail:function(){return d.getThumbnail(a)},getUrl:function(){return a.url}}}):[]},getAttributes:function(){return h.composeAttributesFromFieldInfos(this._fieldInfos,this._attributes)},getNotes:function(){return[]},setCurrentAnalysisAreaIndex:null})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsUtil":function(){define([],
function(){return{getFeatureAttachmentInfos:function(r){var p=r.getLayer();if(p&&p.hasAttachments&&p.queryAttachmentInfos&&p.objectIdField)return p.queryAttachmentInfos(r.attributes[p.objectIdField])}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/supportClasses/LayoutXMLBuilder":function(){define("dojo/_base/lang esri/dijit/geoenrichment/utils/JsonXmlConverter esri/dijit/geoenrichment/ReportPlayer/core/conversion/reportingEngine/converters/DocumentConverter esri/dijit/geoenrichment/ReportPlayer/core/conversion/ConversionUtil esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes".split(" "),
function(r,p,m,h,f,e){return{buildLayoutXML:function(b){var c=m.buildDocumentTag({addDefaultQuery:!0,report:{templateJson:{documentOptions:r.mixin({},b.documentOptions,{left:0,right:0,top:0,bottom:0})}}}).documentTag,d=f.getPageBox(b.documentOptions),a=h.pxToPt(d.w),g=h.pxToPt(d.h);b.svgStrings.forEach(function(k,n){c.tags.push({name:"section",attributes:{type:e.DETAILS},tags:[{name:"img",attributes:{left:0,top:0,width:a,height:g},tags:[{text:"__svgString__"+n+"__svgString__"}]}]});n<b.svgStrings.length-
1&&c.tags.push({name:"pageBreak"})});var l=p.parseJson(c);b.svgStrings.forEach(function(k,n){l=l.replace("__svgString__"+n+"__svgString__",k)});return l},stitchDocuments:function(b){if(!b||!b.length)return null;var c=b[0],d=c.substr(0,c.indexOf("\x3csection")),a="";b.forEach(function(g,l){a+=g.replace(d,"").replace("\x3c/HTMLextReport\x3e","")+(l<b.length-1?"\x3cpageBreak /\x3e":"")});return d+a+"\x3c/HTMLextReport\x3e"}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/reportingEngine/converters/DocumentConverter":function(){define(["../../ConversionUtil",
"../ReportingEnginePageSizeCompatibilityUtil"],function(r,p){var m={buildDocumentTag:function(h){var f=h.report,e=f.templateJson.documentOptions,b={name:"HTMLextReport",attributes:{version:"10.1",pagesize:p.getReportingEnginePageSize(e.pagesize,e.orientation),orientation:e.orientation,left:r.pxToPt(e.left),right:r.pxToPt(e.right),top:r.pxToPt(e.top),bottom:r.pxToPt(e.bottom),style:r.composeStyleString(m.buildDocumentStyle(h)),comparisonZoom:f.defaultComparisonZoom||void 0},tags:[]};h.addDefaultQuery&&
b.tags.push({name:"queries",tags:[{name:"query",attributes:{name:"default",table:"headers"}}]});h.report.isGraphicReport||b.tags.push({name:"def",attributes:{align:e.align,lineSpacing:e.lineSpacing}});f.templateJson.tooltipInfo&&(f.templateJson.tooltipInfo.table||f.templateJson.tooltipInfo.chart)&&(h={name:"tooltip",tags:[]},b.tags.push(h),(e=f.templateJson.tooltipInfo.table)&&h.tags.push({name:"table",attributes:{value:e.value||void 0,alias:e.alias||void 0,expression:e.expression||void 0,conditional:e.conditional||
void 0}}),(f=f.templateJson.tooltipInfo.chart)&&h.tags.push({name:"chart",attributes:{title:f.title||void 0,value:f.value||void 0,weight:f.weight||void 0,min:f.min||void 0,max:f.max||void 0,avg:f.avg||void 0,conditional:f.conditional||void 0}}));return{documentTag:b}},buildDocumentStyle:function(h){h=h.report.templateJson.documentOptions;return{fontSize:r.pxToPt(h.fontSize),fontFamily:h.fontFamily}}};return m})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/ConversionUtil":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/PageUnitsConverter","esri/dijit/geoenrichment/utils/ColorUtil"],function(r,p,m){var h={};r.mixin(h,p);var f={"font-size":"fontSize","line-height":"lineHeight","font-family":"fontFamily","font-style":"fontStyle","font-weight":"fontWeight","text-decoration":"textDecoration",color:"color","background-color":"backgroundColor"},e={},b;for(b in f)e[f[b]]=b;h.splitTrim=function(a,g,l){a=String(a).split(g).map(function(k){return k.trim()});return l?a.filter(function(k){return!!k}):
a};h.parseStyleString=function(a){var g={};h.splitTrim(a||"",";",!0).forEach(function(l){var k=h.splitTrim(l,":");if(l=f[k[0]])k=k[1],"rgba(0, 0, 0, 0)"===k&&(k="transparent"),g[l]=k});return g};h.composeStyleString=function(a,g){g=g&&g.addPx;var l="",k;for(k in a){var n=e[k];if(n){var q=a[k];q&&("backgroundColor"===k&&(q=m.toCSSColor(q)),l+=n+":"+q+(g&&g[n]?"px;":";"))}}return l};h.removeZeroProperties=function(a){Object.keys(a).forEach(function(g){0===Number(a[g])&&delete a[g]});return a};var c=
{valign:{center:"middle"}},d={valign:{middle:"center"}};h.getPropValuePtoE=function(a,g){return c[a]&&c[a][g]||g};h.getPropValueEtoP=function(a,g){return d[a]&&d[a][g]||g};h.KEY_OPERATOR_RE=/^(!=|>=|<=|<|>|=)/;h.ONE_FIELD_KEY_TEST=/^(default|(<|>|<=|>=|!=|=|)(-?\d+\.\d+|-?\d+))$/;h.KEY_INTERVAL_SEPARATOR=";";return h})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/reportingEngine/ReportingEnginePageSizeCompatibilityUtil":function(){define(["../../supportClasses/DocumentOptions"],function(r){var p=
{},m={a4:1,letter:1};p.getReportingEnginePageSize=function(h,f){return m[h]?h:(f=r.SIZE_TYPE_TO_DIM_HASH[h]&&r.SIZE_TYPE_TO_DIM_HASH[h][f])?r.combineCustomSizeString(f.w,f.h,"in"):h};return p})},"widgets/BusinessAnalyst/utils/ReportUtil":function(){define("dojo/Deferred dojo/promise/all dojo/when dojo/_base/array esri/request jimu/portalUtils dojo/i18n!../nls/strings".split(" "),function(r,p,m,h,f,e,b){STANDARD_INFOGRAPHIC_TYPEKEYWORD="esriReportPlayerStandardInfographic";return{_ownedCachedCustomReports:null,
_sharedCachedCustomReports:null,_cachedCountryClassicReports:[],_cachedInfographicReports:null,_countryInitDfds:[],getAvailableClassicReports:function(c,d){var a=this,g=[],l=new r,k;d&&h.forEach(d.countryConfig,function(t){c==t.countryID&&(k=t)});k||(k={countryID:c,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,
defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var n=null,q=null,u=null;m(this._initReports(c),function(){if(!d||k.allowAllEsriReports||a._hasEnabledReports(a._cachedCountryClassicReports[c],k.enabledEsriReports))n=g.length,g.push({value:"esriReports",label:b.esriReports,children:[]});if(!d||k.allowAllOrgReports&&a._hasReportsForCountry(a._ownedCachedCustomReports,c)||a._hasEnabledReportsForCountry(a._ownedCachedCustomReports,
c,k.enabledOrgReports))q=g.length,g.push({value:"myReports",label:b.myReports,children:[]});if(!d||k.allowAllOrgReports&&a._hasReportsForCountry(a._sharedCachedCustomReports,c)||a._hasEnabledReportsForCountry(a._sharedCachedCustomReports,c,k.enabledOrgReports))u=g.length,g.push({value:"sharedReports",label:b.sharedReports,children:[]});(k.allowAllEsriReports||a._hasEnabledReports(a._cachedCountryClassicReports[c],k.enabledEsriReports))&&a._cachedCountryClassicReports[c]&&0<a._cachedCountryClassicReports[c].length&&
h.forEach(a._cachedCountryClassicReports[c],function(y){(k.allowAllEsriReports||k.enabledEsriReports.includes(y.reportID))&&g[n].children.push(a._formatClassicReportsForDropDown(y))});var t=["esriWebInfographicReport","esriWebSingleInfographic","esriWebBlankInfographic","esriWebHiddenInfographic","esriWebComparisonReport"];(k.allowAllOrgReports&&a._hasReportsForCountry(a._ownedCachedCustomReports,c)||a._hasEnabledReportsForCountry(a._ownedCachedCustomReports,c,k.enabledOrgReports))&&h.forEach(a._ownedCachedCustomReports,
function(y){y.properties.countries.includes(c)&&(k.allowAllOrgReports||k.enabledOrgReports.includes(y.id))&&(y.typeKeywords.some(function(B){return 0<=t.indexOf(B)})||g[q].children.push(a._formatClassicReportsForDropDown(y)))});(k.allowAllOrgReports&&a._hasReportsForCountry(a._sharedCachedCustomReports,c)||a._hasEnabledReportsForCountry(a._sharedCachedCustomReports,c,k.enabledOrgReports))&&h.forEach(a._sharedCachedCustomReports,function(y){y.properties.countries.includes(c)&&(k.allowAllOrgReports||
k.enabledOrgReports.includes(y.id))&&(y.typeKeywords.some(function(B){return 0<=t.indexOf(B)})||g[u].children.push(a._formatClassicReportsForDropDown(y)))});var v=function(y,B){y=y.label.toUpperCase();B=B.label.toUpperCase();var D=0;y>B?D=1:y<B&&(D=-1);return D};0<g.length&&g[0].children.sort(v);1<g.length&&g[1].children.sort(v);2<g.length&&g[2].children.sort(v);l.resolve(g)});return l},_hasEnabledReports:function(c,d){return c&&d?h.some(c,function(a){return d.includes(a.reportID)}):!1},_hasReportsForCountry:function(c,
d){return c&&d?h.some(c,function(a){return a.properties.countries.includes(d)}):!1},_hasEnabledReportsForCountry:function(c,d,a){return c&&d&&a?h.some(c,function(g){return g.properties.countries.includes(d)?a.includes(g.id):!1}):!1},_formatClassicReportsForDropDown:function(c){return c.metadata?{label:c.metadata.title,value:c.reportID,reportType:c.metadata.type}:{label:c.title,value:c.id,reportType:c.properties.type,item:{itemid:c.id,url:portalUrl,token:esri.id.credentials[0].token}}},getAvailableInfographicReports:function(c,
d){var a=this,g=[],l=new r,k;d&&h.forEach(d.countryConfig,function(t){c==t.countryID&&(k=t)});k||(k={countryID:c,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var n=null,q=
null,u=null;m(this._initReports(c),function(){if(!d||k.allowAllEsriInfographics||a._hasEnabledInfographics(a._cachedInfographicReports,k.enabledEsriInfographics))n=g.length,g.push({value:"esriReports",label:b.esriInfographics,children:[]});if(!d||k.allowAllOrgInfographics&&0<a._ownedCachedCustomReports.length||a._hasEnabledInfographics(a._ownedCachedCustomReports,k.enabledOrgInfographics))q=g.length,g.push({value:"myReports",label:b.myInfographics,children:[]});if(!d||k.allowAllOrgInfographics&&0<
a._sharedCachedCustomReports.length||a._hasEnabledInfographics(a._sharedCachedCustomReports,k.enabledOrgInfographics))u=g.length,g.push({value:"sharedReports",label:b.sharedInfographics,children:[]});(k.allowAllEsriInfographics||a._hasEnabledInfographics(a._cachedInfographicReports,k.enabledEsriInfographics))&&h.forEach(a._cachedInfographicReports,function(v){v.properties.countries.includes(c)&&(k.allowAllEsriInfographics||k.enabledEsriInfographics.includes(v.id))&&g[n].children.push(a._formatInfographicReportsForDropDown(v))});
(k.allowAllOrgInfographics&&0<a._ownedCachedCustomReports.length||a._hasEnabledInfographics(a._ownedCachedCustomReports,k.enabledOrgInfographics))&&h.forEach(a._ownedCachedCustomReports,function(v){v.properties.countries.includes(c)&&(k.allowAllOrgInfographics||k.enabledOrgInfographics.includes(v.id))&&(v.typeKeywords.includes("esriWebInfographicReport")||a._isOldPortalInfographic(v))&&g[q].children.push(a._formatInfographicReportsForDropDown(v))});(k.allowAllOrgInfographics&&0<a._sharedCachedCustomReports.length||
a._hasEnabledInfographics(a._sharedCachedCustomReports,k.enabledOrgInfographics))&&h.forEach(a._sharedCachedCustomReports,function(v){v.properties.countries.includes(c)&&(k.allowAllOrgInfographics||k.enabledOrgInfographics.includes(v.id))&&(v.typeKeywords.includes("esriWebInfographicReport")||a._isOldPortalInfographic(v))&&g[u].children.push(a._formatInfographicReportsForDropDown(v))});var t=function(v,y){v=v.label.toUpperCase();y=y.label.toUpperCase();var B=0;v>y?B=1:v<y&&(B=-1);return B};0<g.length&&
g[0].children.sort(t);1<g.length&&g[1].children.sort(t);2<g.length&&g[2].children.sort(t);l.resolve(g)});return l},_hasEnabledInfographics:function(c,d){return h.some(c,function(a){return d.includes(a.id)})},_isOldPortalInfographic:function(c){return c.properties&&c.properties.isHidden&&"true"===c.properties.isHidden?!1:c.properties&&c.properties.isGraphicReport&&"true"===c.properties.isGraphicReport?!0:!1},_formatInfographicReportsForDropDown:function(c){return{label:c.title,value:c.id}},_initReports:function(c){var d=
[],a=this;if(this._countryInitDfds[c])return this._countryInitDfds[c];this._countryInitDfds[c]=new r;var g=function(l,k){return f(l).then(function(n){h.forEach(n.results,function(q){k.push(q)});if(-1!=n.nextStart)return l.content.start=n.nextStart,g(l,k)},function(n){alert(n)})};e.getPortal(portalUrl).loadSelfInfo().then(function(l){var k=l&&l.helperServices&&l.helperServices.geoenrichment&&l.helperServices.geoenrichment.url?l.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";
a._cachedCountryClassicReports[c]||d.push(f({url:k+"/Geoenrichment/reports/"+c,content:{appID:"webappbuilder",f:"json",langCode:"en-us"}}).then(function(n){a._cachedCountryClassicReports[c]=n.reports},function(n){alert(n)}));a._cachedInfographicReports||(a._cachedInfographicReports=[],d.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:"typekeywords:(esriReportPlayerStandardInfographic jsapiVersion3.35)"}},
a._cachedInfographicReports)));a._ownedCachedCustomReports||(a._ownedCachedCustomReports=[],d.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) owner:'+esri.id.credentials[0].userId}},a._ownedCachedCustomReports)));a._sharedCachedCustomReports||(a._sharedCachedCustomReports=[],d.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",
f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:shared type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},a._sharedCachedCustomReports)),d.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:org type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},
a._sharedCachedCustomReports)),l&&l.appInfo&&l.appInfo.orgId&&d.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:public type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId+" orgid: "+l.id}},a._sharedCachedCustomReports)));0===d.length?a._countryInitDfds[c].resolve():p(d).then(function(){a._countryInitDfds[c].resolve()})});return this._countryInitDfds[c]}}})},
"widgets/BusinessAnalyst/esriAnalystX/widgets/Selects/FilteringSelectTree":function(){define(["dojo/_base/declare","./FilteringSelect","esri/dijit/geoenrichment/SelectableTree","../../widgets/SelectableTreeGrid/SelectableTreeGrid","xstyle/css!./css/FilteringSelect.css"],function(r,p,m,h){function f(b,c){var d=[];b.forEach(function(a){a.children.forEach(function(g){var l={};l[c.idProperty]=g[c.idProperty];l[c.labelProperty]=g[c.labelProperty];l.__item=g;d.push(l)})});return d}function e(b,c,d){var a=
{};c.forEach(function(l){a[l[d.idProperty]]=l});var g=[];b.forEach(function(l){var k=l.children.filter(function(q){return a[q[d.idProperty]]});if(k.length){var n={};n[d.idProperty]=l[d.idProperty];n[d.labelProperty]=l[d.labelProperty];n.children=k.map(function(q){var u={};u[d.idProperty]=q[d.idProperty];u[d.labelProperty]=q[d.labelProperty];return u});g.push(n)}});return{treeData:g,idsHash:a}}h=r(h,{showRootCheckbox:!1,showCheckboxColumn:!1,enableRowSelection:!0,expandOnNodeClick:!0,baseTree:null,
hostWidget:null,defaultExpand:null,_firstTimeExpand:!0,getLabel:function(b,c){return b[this.labelProperty]},onRowsSelected:function(b,c){b=b&&b[0];c=c&&c[0];b&&!b.children&&(c.setAttribute("item",b[this.idProperty]),this.onChange(c))},createOptions:function(b,c,d){b=e(this.baseTree.data,b,this);this.items=b.idsHash;this.tree.clear();if(this._firstTimeExpand){this._firstTimeExpand=!1;if(this.defaultExpand)var a=Object.assign({},this.defaultExpand);else{a={};var g=this;b.treeData.forEach(function(l){a[l[g.idProperty]]=
!0})}this.grid._expanded=a}this.tree.addNodes(b.treeData);this.refresh()},getHighlightedOption:function(){},highlightFirstOption:function(){},highlightLastOption:function(){},clearResultList:function(){this.tree.clear()},onChange:function(b){}});r=r(p,{dropDownClass:h,tree:null,autoComplete:!1,defaultExpand:null,postCreate:function(){this.inherited(arguments);this.tree&&this.setItems(this._getStoreItemsFromTree())},_setTreeAttr:function(b){this.tree=b;this._isCreated&&this.setItems(this._getStoreItemsFromTree());
this.dropDown&&(this.dropDown.baseTree=this.tree)},_getStoreItemsFromTree:function(){return f(this.tree.data,this)},_startSearch:function(b){if(!this.dropDown){var c=this.id+"_popup";this.dropDown=new this.dropDownClass({gridClass:"esriMapsAnalystXSelectableTreeGrid esriMapsAnalystXFilteringSelect_treeGrid",onChange:function(){return this._selectOption.apply(this,arguments)}.bind(this),id:c,dir:this.dir,textDir:this.textDir,tree:new m([],{idProperty:this.idProperty}),idProperty:this.idProperty,labelProperty:this.labelProperty,
baseTree:this.tree,hostWidget:this,defaultExpand:this.defaultExpand})}this.inherited(arguments)},_openResultList:function(){this.inherited(arguments);this.dropDown&&this.dropDown.refresh()},getSelectedItem:function(){var b=this.inherited(arguments);return b&&b.__item}});r.NONE_ID=p.NONE_ID;return r})},"widgets/BusinessAnalyst/esriAnalystX/widgets/Selects/FilteringSelect":function(){define("dojo/_base/declare dojo/store/Memory dojo/query dojo/dom-class dojo/dom-style dojo/dom-geometry dijit/form/FilteringSelect dijit/form/_ComboBoxMenu ../../dijit/tooltips/TooltipUtil dojo/i18n!../../../nls/strings xstyle/css!./css/FilteringSelect.css".split(" "),
function(r,p,m,h,f,e,b,c,d,a){var g=r(p,{filtered:!1,noneItem:null,get:function(l){return"None"==l?this.noneItem:this.inherited(arguments)},query:function(l,k){var n=this.inherited(arguments);this.filtered=n.length!=this.data.length;return n}});p=r(c,{baseClass:"dijitComboBoxMenu",idProperty:"value",postCreate:function(){this.inherited(arguments);d.autoTooltip(this.domNode)},_createMenuItem:function(){var l=this.inherited(arguments);l.className+=" TrimWithEllipses";return l},selectItem:function(l){if(this.items){for(var k=
-1,n=0;n<this.items.length;n++)if(this.items[n][this.idProperty]==l){k=n;break}if(!(0>k))for(l=this.containerNode.children,n=0;n<l.length;n++){var q=l[n];if("none"!=q.style.display&&q.getAttribute("item")==k){this.selectLastNode();this.set("selected",q,!0);break}}}}});r=r(b,{forceWidth:!1,autoWidth:!1,selectOnClick:!0,idProperty:"value",labelProperty:"label",placeHolder:null,dropDownClass:p,options:null,_assignedStore:null,_isCreated:!1,postMixInProperties:function(){this.searchAttr=this.labelAttr=
this.labelProperty;var l={};l[this.idProperty]="None";l[this.labelAttr]=this.placeHolder||a.None;this.set("store",new g({idProperty:this.idProperty,noneItem:l}));this.inherited(arguments)},_startSearch:function(){this.inherited(arguments);this.dropDown.idProperty=this.idProperty;this.dropDown.labelProperty=this.labelProperty},postCreate:function(){this.inherited(arguments);d.autoTooltip(this.domNode);(this.options||this._assignedStore)&&this.setItems(this.options||this._assignedStore.data);h.add(this.domNode,
"esriMapsAnalystXFilteringSelect");this._isCreated=!0},_onFocus:function(){this._updateTrimWithEllipses(!0);this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this._updateTrimWithEllipses(!1)},_updateTrimWithEllipses:function(l){var k=m(".dijitInputInner",this.domNode)[0];if(k)h[l?"remove":"add"](k,"TrimWithEllipses")},_setStoreAttr:function(l){l instanceof g?(this.store=l,this.inherited(arguments)):(this._assignedStore=l,this._isCreated&&this.setItems(this._assignedStore.data))},
_setOptionsAttr:function(l){this.options=l;this._isCreated&&this.setItems(this.options)},setItems:function(l,k){this.store.setData(l);this.closeDropDown();this.dropDown&&this.dropDown.clearResultList();l=this.get("value");k=k||"None";this.set("value",k);k==l&&this.emit("Change");this._updateTrimWithEllipses(this.get("focused"))},_openResultList:function(l,k,n){var q=e.getContentBox(this.domNode).w;f.set(this.dropDown.domNode,"width",q+"px");this.inherited(arguments);this.store.filtered||this.dropDown.selectItem&&
this.dropDown.selectItem(this.get("value"))},_setBlurValue:function(){var l=this.get("displayedValue");"undefined"==typeof this.item&&(this.item=null,this.set("displayedValue",l));this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0);this._refreshState();this.focusNode.removeAttribute("aria-activedescendant")},getSelectedItem:function(){var l=this;return this.store.data.filter(function(k){return k[l.idProperty]==l.get("value")})[0]}});r.NONE_ID="None";return r})},"widgets/BusinessAnalyst/esriAnalystX/dijit/tooltips/TooltipUtil":function(){define("dojo/dom-construct dojo/dom-style dojo/dom-geometry dojo/dom-class dojo/query dojo/on dojox/gfx dojo/sniff dojo/aspect dojox/uuid/generateRandomUuid dijit/Tooltip ../utils/DomUtil ../utils/MouseUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/domReady!".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n){function q(){F&&(F.isMultilineContainer?B.hideTooltipForNode(F):(clearInterval(F.__autoTooltipInLayoutCheckHandle),delete F.__autoTooltipInLayoutCheckHandle,g.hide(F)),F=null)}function u(z,w){w=w||"";var A=r.create("div",{class:"esriMapsAnalystXValidationTooltip"+w},document.body);!w&&r.create("div",{class:"esriMapsAnalystXValidationTooltipTip"+w},A);r.create("div",{innerHTML:z,class:"esriMapsAnalystXValidationTooltipBody"+w},A);p.set(A,"position","fixed");return A}
function t(z,w){function A(){z&&(document.body.removeChild(z),I.forEach(function(N){N.remove()}),z=I=null)}w=w.textbox||w;var H=m.getMarginBox(z),G=m.position(w);"rtl"===document.dir?p.set(z,{left:G.x-H.w+"px",top:G.y+G.h/2-H.h/2+"px"}):p.set(z,{left:G.x+G.w+"px",top:G.y+G.h/2-H.h/2+"px"});var I=[e(document.body,"mousedown, keydown",A),e(w,"blur",A)];return{remove:A}}function v(z,w,A){function H(){var O=r.create("div",{class:"esriMapsAnalystXClosableTooltipTip"},I);h.add(O,"right"===A?"esriMapsAnalystXClosableTooltipTipRight":
"esriMapsAnalystXClosableTooltipTipLeft")}function G(){N=r.create("div",{class:"esriMapsAnalystXClosableTooltipBody"},I);r.create("div",{innerHTML:z,class:"esriMapsAnalystXClosableTooltipLabel"},N);M=r.create("div",{class:"esriMapsAnalystXClosableTooltipCloseButton esriMapsAnalystXCloseWindow esriMapsAnalystXCloseWindowWhite"},N)}w={class:"esriMapsAnalystXClosableTooltip "+(w||"")};w.id=a();var I=r.create("div",w,document.body),N,M;"right"!==A?(G(),H()):(H(),G());p.set(I,"position","fixed");return{tooltip:I,
body:N,closeButton:M}}function y(z,w,A,H){var G=m.getMarginBox(z.tooltip),I=m.position(w);"rtl"===document.dir&&"right"!==H||"rtl"!==document.dir&&"right"===H?p.set(z.tooltip,{left:I.x+I.w+"px",top:I.y+I.h/2-G.h/2+"px"}):p.set(z.tooltip,{left:I.x-G.w+"px",top:I.y+I.h/2-G.h/2+"px"});var N,M=function(){N&&clearTimeout(N);O&&clearInterval(O);S&&S.remove();z.tooltip.parentNode===document.body&&document.body.removeChild(z.tooltip)};var O=setInterval(function(){l.isNodeInLayout(w)||M();l.isNodeVisible(w)?
l.show(z.tooltip):l.hide(z.tooltip)},300);A&&(N=setTimeout(M,A));var S=e(z.closeButton,"click",function(){M()});z.tooltip._removeFunc=M;return z.tooltip}var B={},D={};B.hideTooltipForNode=n.hideTooltipForNode;B.setTooltipToNode=n.setTooltipToNode;B.createTooltip=function(z,w,A){var H={orientation:m.isBodyLtr(document)?"right":"left",offset:{x:15,y:0}};w&&(H.innerHTML=w);A&&(H=Object.assign(H,A));H.id=a();H.toMouseCursor&&(H.mouseEvent=k.getCursorPosition(),delete H.toMouseCursor);w=H.mouseEvent;delete H.mouseEvent;
A=H.htmlFragment;delete H.htmlFragment;var G=H.widget;delete H.widget;var I=H.orientation;delete H.orientation;var N=H.offset;delete H.offset;var M=H.horizontalOffset;delete H.horizontalOffset;var O=r.create("div",H,z?z.container:document.body);A?r.place(A,O):G&&G.placeAt(O);p.set(O,"position","fixed");var S=m.getMarginBox(O),R=function(V,Z){var da=V.touches?event.touches[0].clientX:V.clientX;V=V.touches?event.touches[0].clientY:V.clientY;var W,ea,Q=N.x,X=N.y;"left"===I?0>da-S.w-Q&&(W="right"):da+
S.w+Q>document.body.clientWidth&&(W="left");V+S.h+X>document.body.clientHeight&&(ea="above");W=W||I;p.set(O,{left:Z?Z+"px":da+("left"===W?-S.w-Q:Q)+"px",top:V+("above"===ea?-S.h-X:X)+"px"});O.style.display=""};w&&R(w,M);H=[];H.push(e(z?z:document.body,z?"mouse-move, mousemove":"mousemove, touchmove",function(V){R(V,M)}));H.push(e(z?z:document.body,z?"mouse-out, mouseout":"mouseout, touchend",function(V){O.style.display="none"}));z={};z.handlers=H;z.tooltip=O;D[O.id]=z;return O};B.removeTooltip=function(z){if(z){z=
"string"===typeof z?z:z.id;var w=D[z];delete D[z];w&&(w.handlers.forEach(function(A){A.remove()}),r.destroy(w.tooltip))}};var E={};B.registerTooltipForSlider=function(z,w,A,H){var G={offsetX:0,offsetY:0,class:"esriMapsAnalystXTooltip"};w&&(G=Object.assign(G,w));G.id=a();var I=r.create("div",G,document.body);I.style.display="none";p.set(I,"position","fixed");var N=!1,M=function(S,R){if(!N){N=!0;I.style.display="";I.innerHTML=R();var V=m.getMarginBox(I),Z=m.position(S);p.set(I,{left:Z.x+Z.w/2-V.w/2+
G.offsetX+"px",top:Z.y-V.h-5+G.offsetY+"px"});var da=[];da.push(d.after(z,"onChange",function(){I.innerHTML=R();Z=m.position(S);p.set(I,{left:Z.x+Z.w/2-V.w/2+"px",top:Z.y-V.h-5+"px"})}));var W=function(){I.style.display="none";da.forEach(function(Q){Q.remove()});N=!1},ea=!1;da.push(e(S,"mousedown, mouseDown, mouse-down",function(){ea=!0;da.push(e(document,"mouseup, mouseUp, mouse-up",function(){W()}))}));da.push(e(S,"mouseout, mouseOut, mouse-out",function(){ea||W()}))}};w=[];w.push(e(z.sliderHandle,
"mouseover, mouseOver, mouse-over",function(){H&&z.isSliderDisabled&&z.isSliderDisabled()||M(z.sliderHandle,function(){var S=H?z.get("value")[0]:z.get("value");return A?A(S):S})}));H&&w.push(e(z.sliderHandleMax,"mouseover, mouseOver, mouse-over",function(){z.isSliderDisabled&&z.isSliderDisabled()||M(z.sliderHandleMax,function(){return A?A(z.get("value")[1]):z.get("value")[1]})}));w.push(d.before(z,"destroy",function(){B.unregisterTooltipForSlider(z)}));z.tooltipId=I.id;var O={};O.tooltip=I;O.handlers=
w;E[I.id]=O};B.unregisterTooltipForSlider=function(z){var w=E[z.tooltipId];w&&(w.handlers.forEach(function(A){A.remove()}),r.destroy(w.tooltip));delete E[z.tooltipId];delete z.tooltipId};var F=null;B.autoTooltip=function(z,w,A){"string"===typeof w&&(w=w.split(" ").filter(function(G){return G&&!!G.trim().length}));w=w||[];w.push("TrimWithEllipses");A=A||[];A.push("esriMapsAnalystXInfoIcon");for(var H=0;H<w.length;H++)e(z,"."+w[H]+":mouseover, "+w[H]+":touchstart, ",function(G){this!==F&&this.offsetWidth<
this.scrollWidth&&!this.noAutoTooltip&&(G=getComputedStyle(this).width,G=Number(G.substr(0,G.length-2)),0>G-Math.round(G)&&this.offsetWidth==this.scrollWidth-1||(q(),F=this,G=F.autoTooltip||F.textContent||F.value,F.title&&(G+=" ("+F.title+")"),G&&g.show(G,F,["above","below"]),e.once(F,"mouseout, touchstart, touchout",function(){q()}),F.__autoTooltipInLayoutCheckHandle=setInterval(function(){l.isNodeInLayout(F)||q()},500)))});if(c("touch"))for(H=0;H<A.length;H++)e(z,"."+A[H]+":touchstart ",function(G){this!==
F&&(F=this,F.title&&(g.show(F.title,F,["above","below"]),e.once(F,"touchstart, touchout",function(){g.hide(F);F=null})))})};B.addAutoTooltipsToTabContainer=function(z){f(".tabLabel",z.domNode).forEach(function(w){h.add(w,"TrimWithEllipses")});B.autoTooltip(z)};B.setMultilineText=function(z,w,A,H){A=A||2;w=w.trim();H=H||["above","below"];h.remove(z,"TrimWithEllipses");z.style.overflow="hidden";z.innerHTML="";for(var G=w,I=!1;G;){A--;var N=r.create("div",null,z);N.style.overflow="hidden";N.style.whiteSpace=
"nowrap";for(var M=G;M;)if(N.textContent=M,N.offsetWidth<N.scrollWidth-1)M=(M=M.match(/^(.*[^\s]+)\s+[^\s]+$/))&&M[1]||"";else break;!M||!A&&M!==G?(N.textContent=G,G="",N.style.textOverflow="ellipsis",I=!0):G=G.substr(M.length).trim()}I&&B.setTooltipToNode(z,function(){q();F=z;F.isMultilineContainer=!0;return w},{position:H})};B.showErrorTip=function(z,w){return t(u(w),z.domNode||z)};B.showNewStyleErrorTip=function(z,w,A){return t(u(w,"NewStyle"+(A?" esriMapsAnalystXWarningStyle":"")),z.domNode||
z)};B.showAlertTooltip=function(z){z&&z.node&&z.message&&(g.show(z.message,z.node,z.position||["above","below"]),setTimeout(function(){g.hide(z.node)},z.timeout||5E3))};B.showClosableTooltip=function(z){var w=v(z.message,z.tooltipClass,z.position);return y(w,z.component,z.timeout,z.position)};B.removeClosableTooltip=function(z){z&&z._removeFunc&&z._removeFunc()};B.showClosableTooltipOnVerticalBracket=function(z){var w=z.below||z.above,A=m.position(z.above,!0),H=m.position(w,!0),G="rtl"!==document.dir?
"start"===z.direction:"end"===z.direction,I=A.x+A.w*(G?0:1);A=A.y;var N=H.y+H.h,M=r.create("div",{class:"esriMapsAnalystFlexibleTooltip_tooltip esriMapsAnalystXNonSelectable"},document.body),O=r.create("div",{class:"esriMapsAnalystFlexibleTooltip_surfaceContainer"},M);H={};I={top:A-2,left:I+(G?-3:3),height:N-A+4,width:10};for(var S in I)H[S]=I[S]+"px";p.set(M,H);var R=b.createSurface(O,I.width,I.height);R.clear();R.createPolyline([{x:G?I.width:0,y:0},{x:G?0:I.width,y:0},{x:G?0:I.width,y:I.height},
{x:G?I.width:0,y:I.height}]).setStroke({color:"#6E6E6E",width:6});z.component=M;G=v(z.message,z.tooltipClass,z.position);var V=function(){clickHandler&&clickHandler.remove();Z&&clearInterval(Z);R&&R.clear();r.destroy(O);r.destroy(M)},Z=setInterval(function(){l.isNodeInLayout(w)||V();l.isNodeVisible(w)?p.set(M,"visibility","visible"):p.set(M,"visibility","hidden")},300);z.timeout&&setTimeout(V,z.timeout);clickHandler=e(G.closeButton,"click",V);tooltip=y(G,z.component,z.timeout,z.position);var da=tooltip._removeFunc;
tooltip._removeFunc=function(){da();V()};return tooltip};return B})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DomUtil":function(){define("dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/on ../../utils/ObjectUtil esri/dijit/geoenrichment/utils/DomUtil".split(" "),function(r,p,m,h,f,e,b){var c=Object.assign({},b);c.select=function(d){return c.addTag(d,"selected")};c.unselect=function(d){return c.removeTag(d,"selected")};c.floatStart=function(d){return c.addTag(d,"esriMapsAnalystXFloatStart")};
c.floatEnd=function(d){return c.addTag(d,"esriMapsAnalystXFloatEnd")};c.addSpacer=function(d,a){d=r.create("div",{"class":"esriMapsAnalystXSpacer",innerHTML:"\x26nbsp;"},d);if(a)c[a](d);return d};c.getAndUpdateNumber=function(d,a){if(!d)return NaN;var g=d.get&&d.set;void 0===a&&(a=0);var l=e.parseNumber(g?d.get("value"):d.value,a);isNaN(l)||(g?d.set("value",e.formatNumber(l,a)):d.value=e.formatNumber(l,a));return l};c.getAndUpdateString=function(d){if(!d)return null;if(d.get&&d.set){var a=d.get("value").trim();
d.set("value",a)}else a=d.value.trim(),d.value=a;return a};c.getScreenScaleFactor=function(){return c.getTextBox("",{style:"width: 72pt; height: 72pt"}).w/96};c.positionAtCenter=function(d,a){if(d&&a){var g=p.position(d);a=p.position(a);g.w&&g.h&&a.w&&a.h&&m.set(d,{left:(a.w-g.w)/2+"px",top:(a.h-g.h)/2+"px"})}};c.showAroundOverlay=function(d,a){a=a||{};c.removeAroundOverlay(d);var g={w:"width",h:"height",l:"left",t:"top",r:"right",b:"bottom"},l=p.position(d);if(a.viewPortContainer){var k=p.position(a.viewPortContainer),
n=l.x,q=l.y;l.x=Math.max(l.x,k.x);l.w-=l.x-n;l.y=Math.max(l.y,k.y);l.h-=l.y-q;l.w=Math.min(l.w,k.x+k.w-l.x);l.h=Math.min(l.h,k.y+k.h-l.y)}d.__aroundOverlays=(a.placeInNode?[{l:0,t:-l.y,w:l.w,h:l.y},{l:l.w,t:-l.y,w:document.body.clientWidth-(l.x+l.w),h:document.body.clientHeight},{l:0,t:l.h,w:l.w,h:document.body.clientHeight-(l.y+l.h)},{l:-l.x,t:-l.y,w:l.x,h:document.body.clientHeight}]:[{l:l.x,t:0,w:l.w,h:l.y},{w:document.body.clientWidth-(l.x+l.w),r:0,t:0,b:0},{l:l.x,h:document.body.clientHeight-
(l.y+l.h),w:l.w,b:0},{l:0,t:0,w:l.x,b:0}]).map(function(t){var v=r.create("div",{"class":a.overlayClass||"esriMapsAnalystXNodeAroundOverlay"},a.placeInNode?d:document.body),y={position:"absolute"},B;for(B in g)void 0!==t[B]&&(y[g[B]]=Math.round(t[B])+"px");m.set(v,y);return v});l=function(){c.removeAroundOverlay(d)};a.removeOnClick&&(d.__aroundOverlaysRemoveHandle=f.once(document.body,"click",l));d.__aroundOverlaysResizeHandle=f(window,"resize",function(){c.showAroundOverlay(d,a)});var u;d.__aroundOverlaysSetIntervalHandle=
setInterval(function(){if(u){var t=p.position(d);t.x==u.x&&t.y==u.y&&t.w==u.w&&t.h==u.h||c.showAroundOverlay(d,a)}else u=p.position(d)},50);return{remove:l}};c.removeAroundOverlay=function(d){d.__aroundOverlays&&d.__aroundOverlays.forEach(function(a){r.destroy(a)});delete d.__aroundOverlays;d.__aroundOverlaysRemoveHandle&&d.__aroundOverlaysRemoveHandle.remove();delete d.__aroundOverlaysRemoveHandle;d.__aroundOverlaysResizeHandle&&d.__aroundOverlaysResizeHandle.remove();delete d.__aroundOverlaysResizeHandle;
clearInterval(d.__aroundOverlaysSetIntervalHandle);delete d.__aroundOverlaysSetIntervalHandle};c.getDocumentStyleDeclaration=function(d){function a(k){try{var n=k.rules||k.cssRules}catch(u){n=null}if(n)for(k=0;k<n.length;k++){var q=n[k];if(q.styleSheet){if(q=a(q.styleSheet))return q}else if(q.selectorText==d)return q.style}}for(var g=0;g<document.styleSheets.length;g++){var l=a(document.styleSheets[g]);if(l)return l}return null};c.getNodeFontFamily=function(d){return(d=m.get(d,"fontFamily")||m.getComputedStyle(d)["font-family"])?
d.replace(/'|"/g,"").split(",")[0]:d};c.getNodeFontSize=function(d){return m.toPixelValue(d,m.get(d,"fontSize"))};c.listenToNodeAdded=function(d,a,g){if(c.isNodeInLayout(d))a();else{d.__listenToNodeAddedHandle&&d.__listenToNodeAddedHandle.remove();var l=setInterval(function(){c.isNodeInLayout(d)&&(d.__listenToNodeAddedHandle&&d.__listenToNodeAddedHandle.remove(),a())},g||100);d.__listenToNodeAddedHandle={remove:function(){clearInterval(l);delete d.__listenToNodeAddedHandle}};return d.__listenToNodeAddedHandle}};
c.isNodeVisible=function(d){return c.isChildOf(d,document.body,function(a){return!h.contains(a,"dijitHidden")&&"hidden"!=m.get(a,"visibility")})};c.enableHyperlink=function(d,a){a?h.replace(d,"esriMapsAnalystXLink","esriMapsAnalystXLinkDisabled"):h.replace(d,"esriMapsAnalystXLinkDisabled","esriMapsAnalystXLink")};return c})},"widgets/BusinessAnalyst/esriAnalystX/utils/ObjectUtil":function(){define(["../../baUtil/ObjectUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/utils/SortUtil"],
function(r,p,m){var h=Object.assign({},r,p,m);h.getPrototypeOf=function(f){try{return Object.getPrototypeOf?Object.getPrototypeOf(f):f.__proto__||f.constructor&&f.constructor.prototype}catch(e){return null}};h.isJson=function(f){return"object"===typeof f&&h.getPrototypeOf(f)===Object.prototype};h.copyJson=function(f){return void 0===f||null===f?null:JSON.parse(JSON.stringify({object:f})).object};h.convert=function(f,e,b){var c=e||function(){};e=c(f);if("undefined"!==typeof e)return e;if(Array.isArray(f)){var d=
[];f.forEach(function(k){d.push(h.convert(k,c,b))},this);return d}if(!h.isJson(f))return f;e={};for(var a in f){var g=f[a],l=b?c(a):a;"undefined"===typeof l&&(l=a);e[l]=h.convert(g,c,b)}return e};h.getDeepCopy=function(f){return h.convert(f)};h.getRange=function(f,e,b){e="function"===typeof e?e.bind(null==b?null:b):null;var c,d;for(d in f)if(b=f[d],b=Number(null===e?b:e(b,d)),!isNaN(b))if(void 0===a)var a=c=b;else a=Math.min(a,b),c=Math.max(c,b);return void 0===a?{}:{min:a,max:c}};h.removeEmptyObjects=
function(f){function e(c){c&&"object"===typeof c&&Object.keys(c).forEach(function(d){var a=c[d];!a||"object"!==typeof a||Array.isArray(a)||Object.keys(a).length?e(a):(b=!0,delete c[d])})}for(var b=!0;b;)b=!1,e(f);return f};h.removeValues=function(f,e){function b(c){c&&"object"===typeof c&&Object.keys(c).forEach(function(d){e(d,c[d])?b(c[d]):delete c[d]})}b(f);return f};h.isEqual=function(f,e){if(null===f||"object"!==typeof f||null===e||"object"!==typeof e)return f===e;if(Object.keys(f).length!==Object.keys(e).length)return!1;
var b={},c;for(c in f)b[c]=!0;for(c in e)if(void 0!==b[c])delete b[c];else return!1;for(c in f)if(!h.isEqual(f[c],e[c]))return!1;return!0};h.getObject=function(f,e){if(!e)return f;e=e.split(".");for(var b=0;b<e.length;b++)f=f&&f[e[b]];return f};h.formatNumber=function(f,e){e="number"===typeof e?{places:e}:e||{};if(null==e.places||0>e.places)e.places=h.getPlaces(f,!0),e.maxPlaces&&e.places>e.maxPlaces&&(e.places=e.maxPlaces);return p.formatNumber(f,e)};h.getPlaces=function(f,e){function b(l,k){var n=
f.indexOf(l,c);if(0>n)return d;l=f.charAt(n+l.length);return!l||0>k.indexOf(l)?d:n-c}f=+f;if(isNaN(f))return-1;f+="";var c=f.indexOf(".")+1,d=c?f.length-c:0;if(2>=d||!e)return d;e=0;if(!+f.substr(0,c-1))for(;"0"===f.charAt(c);)c++,e++,d--;for(var a=d-1;2<=a;a--){var g=Math.min(b("000000000000000".substr(0,a),"01234"),b("999999999999999".substr(0,a),"56789"));if(g!==d){d=g;break}}return d+e};return h})},"widgets/BusinessAnalyst/baUtil/ObjectUtil":function(){define(["require","exports"],function(r,
p){function m(h,f){for(var e=0,b=Object.keys(f);e<b.length;e++){var c=b[e];"object"!==typeof h[c]||null===h[c]||"object"!==typeof f[c]||null===f[c]?h[c]=f[c]:Array.isArray(h[c])?Array.isArray(f[c])?h[c].concat(f[c]):h[c]=f[c]:Array.isArray(f[c])?h[c]=f[c]:m(h[c],f[c])}}return{map:function(h,f,e){void 0!==e&&(f=f.bind(e));if("object"!==typeof h)throw Error("Object or array expected");if(Array.isArray(h)){e=[];for(var b=0,c=h.length;b<c;b++)e.push(f(h[b],b));return e}e={};b=0;for(c=Object.keys(h);b<
c.length;b++){var d=c[b];Object.hasOwnProperty.call(h,d)&&(e[d]=f(h[d],d))}return e},deepAssign:function(h){for(var f=[],e=1;e<arguments.length;e++)f[e-1]=arguments[e];for(e=0;e<f.length;e++)m(h,f[e]);return h}}})},"esri/dijit/geoenrichment/utils/SortUtil":function(){define([],function(){function r(f,e,b,c){f=void 0===f||null===f;return f!=(void 0===e||null===e)?(e=f?-1:1,(void 0===c?b:c)?-e:e):f?0:null}function p(f){var e=/^(.+)\s([1-9]\d*)$/.exec(f);return e?{base:e[1],number:e[2]}:/^[1-9]\d*$/.test(f)?
{base:"",number:+f}:{base:f,number:0}}var m={NEWEST:"newest",OLDEST:"oldest",ALPHABETICAL:"alphabetical",UNALPHABETICAL:"unalphabetical",compareNumeric:function(f,e,b,c){c=r(f,e,b,c);if(null!==c)return c;f=Number(f);e=Number(e);c=f>e?1:f<e?-1:0;return b?-c:c},compareString:function(f,e,b,c){c=r(f,e,b,c);if(null!==c)return c;f=String(f);e=String(e);c=f.localeCompare(e);return b?-c:c}},h=/^(.+)\s([1-9]\d*)(\D*)$/;m.compareNames=function(f,e,b,c){var d=p("string"===typeof f?f.toLowerCase():f),a=p("string"===
typeof e?e.toLowerCase():e),g=null;if(d.base===a.base)g=m.compareNumeric(d.number,a.number,b,c);else{var l=h.exec(d.base);if(l){var k=h.exec(a.base);k&&l[1]===k[1]&&l[3]===k[3]&&(g=m.compareNumeric(l[2],k[2],b,c))}null===g&&(g=m.compareString(d.base,a.base,b,c))}return g||m.compareString(f,e,b,c)};m.compare=function(f,e,b,c){var d=r(f,e,b,c);if(null!==d)return d;d=typeof f;typeof e!=d&&(d="");switch(d){case "number":case "boolean":break;case "object":f=f.valueOf();e=e.valueOf();break;default:return m.compareString(f,
e,b,c)}d=f>e?1:f<e?-1:0;return b?-d:d};return m})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/MouseUtil":function(){define(["dojo/dom-geometry","esri/dijit/geoenrichment/utils/MouseUtil"],function(r,p){var m;p.unitTesting_setCursorOverNode=function(h){h=r.position(h);p.unitTesting_setCursorPosition(h.x+h.w/2,h.y+h.h/2)};p.unitTesting_setCursorPosition=function(h,f){p._latestEvent={clientX:h,pageX:h,clientY:f,pageY:f}};p.unitTesting_lockPosition=function(h){m=h};p.unitTesting_shiftMousePosition=
function(h,f){p.unitTesting_setCursorPosition(p._latestEvent.clientX+(h||0),p._latestEvent.clientY+(f||0))};p._setLatestEvent=function(h){m||(p._latestEvent=h)};return p})},"widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/SelectableTreeGrid":function(){define("dojo/_base/declare dojo/aspect dojo/Evented dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on dojo/query dijit/Tooltip dijit/_WidgetBase ../../dijit/_TemplatedMixin dgrid/OnDemandGrid dgrid/tree esri/dijit/geoenrichment/utils/KeyboardUtil esri/dijit/geoenrichment/TriStateItem ../../dijit/utils/DgridUtil ../../dijit/utils/DomUtil ../../dijit/utils/MouseUtil ../../dijit/tooltips/TooltipUtil dojo/text!./templates/SelectableTreeGrid.html xstyle/css!./css/SelectableTreeGrid.css".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y,B){var D=r(null,{_selectedRowInfos:null,_lastSelectedRowInfo:null,_outsideHandler:null,_isSelectionFrozen:!1,keepSelectionOnOutsideClick:!1,_previouslySelectedRowsByNode:null,constructor:function(){this._previouslySelectedRowsByNode=new WeakMap},buildRendering:function F(){this._selectedRowInfos={};this.inherited(F,arguments)},postCreate:function z(){this.inherited(z,arguments);h.add(this.domNode,"esriMapsAnalystXNonSelectable")},_reselectSingleNode:function(z){this.selectSingleRow(this._previouslySelectedRowsByNode.get(z),
z)},selectSingleRow:function(z,w){this.unselectAllRows();this._selectRow(z,w)},_selectRow:function(z,w){h.add(z,this.selectedRowClass);h.add(z,"row-level-"+this._getNodeLevel(w));var A=this.tree.getIdentity(w),H={row:z,node:w,nodeId:A,index:w.parent&&w.parent.children.indexOf(w)};this._lastSelectedRowInfo=this._selectedRowInfos[A]=H;this._previouslySelectedRowsByNode.set(w,z);var G=this;this._outsideHandler=this._outsideHandler||b(document.body,"click",function(){v.isMouseOver(G.domNode)||G._isSelectionFrozen||
G.keepSelectionOnOutsideClick||G.unselectAllRows()})},_unselectRow:function(z,w){delete this._selectedRowInfos[this.tree.getIdentity(w)];h.remove(z,this.selectedRowClass)},unselectAllRows:function(){for(var z in this._selectedRowInfos)h.remove(this._selectedRowInfos[z].row,this.selectedRowClass);this._selectedRowInfos={};this._lastSelectedRowInfo=null;this._outsideHandler&&this._outsideHandler.remove();this._outsideHandler=null},getSelectedRowNodes:function(){return this._getSelectedNodesRows().nodes},
selectRowNodes:function(z){var w=this;z&&z.forEach(function(A){var H=w.grid.row(A);H&&H.element&&w._selectRow(H.element,A)})},freezeRowSelection:function(){this._isSelectionFrozen=!0},unfreezeRowSelection:function(){this._isSelectionFrozen=!1},_getSelectedNodesRows:function(){var z=[],w=[],A=[],H;for(H in this._selectedRowInfos)A.push(this._selectedRowInfos[H]);A.sort(function(G,I){return G.index-I.index});A.forEach(function(G){z.push(G.node);w.push(G.row)});return{nodes:z,rows:w}},_emitSelectedRowsEvent:function(){var z=
this._getSelectedNodesRows();if(z.nodes.length)this.onRowsSelected(z.nodes,z.rows)}});return r([a,g,m,D],{templateString:B,tree:null,grid:null,gridClass:"",highlightSelected:!0,firstColumns:null,additionalColumns:null,showRootCheckbox:!0,showCheckboxColumn:!0,showHeader:!0,labelColumnField:"label",gridParams:null,keepContentUnderScroll:void 0,hideInvisibleExpandoIcons:!1,expandOnNodeClick:!1,checkLimit:0,checkLimitMessage:null,checkLimitMessageTimeout:5E3,handleMultipleCheck:!1,enableRowSelection:!1,
enableMultipleRowSelection:!1,allowSelectionFromManyParents:!1,selectedRowFilter:null,selectedRowClass:"row-selected",enableHeaderLabelToggleClick:!0,defaultExpand:null,fitParentSize:!1,renderAllRows:!1,rowPostProcessor:null,_rootCheckbox:null,_checkboxes:null,_lastCheckedNode:null,updateSelectionCountDiv:function(z,w){},getLabel:function(z,w){return z.label},postCreate:function w(){this.inherited(w,arguments);this._createGrid()},resize:function(){this.grid.resize();this._updateCheckboxState(this._rootCheckbox);
for(var w in this._checkboxes)this._updateCheckboxState(this._checkboxes[w]);this._emitSelectionChanged()},setWidth:function(w){this.grid&&this.grid.domNode&&e.set(this.grid.domNode,"width",w+"px")},setHeight:function(w){this.grid&&this.grid.domNode&&e.set(this.grid.domNode,"height",w+"px")},row:function(w){return this.grid.row(w)},cell:function(w){return this.grid.cell(w)},_labelColumn:null,_createGrid:function(){var w=this;this._checkboxes={};var A={label:this.getLabel(this.tree.root,!0),sortable:!1,
field:this.labelColumnField,renderCell:this._renderLabel.bind(this),renderHeaderCell:this._renderLabelHeader.bind(this,this.tree.root)},H;if(this.additionalColumns&&this.additionalColumns.length&&(H=this.additionalColumns.filter(function(I){return I.field===w.labelColumnField})[0])){for(var G in A)void 0===H[G]&&(H[G]=A[G]);A=H}A.indentWidth=A.indentWidth||16;this._labelColumn=A=this._prepareTreeColumn(A);G=[];this.firstColumns&&(G=G.concat(this.firstColumns));this.showCheckboxColumn&&G.push({label:"",
field:"checkbox",sortable:!1,renderCell:this._renderCheckboxForColumn.bind(this),renderHeaderCell:this._renderCheckboxForColumn.bind(this,this.tree.root)});H||G.push(A);this.additionalColumns&&(G=G.concat(this.additionalColumns));A=["esriMapsAnalystXSelectableTreeGrid"];this.gridClass&&A.push(this.gridClass);this.fitParentSize&&A.push("fitParentSize");A=Object.assign({class:A.join(" "),keepScrollPosition:!0,store:this.tree,columns:G},this.gridParams);this.grid=this._createGridObject(A,this.gridContainer);
this.own(this.grid);this.grid._expanded=this.defaultExpand||this.grid._expanded||{};u.oddEvenFix(this.grid);this.own(b(this.tree,"updated",this._onStoreUpdated.bind(this)));this._addKeepScrollHandlers();this._addGridHandlers();this.renderAllRows&&(this.grid.minRowsPerPage=1E4,this.grid.maxRowsPerPage=10250);this.grid.startup();y.autoTooltip(this.domNode);this.showHeader||h.add(this.domNode,"esriMapsAnalystXGridNoHeader");b(this.grid.domNode,".dgrid-expando-icon:click,.dgrid-content .dgrid-column-labelColumn:dblclick,.dgrid-content .dgrid-column-labelColumn:keydown",
function(I){(I=w.grid.row(I))&&w.onExpandChangedUser(I.data)})},_createGridObject:function(w,A){return new l(w,A)},onRowInserted:function(w,A){},_addGridHandlers:function(){function w(H,G){A.enableRowSelection&&G.parent&&(!A.selectedRowFilter||A.selectedRowFilter(G))&&(h.add(H,"esriMapsAnalystXClickable"),b(H,"click",function(I){setTimeout(function(){if(!A._isSelectionFrozen){if(I.shiftKey&&A.enableMultipleRowSelection){if(A._lastSelectedRowInfo&&A._lastSelectedRowInfo.row.parentNode&&A._lastSelectedRowInfo.node.parent===
G.parent){var N=t.getChildIndex(A._lastSelectedRowInfo.row.parentNode,A._lastSelectedRowInfo.row),M=t.getChildIndex(H.parentNode,H),O=N<=M?A._lastSelectedRowInfo.row:H;N=N<=M?H:A._lastSelectedRowInfo.row;M=O;if(O.id!==N.id){do{O=A.grid.row(M).data;A._selectRow(M,O);if(M.id===N.id)break;M=M.nextSibling}while(M)}}else A.selectSingleRow(H,G);t.stealFocus()}else n.isCtrl(I)&&A.enableMultipleRowSelection?A._lastSelectedRowInfo&&A._lastSelectedRowInfo.row.parentNode&&A._lastSelectedRowInfo.node.parent===
G.parent||A.allowSelectionFromManyParents?A._selectedRowInfos[G.id]?A._unselectRow(H,G):A._selectRow(H,G):A.selectSingleRow(H,G):A.selectSingleRow(H,G);A._emitSelectedRowsEvent()}})}))}var A=this;this.own(p.after(this.grid,"insertRow",function(H){var G=H&&A.grid._rowIdToObject[H.id];if(H){if(G&&A.hideInvisibleExpandoIcons&&(!G.children||!G.children.length)){var I=c(".dgrid-expando-icon",H)[0];I&&(I.style.width="0")}t[G&&!1===G.visible?"hide":"show"](H);w(H,G)}G&&(A._updateRowHighlighting(G,H),A.onRowInserted(H,
G));A.rowPostProcessor&&A.rowPostProcessor(H,G);return H}))},_addKeepScrollHandlers:function(){function w(H){if(!A.grid.contentNode)return H;if(A.fitParentSize){var G=t.hasScrollbars(A.grid.bodyNode);A.grid.headerNode.style[A.isLeftToRight()?"right":"left"]=G.w?"":"0px";A._lastContentWidth=A.grid.contentNode.style.width||A._lastContentWidth||"";A.grid.contentNode.style.width=G.h?A._lastContentWidth:""}else A.keepContentUnderScroll?A.grid.contentNode.style.width=A.grid.headerNode.firstChild.offsetWidth+
"px":!1===A.keepContentUnderScroll&&(A.grid.contentNode.style.width="");return H}var A=this;if(this.fitParentSize||void 0!==this.keepContentUnderScroll)p.before(this.grid,"refresh",function(){A.hideCheckLimitMessage();A._lastCheckedNode=null}),p.after(this.grid,"resize",w),p.after(this.grid,"refresh",w)},_getNodeLevel:function(w){var A=-1;for(w=w&&w.parent;w;)A++,w=w.parent;return A},_prepareTreeColumn:function(w){return this._wrapTreeColumn(k(w))},_wrapTreeColumn:function(w){return w},_onStoreUpdated:function(){this._checkboxes=
{};this._refreshGrid();this._rootCheckbox&&this._updateCheckboxState(this._rootCheckbox);this._emitSelectionChanged()},_emitSelectionChanged:function(w){var A=this.tree.root.selectCount;this.updateSelectionCountDiv(this.selectionCounter,A);this.emit("SelectionChanged",{selected:A,toggledTreeNode:w})},refresh:function(){this._refreshGrid();this.refreshCheckboxes()},_isRefreshSuspended:!1,setRefreshSuspended:function(w){this._isRefreshSuspended=w},_refreshGrid:function(){if(!this._isRefreshSuspended){var w=
this.grid.getScrollPosition();this.grid.refresh();this.grid.scrollTo(w);for(var A in this._selectedRowInfos)this.grid.row(this._selectedRowInfos[A].node).element&&this._selectRow(this.grid.row(this._selectedRowInfos[A].node).element,this._selectedRowInfos[A].node)}},getScrollPosition:function(){return this.grid&&this.grid.getScrollPosition()},setScrollPosition:function(w){return this.grid&&this.grid.scrollTo(w)},_renderCheckbox:function(w){if(!w.leafCount&&w!==this.tree.root||!this.showCheckboxColumn||
!1===w.selectable&&void 0===w.indepSelection)return document.createTextNode("");var A=new q(null,{class:"esriStyleInTable"});A.autoToggle=!1;A.node=w;this._updateCheckboxState(A,w);!1===w.enabled&&A.set("disabled",!0);w===this.tree.root?(this._rootCheckbox=A,t[this.showRootCheckbox?"show":"hide"](A.domNode)):this._checkboxes[this.tree.getIdentity(w)]=A;A.onClick=this._onCheckboxClick.bind(this,w,A);return A},_renderCheckboxForColumn:function(w){return(w=this._renderCheckbox(w))&&w.domNode},refreshCheckboxes:function(){this._rootCheckbox&&
this._updateCheckboxState(this._rootCheckbox);for(var w in this._checkboxes)this._updateCheckboxState(this._checkboxes[w])},clearLastCheckInfo:function(){this._lastCheckedNode=null},_onCheckboxClick:function(w,A,H){H.stopPropagation();this.hideCheckLimitMessage();var G=this.handleMultipleCheck&&("function"!==typeof this.handleMultipleCheck||this.handleMultipleCheck(w));G&&H.shiftKey&&this._tryToggleMultipleNodes(this._lastCheckedNode,w,A||H)?this._lastCheckedNode=w:(this._lastCheckedNode=G?w:null,
this._toggleNodeSelection(w,A||H),this.refreshCheckboxes())},_tryToggleMultipleNodes:function(w,A,H){if(!w||w===A||w.parent!==A.parent)return!1;var G=A.parent.children,I=G.indexOf(w);A=G.indexOf(A);w=I<A?1:-1;var N=[],M=[];for(I+=w;;I+=w){var O=G[I];((void 0===O.indepSelection?O.selected:O.indepSelection)?N:M).push(O);if(I===A)break}N.forEach(function(S){this._toggleNodeSelection(S,H)},this);M.every(function(S){return this._toggleNodeSelection(S,H)},this);this.refreshCheckboxes();return!0},_toggleNodeSelection:function(w,
A){var H=void 0===w.indepSelection?!w.selected:!w.indepSelection;if(H&&this.checkLimit){var G=this.getSelectedNodes().length,I="function"===typeof this.checkLimit?this.checkLimit(this.tree,G):this.checkLimit;if(G>=I)if(void 0===w.indepSelection&&w.children&&!1!==this.tree.getSelectionState(w))H=!1;else return this.showCheckLimitMessage(A),!1}G=!0;void 0===w.indepSelection?(G=this.tree.changeSelect(w,H,I),!G&&this.showCheckLimitMessage(A)):w.indepSelection=H;this._emitSelectionChanged(w);return G},
_checkLimitHandler:null,showCheckLimitMessage:function(w){if(this.checkLimitMessage){var A=w&&(w.domNode||w.target);A&&(d.show(this.checkLimitMessage,A,["above","below"]),w=function(){A&&d.hide(A);A=null},setTimeout(w,this.checkLimitMessageTimeout),this._checkLimitHandler=w,this.onCheckLimitReached(w))}},hideCheckLimitMessage:function(){this._checkLimitHandler&&this._checkLimitHandler();this._checkLimitHandler=null},onCheckLimitReached:function(w){},_updateCheckboxState:function(w){if(w){var A=this._getNodeSelection(w.node);
w.set("checked",A);this._updateRowHighlighting(w.node,null,A)}},_getNodeSelection:function(w){return void 0!==w.indepSelection?w.indepSelection:this.tree.getSelectionState(w)},_updateRowHighlighting:function(w,A,H){this.highlightSelected&&w&&(H=void 0!==H?H:this._getNodeSelection(w),(A=A||this.grid&&this.row(w).element)&&(!0!==H||void 0===w.indepSelection&&!1===w.selectable?h.remove(A,"selected"):h.add(A,"selected")))},_renderLabel:function(w,A,H){A=this._renderLabelNode(w,H);this._provideLabelClickAction(A,
H,w);return A},_provideLabelClickAction:function(w,A,H){var G=this.expandOnNodeClick&&H.children?H.children.length&&(w=A,function(){this.toggleExpand(H);this.onExpandChangedUser(H)}.bind(this)):!1!==H.enabled&&this.showCheckboxColumn?this._onCheckboxClick.bind(this,H,null):null;G&&(h.add(w,"esriMapsAnalystXClickable"),b(w,"click",function(I){I.stopPropagation();G(I)}))},_renderLabelNode:function(w){return f.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(w)})},
_renderLabelHeader:function(w){var A=f.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(w)||this._labelColumn&&this._labelColumn.label||""});this.enableHeaderLabelToggleClick&&this.showRootCheckbox&&(h.add(A,"esriMapsAnalystXClickable"),b(A,"click",this._onCheckboxClick.bind(this,w,null)));return A},onRowsSelected:function(w,A){},isNodeSelected:function(w){return w&&(w.selected||w.indepSelection)},getSelectedNodes:function(){var w=this.tree.getSelectedNodes(!1),
A=this._getIndepSelectedNodes();return w.concat(A)},_getIndepSelectedNodes:function(){function w(H){H&&(H.indepSelection&&A.push(H),H.children&&H.children.forEach(w))}var A=[];w(this.tree.root);return A},getSelectedState:function(){if(!this.tree)return null;var w={normalSelection:{},indepSelection:{}},A=this.tree.getSelectedNodes(!1);A&&A.forEach(function(H){w.normalSelection[H.id]=!0});(A=this._getIndepSelectedNodes())&&A.forEach(function(H){w.indepSelection[H.id]=!0});return w},setSelectedState:function(w){if(this.tree){this.tree.changeSelect(this.tree.root,
!1);if(w){for(var A in w.normalSelection){var H=this.tree.get(A);H&&this.tree.changeSelect(H,!0)}for(A in w.indepSelection)if(H=this.tree.get(A))H.indepSelection=!0}this.refreshCheckboxes()}},setNodeSelected:function(w,A,H){w&&(void 0!==w.indepSelection?w.indepSelection=A:this.tree.changeSelect(w,A),!1!==H&&this.refreshCheckboxes())},isExpanded:function(w){w="string"===typeof w?w:w[this.tree.idProperty];return this.grid._expanded&&this.grid._expanded[w]},setExpanded:function(w,A,H){w="string"==typeof w?
w:w[this.tree.idProperty];void 0!==w&&(!1!==H?(H=this.grid.row(w))&&H.element&&this.grid.expand(w,A):this.grid._expanded[w]=A)},toggleExpand:function(w){this.setExpanded(w,!this.isExpanded(w))},getExpandedState:function(){return Object.assign({},this.grid._expanded)},setExpandedState:function(w){this.grid._expanded=w||{}},onExpandChangedUser:function(w){},destroy:function(){this.unselectAllRows();this.inherited(arguments)}})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_TemplatedMixin":function(){define(["dojo/_base/declare",
"dijit/_TemplatedMixin","./_EscapeValueMixin"],function(r,p,m){return r([p,m],{})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_EscapeValueMixin":function(){define(["dojo/_base/declare"],function(r){return r(null,{_escapeValue:function(p){return p.replace(/"/g,"\x26quot;")}})})},"dgrid/tree":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/Deferred dojo/_base/lang dojo/query dojo/on dojo/aspect ./util/has-css3 ./Grid dojo/has!touch?./util/touch put-selector/put".split(" "),function(r,
p,m,h,f,e,b,c,d,a,g){function l(q,u,t,v){v=this.grid.isRTL?"right":"left";var y=".dgrid-expando-icon";u&&(y+=".ui-icon.ui-icon-triangle-1-"+(t?"se":"e"));q=g("div"+y+"[style\x3dmargin-"+v+": "+q*(this.indentWidth||9)+"px; float: "+v+"]");q.innerHTML="\x26nbsp;";return q}function k(q){var u=this,t=this.style.height;t&&(this.style.display="0px"==t?"none":"block");q&&(g(this,".dgrid-tree-resetting"),setTimeout(function(){g(u,"!dgrid-tree-resetting")}));this.style.height=""}function n(q){var u=q.renderCell||
d.defaultRenderCell,t,v;q||(q={});q.shouldExpand=q.shouldExpand||function(y,B,D){return D};b.after(q,"init",function(){var y=q.grid,B=".dgrid-content .dgrid-column-"+q.id,D=[];y.cleanEmptyObservers=!1;if(!y.store)throw Error("dgrid tree column plugin requires a store to operate.");q.renderExpando||(q.renderExpando=l);D.push(y.on(q.expandOn||".dgrid-expando-icon:click,"+B+":dblclick,"+B+":keydown",function(E){var F=y.row(E);y.store.mayHaveChildren&&!y.store.mayHaveChildren(F.data)||"keydown"==E.type&&
32!=E.keyCode||"dblclick"==E.type&&v&&1<v.count&&F.id==v.id&&-1<E.target.className.indexOf("dgrid-expando-icon")||y.expand(F);-1<E.target.className.indexOf("dgrid-expando-icon")&&(v&&v.id==y.row(E).id?v.count++:v={id:y.row(E).id,count:1})}));c("touch")&&D.push(y.on(a.selector(B,a.dbltap),function(){y.expand(this)}));y._expanded||(y._expanded={});D.push(b.after(y,"insertRow",function(E){var F=this.row(E);q.shouldExpand(F,t,this._expanded[F.id])&&this.expand(E,!0,!0);return E}));D.push(b.before(y,"removeRow",
function(E,F){if(E=E.connected)f("\x3e.dgrid-row",E).forEach(function(z){y.removeRow(z,!0)}),F||g(E,"!")}));q.collapseOnRefresh&&D.push(b.after(y,"cleanup",function(){this._expanded={}}));y._calcRowHeight=function(E){var F=E.connected;return E.offsetHeight+(F?F.offsetHeight:0)};y.expand=function(E,F,z){var w=E.element?E:y.row(E),A=c("transitionend");E=new m;var H=E.promise;E.resolve();E=w.element;E=-1<E.className.indexOf("dgrid-expando-icon")?E:f(".dgrid-expando-icon",E)[0];z=z||!1===q.enableTransitions;
if(E&&E.mayHaveChildren&&(z||F!==!!this._expanded[w.id])){var G=void 0===F?!this._expanded[w.id]:F;g(E,".ui-icon-triangle-1-"+(G?"se":"e")+"!ui-icon-triangle-1-"+(G?"e":"se"));F=w.element;var I=F.connected,N={originalQuery:this.query};if(!I){I=N.container=F.connected=g(F,"+div.dgrid-tree-container");var M=function(R){return y.store.getChildren(w.data,R)};q.allowDuplicates&&(N.parentId=w.id);"level"in E&&(M.level=E.level);H=H.then(function(){if(y.renderQuery)return y.renderQuery(M,N);var R=g(I,"div"),
V=y.renderArray(M(N),R,"level"in M?{queryLevel:M.level}:{});m.when(V,function(){g(R,"!")});return V});A?e(I,A,k):k.call(I)}I.hidden=!G;var O=I.style;if(!A||z)O.display=G?"block":"none",O.height="";else{if(G){O.display="block";var S=I.scrollHeight;O.height="0px"}else g(I,".dgrid-tree-resetting"),O.height=I.scrollHeight+"px";setTimeout(function(){g(I,"!dgrid-tree-resetting");O.height=G?S?S+"px":"auto":"0px"})}G?this._expanded[w.id]=!0:delete this._expanded[w.id]}return H};b.after(q,"destroy",function(){p.forEach(D,
function(E){E.remove()});delete y.expand;delete y._calcRowHeight})});q.renderCell=function(y,B,D,E){var F=q.grid,z=Number(E&&E.queryLevel)+1,w=!F.store.mayHaveChildren||F.store.mayHaveChildren(y),A=E.parentId;z=t=isNaN(z)?0:z;F=q.renderExpando(z,w,F._expanded[(A?A+"-":"")+F.store.getIdentity(y)],y);F.level=z;F.mayHaveChildren=w;(y=u.call(q,y,B,D,E))&&y.nodeType?(g(D,F),g(D,y)):D.insertBefore(F,D.firstChild)};return q}n.defaultRenderExpando=l;h.getObject("dgrid.tree",!0);return dgrid.tree=n})},"dgrid/util/has-css3":function(){define(["dojo/has"],
function(r){function p(h,f){h=h.style;var e;if(f in h)return!0;f=f.slice(0,1).toUpperCase()+f.slice(1);for(e=m.length;e--;)if(m[e]+f in h)return m[e];return!1}var m=["ms","O","Moz","Webkit"];r.add("css-transitions",function(h,f,e){return p(e,"transitionProperty")});r.add("css-transforms",function(h,f,e){return p(e,"transform")});r.add("css-transforms3d",function(h,f,e){return p(e,"perspective")});r.add("transitionend",function(){var h=r("css-transitions");return h?!0===h?"transitionend":{ms:"MSTransitionEnd",
O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[h]:!1});return r})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DgridUtil":function(){define(["dojo/aspect","dojo/dom-class","dojo/query","../../utils/ArrayUtil"],function(r,p,m,h){function f(d,a,g){if(void 0===g){var l=d._rowIdToObject[a.id];l&&(g=(d=d.store)&&d.isOdd&&d.isOdd(l))}0!==g&&1!==g||p.replace(a,c[g],c[1-g])}function e(d,a,g){var l=d.store;if(l&&l.updateExpand){g=l.updateExpand(a.data,g,!0,d.getSortingFunction());
for(var k in g)a=d.row(l.get(k)),a.element&&f(d,a.element,g[k])}}var b=["ui-icon-triangle-1-e","ui-icon-triangle-1-se"],c=["dgrid-row-even","dgrid-row-odd"];return{createExpando:function(d){p.add(d,"dgrid-expando-icon ui-icon ui-icon-triangle-1-e esriMapsAnalystXClickable");return{expando:d,update:function(a){a=a?1:0;p.replace(d,b[a],b[1-a])}}},oddEvenFix:function(d){d.expand&&(d.getSortingFunction=function(){var a=this.get("sort");return a&&a.length?h.getSorting(a):null},r.after(d,"insertRow",function(a){f(d,
a);return a}),r.before(d,"refresh",function(){var a=d.store;a&&a.updateExpandedNodes&&a.updateExpandedNodes(d._expanded,d.getSortingFunction())}),r.around(d,"expand",function(a){return function(g,l){var k=g.element?g:d.row(g);void 0===l&&(l=!d._expanded[k.id]);!0===l&&e(d,k,!0);var n=a.apply(this,arguments);!1===l&&e(d,k,!1);return n}}),r.around(d,"adjustRowIndices",function(a){return function(){var g=d.store;g&&g.updateExpandedNodes&&g.updateExpand&&g.isOdd||a.apply(this,arguments)}}))},makeContentNeverGoUnderScroll:function(d){function a(){var g=
d.headerNode.firstChild,l=d.contentNode;l&&g&&g.offsetWidth!==l.offsetWidth&&(l.style.width="",g.style.width="",g.style.width=l.offsetWidth+"px")}r.after(d,"resize",a);r.after(d,"refresh",a);r.after(d,"expand",function(g){setTimeout(a,100);setTimeout(a,300);return g})},inlineSortArrow:function(d,a,g){a=h.arrayToObject(h.listToArray(a));r.after(d,"updateSortArrow",function(l,k){if((k=l[0]&&l[0].attribute)&&a[k]){var n=(k=d._sortNode||d._findSortArrowParent(k))&&m(".dgrid-sort-arrow",k)[0];l=l[0].descending;
if(n){n.remove();p.remove(k,"dgrid-sort-down dgrid-sort-up");var q=g?m(g,k)[0]:k.lastChild.append?k.lastChild:k;q.append||(q=k);p.add(q,l?"dgrid-sort-down":"dgrid-sort-up");q.append(n)}}},!0)}}})},"widgets/BusinessAnalyst/esriAnalystX/utils/ArrayUtil":function(){define("require exports ../../baUtil/array dojo/store/util/SimpleQueryEngine ./ObjectUtil esri/dijit/geoenrichment/utils/ArrayUtil".split(" "),function(r,p,m,h,f,e){function b(a,g){a.some(function(l,k){g.func(l,k,g,a);if(g.stop)return!0});
return g}function c(a){var g=a.split(" "),l=g[1];a={};switch(g[0]){case "max":a.result=-Infinity;g=function(k,n,q){q.result=Math.max(q.result,f.getObject(k,l))};break;case "min":a.result=Infinity;g=function(k,n,q){q.result=Math.min(q.result,f.getObject(k,l))};break;case "sum":a.result=0;g=function(k,n,q){q.result+=f.getObject(k,l)};break;case "random":a.result=void 0;g=function(k,n,q,u){q.result=u[Math.round((u.length-1)*Math.random())];q.stop=!0};break;default:throw Error("Unsupported query.");}a.func=
g;return a}var d={getSorting:function(a,g){if(!a)return f.compare;if("function"===typeof a)return a;var l=Array.isArray(a)?a:a.sort||[a];var k={};"string"===typeof g&&(g=[g]);Array.isArray(g)?g.forEach(function(n){k[n]=f.compareNames}):g&&(k=g);return function(n,q){for(var u=void 0,t=0;u=l[t];t++){var v=n[u.attribute],y=q[u.attribute];if(v=(k[u.attribute]||(k["*"]?k["*"].bind(null,u.attribute):f.compare))(v,y,!1,!1,n,q))return u.descending?-v:v}return 0}},sort:function(a,g,l){return a.sort(d.getSorting(g,
l))},sortIndices:function(a,g,l){a=m.map(a,function(n,q){return{value:n,index:q}});var k=d.getSorting(g,l);a.sort(function(n,q){return k(n.value,q.value)});return m.map(a,function(n){return n.index})},getQueryEngine:function(a,g){return function(l,k){k&&k.sort&&(k=Object.assign({},k),k.sort=d.getSorting(k.sort,a));return(g||h)(l,k)}},objectToArray:function(a,g){void 0===g&&(g=null);var l=[],k=g?function(u){return a[u]?a[u][g]:void 0}:function(u){return a[u]},n;for(n in a){var q=k(n);"undefined"!==
typeof q&&l.push(q)}return l},arrayToObject:function(a,g){var l={},k=e.composeIdentityFunction(g);m.forEach(a,function(n){l[k(n)]=n});return l},composeIdentityFunction:e.composeIdentityFunction,removeDuplicates:e.removeDuplicates,splitArrayToBunches:e.splitArrayToBunches,contains:function(a,g){return-1!==m.indexOfLoose(a,g)},remove:function(a,g){g=m.indexOfLoose(a,g);-1!==g&&a.splice(g,1);return-1!==g},merge:function(a,g){a=a||[];null!=g&&Array.prototype.push.apply(a,g);return a},listToArray:function(a,
g){if(null==a)return[];void 0===g&&(g=",");a="string"===typeof a?a.split(g):a.slice();for(g=0;g<a.length;g++)"string"===typeof a[g]&&(a[g]=a[g].trim());return a},reorderArray:function(a,g){var l=a.length,k=0,n=Array(l),q={},u={},t;for(t in g){var v=Math.round(t);if(0<=v&&v<l&&!q[v]){var y=Math.round(g[t]);0<=y&&y<l&&!u[y]&&(n[y]=a[v],q[v]=1,u[y]=1,k++)}}k!==l&&(n=n.filter(function(B,D){return u[D]}),a.forEach(function(B,D){!q[D]&&n.push(B)}));return n},mapIndices:function(a,g,l,k){k=null==k?null:
k;if(1===a)l.call(k,0,Math.floor(g/2));else{g=(g-1)/(a-1);for(var n=0;n<a;n++)l.call(k,n,Math.floor(.5+n*g))}},moveElement:function(a,g,l,k){var n=Array.isArray(g)?g:[g];if(-1!==n.indexOf(l))return a.slice();var q=[];a.forEach(function(u){-1===n.indexOf(u)&&(u==l?"before"===k?(n.forEach(function(t){q.push(t)}),q.push(l)):"after"===k&&(q.push(l),n.forEach(function(t){q.push(t)})):q.push(u))});return q},min:function(a,g){var l=a.length;switch(l){case 0:return null;case 1:return a[0];default:for(var k=
a[0],n=g(k),q=0,u=1;u<l;u++){var t=g(a[u]);n>t&&(k=a[u],n=t,q=u)}return{key:q,value:k,comparisonValue:n}}},max:function(a,g){var l=a.length;switch(l){case 0:return null;case 1:return a[0];default:for(var k=a[0],n=g(k),q=0,u=1;u<l;u++){var t=g(a[u]);n<t&&(k=a[u],n=t,q=u)}return{key:q,value:k,comparisonValue:n}}},query:function(a,g){if("object"===typeof g)return b(a,g);if("string"===typeof g)return g=c(g),b(a,g).result},everyEqualProperty:function(a,g){if(2>a.length)return!0;var l;return!a.some(function(k,
n){if(0===n)l=k[g];else if(l!==k[g])return!0})}};return d})},"widgets/BusinessAnalyst/baUtil/array":function(){define(["require","exports"],function(r,p){var m=Array.prototype,h={every:function(f,e,b){return null==f?!0:"string"===typeof f?m.every.call(f.split(""),e,b):m.every.call(f,e,b)},some:function(f,e,b){return null==f?!1:"string"===typeof f?m.some.call(f.split(""),e,b):m.some.call(f,e,b)},forEach:function(f,e,b){if(null!=f)return"string"===typeof f?m.forEach.call(f.split(""),e,b):m.forEach.call(f,
e,b)},map:function(f,e,b){return null==f?[]:"string"===typeof f?m.map.call(f.split(""),e,b):m.map.call(f,e,b)},filter:function(f,e,b){return null==f?[]:"string"===typeof f?m.filter.call(f.split(""),e,b):m.filter.call(f,e,b)},indexOf:function(f,e){return null==f?-1:"string"===typeof f?m.indexOf.call(f.split(""),e):m.indexOf.call(f,e)},indexOfLoose:function(f,e){if(null==f||void 0===f.length)return-1;if("string"===typeof f)return h.indexOfLoose(f.split(""),e);for(var b=0,c=f.length;b<c;b++)if(f[b]==
e)return b;return-1},lastIndexOf:function(f,e){return null==f?-1:"string"===typeof f?m.lastIndexOf.call(f.split(""),e):m.lastIndexOf.call(f,e)},lastIndexOfLoose:function(f,e){if(null==f||void 0===f.length)return-1;if("string"===typeof f)return h.lastIndexOfLoose(f.split(""),e);for(var b=f.length-1;0<=b;b--)if(f[b]==e)return b;return-1}};return h})},"widgets/BusinessAnalyst/SelectPointPolygonPage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/dom-class dojo/dom-style dojo/on dojo/query dojo/when dijit/_TemplatedMixin dijit/_WidgetBase esri/Color esri/dijit/Search esri/dijit/geoenrichment/_WizardPage esri/geometry/webMercatorUtils esri/graphic esri/InfoTemplate esri/symbols/PictureMarkerSymbol esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/toolbars/draw jimu/dijit/EditorXssFilter jimu/utils dojo/text!./SelectPointPolygonPage.html ./utils/GeocodeUtil".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y,B,D,E,F,z){return r([a,d,k],{templateString:F,polygonActive:!1,freehandPolygonActive:!1,postCreate:function(){this.inherited(arguments);var w=this;this.config.firstPageText=D.getInstance().sanitize(this.config.firstPageText);this.config.searchTextBoxOption?(this.search=(new l({map:this.map})).placeAt(this.searchContainer),this.search.activeSource.outFields.push("country"),this.own(e(this.search,"select-result",function(){w._loadSearchResult()}))):(h.remove(this.activatePinButton,
"esriBusinessAnalystButtonSearchPadding"),h.remove(this.activatePolygonButton,"esriBusinessAnalystButtonSearchPadding"),h.remove(this.activateFreehandPolygonButton,"esriBusinessAnalystButtonSearchPadding"));this.config.dropPinOption?this.own(e(this.activatePinButton,"click",function(){w._onActivatePinButtonClick()})):f.set(this.activatePinButton,"display","none");this.config.drawPolygonOption?this.own(e(this.activatePolygonButton,"click",function(){w._onActivatePolygonButtonClick()})):f.set(this.activatePolygonButton,
"display","none");this.config.drawFreehandPolygonOption?this.own(e(this.activateFreehandPolygonButton,"click",function(){w._onActivateFreehandPolygonButtonClick()})):f.set(this.activateFreehandPolygonButton,"display","none")},startup:function(){this.resize();this._started||h.add(this.layoutGrid.domNode,"business-analyst-search-suggestions-overflow")},_loadSearchResult:function(){this.wizard.selectedPoint.geometry=this.search.selectedResult.feature.geometry;this.wizard.selectedPoint.locationName=this.search.selectedResult.name;
var w=n.xyToLngLat(this.search.selectedResult.feature.geometry.x,this.search.selectedResult.feature.geometry.y);this.wizard.selectedPoint.long=w[0].toFixed(5);this.wizard.selectedPoint.lat=w[1].toFixed(5);this.wizard.setSelectedCountry(this.search.selectedResult.feature.attributes.country);this.onNext()},_onActivatePinButtonClick:function(){this._executeHandler?(this._deactivate(),this._deactivatePolygon(),this._deactivateFreehandPolygon()):(this._deactivatePolygon(),this._deactivateFreehandPolygon(),
this._setActive())},_setActive:function(){this._executeHandler||(h.add(this.activatePinButton,"esriBusinessAnalystPressedButton"),this.map.setInfoWindowOnClick(!1),this.map.setMapCursor("default"),this.map.disablePan(),this._executeHandler=e(this.map,"click",this._addPoint.bind(this)))},_deactivate:function(){this._executeHandler&&(h.remove(this.activatePinButton,"esriBusinessAnalystPressedButton"),this.map.setInfoWindowOnClick(!0),this.map.enablePan(),this._executeHandler.remove(),this._executeHandler=
null)},_addPoint:function(w){if(this._executeHandler){this._deactivate();var A=n.xyToLngLat(w.mapPoint.x,w.mapPoint.y),H=this;c(z.reverseGeocode({x:A[0],y:A[1]}),function(G){var I=new t("https://js.arcgis.com/3.28/esri/dijit/Search/images/search-pointer.png",36,36);H.wizard.selectedPoint.pointGraphic=new q(w.mapPoint,I);H.map.graphics.add(H.wizard.selectedPoint.pointGraphic);H.map.centerAndZoom(w.mapPoint,12);H.wizard.selectedPoint.geometry=w.mapPoint;H.wizard.selectedPoint.locationName=G&&G.address&&
G.address.LongLabel?G.address.LongLabel:"";H.wizard.setSelectedCountry(G.address.CountryCode);H.wizard.selectedPoint.long=A[0].toFixed(5);H.wizard.selectedPoint.lat=A[1].toFixed(5);H.onNext()})}},_onActivatePolygonButtonClick:function(){this.polygonActive?(this._deactivatePolygon(),this._deactivate(),this._deactivateFreehandPolygon()):(this._deactivate(),this._deactivateFreehandPolygon(),this._setActivePolygon())},_setActivePolygon:function(){this.polygonActive||(h.add(this.activatePolygonButton,
"esriBusinessAnalystPressedButton"),this.polygonActive=!0,this.toolbar||(this.toolbar=new B(this.map),this.toolbar.on("draw-end",m.hitch(this,this._addPolygon))),this.map.disablePan(),this.map.setInfoWindowOnClick(!1),this.toolbar.activate("polygon"))},_deactivatePolygon:function(){this.polygonActive&&(h.remove(this.activatePolygonButton,"esriBusinessAnalystPressedButton"),this.toolbar&&(this.toolbar.deactivate(),this.map.enablePan(),this.map.setInfoWindowOnClick(!0)),this.polygonActive=!1)},_onActivateFreehandPolygonButtonClick:function(){this.freehandPolygonActive?
(this._deactivateFreehandPolygon(),this._deactivate(),this._deactivatePolygon()):(this._deactivate(),this._deactivatePolygon(),this._setActiveFreehandPolygon())},_setActiveFreehandPolygon:function(){this.freehandPolygonActive||(h.add(this.activateFreehandPolygonButton,"esriBusinessAnalystPressedButton"),this.freehandPolygonActive=!0,this.toolbar||(this.toolbar=new B(this.map),this.toolbar.on("draw-end",m.hitch(this,this._addPolygon))),this.map.disablePan(),this.map.setInfoWindowOnClick(!1),this.toolbar.activate("freehandpolygon"))},
_deactivateFreehandPolygon:function(){this.freehandPolygonActive&&(h.remove(this.activateFreehandPolygonButton,"esriBusinessAnalystPressedButton"),this.toolbar&&(this.toolbar.deactivate(),this.map.enablePan(),this.map.setInfoWindowOnClick(!0)),this.freehandPolygonActive=!1)},_addPolygon:function(w){this._deactivate();this._deactivatePolygon();this._deactivateFreehandPolygon();var A=new v(v.STYLE_SOLID,new y(y.STYLE_SOLID,new g([199,55,36,1]),2),new g([199,55,36,.5]));w=new q(w.geometry,A);w.attributes=
{title:this.nls.customPolygon};A=new u;A.title="${title}";A.content=" ";A.info={};A.info.fieldInfos=[];w.setInfoTemplate(A);this.map.graphics.add(w);this.map.infoWindow.setFeatures([w]);this.map.infoWindow.show(this.map.toScreen(w.geometry.getExtent().getCenter()));this.map.infoWindow.removeActions("addMarker");this.wizard.drawnPolygonGraphic=w},resize:function(){this._resizeContentImg()},_resizeContentImg:function(){var w=document.activeElement;p.empty(this.contentContainer);var A=p.toDom(this.config.firstPageText);
p.place(A,this.contentContainer);this.contentContainer.nodeType&&1===this.contentContainer.nodeType&&((A=b("img",this.contentContainer))&&A.length&&A.forEach(m.hitch(this,function(H){"undefined"!==typeof H.complete&&!1===H.complete?this.own(e(H,"load",m.hitch(this,function(){this._resizeImg(H)}))):this._resizeImg(H)})),A=E.getFocusNodesInDom(this.domNode),A.length&&(E.initFirstFocusNode(this.domNode,A[0]),E.initLastFocusNode(this.domNode,A[A.length-1])),this.isOpen||p.isDescendant(w,this.domNode))&&
(w=E.getFirstFocusNode(this.domNode),E.isAutoFocusFirstNodeWidget(this)&&w.focus(),this.isOpen=!1)},_resizeImg:function(w){var A=p.getContentBox(this.contentContainer),H=p.getContentBox(w);H&&H.w&&H.w>=A.w&&p.setStyle(w,{maxWidth:A.w-20+"px",maxHeight:A.h-40+"px"})}})})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(r,p,m,h,f,e,b,c,d,a,g,l,k,n,q,u,t,v,y,B,D,E,F,z,w,A,H,G,I,N,M,O,S,R,V,Z,da,W,ea,Q,X,U,fa,ka){function oa(C,J){C&&J&&(C._layer=J,C._sourceLayer=J)}p=p([B,D,E,f],{declaredClass:"esri.dijit.Search",templateString:y,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(C,J){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new X("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:v.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:v.widgets.Search.main.placeholder,highlightSymbol:(new M(r.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new V).setColor(new fa([181,56,46,.9])).setFont(new Z("14px",Z.STYLE_NORMAL,Z.VARIANT_NORMAL,Z.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new A(v.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};C=m.mixin({},this.options,C);this.set(C);this._updateActiveSource();this._i18n=v;this._defaultSR=new G(4326);this.domNode=J},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(m.hitch(this,this._init))},postCreate:function(){var C=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(c(this.submitNode,F,m.hitch(this,this._searchButton)));this.own(c(this.sourcesBtnNode,F,m.hitch(this,this._toggleSourcesMenu)));this.own(c(this.inputNode,F,m.hitch(this,this._inputClick)));this.own(c(this.clearNode,F,m.hitch(this,this._clearButton)));this.own(c(this.formNode,"submit",m.hitch(this,function(J){J.preventDefault();this._cancelSuggest();this.search()})));this.own(c(this.inputNode,"keyup",m.hitch(this,function(J){this._inputKey(J)})));
this.own(c(this.sourcesBtnNode,"keyup",m.hitch(this,function(J){this._sourceBtnKey(J)})));this.own(c(this.suggestionsNode,"li:click, li:keyup",function(J){C._suggestionsEvent(J,this)}));this.own(c(this.sourcesNode,"li:click, li:keyup",function(J){C._sourcesEvent(J,this)}));this.own(c(this.inputNode,"input, paste",m.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",m.hitch(this,function(J){this._showMoreResultsClick(J)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",m.hitch(this,function(J){this._moreResultsClick(J)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",m.hitch(this,function(J){this._switchCoordinatesClick(J)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();u.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();k.get(this.inputNode,"value")&&k.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);n.remove(this.containerNode,this.css.hasValue);k.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){q.set(this.domNode,"display","block")},hide:function(){q.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(n.add(this.containerNode,this.css.searchExpanded),n.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(n.remove(this.containerNode,this.css.searchExpanded),n.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(C){this.enableButtonMode&&("undefined"===typeof C&&(C=!this.expanded),C?this.expand():this.collapse())},search:function(C){var J=new e;this._mapLoaded().then(m.hitch(this,function(){this._searchDeferred(C).then(m.hitch(this,function(L){var K=L.results;this.set("searchResults",K);0===L.numResults&&(this._noResults(L.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",L);this._selectFirstResult(K,
L.activeSourceIndex);J.resolve(K)}),m.hitch(this,function(L){J.reject(L)}))}));return J.promise},suggest:function(C){var J=new e;this._mapLoaded().then(m.hitch(this,function(){this._suggestDeferred(C).then(m.hitch(this,function(L){if(L){var K=L.results;this.set("suggestResults",K);this._insertSuggestions(K,L.value);this.emit("suggest-results",L);J.resolve(K)}}),m.hitch(this,function(L){J.reject(L)}))}));return J.promise},select:function(C){var J=this._getDefaultSymbol(C),L=this.labelSymbol,K=this.sources,
P=this.activeSourceIndex,T=this.enableHighlight,ba=this.enableLabel,ia=this.autoNavigate,aa=this.showInfoWindowOnSelect,ca=this.enableInfoWindow,Y=this.infoTemplate,ha=C.feature?new I(C.feature.toJson()):null,na=ha?C.feature._sourceLayer:null;oa(ha,na);if(P===this._allIndex){var la=this._getSourceIndexOfResult(C);if(null!==la){var ja=K[la];P=la}}else ja=K[P];ja&&(ja.hasOwnProperty("highlightSymbol")&&(J=ja.highlightSymbol),ja.hasOwnProperty("labelSymbol")&&(L=ja.labelSymbol),ja.hasOwnProperty("enableHighlight")&&
(T=ja.enableHighlight),ja.hasOwnProperty("enableLabel")&&(ba=ja.enableLabel),ja.hasOwnProperty("autoNavigate")&&(ia=ja.autoNavigate),ja.hasOwnProperty("showInfoWindowOnSelect")&&(aa=ja.showInfoWindowOnSelect),ja.hasOwnProperty("enableInfoWindow")&&(ca=ja.enableInfoWindow),ja.hasOwnProperty("infoTemplate")?Y=ja.infoTemplate:ja.featureLayer&&ja.featureLayer.infoTemplate&&(Y=ja.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(ha){K=this.highlightGraphic;var ma=this.graphicsLayer;
la=this.labelGraphic;var pa=m.mixin({},ha.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(C),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(C)}),qa=null;ca&&(qa=Y);la?(la.setGeometry(ha.geometry),la.setAttributes(pa),la.setSymbol(L),L&&"textsymbol"===L.type&&la.symbol.setText(C.name)):(la=new I(ha.geometry,L,pa),oa(la,na),L&&"textsymbol"===L.type&&
la.symbol.setText(C.name),ba&&(ma?ma.add(la):this.map&&this.map.graphics&&this.map.graphics.add(la)));K?(K.setGeometry(ha.geometry),K.setAttributes(pa),K.setInfoTemplate(qa),K.setSymbol(J)):(K=new I(ha.geometry,J,pa,qa),oa(K,na),T&&(ma?ma.add(K):this.map&&this.map.graphics&&this.map.graphics.add(K)));K&&K.symbol&&"textsymbol"===K.symbol.type&&K.symbol.setText(C.name);this.map&&this.map.infoWindow&&ca&&aa&&(this.map.infoWindow.setFeatures([K]),J=this._getPointFromGeometry(K.geometry),this.map.infoWindow.show(J));
this.map&&ia&&C&&C.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&this.map.setExtent(C.extent,!0);this.set("highlightGraphic",K);this.set("labelGraphic",la)}this.set("selectedResult",C);this.emit("select-result",{result:C,source:ja,sourceIndex:P})},focus:function(){z.focus(this.inputNode)},blur:function(){this.inputNode.blur();z.curNode&&z.curNode.blur()},clearGraphics:function(){var C=this.highlightGraphic,J=this.graphicsLayer,L=this.labelGraphic;C&&(J?J.remove(C):this.map&&this.map.graphics&&
this.map.graphics.remove(C));L&&(J?J.remove(L):this.map&&this.map.graphics&&this.map.graphics.remove(L));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var C=new e;if(this.map)if(this.map.loaded)C.resolve();else c.once(this.map,"load",m.hitch(this,function(){C.resolve()}));else C.resolve();return C.promise},_init:function(){this._getMapLayers().then(m.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();z.focus(this.inputNode)},
_error:function(C){return Error(this.declaredClass+" "+C)},_searchDeferred:function(C){var J=new e,L=this.value,K=this.activeSourceIndex;C&&C.hasOwnProperty("index")&&(K=C.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var P={magicKey:this.magicKey,text:L};C?"string"===typeof C?(P.text=C,C=this._searchQueries(P)):C="object"===typeof C&&C.hasOwnProperty("magicKey")?this._searchQueries(C):"object"===typeof C&&C.hasOwnProperty("geometry")?this._searchQueries({geometry:C}):
"object"===typeof C&&C.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(C):"object"===typeof C&&"point"===C.type?this._searchQueries({point:C}):C instanceof Array&&2===C.length?this._searchQueries({latlon:C}):this._searchQueries(P):C=this._searchQueries(P);C.always(m.hitch(this,function(T){T=this._formatResults(T,K,L);J.resolve(T)}));return J.promise},_suggestDeferred:function(C){var J=new e;this._deferreds.push(J);C||(C=this.value);var L=this.activeSourceIndex;this._suggestQueries({text:C}).always(m.hitch(this,
function(K){var P;if(K)for(var T=0;T<K.length;T++)K[T]&&(P=!0);P?(K=this._formatResults(K,L,C),J.resolve(K)):J.resolve()}));return J.promise},_getDefaultSymbol:function(C){var J;this.map&&(J=this.map.getBasemap());J||(J="topo");if(C&&C.feature&&C.feature.geometry)var L=C.feature.geometry.type;"polyline"===L?L="line":"circle"===L||"extent"===L?L="polygon":"multipoint"===L&&(L="point");if(L){if(C=ka.getSchemes({theme:"default",basemap:J,geometryType:L}))var K=C.primaryScheme;if(K){K.color&&K.hasOwnProperty("opacity")&&
(K.color.a=K.opacity);var P=K;C=K.color;K=K.size;switch(L){case "point":var T=new O;T.setColor(C);T.setSize(null!==K?K:P.size);L=new S;L.setColor(P.outline.color);L.setWidth(P.outline.width);T.setOutline(L);break;case "line":T=new S;T.setColor(C);T.setWidth(null!==K?K:P.width);break;case "polygon":T=new R,T.setColor(C),L=new S,L.setColor(P.outline.color),L.setWidth(P.outline.width),T.setOutline(L)}P=T}}return P},_selectFirstResult:function(C,J){if(this.autoSelect&&C){var L;J===this._allIndex?L=this._getFirstResult(C):
C[J]&&C[J][0]&&(L=C[J][0]);L&&this.select(L)}},_getSourceIndexOfResult:function(C){var J=this.searchResults;if(J)for(var L in J)if(J[L]&&J[L].length)for(var K=0;K<J[L].length;K++)if(J[L][K]===C)return parseInt(L,10);return null},_getFirstResult:function(C){if(C)for(var J in C)if(C[J]&&C[J][0])return C[J][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();
this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var C=new e;if(this.addLayersFromMap&&this.map){var J=[],L=this.map.graphicsLayerIds;if(L&&L.length){for(var K=0;K<L.length;K++){var P=this.map.getLayer(L[K]);P&&J.push(this._featureLayerLoaded(P))}N(J).always(m.hitch(this,function(T){for(var ba,ia=this.sources,aa=0;aa<T.length;aa++)T[aa]&&
T[aa].loaded&&"Feature Layer"===T[aa].type&&(ia.push({featureLayer:T[aa],enableSuggestions:!0}),ba=!0);ba&&this.set("sources",ia);C.resolve()}))}else C.resolve()}else C.resolve();return C.promise},_switchCoordinatesClick:function(C){C.preventDefault();if(C=k.get(C.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",C),this.search()},_moreResultsClick:function(C){C.preventDefault();var J=C.target;C=parseInt(k.get(J,"data-source-index"),10);J=parseInt(k.get(J,"data-index"),10);
var L=this.searchResults;L&&L[C]&&(C=L[C][J])&&this.select(C)},_showMoreResultsClick:function(C){C.preventDefault();if(C=l.byId(this._moreResultsId)){n.toggle(C,this.css.searchShowMoreResults);var J=l.byId(this._moreResultsId+"_show");J&&(n.contains(C,this.css.searchShowMoreResults)?k.set(J,"textContent",v.widgets.Search.main.hideMoreResults):k.set(J,"textContent",v.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(C){var J=new e;if(C.loaded)J.resolve(C);else if(C.loadError)J.reject(this._error("Layer failed to load."));
else{var L=c.once(C,"load",m.hitch(this,function(){K.remove();J.resolve(C)}));var K=c.once(C,"error",m.hitch(this,function(){L.remove();J.reject(this._error("Layer could not be loaded."))}))}return J.promise},_getObjectSize:function(C){var J=0,L;for(L in C)C.hasOwnProperty(L)&&J++;return J},_sourcesEvent:function(C,J){var L=k.get(J,"data-index"),K=d("li",this.sourcesNode);J=h.indexOf(K,J);L!==this._allIndex&&(L=parseInt(L,10));"click"===C.type||C.keyCode===b.ENTER?(this.set("activeSourceIndex",L),
z.focus(this.inputNode),this._hideSourcesMenu()):C.keyCode===b.UP_ARROW?(C.stopPropagation(),C.preventDefault(),C=J-1,0>C?z.focus(this.sourcesBtnNode):z.focus(K[C])):C.keyCode===b.DOWN_ARROW?(C.stopPropagation(),C.preventDefault(),C=J+1,C>=K.length?z.focus(this.sourcesBtnNode):z.focus(K[C])):C.keyCode===b.ESCAPE&&(this._hideSourcesMenu(),z.focus(this.inputNode))},_suggestionsEvent:function(C,J){var L=k.get(J,"data-source-index"),K=parseInt(k.get(J,"data-index"),10),P=d("li",this.suggestionsNode),
T=this.sources;J=h.indexOf(P,J);L!==this._allIndex&&(L=parseInt(L,10));var ba;this._clearQueryTimeout();"click"===C.type||C.keyCode===b.ENTER?((P=this.suggestResults)&&P[L]&&P[L][K]&&(ba=P[L][K]),ba&&(ba.index=L,T[L].featureLayer?(L=T[L].featureLayer.objectIdField,ba[this._objectIdIdentifier]=ba.feature.attributes[L],this.set("value",this._getSuggestionName(ba)),this.set("selectedFeatureId",ba.feature.attributes[L])):ba.magicKey&&ba.text&&(this.set("value",ba.text),this.set("magicKey",ba.magicKey)),
this.search(ba),z.focus(this.inputNode))):C.keyCode===b.BACKSPACE||C.keyCode===b.DELETE?z.focus(this.inputNode):C.keyCode===b.UP_ARROW?(C.stopPropagation(),C.preventDefault(),ba=J-1,0>ba?z.focus(this.inputNode):z.focus(P[ba])):C.keyCode===b.DOWN_ARROW?(C.stopPropagation(),C.preventDefault(),ba=J+1,ba>=P.length?z.focus(this.inputNode):z.focus(P[ba])):C.keyCode===b.ESCAPE&&(this._hideMenus(),z.focus(this.inputNode))},_getResultName:function(C){var J;C.hasOwnProperty("name")&&null!==C.name&&(J=C.name.toString());
J||(J=v.widgets.Search.main.untitledResult);return J},_getSuggestionName:function(C){var J;C.hasOwnProperty("name")&&null!==C.name&&(J=C.name.toString());C=C.text||J;C||(C=v.widgets.Search.main.untitledResult);return C},_searchResultHTML:function(C){var J="";if(C.feature&&C.feature.attributes&&C.feature.attributes.Addr_type&&"LatLong"===C.feature.attributes.Addr_type){var L=C.name.split(" ");if(2===L.length){var K=L[0];var P=L[1]}P&&K?(C=parseFloat(K),P=parseFloat(P),L=P+", "+C,J+='\x3cdiv class\x3d"'+
this.css.searchMoreResultsItem+'"\x3e',J+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+v.widgets.Search.main.lonlat+"\x3c/div\x3e",J=J+(C+", "+P)+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsItem+'"\x3e'),C===P||90<C||-90>C||180<P||-180>P||(J+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+v.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",J+='\x3ca data-switch-coordinates\x3d"'+L+'" tabindex\x3d"0" href\x3d"#"\x3e'+L+"\x3c/a\x3e\x3c/div\x3e")):J=C.name}else J=C.name;
return J},_moreResultsHTML:function(C){var J="",L="",K=this.searchResults,P=this.sources,T=0;if(K){L+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e';L+='\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+v.widgets.Search.main.showMoreResults+"\x3c/a\x3e";L=L+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsList+'"\x3e');L+='\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e';for(var ba in K)if(K[ba]){var ia=K[ba].length;if(ia){var aa=1===ia&&K[ba][0]===C;if(1<this._getObjectSize(K)&&
!aa){var ca=this._getSourceName(ba);L+='\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+ca+"\x3c/div\x3e"}if(ia&&!aa){L+="\x3cul\x3e";ca=P[ba].maxResults||this.maxResults;for(aa=0;aa<ia&&aa<ca;++aa)if(K[ba][aa]!==C){var Y=this._getResultName(K[ba][aa]);L+='\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+aa+'" data-source-index\x3d"'+ba+'" href\x3d"#"\x3e'+Y+"\x3c/a\x3e\x3c/li\x3e";T++}L+="\x3c/ul\x3e"}}}L+="\x3c/div\x3e\x3c/div\x3e"}T&&(J+=L);return J},_validField:function(C,J){return C.getField(J)},
_validFields:function(C,J){if(C&&J&&J.length){for(var L=0;L<J.length;L++)if(!this._validField(C,J[L]))return!1;return!0}return!1},_getCodedName:function(C,J){if(C&&C.length)for(var L=0,K=C.length;L<K;L++){var P=C[L];if(P.code===J)return P.name}},_getCodedValue:function(C,J,L){if(C&&C.length)for(var K=0,P=C.length;K<P;K++){var T=C[K],ba=T.name,ia=J;L||(ba=ba.toLowerCase(),ia=ia.toLowerCase());if(ba===ia)return T.code}return!1},_whereClause:function(C,J,L,K){var P=null;if(C){var T="";this.reHostedFS.test(J.url)&&
this._containsNonLatinCharacter(C)&&(T="N");if(L&&L.length)for(var ba=0,ia=L.length;ba<ia;ba++){var aa="",ca=C.replace(/'/g,"''");aa=L[ba];var Y=J.getField(aa),ha=J.getDomain(aa);ha&&"codedValue"===ha.type&&(ca=this._getCodedValue(ha.codedValues,ca,K));!1!==ca&&(Y=Y.type,"esriFieldTypeString"===Y||"esriFieldTypeDate"===Y?aa=K?aa+" \x3d "+T+"'"+ca+"'":"UPPER("+aa+") LIKE "+T+"'%"+ca.toUpperCase()+"%'":"esriFieldTypeOID"===Y||"esriFieldTypeSmallInteger"===Y||"esriFieldTypeInteger"===Y||"esriFieldTypeSingle"===
Y||"esriFieldTypeDouble"===Y?(ca=parseFloat(ca),aa=isNaN(ca)?!1:aa+" \x3d "+ca):aa=aa+" \x3d "+ca,aa&&(P=P?P+" or ":"",P+=aa))}}return P},_suggest:function(C){C||(C={index:this.activeSourceIndex,text:this.value});var J=new e,L=C.index,K=this.sources[L],P=this.enableSuggestions;K.hasOwnProperty("enableSuggestions")&&(P=K.enableSuggestions);var T=0;if(C.hasOwnProperty("text")&&C.text){var ba=m.trim(C.text);T=C.text.length}C=K.minCharacters||this.minCharacters;if(P&&ba&&T>=C&&this._supportsPagination(K)){var ia=
"";K.prefix&&(ia+=K.prefix);ia+=ba;K.suffix&&(ia+=K.suffix);var aa=this._defaultSR;this.map&&(aa=this.map.spatialReference);P={};K.locator?(K.categories&&(P.categories=K.categories),K.locator.outSpatialReference=aa,this.map&&K.localSearchOptions&&K.localSearchOptions.hasOwnProperty("distance")&&K.localSearchOptions.hasOwnProperty("minScale")&&(T=this._getScale(),!K.localSearchOptions.minScale||T&&T<=parseFloat(K.localSearchOptions.minScale))&&(P.location=this.map.extent.getCenter(),P.distance=K.localSearchOptions.distance),
P.text=ia,K.useMapExtent&&this.map&&this.map.extent&&(P.searchExtent=this.map.extent),K.searchExtent&&(P.searchExtent=K.searchExtent),P.maxSuggestions=K.maxSuggestions||this.maxSuggestions,K.sourceCountry&&(P.countryCode=K.sourceCountry),K.countryCode&&(P.countryCode=K.countryCode),K.locator.suggestLocations(P).then(m.hitch(this,function(ca){J.resolve(ca)}),m.hitch(this,function(ca){ca||(ca=this._error("Locator suggestLocations could not be performed."));J.reject(ca)}))):K.featureLayer?this._featureLayerLoaded(K.featureLayer).then(m.hitch(this,
function(){var ca=this._getDisplayField(K),Y=K.searchFields||[ca],ha=[];K.suggestionTemplate?K.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(ma,pa){ha.push(pa)}):ha=[ca];-1===h.indexOf(ha,K.featureLayer.objectIdField)&&ha.push(K.featureLayer.objectIdField);ca=this._validField(K.featureLayer,ca);var na=this._validFields(K.featureLayer,ha),la=this._validFields(K.featureLayer,Y);if(ca&&na&&la){ca=new U;K.hasOwnProperty("suggestQueryParams")&&m.mixin(ca,K.suggestQueryParams);ca.outSpatialReference=
aa;ca.returnGeometry=!1;ca.num=K.maxSuggestions||this.maxSuggestions;ca.outFields=ha;K.useMapExtent&&this.map&&this.map.extent&&(ca.geometry=this.map.extent);K.searchExtent&&(ca.geometry=K.searchExtent);if(Y=this._whereClause(ia,K.featureLayer,Y,!1)){ca.where=Y;var ja=!0}ja?K.featureLayer.queryFeatures(ca,m.hitch(this,function(ma){var pa;(ma=ma.features)&&(pa=this._hydrateResults(ma,L,!0));J.resolve(pa)}),m.hitch(this,function(ma){ma||(ma=this._error("FeatureLayer queryFeatures errored with suggestions"));
J.reject(ma)})):J.resolve()}else J.reject(this._error("Invalid FeatureLayer field"))})):J.reject(this._error("Invalid source"))}else J.resolve();return J.promise},_supportsPagination:function(C){var J;C.locator?J=!0:C.featureLayer&&C.featureLayer.advancedQueryCapabilities&&C.featureLayer.advancedQueryCapabilities.supportsPagination&&(J=!0);return J},_suggestQueries:function(C){var J=this.sources,L=this.activeSourceIndex,K=[];if(L===this._allIndex)for(L=0;L<J.length;L++){var P=C;P.index=L;P=this._suggest(P);
K.push(P)}else C.index=L,P=this._suggest(C),K.push(P);return N(K)},_getPointFromGeometry:function(C){switch(C.type){case "extent":var J=C.getCenter();break;case "multipoint":J=C.getPoint(0);break;case "point":J=C;break;case "polygon":J=C.getCentroid();break;case "polyline":J=C.getPoint(0,0)}return J},_searchQueries:function(C){C.hasOwnProperty("index")||(C.index=this.activeSourceIndex);var J=[];if(C.index===this._allIndex)for(var L=this.sources,K=0;K<L.length;K++){var P=C;P.index=K;P=this._search(P);
J.push(P)}else C=this._search(C),J.push(C);return N(J)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),z.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(C){C||(C={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(C.text=null,C[this._objectIdIdentifier]=this.selectedFeatureId);var J,L=new e,K=C.index,P=this.sources[K],T;C.hasOwnProperty("text")&&C.text&&(T=m.trim(C.text));
if(P){var ba="";P.prefix&&!C.magicKey&&(ba+=P.prefix);ba+=T;P.suffix&&!C.magicKey&&(ba+=P.suffix);var ia=this._defaultSR;this.map&&(ia=this.map.spatialReference);if(P.locator)if(C.hasOwnProperty("text")&&T){var aa={};P.categories&&(aa.categories=P.categories);P.locationType&&(aa.locationType=P.locationType);ia&&(P.locator.outSpatialReference=ia);if(this.map&&P.localSearchOptions&&P.localSearchOptions.hasOwnProperty("distance")&&P.localSearchOptions.hasOwnProperty("minScale")){var ca=this._getScale();
if(!P.localSearchOptions.minScale||ca&&ca<=parseFloat(P.localSearchOptions.minScale))aa.location=this.map.extent.getCenter(),aa.distance=P.localSearchOptions.distance}aa.address={};aa.maxLocations=P.maxResults||this.maxResults;P.useMapExtent&&this.map&&this.map.extent&&(aa.searchExtent=this.map.extent);P.searchExtent&&(aa.searchExtent=P.searchExtent);P.sourceCountry&&(aa.countryCode=P.sourceCountry);P.countryCode&&(aa.countryCode=P.countryCode);C.magicKey&&(aa.magicKey=C.magicKey);P.singleLineFieldName?
aa.address[P.singleLineFieldName]=ba:aa.address["Single Line Input"]=ba;P.outFields&&(aa.outFields=P.outFields);P.locator.addressToLocations(aa).then(m.hitch(this,function(Y){Y=this._hydrateResults(Y,K,!1);L.resolve(Y)}),m.hitch(this,function(Y){Y||(Y=this._error("Locator addressToLocations could not be performed"));L.reject(Y)}))}else C.geometry?(J=this._getPointFromGeometry(C.geometry.geometry))?this._reverseGeocodePoint(K,J).then(function(Y){L.resolve(Y)},function(Y){L.reject(Y)}):L.reject(this._error("Invalid point to reverse geocode")):
C.point?this._reverseGeocodePoint(K,C.point).then(function(Y){L.resolve(Y)},function(Y){L.reject(Y)}):C.latlon?(aa=new da(C.latlon,this._defaultSR),this._reverseGeocodePoint(K,aa).then(function(Y){L.resolve(Y)},function(Y){L.reject(Y)})):C.hasOwnProperty("text")&&!T?L.resolve([]):L.reject(this._error("Invalid query type for Locator"));else P.featureLayer?this._featureLayerLoaded(P.featureLayer).then(m.hitch(this,function(){var Y=this._getDisplayField(P),ha=P.searchFields||[Y];Y=this._validField(P.featureLayer,
Y);var na=this._validFields(P.featureLayer,ha);if(Y&&na){Y=new U;P.hasOwnProperty("searchQueryParams")&&m.mixin(Y,P.searchQueryParams);ia&&(Y.outSpatialReference=ia,na=this.map&&this.map.getMaxResolution()||1/Q.getUnitValueForSR(ia))&&(Y.maxAllowableOffset=na);Y.returnGeometry=!0;P.outFields&&(Y.outFields=P.outFields);if(!C.hasOwnProperty(this._objectIdIdentifier)){this._supportsPagination(P)&&(Y.num=P.maxResults||this.maxResults);P.useMapExtent&&this.map&&this.map.extent&&(Y.geometry=this.map.extent);
P.searchExtent&&(Y.geometry=P.searchExtent);var la=P.exactMatch}C.hasOwnProperty("text")&&T?(ha=this._whereClause(ba,P.featureLayer,ha,la))?(Y.where=ha,ha=!0):ha=!1:C.hasOwnProperty(this._objectIdIdentifier)?(Y.objectIds=[C[this._objectIdIdentifier]],ha=!0):C.geometry?(Y.geometry=C.geometry,ha=!0):C.point?(Y.geometry=C.point,ha=!0):C.latlon?(J=new da(C.latlon,this._defaultSR),Y.geometry=J,ha=!0):(C.hasOwnProperty("text")&&!T?L.resolve([]):L.reject(this._error("Invalid query type for FeatureLayer")),
ha=!1);ha?P.featureLayer.queryFeatures(Y,m.hitch(this,function(ja){ja=ja.features;var ma;ja&&(ma=this._hydrateResults(ja,K,!1));L.resolve(ma)}),m.hitch(this,function(ja){ja||(ja=this._error("FeatureLayer queryFeatures could not be performed"));L.reject(ja)})):L.resolve()}else L.reject(this._error("Invalid FeatureLayer field"))})):L.reject(this._error("Invalid source"))}else L.reject(this._error("Source is undefined"));return L.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},
_formatResults:function(C,J,L){L={activeSourceIndex:J,value:L,numResults:0,numErrors:0,errors:null,results:null};var K={},P={};if(C)if(J===this._allIndex)for(J=0;J<C.length;J++)C[J]&&(C[J]instanceof Error?(K[J]=C[J],L.numErrors++):(P[J]=C[J],L.numResults+=C[J].length));else C[0]&&(C[0]instanceof Error?(K[J]=C[0],L.numErrors++):(P[J]=C[0],L.numResults+=C[0].length));L.numErrors&&(L.errors=K);L.numResults&&(L.results=P);return L},_reverseGeocodePoint:function(C,J){var L=new e,K=this.sources[C];if(J&&
K){var P=K.locationToAddressDistance||this.locationToAddressDistance;K.locator.outSpatialReference=this._defaultSR;this.map&&(K.locator.outSpatialReference=this.map.spatialReference);K.locator.locationToAddress(J,P,m.hitch(this,function(T){T=this._hydrateResults([T],C,!1);L.resolve(T)}),m.hitch(this,function(T){T||(T=this._error("Locator locationToAddress could not be performed"));L.reject(T)}))}else L.reject(this._error("No point or source defined for reverse geocoding"));return L.promise},_cancelDeferreds:function(){if(this._deferreds&&
this._deferreds.length)for(var C=0;C<this._deferreds.length;C++)this._deferreds[C].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(C){if(C){var J=d("li",this.sourcesNode);C.keyCode===b.UP_ARROW?(C.stopPropagation(),C.preventDefault(),this._showSourcesMenu(),(C=J.length)&&z.focus(J[C-1])):C.keyCode===b.DOWN_ARROW&&(C.stopPropagation(),C.preventDefault(),this._showSourcesMenu(),J[0]&&z.focus(J[0]))}},_inputKey:function(C){if(C){var J=d("li",this.suggestionsNode),
L=this.suggestResults;if(C.keyCode===b.TAB||C.keyCode===b.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(C.keyCode===b.UP_ARROW)C.stopPropagation(),C.preventDefault(),this._cancelSuggest(),L&&this._showSuggestionsMenu(),(C=J.length)&&z.focus(J[C-1]);else if(C.keyCode===b.DOWN_ARROW)C.stopPropagation(),C.preventDefault(),this._cancelSuggest(),L&&this._showSuggestionsMenu(),J[0]&&z.focus(J[0]);else{if(C.ctrlKey||C.metaKey||C.keyCode===b.copyKey||C.keyCode===b.LEFT_ARROW||C.keyCode===b.RIGHT_ARROW||
C.keyCode===b.ENTER)return C;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(m.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},
_getSourceName:function(C){return this._sourceNames[C]},_loadSources:function(C){C=h.filter(C,function(J){return!!J.featureLayer});C=h.map(C,function(J){return this._featureLayerLoaded(J.featureLayer)},this);return N(C)},_createSourceNameMap:function(C){return this._loadSources(C).then(m.hitch(this,function(){var J=h.map(C,function(L){return L.name||L.featureLayer&&L.featureLayer.name||v.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(C,J);return J}))},_getDuplicateSourceNameIndexes:function(C){var J=
{},L=[];h.forEach(C,function(K,P){J.hasOwnProperty(K)?(-1===L.indexOf(J[K])&&L.push(J[K]),L.push(P)):C.lastIndexOf(K)!==P&&(J[K]=P)});return L},_preventDuplicateSourceNames:function(C,J){if(J&&1<J.length){var L=this._getDuplicateSourceNameIndexes(J);h.forEach(L,function(K){J[K]+=this._getFieldsString(C[K])},this)}},_getFieldsString:function(C){var J="",L=C.featureLayer;if(L){C=C.searchFields||[this._getDisplayField(C)];for(var K=0;K<C.length;K++){J=0===K?J+": ":J+", ";var P=C[K],T=L.getFieldLabel(P);
J+=T||P}}return J},_splitResult:function(C,J){J=g.escapeString(J);return C.replace(new RegExp("(^|)("+J+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(C,J){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var L=this.sources;if(C){var K=u.create("div");for(var P in C)if(C[P]&&C[P].length){var T=this._getSourceName(P);1<L.length&&this.activeSourceIndex===this._allIndex&&u.create("div",{className:this.css.searchMenuHeader,textContent:T},
K);T=u.create("ul",{role:"menu"},K);for(var ba=L[P].maxSuggestions||this.maxSuggestions,ia=0;ia<C[P].length&&ia<ba;++ia){var aa=u.create("li",{"data-index":ia,"data-source-index":P,role:"menuitem",tabindex:0},T),ca=this._getSuggestionName(C[P][ia]);ca=this._splitResult(ca,J);for(var Y=ca.length,ha=0;ha<Y;ha++){var na=ca[ha];na.toLowerCase()===J.toLowerCase()?u.create("strong",{textContent:na},aa):(na=document.createTextNode(na),u.place(na,aa))}}}}K?(u.place(K,this.suggestionsNode,"only"),this._showSuggestionsMenu()):
(u.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(C){if(this.enableSourcesMenu&&C&&1<C.length){var J,L=this.activeSourceIndex,K=u.create("ul",{role:"menu"});if(this.enableSearchingAll){var P="";L===this._allIndex&&(P="active");u.create("li",{"data-index":this._allIndex,role:"menuitem",className:P,tabIndex:0,textContent:v.widgets.Search.main.all},K)}for(J=0;J<C.length;J++){P="";J===L&&(P=this.css.activeSource);var T=this._getSourceName(J);u.create("li",{"data-index":J,
role:"menuitem",className:P,tabIndex:0,textContent:T},K)}n.add(this.containerNode,this.css.hasMultipleSources);u.place(K,this.sourcesNode,"only")}else n.remove(this.containerNode,this.css.hasMultipleSources),u.empty(this.sourcesNode)},_showLoading:function(){n.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){n.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(n.add(this.containerNode,this.css.hasValue),k.set(this.clearNode,"title",v.widgets.Search.main.clearButtonTitle)):
this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(C){var J;C&&(J=m.trim(C));var L=u.create("div",{className:this.css.searchNoResultsBody});C&&J?(u.create("div",{className:this.css.searchNoResultsHeader,textContent:v.widgets.Search.main.noResults},L),u.create("div",{className:this.css.searchNoResultsText,textContent:w.substitute({value:'"'+C+'"'},v.widgets.Search.main.noResultsFound)},L)):(C=u.create("div",{},
L),u.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},C),u.create("span",{className:this.css.searchNoValueText,textContent:v.widgets.Search.main.emptyValue},C));u.place(L,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){n.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();n.add(this.containerNode,
this.css.showNoResults)},_hideSourcesMenu:function(){n.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){n.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();n.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();n.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();
this._hideNoResultsMenu();n.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(C){if(C&&(C=C.fields)&&C.length)for(var J=0;J<C.length;J++){var L=C[J];if("esriFieldTypeString"===L.type)return L.name}return""},_getDisplayField:function(C){return C.displayField||C.featureLayer.displayField||this._getFirstStringField(C.featureLayer)},_validLocation:function(C){return C&&"number"===typeof C.x&&"number"===typeof C.y},_validExtent:function(C){return C&&"number"===typeof C.xmin&&
"number"===typeof C.ymin&&"number"===typeof C.xmax&&"number"===typeof C.ymax},_hydrateResult:function(C,J,L){var K={},P=this._defaultSR;J=this.sources[J];this.map&&(P=this.map.spatialReference);if(C.hasOwnProperty("text")&&C.hasOwnProperty("magicKey"))return C;if(C.hasOwnProperty("geometry")){var T=new I(C.toJson());K.feature=T;(T=K.feature.geometry)&&T.setSpatialReference(P)}else if(C.hasOwnProperty("location")&&this._validLocation(C.location)){var ba=new da(C.location.x,C.location.y,P);T={};C.hasOwnProperty("attributes")&&
(T=C.attributes);C.hasOwnProperty("address")&&"object"===typeof C.address&&m.mixin(T,C.address);C.hasOwnProperty("score")&&(T.score=C.score);K.feature=new I(ba,null,T,null)}!K.feature&&L&&(T={},C.hasOwnProperty("attributes")&&(T=C.attributes),C.hasOwnProperty("score")&&(T.score=C.score),K.feature=new I(null,null,T,null));if(K.feature){if(C.hasOwnProperty("extent")&&this._validExtent(C.extent))K.extent=new W(C.extent),K.extent.setSpatialReference(P);else if(K.feature&&K.feature.geometry)switch(K.feature.geometry.type){case "extent":K.extent=
K.feature.geometry;break;case "multipoint":K.extent=ea.getDenormalizedExtent(K.feature.geometry);break;case "polygon":K.extent=ea.getDenormalizedExtent(K.feature.geometry);break;case "polyline":K.extent=ea.getDenormalizedExtent(K.feature.geometry);break;case "point":this.map?(P=this.zoomScale,J&&J.zoomScale&&(P=J.zoomScale),this._getScale()>P?K.extent=Q.getExtentForScale(this.map,P).centerAt(K.feature.geometry):K.extent=this.map.extent.centerAt(K.feature.geometry)):K.extent=new W({xmin:K.feature.geometry.x-
.25,ymin:K.feature.geometry.y-.25,xmax:K.feature.geometry.x+.25,ymax:K.feature.geometry.y+.25,spatialReference:this._defaultSR})}else K.extent=null;K.name="";J.featureLayer?J.suggestionTemplate&&L?K.name=w.substitute(C.attributes,J.suggestionTemplate):J.searchTemplate?K.name=w.substitute(C.attributes,J.searchTemplate):(T=this._getDisplayField(J),L=J.featureLayer.getField(T),P=J.featureLayer.getDomain(T),T&&C.hasOwnProperty("attributes")&&C.attributes.hasOwnProperty(T)&&(C=C.attributes[T],P&&"codedValue"===
P.type?K.name=this._getCodedName(P.codedValues,C):L&&"esriFieldTypeDate"===L.type&&!isNaN(C)?K.name=t.format(new Date(C)):K.name=C)):C.address&&J.searchTemplate?K.name=w.substitute(C.address,J.searchTemplate):C.hasOwnProperty("name")?K.name=C.name:C.hasOwnProperty("attributes")&&"object"===typeof C.attributes&&C.attributes.LongLabel?K.name=C.attributes.LongLabel:C.hasOwnProperty("attributes")&&"object"===typeof C.attributes&&C.attributes.Match_addr?(K.name=C.attributes.Match_addr,C.attributes.Addr_type&&
"POI"===C.attributes.Addr_type&&C.attributes.StAddr&&C.attributes.City?K.name+=" - "+C.attributes.StAddr+", "+C.attributes.City:C.attributes.Addr_type&&"POI"===C.attributes.Addr_type&&C.attributes.City&&(K.name+=" - "+C.attributes.City)):C.hasOwnProperty("address")&&"string"===typeof C.address?K.name=C.address:C.hasOwnProperty("address")&&"object"===typeof C.address&&C.address.hasOwnProperty("Address")?C.address.hasOwnProperty("Match_addr")?K.name=C.address.Match_addr:C.address.hasOwnProperty("Address")&&
(K.name=C.address.Address):K.feature&&K.feature.geometry&&(K.name=K.feature.geometry.x+","+K.feature.geometry.y);J.featureLayer&&K.feature&&oa(K.feature,J.featureLayer);return K}},_getScale:function(){var C;this.map&&"function"===typeof this.map.getScale&&(C=this.map.getScale());return C},_hydrateResults:function(C,J,L,K){K=[];var P=0;if(C&&C.length)for(P;P<C.length;P++){var T=this._hydrateResult(C[P],J,L);T&&K.push(T)}return K},_containsNonLatinCharacter:function(C){for(var J=0;J<C.length;J++)if(255<
C.charCodeAt(J))return!0;return!1},_setPlaceholder:function(C){var J="",L=this.sources[C];C===this._allIndex?J=this.allPlaceholder||v.widgets.Search.main.allPlaceholder:L&&L.placeholder&&(J=L.placeholder);var K=v.widgets.Search.main.all;L&&(K=this._getSourceName(C));k.set(this.sourceNameNode,"textContent",K);k.set(this.inputNode,"placeholder",J);k.set(this.inputNode,"title",J)},_updateActiveSource:function(){var C=this.sources,J=this.activeSourceIndex,L;C&&C[J]&&(L=C[J]);L?this.set("activeSource",
L):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(C){C?(n.toggle(this.containerNode,this.css.searchExpanded,this.expanded),n.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),n.add(this.containerNode,this.css.hasButtonMode)):(n.remove(this.containerNode,this.css.searchExpanded),n.remove(this.containerNode,this.css.searchCollapsed),n.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(C){C&&
1===C.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(C){this._set("enableSourcesMenu",C);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(C){this._set("enableSearchingAll",C);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(C){this._createSourceNameMap(C).then(m.hitch(this,
function(J){this._sourceNames=J;this._created&&(this._setDefaultActiveSourceIndex(C),this._hideMenus(),this._insertSources(C))}));this._set("sources",C)},_setAllPlaceholderAttr:function(C){this._set("allPlaceholder",C);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(C){this._set("activeSourceIndex",C);this._updateActiveSource();this._created&&(this._setPlaceholder(C),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(C){this._set("maxLength",
C);this._created&&k.set(this.inputNode,"maxLength",C)},_setValueAttr:function(C){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",C);this._created&&(k.set(this.inputNode,"value",C),this._checkStatus())},_setVisibleAttr:function(C){this._set("visible",C);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(C){this._set("enableButtonMode",C);this._created&&this._updateButtonMode(C)},_setThemeAttr:function(C){this._created&&(n.remove(this.domNode,this.theme),
n.add(this.domNode,C));this._set("theme",C)}});a("extend-esri")&&m.setObject("dijit.Search",p,H);return p})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(r,p,m,h,f,e,b,c,d,a,g){r=r(a,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],
"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(l){this._geocodeHandler=p.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=p.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=p.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(l){this.outSpatialReference=l},_geocodeHandler:function(l,k,n,q,u){try{var t=l.candidates;k=[];var v,
y=t.length,B=l.spatialReference,D;for(v=0;v<y;v++){var E=t[v];if(D=E.location)D.spatialReference=B;k[v]=new g(E)}this._successHandler([k],"onAddressToLocationsComplete",n,u)}catch(F){this._errorHandler(F,q,u)}},_geocodeAddressesHandler:function(l,k,n,q,u){try{var t=l.locations;k=[];var v,y=t.length,B=l.spatialReference,D;for(v=0;v<y;v++){if(D=t[v].location)D.spatialReference=B;k[v]=new g(t[v])}this._successHandler([k],"onAddressesToLocationsComplete",n,u)}catch(E){this._errorHandler(E,q,u)}},addressToLocations:function(l,
k,n,q,u){var t;if(l.address){q=n;n=k;k=l.outFields;u=l.searchExtent;var v=l.countryCode;var y=l.magicKey;var B=l.distance;var D=l.categories;l.location&&this.normalization&&(t=l.location.normalize());var E=l.locationType;var F=l.maxLocations;var z=l.forStorage;l=l.address}u&&(u=u.shiftCentralMeridian());var w=this.outSpatialReference;l=this._encode(p.mixin({},this._url.query,l,{f:"json",outSR:w&&f.toJson(w.toJson()),outFields:k&&k.join(",")||null,searchExtent:u&&f.toJson(u.toJson()),category:D&&D.join(",")||
null,countryCode:v||null,magicKey:y||null,distance:B||null,location:t||null,locationType:E||null,maxLocations:F||null,forStorage:z||null}));var A=this._geocodeHandler,H=this._errorHandler,G=new h(d._dfdCanceller);G._pendingDfd=c({url:this._url.path+"/findAddressCandidates",content:l,callbackParamName:"callback",load:function(I,N){A(I,N,n,q,G)},error:function(I){H(I,q,G)}});return G},suggestLocations:function(l){var k=new h(d._dfdCanceller);l.hasOwnProperty("location")&&this.normalization&&(l.location=
l.location.normalize());l.searchExtent&&(l.searchExtent=l.searchExtent.shiftCentralMeridian());l=this._encode(p.mixin({},this._url.query,{f:"json",text:l.text,maxSuggestions:l.maxSuggestions,searchExtent:l.searchExtent&&f.toJson(l.searchExtent.toJson()),category:l.categories&&l.categories.join(",")||null,countryCode:l.countryCode||null,location:l.location||null,distance:l.distance||null},{f:"json"}));l=c({url:this._url.path+"/suggest",content:l,callbackParamName:"callback"});k._pendingDfd=l;l.then(p.hitch(this,
function(n){n=n.suggestions||[];this.onSuggestLocationsComplete(n);k.resolve(n)}),p.hitch(this,function(n){this._errorHandler(n);k.reject(n)}));return k},addressesToLocations:function(l,k,n){var q=this.outSpatialReference,u=[],t=l.categories,v=l.locationType,y=l.countryCode;m.forEach(l.addresses,function(F,z){u.push({attributes:F})});l=this._encode(p.mixin({},this._url.query,{category:t&&t.join(",")||null,locationType:v||null,sourceCountry:y||null},{addresses:f.toJson({records:u})},{f:"json",outSR:q&&
f.toJson(q.toJson())}));var B=this._geocodeAddressesHandler,D=this._errorHandler,E=new h(d._dfdCanceller);E._pendingDfd=c({url:this._url.path+"/geocodeAddresses",content:l,callbackParamName:"callback",load:function(F,z){B(F,z,k,n,E)},error:function(F){D(F,n,E)}});return E},_reverseGeocodeHandler:function(l,k,n,q,u){try{var t=new g({address:l.address,location:l.location,score:100});this._successHandler([t],"onLocationToAddressComplete",n,u)}catch(v){this._errorHandler(v,q,u)}},locationToAddress:function(l,
k,n,q){l&&this.normalization&&(l=l.normalize());var u=this.outSpatialReference;l=this._encode(p.mixin({},this._url.query,{outSR:u&&f.toJson(u.toJson()),location:l&&f.toJson(l.toJson()),distance:k,f:"json"}));var t=this._reverseGeocodeHandler,v=this._errorHandler,y=new h(d._dfdCanceller);y._pendingDfd=c({url:this._url.path+"/reverseGeocode",content:l,callbackParamName:"callback",load:function(B,D){t(B,D,n,q,y)},error:function(B){v(B,q,y)}});return y},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},
onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});e("extend-esri")&&p.setObject("tasks.Locator",r,b);return r})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(r,p,m,h,f){r=r(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(e){p.mixin(this,e);this.location=new f(this.location)}});m("extend-esri")&&p.setObject("tasks.AddressCandidate",r,h);return r})},
"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has","../kernel","../Color"],function(r,p,m,h,f){function e(g,l){if(g){var k={};k.color=new f(g.color);k.opacity=g.opacity||1;switch(l){case "point":k.outline={color:new f(g.outline.color),width:g.outline.width};k.size=g.size;break;case "line":k.width=g.width;break;case "polygon":k.outline={color:new f(g.outline.color),width:g.outline.width}}}return k}function b(g){if("esriGeometryPoint"===g||"esriGeometryMultipoint"===
g)g="point";else if("esriGeometryPolyline"===g)g="line";else if("esriGeometryPolygon"===g||"esriGeometryMultiPatch"===g)g="polygon";return g}var c={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},
pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,
77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,
139,79,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},d={};(function(){var g,l,k;for(g in c){var n=c[g];var q=n.basemapGroups;var u=d[g]={basemaps:[].concat(q.light).concat(q.dark),point:{},line:{},polygon:{}};for(l in q){var t=q[l];for(k=0;k<t.length;k++){var v=t[k];n.pointSchemes&&(u.point[v]=n.pointSchemes[l]);n.lineSchemes&&
(u.line[v]=n.lineSchemes[l]);n.polygonSchemes&&(u.polygon[v]=n.polygonSchemes[l])}}}})();var a={getAvailableThemes:function(g){var l=[],k;for(k in c){var n=c[k];var q=d[k];g&&-1===r.indexOf(q.basemaps,g)||l.push({name:n.name,label:n.label,description:n.description,basemaps:q.basemaps.slice(0)})}return l},getSchemes:function(g){var l=g.theme,k=g.basemap,n=b(g.geometryType);g=d[l];var q;(g=(g=g&&g[n])&&g[k])&&(q={primaryScheme:e(g.primary,n),secondarySchemes:r.map(g.secondary,function(u){return e(u,
n)})});return q},cloneScheme:function(g){if(g){var l=p.mixin({},g);l.color&&(l.color=new f(l.color));l.outline&&(l.outline={color:l.outline.color&&new f(l.outline.color),width:l.outline.width})}return l}};m("extend-esri")&&p.setObject("styles.basic",a,h);return a})},"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),function(r,p,m,h,f,e){var b=null,c=r([m,f],
{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new e({whiteList:this.whiteList,safeAttrValue:h.hitch(this,function(d,a,g,l){return"style"===a?this.xss.friendlyAttrValue(g).replace(/"/g,"'"):"img"===d&&"src"===a?this.xss.escapeAttrValue(g):this.xss.safeAttrValue(d,a,g,l)}),onTag:h.hitch(this,function(d,a,g){if(g.isWhite&&this._isInWhiteList(d,
this.graphicsWhiteList))return a}),onIgnoreTagAttr:h.hitch(this,function(d,a,g,l){if("data-"===a.substr(0,5))return a+'\x3d"'+this.xss.escapeAttrValue(g)+'"'}),onIgnoreTag:h.hitch(this,function(d,a,g){if("o:"===d.substr(0,2)||"!--[if"===d||"!--[endif]--"===d)return a})},!0);this.xss=this.sanitizer.xss},sanitize:function(d){return this.sanitizer.sanitize(d)},_getWhiteList:function(){var d="title height width class style font-family id align text-align".split(" "),a={div:d,h1:d,h2:d,h3:d,h4:d,h5:d,
h6:d,span:d,p:d,s:d,strong:d,em:d,u:d,ol:d,ul:d,li:d,a:["href","target"].concat(d),img:["src","alt","border"].concat(d),blockquote:d,font:["face","size","color"].concat(d),pre:d,code:d,b:d,i:d,wbr:d,video:"autoplay controls loop muted poster preload".split(" ").concat(d),audio:["autoplay","controls","loop","muted","preload"].concat(d),source:["media","src","type"].concat(d),table:["cellpadding","cellspacing","border"].concat(d),tbody:[].concat(d),tr:["valign"].concat(d),td:["valign","colspan","rowspan",
"nowrap"].concat(d),th:["valign","colspan","rowspan","nowrap"].concat(d),hr:d,html:d,title:d,link:["rel","href"],style:["type"].concat(d),body:d};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],feFuncA:[],feFuncB:[],feFuncG:[],
feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],textPath:[],title:[],tspan:[],
use:[],view:[],object:[],canvas:d};return this._extendObjectOfArrays([a,{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size",
"face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],
ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},_extendObjectOfArrays:function(d){var a={};p.forEach(d,function(g){var l=Object.keys(g);p.forEach(l,function(k){Array.isArray(g[k])&&Array.isArray(a[k])?a[k]=a[k].concat(g[k]):a[k]=g[k]},this)},this);return a},_isInWhiteList:function(d,a){a=Object.keys(a);var g=!1;p.forEach(a,function(l){d===l&&(g=!0)},this);return g}});c.getInstance=function(){null===b&&(b=new c);return b};return c})},"widgets/BusinessAnalyst/_build-generate_module":function(){define(["dojo/text!./Widget.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:esri/dijit/geoenrichment/templates/_WizardPage.html":'\x3cdiv style\x3d"width: 100%; height: 100%;"\x3e\r\n    \x3cdiv data-dojo-type\x3d"esri/dijit/geoenrichment/Grid" data-dojo-attach-point\x3d"layoutGrid"  class\x3d"Grid"\x3e\r\n        ${content}\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/BusinessAnalyst/CreateBuffersPage.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e${nls.addRingsDtWt}\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n    \x3cdiv style\x3d"width: 350 px; height: 110px"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"ringDtWtTabContainer" style\x3d"width: 100%; height: 110px;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"ringsContentPane" title\x3d"${nls.rings}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.radius}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 1" data-dojo-attach-point\x3d"ringsBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 3" data-dojo-attach-point\x3d"ringsBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"ringsBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"ringsBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles" selected\x3d"selected"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"ringValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"driveTimeContentPane" title\x3d"${nls.driveTime}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.time}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"driveTimeBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 10" data-dojo-attach-point\x3d"driveTimeBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 15" data-dojo-attach-point\x3d"driveTimeBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"driveTimeBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"driveTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"walkTimeContentPane" title\x3d"${nls.walkTime}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.time}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"walkTimeBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 10" data-dojo-attach-point\x3d"walkTimeBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 15" data-dojo-attach-point\x3d"walkTimeBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"walkTimeBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"walkTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top: 10px;" class\x3d"jimu-btn jimu-btn-vacation"  data-dojo-attach-point\x3d"backBtn" data-dojo-attach-event\x3d"onclick:backOnClick"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top: 10px;" class\x3d"jimu-btn"  data-dojo-attach-point\x3d"createBufferBtn" data-dojo-attach-event\x3d"onclick:applyBuffer"\x3e${nls.apply}\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/ErrorPage.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noPermissionsErrorDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"servicesErrorDiv"\r\n\x3c/div\x3e\r\n',"url:esri/dijit/geoenrichment/templates/OnDemandSelect.html":'\x3cdiv class\x3d"esriGEOnDemandSelect"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"openButton" class\x3d"onDemandSelect_openButton"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"arrow" class\x3d"onDemandSelect_arrow"\x3e\x26nbsp;\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"selectedLabel" class\x3d"onDemandSelect_selectedLabel TrimWithEllipses"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"selectedItemHolder" class\x3d"onDemandSelect_selectedItem TrimWithEllipses"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/ComparisonSettings.html":'\x3cdiv class\x3d"esriGEReportPlayerToolbar_comparisonSettings esriGENonSelectable"\x3e\r\n    \x3cdiv class\x3d"esriGERow20" data-dojo-attach-point\x3d"showBackgroundImageBlock"\x3e\r\n        ${nls.comparisonSettings}\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriGESpaceBefore20"\x3e\r\n        \x3cdiv class\x3d"esriGERow20" data-dojo-attach-point\x3d"showBackgroundImageBlock"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"showBackgroundImageLabel"\x3e\x26nbsp;${nls.showBackgroundImage}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20"\x3e\r\n            \x3cdiv class\x3d"dijitInline"\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"splitPanelsLabel"\x3e\x26nbsp;${nls.splitPanels}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceBeforeBig esriGEInfoIcon" data-dojo-attach-point\x3d"splitPanelsInfoIcon"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20"\x3e\r\n            \x3cdiv class\x3d"dijitInline"\x3e${nls.zoomPanels}\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceBeforeBig esriGEInfoIcon" data-dojo-attach-point\x3d"zoomPanelsInfoIcon"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20 esriGESpaceBefore20" data-dojo-attach-point\x3d"zoomBlock"\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomOutButton esriGEIcon16" data-dojo-attach-point\x3d"zoomOutButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomLabel" data-dojo-attach-point\x3d"zoomLabel"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomInButton esriGEIcon16" data-dojo-attach-point\x3d"zoomInButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGELink comparisonSettings_resetLink" data-dojo-attach-point\x3d"resetButton"\x3e${nls.reset}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20 esriGESpaceBefore20" data-dojo-attach-point\x3d"zoomSplitBlock"\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomOutButton esriGEIcon16" data-dojo-attach-point\x3d"zoomOutSplitButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomLabel" data-dojo-attach-point\x3d"zoomSplitLabel"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomInButton esriGEIcon16" data-dojo-attach-point\x3d"zoomInSplitButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGELink comparisonSettings_resetLink" data-dojo-attach-point\x3d"resetSplitButton"\x3e${nls.reset}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/PlayerToolbarHolder.html":'\x3cdiv class\x3d"esriGEPlayerToolbar"\x3e\r\n\r\n    \x3c!--left--\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"infographicsSelectDiv" class\x3d"dijitInline playerToolbar_infographicsSelectDiv"\x3e\x3c/div\x3e\r\n    \r\n    \x3c!--center--\x3e\r\n    \r\n    \x3cdiv data-dojo-attach-point\x3d"areaTitleDiv" class\x3d"dijitInline playerToolbar_areaTitleDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"areaTitleInnerDiv" class\x3d"dijitInline playerToolbar_areaTitleInnerDiv TrimWithEllipses"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"areasSelectDiv" class\x3d"dijitInline playerToolbar_areasSelectDiv"\x3e\x3c/div\x3e\r\n\r\n    \x3c!--right--\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"rightSideControlsBlock" class\x3d"dijitInline playerToolbar_rightSideControlsBlock"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"zoomSelectDiv" class\x3d"dijitInline dijitInline playerToolbar_zoomSelectDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"pageSelectDiv" class\x3d"dijitInline dijitInline playerToolbar_pageSelectDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"commandButtonsContainer" class\x3d"dijitInline playerToolbar_commandButtonsContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/ReportPlayer.html":'\x3cdiv class\x3d"esriGEReportPlayer esriGENonSelectable"\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"printBackgroundView" class\x3d"esriGEAbsoluteStretched"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"normalViewDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"playerToolbarDiv"\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"printableDivContainer" class\x3d"reportPalyer_printableDivContainer"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"printableDiv" class\x3d"reportPalyer_printableDiv"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"reportContainerDiv"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"reportPlayer_sidePageNavigator" data-dojo-attach-point\x3d"sidePageNavigator"\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowUp" data-dojo-attach-point\x3d"prevPageButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowDown" data-dojo-attach-point\x3d"nextPageButton"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"playerAfterToolbarDiv" class\x3d"reportPlayer_playerAfterToolbarDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/templates/SelectableTreeGrid.html":'\x3cdiv class\x3d"esriMapsAnalystXNonSelectable"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"gridContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"selectionCounter" class\x3d"esriMapsAnalystXSelectableTreeCounter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/BusinessAnalyst/RunReportsPage.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"business-analyst-run-reports-page" style\x3d"width: 350 px; height: 150px"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"runReportTabContainer" style\x3d"width: 100%; height: 155px;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"infographicsContentPane" title\x3d"${nls.infographics}" style\x3d"overflow-y: hidden"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"infographicDropDownContainer"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-btn runReportButton jimu-state-disabled" data-dojo-attach-point\x3d"runInfographicBtn" data-dojo-attach-event\x3d"onclick:runInfographic"\x3e${nls.runInfographic}\x3c/div\x3e\r\n\t\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"reportsContentPane" title\x3d"${nls.reports}" style\x3d"overflow-y: hidden"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"reportFilteringSelectDropDownContainer"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-btn runReportButton jimu-state-disabled" data-dojo-attach-point\x3d"runReportBtn" data-dojo-attach-event\x3d"onclick:runReport"\x3e${nls.runReport}\x3c/div\x3e\r\n\t\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n\t\x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"backBtn" data-dojo-attach-event\x3d"onclick:backOnClick"\x3e${nls.back}\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/SelectPointPolygonPage.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"contentContainer"\x3e\x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"searchContainer" class\x3d"esriBusinessAnalystSearchContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"activatePinButton" title\x3d"${nls.addPoint}" class\x3d"esriBusinessAnalystButton esriBusinessAnalystPinButton esriBusinessAnalystButtonSearchPadding" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"1" role\x3d"button" data-dojo-attach-point\x3d"activatePolygonButton" title\x3d"${nls.addPolygon}" class\x3d"esriBusinessAnalystButton esriBusinessAnalystPolygonButton esriBusinessAnalystButtonSearchPadding" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"2" role\x3d"button" data-dojo-attach-point\x3d"activateFreehandPolygonButton" title\x3d"${nls.addFreehandPolygon}" class\x3d"esriBusinessAnalystButton esriBusinessAnalystFreehandPolygonButton esriBusinessAnalystButtonSearchPadding" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"wizardContainer"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/BusinessAnalyst/css/style.css":'.esriBusinessAnalystButton {background: #fff; border: 1px solid #c5c5c5; color: #555; -webkit-border-radius: 3px; -moz-border-radius: 3px; -ms-border-radius: 3px; -o-border-radius: 3px; border-radius: 3px; font-size: 12px; line-height: 12px; -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); -moz-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-user-select: none; -moz-user-select: none; user-select: none; -webkit-transition: all .05s linear; -moz-transition: all .05s linear; -o-transition: all .05s linear; transition: all .05s linear; padding: 5px 10px; text-align: center; text-transform: uppercase; cursor: pointer; letter-spacing: 1px; position: relative; -webkit-font-smoothing: antialiased; width: 34px; height: 34px; background-repeat: no-repeat; background-position: center; margin-left: 1px;}.esriBusinessAnalystPressedButton {box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.2);}.esriBusinessAnalystPressedButton,.esriBusinessAnalystPressedButton:hover{background-color: #DDE8F2;}.esriBusinessAnalystButtonSearchPadding {top: 22px;}.esriBusinessAnalystPinButton {float: left; margin-right: 10px; background-image: url("../../../jimu.js/css/images/draw_point.png");}.esriBusinessAnalystPolygonButton {float: left; background-size: 45px 45px; margin-right: 10px; background-image: url("../../../jimu.js/css/images/draw_polygon.png");}.esriBusinessAnalystFreehandPolygonButton {float: left; background-image: url("../../../jimu.js/css/images/draw_freehand_polygon.png");}.esriGETooltip {box-sizing: initial !important;}.esriGEPlayerToolbar.playerThemeDark {background-color: inherit !important;}.runReportButton {display: block; margin-top: 15px; width: max-content;}.jimu-btn.runReportButton.jimu-state-disabled {cursor: default;}.jimu-widget-business-analyst .tabs {font-family: "Avenir Light"; color: #000000; height: 100%;} .jimu-widget-business-analyst .tabs .tab-description {margin: 10px 0;} .jimu-widget-business-analyst .jimu-tab3\x3e.control\x3e.tab{background-color: #fff; border-top: 0; border-left: 0; border-right: 0; border-bottom: 1px solid #dedede; color:#898989; font-family: "Avenir Medium"; font-size: 14px;} .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {border-bottom: 3px solid #24b5cc; font-family: "Avenir Heavy"; color: #000000;} .DashboardTheme .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {color: #FFFFFF;} .DashboardTheme.light .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {color: #000000;} .jimu-widget-business-analyst .tabs .titles {font-weight: bold; font-family: "Avenir Medium"; font-size: 14px; margin: 20px 0 10px 0;} .jimu-widget-business-analyst .tabs .hide{display: none;} .jimu-widget-business-analyst .tabs .indent{margin-left: 20px; margin-top: 10px;} .jimu-widget-business-analyst .tabs .unit-item{margin: 15px 5px 5px 5px; line-height: 18px; height: 18px; vertical-align: middle;} .jimu-widget-business-analyst .tabs .clearFix {*overflow: hidden; *zoom: 1;} .jimu-widget-business-analyst .tabs .clearFix:after {display: table; content: ""; width: 0; clear: both;} .jimu-widget-business-analyst .tabs .view{height: 100%; overflow-y: auto;} .jimu-widget-business-analyst .tabs .jimu-tab3\x3e.jimu-viewstack{padding-bottom: 30px;} .claro .jimu-widget-business-analyst .dijitTextBox, .claro .esriGEReportPlayer .esriGEPlayerToolbar .dijitTextBox {height: 30px;} .claro .jimu-widget-business-analyst .ui-icon {background-image: inherit;} .business-analyst-search-suggestions-overflow {overflow: visible !important;} .claro .jimu-widget-business-analyst .arcgisSearch .searchClear {top: 2px;} .jimu-widget-business-analyst .validationErrorMessage {color: #FF0000; margin-top: 10px;} .jimu-widget-business-analyst .validationErrorMessage.hidden {display: none;} .jimu-widget-business-analyst .invalidValue {outline: 3px solid #FF0000;} .jimu-widget-business-analyst .business-analyst-run-reports-page .dijitTextBox, .esriGEReportPlayer .playerToolbar_infographicsSelectDiv .dijitTextBox {width: 20em;}',
"*now":function(r){r(['dojo/i18n!*preload*widgets/BusinessAnalyst/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define(["dojo/_base/declare","dojo/dom-class","dojo/query","jimu/BaseWidget","./BAWizard"],function(r,p,m,h,f){return r([h],{name:"BusinessAnalyst",baseClass:"jimu-widget-business-analyst",reportDropDown:null,infographicDropDown:null,tradeAreaGraphics:[],selectedPoint:{tradeAreas:[]},postCreate:function(){this.inherited(arguments);this.initializeNewConfigValues();this.baWizard=(new f({appConfig:this.appConfig,map:this.map,nls:this.nls,config:this.config})).placeAt(this.wizardContainer)},startup:function(){this.baWizard.resize();
m(".jimu-widget-business-analyst").parents(".jimu-widget-frame.jimu-container")[0]&&p.add(m(".jimu-widget-business-analyst").parents(".jimu-widget-frame.jimu-container")[0],"business-analyst-search-suggestions-overflow");m(".jimu-widget-business-analyst").parents(".jimu-panel.jimu-on-screen-widget-panel")[0]&&p.add(m(".jimu-widget-business-analyst").parents(".jimu-panel.jimu-on-screen-widget-panel")[0],"business-analyst-search-suggestions-overflow")},resize:function(){this.baWizard&&this.baWizard.resize()},
onClose:function(){this.baWizard._featureUnselected()},onOpen:function(){this.baWizard.refreshPage()},initializeNewConfigValues:function(){"undefined"===typeof this.config.exportInfographicsPrintOption&&(this.config.exportInfographicsPrintOption=!0);"undefined"===typeof this.config.exportInfographicsImageOption&&(this.config.exportInfographicsImageOption=!0);"undefined"===typeof this.config.exportInfographicsPDFOption&&(this.config.exportInfographicsPDFOption=!0);"undefined"===typeof this.config.exportInfographicsDynamicHTMLOption&&
(this.config.exportInfographicsDynamicHTMLOption=!0);"undefined"===typeof this.config.firstPageText&&(this.config.firstPageText="\x3cbr\x3e\x3cdiv\x3e"+this.nls.widgetDescription+"\x3c/div\x3e\x3cbr\x3e\x3cdiv\x3e"+this.nls.selectPointOrPolygon+"\x3c/div\x3e");"undefined"===typeof this.config.searchTextBoxOption&&(this.config.searchTextBoxOption=!0);"undefined"===typeof this.config.dropPinOption&&(this.config.dropPinOption=!0);"undefined"===typeof this.config.drawPolygonOption&&(this.config.drawPolygonOption=
!0);"undefined"===typeof this.config.drawFreehandPolygonOption&&(this.config.drawFreehandPolygonOption=!0)}})});