// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/SmartEditor/setting/Coordinates.html":'\x3cdiv style\x3d"max-height: 445px;padding: 0 5px;"\x3e\r\n  \x3cdiv class\x3d"esriCTCoordinateWidth" data-dojo-attach-point\x3d"coordianteDijitMainWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper" data-dojo-attach-point\x3d"groupInfoNode1"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel"\x3e${nls.intersectionPage.groupNameLabel}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"groupNameTextBoxNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- hide coordinate source dropdown --\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper esriCTHidden"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel" title\x3d"${nls.coordinatesPage.coordinatesSourceTitle}"\x3e\r\n        ${nls.coordinatesPage.coordinatesSourceTitle}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTCoordinatePopupdijit" style\x3d"width: 100%;" data-dojo-attach-point\x3d"coordinatesSourceNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel" title\x3d"${nls.coordinatesPage.coordinatesSelectTitle}"\x3e${nls.coordinatesPage.coordinatesSelectTitle}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTCoordinatePopupdijit" style\x3d"width: 100%" data-dojo-attach-point\x3d"selectCoordinateNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel" title\x3d"${nls.coordinatesPage.coordinatesAttributeTitle}"\x3e${nls.coordinatesPage.coordinatesAttributeTitle}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTCoordinatePopupdijit" style\x3d"width: 100%" data-dojo-attach-point\x3d"selectAttributeNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTWrapper" data-dojo-attach-point\x3d"groupInfoNode2"\x3e\r\n    \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n      \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.intersectionPage.layerAndFieldsApplyLabel}\x3c/legend\x3e\r\n      \x3cdiv class\x3d"esriCTTableParentContainer" data-dojo-attach-point\x3d"tableParentContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on dojo/text!./Coordinates.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/Popup dijit/form/Select dijit/form/ValidationTextBox ./layersAndFieldsApplyOn dojo/dom-class".split(" "),function(u,v,d,h,l,p,w,x,y,z,q,A,B,n){return u([y,v,x],{baseClass:"jimu-widget-smartEditor-setting-coordinates",templateString:w,groupNameTextBox:null,postCreate:function(){this.inherited(arguments);this.fieldSelector=
this.groupNameTextBox=null;this._initControls();this._createLayersAndFields();this.isDelete||this.showDialog()},_onCoordinateSystemChanged:function(b){this.fieldSelector.set("options",this._getFieldsOptionsObj(b));0<this.fieldSelector.options.length&&this.fieldSelector.set("value",this.fieldSelector.options[0].value)},showDialog:function(){var b=!1;var a=675;var c=!1;if(this._fieldValues&&this._fieldValues.Coordinates&&this._fieldValues.Coordinates.hasOwnProperty("enabled")){b=this._fieldValues.Coordinates.enabled;
var m=this._fieldValues.Coordinates.coordinatesSystem;var e=this._fieldValues.Coordinates.field;var r=this._fieldValues.Coordinates.hasOwnProperty("coordinatesSource")?this._fieldValues.Coordinates.coordinatesSource:"featureLocation"}this.coordinatesSource=new q({options:this._addCoordinatesSourceOpt(),style:{width:"99%"}},l.create("div",{},this.coordinatesSourceNode));r&&this.coordinatesSource.set("value",r,!1);this.own(p(this.coordinatesSource,"change",d.hitch(this,function(g){f.set("options",this._createCoordinatesOptions(g));
0<f.options.length&&(f.set("value",f.options[0].value,!1),this._onCoordinateSystemChanged(f.options[0].value))})));var f=new q({style:{width:"99%"},options:this._createCoordinatesOptions(this.coordinatesSource.value)},l.create("div",{},this.selectCoordinateNode));this.own(p(f,"change",d.hitch(this,this._onCoordinateSystemChanged)));m&&f.set("value",m,!1);this.fieldSelector=new q({style:{width:"99%"},options:this._getFieldsOptionsObj(f.getValue())},l.create("div",{},this.selectAttributeNode));e&&(this.fieldSelector.set("value",
e),"MGRS"===e&&this._createLayersAndFields());this.own(p(this.fieldSelector,"change",d.hitch(this,function(){this._createLayersAndFields()})));this.isGroup||(n.add(this.groupInfoNode1,"esriCTHidden"),n.add(this.groupInfoNode2,"esriCTHidden"),n.remove(this.coordianteDijitMainWrapper,"esriCTCoordinateWidth"),n.add(this.coordianteDijitMainWrapper,"esriCTFullWidth"),c=!0,a=420);var t=new z({titleLabel:this.nls.coordinatesPage.popupTitle,width:a,maxHeight:500,autoHeight:c,content:this,buttons:[{label:this.nls.ok,
onClick:d.hitch(this,function(){var g={},k={};g.enabled=b;g.coordinatesSystem=f.get("value");g.field=this.fieldSelector.get("value");g.coordinatesSource=this.coordinatesSource.get("value");if(this.isGroup){if(!this.groupNameTextBox.isValid()){this.groupNameTextBox.focus();return}}else delete this._fieldValues.Coordinates.attributeActionGroupName;this._fieldValues.Coordinates||(this._fieldValues.Coordinates={actionName:"Coordinates"});d.mixin(this._fieldValues.Coordinates,g);this.isGroup?(k.name=this.groupNameTextBox.get("value"),
k.dataType=this.fieldSelector._getSelectedOptionsAttr().label,k.attributeInfo=g,k.appliedOn=this._layerAndFieldsApplyOnObj.getCheckedFields(k),this.emit("groupInfoUpdated",k)):this.emit("attributeActionUpdated");t.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:d.hitch(this,function(){t.close()})}],onClose:d.hitch(this,function(){})});this.isGroup&&this.groupNameTextBox.focus()},_initControls:function(){this.groupNameTextBox=new A({style:{width:"99%"},required:!0,trim:!0},
l.create("div",{},this.groupNameTextBoxNode));this.groupNameTextBox.validator=d.hitch(this,function(b){return b?b!==this.prevName&&this.editUtils.isDuplicateGroupName(b,this.existingGroupNames)?(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.uniqueGroupNameMsg),!1):!0:(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.requiredGroupNameMsg),!1)});this.name&&this.groupNameTextBox.set("value",this.name)},_createCoordinatesOptions:function(b){var a=[];this.isGroup?
(0<this.coordinatesSavedDataTypes[b].MapSpatialReference.length&&a.push({label:this.nls.coordinatesPage.mapSpatialReference,value:"MapSpatialReference"}),0<this.coordinatesSavedDataTypes[b].LatLong.length&&a.push({label:this.nls.coordinatesPage.latlong,value:"LatLong"}),0<this.coordinatesSavedDataTypes[b].MGRS.length&&a.push({label:this.nls.coordinatesPage.MGRS,value:"MGRS"})):a.push({label:this.nls.coordinatesPage.mapSpatialReference,value:"MapSpatialReference"},{label:this.nls.coordinatesPage.latlong,
value:"LatLong"},{label:this.nls.coordinatesPage.MGRS,value:"MGRS"});return a},_getFieldsOptionsObj:function(b){var a=[],c=[];c=this._getCoordinateSystemOptions(b);var m=this.coordinatesSource.get("value");h.forEach(c,d.hitch(this,function(e){this.isGroup?(-1!==this.coordinatesSavedDataTypes[m][b].indexOf(e.alias)||-1!==this.coordinatesSavedDataTypes[m].LatLong.indexOf(e.alias))&&a.push({label:e.alias||e.name,value:e.name}):("xy"!==e.name||"xy"===e.name&&"esriFieldTypeString"===this._fieldType)&&
a.push({label:e.alias||e.name,value:e.name})}));return a},_getCoordinateSystemOptions:function(b){switch(b){case "LatLong":var a=[{name:"y",alias:"Latitude"},{name:"x",alias:"Longitude"},{name:"xy",alias:"Latitude Longitude"}];break;case "MapSpatialReference":a=[{name:"x",alias:"X"},{name:"y",alias:"Y"},{name:"xy",alias:"X Y"}];break;case "MGRS":a=[{name:"MGRS",alias:"MGRS"}]}return a},_createLayerFieldsFilter:function(){var b={};!this.fieldSelector||"xy"!==this.fieldSelector.value&&"MGRS"!==this.fieldSelector.value?
h.forEach(this._totalLayers,d.hitch(this,function(a){a.isTable||h.forEach(a.layerObject.fields,d.hitch(this,function(c){if("esriFieldTypeString"===c.type||"esriFieldTypeSmallInteger"===c.type||"esriFieldTypeInteger"===c.type||"esriFieldTypeSingle"===c.type||"esriFieldTypeDouble"===c.type&&c.editable)b[a.id]||(b[a.id]={}),b[a.id][c.name]=c}))})):h.forEach(this._totalLayers,d.hitch(this,function(a){a.isTable||(b[a.id]={},h.forEach(a.layerObject.fields,d.hitch(this,function(c){"esriFieldTypeString"===
c.type&&(b[a.id]||(b[a.id]={}),b[a.id][c.name]=c)})))}));return b},_createLayersAndFields:function(){this._layerAndFieldsApplyOnObj=new B({map:this.map,layerInfos:this.layerInfos,_configInfos:this._configInfos,actionName:"Coordinates",nls:this.nls,prevName:this.prevName,existingGroups:this.existingGroups,layerDetails:this._createLayerFieldsFilter(),appliedOn:this.appliedOn});l.empty(this.tableParentContainer);this._layerAndFieldsApplyOnObj.placeAt(this.tableParentContainer);this._layerAndFieldsApplyOnObj.startup()},
deleteGroup:function(){this._layerAndFieldsApplyOnObj.deleteGroup()},_addCoordinatesSourceOpt:function(){var b=[];b=[{label:this.nls.coordinatesPage.featureLocation,value:"featureLocation"},{label:this.nls.coordinatesPage.myLocation,value:"myLocation"}];return b=this.removeCoordsSourceOption(b)},removeCoordsSourceOption:function(b){h.forEach(b,d.hitch(this,function(a,c){a&&this.isGroup&&(a=this.coordinatesSavedDataTypes[a.value],0===a.LatLong.length&&0===a.MGRS.length&&0===a.MapSpatialReference.length&&
b.splice(c,1))}));return b}})});