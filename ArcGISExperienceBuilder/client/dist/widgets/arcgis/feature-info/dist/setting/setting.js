System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-arcgis","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],(function(e){var t,n,o,s,a,i,r;return{setters:[function(e){t=e},function(e){n=e},function(e){o=e},function(e){s=e},function(e){a=e},function(e){i=e},function(e){r=e}],execute:function(){e(function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=387)}({0:function(e,n){e.exports=t},1:function(e,t){e.exports=n},11:function(e,t){e.exports=a},13:function(e,t){e.exports=i},2:function(e,t){e.exports=o},22:function(e,t){e.exports=r},387:function(e,t,n){"use strict";n.r(t);var o,s=n(0),a=n(1),i=n(22),r=n(2),p=n(11),c=n(40),u="Source",d="Details options",l="Content",g="Media",f="Attachments",h="Last edit info",m="No data message",j="No data found.",b="Text size",S="Respect the source",x=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var y=n(13),C=n(4);var O,M=(O=function(e,t){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),v=function(e){function t(t){var n=e.call(this,t)||this;return n.supportedDsTypes=Object(s.Immutable)([p.AllDataSourceTypes.FeatureLayer]),n.getPortUrl=function(){return Object(s.getAppStore)().getState().portalUrl},n.onRadioChange=function(e){n.props.onSettingChange({id:n.props.id,config:n.props.config.set("useMapWidget",e)}),n.setState({useMapWidget:e})},n.onPropertyChange=function(e,t){n.props.onSettingChange({id:n.props.id,config:n.props.config.set(e,t)})},n.onOptionsChanged=function(e,t){n.props.onSettingChange({id:n.props.id,config:n.props.config.set(t,e)})},n.onToggleUseDataEnabled=function(e){n.props.onSettingChange({id:n.props.id,useDataSourcesEnabled:e})},n.onStyleTypeChanged=function(e){var t=e.target.value;n.props.onSettingChange({id:n.props.id,config:n.props.config.set("styleType",t)})},n.onStyleChanged=function(e,t){n.props.onSettingChange({id:n.props.id,config:n.props.config.setIn(["style",e],t)})},n.onSelectAutoFontSizeType=function(){n.props.onSettingChange({id:n.props.id,config:n.props.config.setIn(["style","fontSizeType"],c.a.auto)})},n.onSelectCustomFontSizeType=function(){n.props.onSettingChange({id:n.props.id,config:n.props.config.setIn(["style","fontSizeType"],c.a.custom)})},n.onFontSizeChanged=function(e){n.props.onSettingChange({id:n.props.id,config:n.props.config.setIn(["style","fontSize"],e)})},n.onFilterChange=function(e,t){var o=n.props.useDataSources;o&&o[0]&&o[0].dataSourceId===t&&n.props.onSettingChange({id:n.props.id,useDataSources:[o[0].setIn(["query","where"],e).asMutable({deep:!0})]})},n.onSortChange=function(e,t){var o=n.props.useDataSources;o&&o[0]&&o[0].dataSourceId===t&&n.props.onSettingChange({id:n.props.id,useDataSources:[o[0].setIn(["query","orderBy"],e).asMutable({deep:!0})]})},n.onDataSourceChange=function(e){e&&n.props.onSettingChange({id:n.props.id,useDataSources:e})},n.onDataSourceCreated=function(e){n.dataSource=e,function(e){return Object(C.loadArcGISJSAPIModules)(["esri/layers/FeatureLayer"]).then((function(t){var n,o=t[0];return(n=e.layer?e.layer:e.itemId?new o({portalItem:{id:e.itemId,portal:{url:e.portalUrl}}}):new o({url:e.url})).load().then((function(){return Promise.resolve(n)}))})).catch((function(e){return console.warn(e),null}))}(e).then((function(e){var t,o,s,a,i,r=null===(t=null==e?void 0:e.popupTemplate)||void 0===t?void 0:t.content,p=!1,u=!1,d=!1,l=!!(null===(o=null==e?void 0:e.popupTemplate)||void 0===o?void 0:o.title),g=null===(s=null==e?void 0:e.popupTemplate)||void 0===s?void 0:s.lastEditInfoEnabled;r&&r.length?r.forEach((function(e){switch(e.type){case"text":p=!0;break;case"media":u=!0;break;case"attachments":d=!0}})):(p=!0,l=!0,u=!1,d=!1,g=!1),p||n.props.onSettingChange({id:n.props.id,config:n.props.config.set("styleType",c.b.custom)});var f=null===(i=null===(a=null==e?void 0:e.capabilities)||void 0===a?void 0:a.data)||void 0===i?void 0:i.supportsAttachment,h=!(!(null==e?void 0:e.editingInfo)||!(null==e?void 0:e.editFieldsInfo));n.setState({popupHasTextContent:p,popupHasMediaContent:u,popupHasAttachmentsContent:d,popupHasTitle:l,popupHasChangeTracking:g,layerHasAttachment:f,layerHasChangeTracking:h})}))},n.onDataSourceRemoved=function(){n.props.onSettingChange({id:n.props.id,useDataSources:[]})},n.onMapWidgetSelected=function(e){n.props.onSettingChange({id:n.props.id,useMapWidgetIds:e})},n.state={useMapWidget:n.props.config.useMapWidget||!1,popupHasTextContent:!0,popupHasMediaContent:!1,popupHasAttachmentsContent:!1,popupHasTitle:!1,popupHasChangeTracking:!1,layerHasAttachment:!1,layerHasChangeTracking:!1},n}return M(t,e),t.prototype.getStyleConfig=function(){return this.props.config.style?this.props.config.style:{textColor:"",fontSize:{distance:0,unit:a.UnitTypes.PIXEL},backgroundColor:""}},t.prototype.getCapabilities=function(){return{supportsTitle:this.state.popupHasTitle,supportsMedia:this.state.popupHasMediaContent,supportsAttachment:this.state.popupHasAttachmentsContent&&this.state.layerHasAttachment,supportsChangeTracking:this.state.popupHasChangeTracking&&this.state.layerHasChangeTracking}},t.prototype.render=function(){var e=this,t=[];if(this.props.useDataSources)for(var n=0;n<this.props.useDataSources.length;n++)t.push(this.props.useDataSources[n].dataSourceId);var C,O,M,v,T,w,I=this.props.useDataSources&&this.props.useDataSources[0],D=null,k=null;return I&&I.dataSourceId&&(k=Object(s.jsx)(s.DataSourceComponent,{useDataSource:I,onDataSourceCreated:this.onDataSourceCreated,query:null})),C=Object(s.jsx)(r.SettingSection,{title:this.props.intl.formatMessage({id:"sourceLabel",defaultMessage:u})},Object(s.jsx)(r.SettingRow,null,Object(s.jsx)(p.DataSourceSelector,{types:this.supportedDsTypes,useDataSourcesEnabled:!0,mustUseDataSource:!0,useDataSources:this.props.useDataSources,onChange:this.onDataSourceChange,widgetId:this.props.id}),k)),O=Object(s.jsx)(r.SettingSection,{className:"map-selector-section",title:this.props.intl.formatMessage({id:"sourceDescript",defaultMessage:"map widget **"})},Object(s.jsx)(r.SettingRow,null,Object(s.jsx)("div",{className:"map-selector-descript"},this.props.intl.formatMessage({id:"sourceDescript",defaultMessage:"set an interactive map **"}))),Object(s.jsx)(r.SettingRow,null,Object(s.jsx)(r.JimuMapViewSelector,{onSelect:this.onMapWidgetSelected,useMapWidgetIds:this.props.useMapWidgetIds}))),D=this.state.useMapWidget?O:C,this.state.popupHasTextContent&&(v=Object(s.jsx)(a.Select,{size:"sm",value:this.props.config&&this.props.config.styleType,onChange:this.onStyleTypeChanged,className:""},Object(s.jsx)("option",{key:2,value:c.b.usePopupDefined},Object(s.jsx)(s.FormattedMessage,{id:"respectTheSource",defaultMessage:S})),Object(s.jsx)("option",{key:3,value:c.b.custom},Object(s.jsx)(s.FormattedMessage,{id:"custom",defaultMessage:"abc"})))),"custom"===this.props.config.styleType&&(T=this.props.config.style.fontSizeType===c.a.custom?Object(s.jsx)(y.InputUnit,{style:{width:"6.5rem"},units:[a.UnitTypes.PIXEL,a.UnitTypes.PERCENTAGE],className:"item",min:1,value:this.getStyleConfig().fontSize,onChange:this.onFontSizeChanged}):Object(s.jsx)(a.Button,{style:{width:"6.5rem"},disabled:!0,size:"sm"},Object(s.jsx)(s.FormattedMessage,{id:"auto",defaultMessage:"Auto"})),M=Object(s.jsx)("div",null,Object(s.jsx)(r.SettingRow,{className:"mt-3",label:Object(s.jsx)(s.FormattedMessage,{id:"textSize",defaultMessage:b})},Object(s.jsx)(a.ButtonGroup,null,Object(s.jsx)(a.Dropdown,{activeIcon:!0,className:"dropdown"},Object(s.jsx)(a.DropdownButton,{size:"sm",style:{width:"auto"},icon:!0}),Object(s.jsx)(a.DropdownMenu,{className:"dropdown-menu",zIndex:"55",alightment:"start"},Object(s.jsx)(a.DropdownItem,{key:1,active:this.props.config.style.fontSizeType===c.a.auto,onClick:this.onSelectAutoFontSizeType},Object(s.jsx)(s.FormattedMessage,{id:"auto",defaultMessage:"Auto"})),Object(s.jsx)(a.DropdownItem,{key:2,active:this.props.config.style.fontSizeType===c.a.custom,onClick:this.onSelectCustomFontSizeType},Object(s.jsx)(s.FormattedMessage,{id:"custom",defaultMessage:"Custom"})))),T)),Object(s.jsx)(r.SettingRow,{label:Object(s.jsx)(s.FormattedMessage,{id:"textColor",defaultMessage:"Text color"})},Object(s.jsx)(i.ThemeColorPicker,{specificTheme:this.props.appTheme,value:this.getStyleConfig().textColor,onChange:function(t){return e.onStyleChanged("textColor",t)}})))),Object(s.jsx)("div",{css:(w=this.props.theme,Object(s.css)(o||(o=x(["\n    .widget-setting-featureInfo{\n      font-weight: lighter;\n      font-size: 13px;\n\n      .second-header {\n        color: ",";\t\n      }\n\n      .webmap-thumbnail{\n        cursor: auto;\n        width: 100%;\n        height: 120px;\n        overflow: hidden;\n        padding: 1px;\n        border: "," solid initial;\n        img, div{\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      .featureInfo-options-part{\n        background-color: ",";\n        padding: 0.5rem;\n      }\n\n      .featureInfo-options{\n        .featureInfo-options-item{\n          display: flex;\n          justify-content: space-between;\n          /* margin-bottom: 8px; */\n        }\n      }\n    }\n  "],["\n    .widget-setting-featureInfo{\n      font-weight: lighter;\n      font-size: 13px;\n\n      .second-header {\n        color: ",";\t\n      }\n\n      .webmap-thumbnail{\n        cursor: auto;\n        width: 100%;\n        height: 120px;\n        overflow: hidden;\n        padding: 1px;\n        border: "," solid initial;\n        img, div{\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      .featureInfo-options-part{\n        background-color: ",";\n        padding: 0.5rem;\n      }\n\n      .featureInfo-options{\n        .featureInfo-options-item{\n          display: flex;\n          justify-content: space-between;\n          /* margin-bottom: 8px; */\n        }\n      }\n    }\n  "])),w.colors.palette.dark[600],s.polished.rem(2),w.colors.palette.light[200]))},Object(s.jsx)("div",{className:"widget-setting-featureInfo"},D,Object(s.jsx)(r.SettingSection,{title:this.props.intl.formatMessage({id:"detailOptions",defaultMessage:d})},Object(s.jsx)("div",{className:"featureInfo-options-part"},Object(s.jsx)(r.SettingRow,{label:Object(s.jsx)(s.FormattedMessage,{id:"title",defaultMessage:"Title"})},Object(s.jsx)(a.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsTitle,checked:this.props.config&&this.props.config.title,"data-key":"title",onChange:function(t){e.onOptionsChanged(t.target.checked,"title")}})),Object(s.jsx)(r.SettingRow,{label:Object(s.jsx)(s.FormattedMessage,{id:"content",defaultMessage:l})},Object(s.jsx)(a.Checkbox,{className:"can-x-switch",checked:this.props.config&&this.props.config.fields,"data-key":"content",onChange:function(t){e.onOptionsChanged(t.target.checked,"fields")}})),Object(s.jsx)(r.SettingRow,{label:Object(s.jsx)(s.FormattedMessage,{id:"media",defaultMessage:g})},Object(s.jsx)(a.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsMedia,checked:this.props.config&&this.props.config.media,"data-key":"media",onChange:function(t){e.onOptionsChanged(t.target.checked,"media")}})),Object(s.jsx)(r.SettingRow,{label:Object(s.jsx)(s.FormattedMessage,{id:"attachments",defaultMessage:f})},Object(s.jsx)(a.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsAttachment,checked:this.props.config&&this.props.config.attachments,"data-key":"attachments",onChange:function(t){e.onOptionsChanged(t.target.checked,"attachments")}})),Object(s.jsx)(r.SettingRow,{label:Object(s.jsx)(s.FormattedMessage,{id:"lastEditInfo",defaultMessage:h})},Object(s.jsx)(a.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsChangeTracking,checked:this.props.config&&this.props.config.lastEditInfo||!0,"data-key":"lastEditInfo",onChange:function(t){e.onOptionsChanged(t.target.checked,"lastEditInfo")}})))),Object(s.jsx)(r.SettingSection,{title:this.props.intl.formatMessage({id:"style",defaultMessage:"Style"})},v,M),Object(s.jsx)(r.SettingSection,{title:this.props.intl.formatMessage({id:"general",defaultMessage:"General"})},Object(s.jsx)("label",{className:"second-header"},Object(s.jsx)(s.FormattedMessage,{id:"noDataMessage",defaultMessage:m})),Object(s.jsx)(a.TextInput,{className:"w-100",type:"textarea",name:"text",id:"noDeataMessageDefaultText",value:this.props.config.noDataMessage||this.props.intl.formatMessage({id:"noDeataMessageDefaultText",defaultMessage:j}),onBlur:function(t){e.onPropertyChange("noDataMessage",t.target.value)}})),null))},t.mapExtraStateProps=function(e){return{dsJsons:e.appStateInBuilder.appConfig.dataSources,appTheme:e&&e.appStateInBuilder&&e.appStateInBuilder.theme}},t}(s.React.PureComponent);t.default=v},4:function(e,t){e.exports=s},40:function(e,t,n){"use strict";var o,s;n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),function(e){e.syncWithTheme="syncWithTheme",e.usePopupDefined="usePopupDefined",e.custom="custom"}(o||(o={})),function(e){e.auto="auto",e.custom="custom"}(s||(s={}))}}))}}}));