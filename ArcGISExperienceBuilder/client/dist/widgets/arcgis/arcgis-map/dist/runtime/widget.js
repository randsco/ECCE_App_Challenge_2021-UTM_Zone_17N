System.register(["jimu-core","jimu-ui","jimu-arcgis","jimu-layouts/layout-runtime"],(function(e){var t,n,o,i;return{setters:[function(e){t=e},function(e){n=e},function(e){o=e},function(e){i=e}],execute:function(){e(function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=367)}({0:function(e,n){e.exports=t},1:function(e,t){e.exports=n},108:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 39 32"><path d="M38.784 9.778v2.962H3.236V9.778h.074L13.086.002l2.111 2.111-7.702 7.665h31.29zM3.236 21.628h31.327l-7.702 7.702 2.111 2.111 9.776-9.813h.037v-2.962H3.237v2.962z"></path></svg>'},109:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 10"><path d="M0 10h15V4H0v6zm1-5h13v4h-1V6h-1v3h-1V7h-1v2H9V6H8v3H7V7H6v2H5V6H4v3H3V7H2v2H1V5zm11-5v1H3V0H0v3h3V2h9v1h3V0h-3zM2 2H1V1h1v1zm12 0h-1V1h1v1z" fill="#000" fill-rule="nonzero"></path></svg>'},110:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 16"><g fill="#000" fill-rule="nonzero"><path d="M4 8h1v3H4V8zM2 9h1v2H2V9zm6-1h1v3H8V8zm4 0h1v3h-1V8z"></path><path d="M15 12V6h-2V5h1V2h-3v1L4 1.05V0H1v3h1v3H0v6h2v1H1v3h3v-1h7v1h3v-3h-1v-1h2zm-3-9h1v1h-1V3zm-8-.92L11 4v1h1v1H3V3h1v-.92zM2 1h1v1H2V1zm1 14H2v-1h1v1zm8-1H4v-1H3v-1h9v1h-1v1zm2 1h-1v-1h1v1zM1 11V7h13v4H1z"></path><path d="M6 9h1v2H6V9zm4 0h1v2h-1V9z"></path></g></svg>'},111:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 16"><g fill="#363636" fill-rule="nonzero"><path d="M.75 3l8.642 4.969-3.422.738 2.723 5.45-2.886 1.667-2.724-5.45-2.351 2.595L.75 3zm.996 1.726l-.01 5.644 1.527-1.684 2.909 5.771 1.155-.667-2.91-5.77 2.222-.48-4.893-2.814z"></path><path d="M8.721 0c1.82 0 2.865 1.556 2.865 4.35 0 .462.12.66.385.774.219.093.473.126.99.131h.551l.397.009c1.251.05 1.807.336 2.04 1.333.41 1.76-1.62 3.114-5.904 4.313l-.326.09-.245-.999.64-.18c3.516-1.02 5.088-2.089 4.88-2.979-.094-.407-.382-.535-1.304-.553l-.787-.002c-.62-.008-.943-.055-1.3-.207-.648-.276-.998-.859-.998-1.73 0-2.286-.694-3.318-1.884-3.318-.731 0-1.68.55-2.815 1.685l-.215.22L5 2.203C6.398.748 7.626 0 8.721 0z"></path></g></svg>'},112:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g fill="#363636" fill-rule="nonzero"><path d="M.25 3l8.642 4.969-3.422.738 2.723 5.45-2.886 1.667-2.724-5.45-2.351 2.595L.25 3zm.996 1.726l-.01 5.644 1.527-1.684 2.909 5.771 1.155-.667-2.91-5.77 2.222-.48-4.893-2.814z"></path><path d="M10.318 0C13.456 0 16 2.462 16 5.5S13.456 11 10.318 11a5.796 5.796 0 01-3.023-.842l-.22-.142.54-.752c.788.53 1.722.82 2.703.82 2.615 0 4.735-2.053 4.735-4.584 0-2.531-2.12-4.583-4.735-4.583-1.916 0-3.617 1.112-4.354 2.779l-.078.187L5 3.56C5.827 1.435 7.933 0 10.318 0z"></path></g></svg>'},113:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g fill="#363636" fill-rule="nonzero"><path d="M.25 3l8.642 4.969-3.422.738 2.723 5.45-2.886 1.667-2.724-5.45-2.351 2.595L.25 3zm.996 1.726l-.01 5.644 1.527-1.684 2.909 5.771 1.155-.667-2.91-5.77 2.222-.48-4.893-2.814zM9.72 1.11l.588-.808 5.082 3.7-4.577 2.656L14.61 9.49l-.598.801L9 6.555l4.56-2.649z"></path></g></svg>'},114:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M.25 3l8.642 4.969-3.422.738 2.723 5.45-2.886 1.667-2.724-5.45-2.351 2.595L.25 3zm.996 1.726l-.01 5.644 1.527-1.684 2.909 5.771 1.155-.667-2.91-5.77 2.222-.48-4.893-2.814zM12 6a2 2 0 100-4 2 2 0 000 4z" fill="#363636" fill-rule="nonzero"></path></svg>'},115:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 0v16H0V0h16zM7.077 1H1v14h10.561L7.078 7.616 7.077 1zM15 6.391L9.56 9.779 12.73 15H15V6.391zM15 1H8.077v6.335l.965 1.589L15 5.213V1z" fill="#363636" fill-rule="nonzero"></path></svg>'},122:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M20.889 1.333h6.222a3.556 3.556 0 013.556 3.556v6.222a3.556 3.556 0 01-3.556 3.556h-6.222a3.556 3.556 0 01-3.556-3.556V4.889a3.556 3.556 0 013.556-3.556zM20 4v8h8V4h-8zM4.889 17.333h6.222a3.556 3.556 0 013.556 3.556v6.222a3.556 3.556 0 01-3.556 3.556H4.889a3.556 3.556 0 01-3.556-3.556v-6.222a3.556 3.556 0 013.556-3.556zM4 20v8h8v-8H4zm20 8a4 4 0 100-8 4 4 0 000 8zm0 2.667a6.667 6.667 0 110-13.334 6.667 6.667 0 010 13.334zM4.981 12h6.037L7.999 5.963 4.98 12zm4.212-9.615l5.176 10.352a1.334 1.334 0 01-1.192 1.93H2.825a1.333 1.333 0 01-1.192-1.929L6.809 2.386a1.332 1.332 0 012.385 0z"></path></svg>'},123:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},124:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7 1a6 6 0 100 12A6 6 0 007 1zm0 13a7 7 0 115.621-2.828l-.222.284 3.405 3.404a.668.668 0 01-.944.944L11.456 12.4A6.974 6.974 0 017 14z" fill="#000" fill-rule="nonzero"></path></svg>'},125:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M14.376 10.573l1.647.927-8 4.5-8-4.5 1.648-.927 1.02.574-.628.353 5.96 3.353 5.96-3.353-.627-.353 1.02-.574zm-.999-2.414l.606.341-5.96 3.353L2.063 8.5l.607-.341-1.02-.574L.023 8.5l8 4.5 8-4.5-1.626-.915-1.02.574zM8.023 1.023l-8 4.5 8 4.5 8-4.5-8-4.5zm-5.96 4.5l5.96-3.352 5.96 3.352-5.96 3.353-5.96-3.353z" fill="#000" fill-rule="nonzero"></path></svg>'},126:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M.1 6.9h6.8V.1H.1v6.8zm6-.8H3.985c.077-.403.25-.78.506-1.102a4.574 4.574 0 001.609.805V6.1zm0-1.128a3.758 3.758 0 01-1.006-.523c.31-.203.65-.358 1.006-.459v.982zM6.1.9v2.266a4.229 4.229 0 00-1.613.73 6.038 6.038 0 01-1.1-1.767l.002-.004-.004-.001A8.16 8.16 0 012.99.9H6.1zM.9.9h1.266a8.7 8.7 0 00.359 1.249A1.93 1.93 0 01.9 3.188V.9zm0 3.09a2.828 2.828 0 002.006-.966c.262.519.594 1 .987 1.428A3.367 3.367 0 003.17 6.1H.9V3.99zM9.1.1v6.8h6.8V.1H9.1zm.8.8h4.063a.373.373 0 01-.045.2.594.594 0 01-.438.176 1.637 1.637 0 00-1.175.49.91.91 0 00-.203.708c-.001.007-.114.736-.607.742a.74.74 0 00-.719.384.828.828 0 00-.026.6H9.9V.9zm5.2 5.2H9.9V5h2.296l-.474-.639a1.562 1.562 0 01-.192-.346c1.041-.03 1.37-1.188 1.365-1.587a.19.19 0 01.028-.154c.031-.037.166-.162.624-.2.419 0 .81-.205 1.049-.549a1.13 1.13 0 00.16-.625h.344v5.2zm-15 9.8h6.8V9.1H.1v6.8zm.8-6h5.2v.46l-2 1.973v.867l-3.2-.089V9.9zm0 4.01l4 .112v-1.355l1.2-1.182V15.1H.9v-1.19zm8.2 1.99h6.8V9.1H9.1v6.8zm6-.8h-1.792l-1.27-1.572 1.468-1.468 1.594 1.605V15.1zm0-5.2v2.628L12.49 9.9h2.61zm-5.2 0h1.46l1.581 1.592-1.978 1.98 1.316 1.628H9.9V9.9z" fill="#000" fill-rule="nonzero"></path></svg>'},127:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 11v5H4v-4.001L0 12v-1h5zm11 0v1l-4-.001V16h-1v-5h5zM5 0v5H0V4l4 .001V0h1zm7 0v4.001L16 4v1h-5V0h1z" fill="#000" fill-rule="nonzero"></path></svg>'},128:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 11v4.001L5 15v1H0v-5h1zm15 0v5h-5v-1l4 .001V11h1zM5 0v1L1 .999V5H0V0h5zm11 0v5h-1V.999L11 1V0h5z" fill="#000" fill-rule="nonzero"></path></svg>'},129:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 9v6h16V9H0zm15 3h-1v2h-1v-3h-1v3h-1v-2h-1v2H9v-3H8v3H7v-2H6v2H5v-3H4v3H3v-2H2v2H1v-4h14v2zm.18-7.5l-2.85 2.85-.71-.7L13.23 5H9V4h4.32l-1.7-1.69.71-.7 2.85 2.89zM2.68 4H7v1H2.77l1.61 1.65-.71.7L.82 4.5l2.85-2.85.71.7L2.68 4z" fill="#000" fill-rule="nonzero"></path></svg>'},130:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M13 7.5a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm-6.5 0a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM0 7.5a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" fill="#000"></path><path d="M0 0h16v16H0z"></path></g></svg>'},131:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.682 6.318a4.5 4.5 0 01.335 5.99l2.847 2.849-.707.707-2.848-2.848a4.5 4.5 0 11.373-6.698zm-5.657.707a3.5 3.5 0 104.95 4.95 3.5 3.5 0 00-4.95-4.95zM16 0v11H9.5v-1h3.099L10 5.153V1H6v2.5H5V0h11zm-1 5.954L12.637 7.83 13.801 10H15V5.954zM15 1h-3.981v3.813l1.055 1.967L15 4.457V1z" fill="#363636" fill-rule="nonzero"></path></svg>'},27:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"l",(function(){return s})),n.d(t,"k",(function(){return p})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return w})),n.d(t,"h",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"e",(function(){return v})),n.d(t,"j",(function(){return M}));var o=n(0),i=n(4);function a(e,t){var n=[];return t&&Object.keys(t).forEach((function(o){e.map.layers.find((function(e){return e.id===o}))?console.warn("the feature layer is already created"):n.push(r(e,t[o],o))})),0===n.length?null:Promise.all(n)}function s(e,t){var n=[];return t&&Object.keys(t).forEach((function(o){var i=e.map.layers.find((function(e){return e.id===o}));i&&(e.map.remove(i),n.push(r(e,t[o],o)))})),0===n.length?null:Promise.all(n)}function r(e,t,n){return new Promise((function(o,a){return Object(i.loadArcGISJSAPIModules)(["esri/layers/FeatureLayer"]).then((function(i){if(t.features.length<1)return o();var a=void 0;a=i[0];for(var s=t.features[0].layer,r=[],p={},l=0;l<s.fields.length;l++){var c=(m=s.fields[l],void 0,{name:m.name.replace(/\./g,"_").replace(/\(/g,"_").replace(/\)/g,"_"),alias:m.alias,type:m.type});p[s.fields[l].name]=c.name,r.push(c)}var u=[];for(var d in t.features[0].attributes)if(p[d]){c={fieldName:p[d],label:d};u.push(c)}var h=[];t.features.forEach((function(e,t){var n=e;if(n.attributes){for(var o in n.attributes)n.attributes[p[o]]=n.attributes[o];n.attributes.exbfid=t}else n.attributes={exbfid:t};h.push(n)}));var m,f=new a({id:n,title:s.title,source:h,fields:r,outFields:["*"],objectIdField:"exbfid",renderer:s.renderer,popupEnabled:!0,popupTemplate:{title:"information",content:[{type:"fields",fieldInfos:u}]}});e.map.add(f),f.on("layerview-create",(function(e){return o()}))}))}))}function p(e,t,n){var o=n,i=null,a=null;if(o||(a=t instanceof Array?t[0]:t)&&(o=a.layer&&a.layer.id),o){for(var s=e.allLayerViews,r=0;r<s.length;r++)s.getItemAt(r).layer.id===o&&(i=s.getItemAt(r));return i?{layerId:o,handle:i.highlight(t)}:null}}function l(e,t){var n=t,o=e;if(n instanceof Array){if(0===n.length)return Promise.resolve();if(n[0].geometry){for(var i=[],a=0;a<n.length;a++)i.push(n[a].geometry);return c(i).then((function(e){return o.goTo(e.center)}))}return c(n).then((function(e){return o.goTo(e.center)}))}if(n.geometry){var s=n.geometry;return o.goTo(f(s))}return o.goTo(f(n))}function c(e){return Object(i.loadArcGISJSAPIModules)(["esri/geometry/Extent"]).then((function(t){var n;if(n=t[0],!e||!e.length)return Promise.resolve(null);var o,i=null,a=e.length;for(o=0;o<a;o++){var s=e[o];if(s){var r=s.extent;if(!r&&"point"===s.type){var p=s;p.x&&p.y&&(r=new n({xmax:p.x,xmin:p.x,ymax:p.y,ymin:p.y,zmax:p.z,zmin:p.z,spatialReference:p.spatialReference}))}r&&(i=i?i.union(r):r)}}return i.width<0&&i.height<0?Promise.resolve(null):Promise.resolve(i)}))}function u(e,t,n){if(t)for(var o=e.jimuLayerViews,a=Object.keys(o),s=0;s<a.length;s++){var r=o[a[s]];r&&r.layer&&r.layerDataSourceId===t&&r.type===i.LayerTypes.FeatureLayer&&r.setLocalDefinitionExpression(n)}}function d(e,t,n){if(t)for(var a=e.jimuLayerViews,s=Object.keys(a),r=function(r){var p=a[s[r]];if(p&&p.layer&&p.layerDataSourceId===t&&p.type===i.LayerTypes.FeatureLayer)if(p.view){var l=p.view;if(!l)return{value:null};Object(i.loadArcGISJSAPIModules)(["esri/tasks/support/Query","esri/Graphic"]).then((function(t){var o,i;o=t[0],i=t[1];var a=new o;a.where=n,a.outFields=["*"],a.returnGeometry=!0,l.layer.queryFeatures(a).then((function(t){if(t&&t.features&&t.features.length>0){var n=m(l.layer.geometryType);h(e.view,t.features,n,i)}}))}))}else Object(i.loadArcGISJSAPIModules)(["esri/tasks/support/Query","esri/layers/FeatureLayer","esri/Graphic"]).then((function(t){var i,a,s;i=t[0],a=t[1],s=t[2];var r=new i;r.where=n,r.outFields=["*"],r.returnGeometry=!0;var l=new a({url:o.dataSourceUtils.getUrlByLayer(p.layer)});l.load().then((function(){l.queryFeatures(r).then((function(t){if(t&&t.features&&t.features.length>0){var n=m(t.features[0].geometry.type);h(e.view,t.features,n,s)}}))}))}))},p=0;p<s.length;p++){var l=r(p);if("object"==typeof l)return l.value}}function h(e,t,n,o){!function(t,i){for(var a=[],s=0,r=0;r<t.length;r++){var p=new o({geometry:t[r].geometry,symbol:n,attributes:t[r].attributes});a.push(p)}var l=function(){e.graphics.addMany(a),setTimeout((function(){e.graphics.removeMany(a),(s+=1)<i&&setTimeout((function(){l()}),500)}),500)};l()}(t,3)}function m(e){return["point","multipoint"].indexOf(e)>-1?{type:"simple-marker",style:"circle",color:[255,255,0,.8],size:"16px",outline:{color:[255,255,0,.8],width:3}}:["polyline"].indexOf(e)>-1?{type:"simple-line",color:[255,255,0,.8],width:3,style:"solid"}:["polygon","extent"].indexOf(e)>-1?{type:"simple-fill",color:[255,255,0,.5],style:"solid",outline:{color:[255,255,0,.8],width:3}}:["mesh"].indexOf(e)>-1?{type:"mesh-3d",symbolLayers:[{type:"fill",material:{color:[255,255,0,.8]}}]}:null}function f(e){switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"polyline":return e.extent.center;default:return e&&e.extent?e.extent.center:void 0}}function g(e,t){var n=null;return e.clone?n=e.clone():(n=t.fromJSON(Object.assign({},e))).attributes=Object.assign({},e.attributes),n}function w(e,t){return e&&0!==e.length&&e[0]&&t.wkid!==e[0].spatialReference.wkid&&!t.equals(e[0].spatialReference)?t.isWebMercator&&e[0].spatialReference.isWGS84||t.isWGS84&&e[0].spatialReference.isWebMercator?Promise.resolve(e):i.geometryUtils.projectToSpatialReference(e,t):Promise.resolve(e)}function b(e,t,n){return e&&"3d"===e.type&&t&&t.queryFeatures&&n?Object(i.loadArcGISJSAPIModules)(["esri/tasks/support/Query"]).then((function(e){var o=new(0,e[0]);return o.returnGeometry=!0,o.outFields=["*"],o.objectIds=n.map((function(e){return e.attributes[t.objectIdField]})),t.queryFeatures(o).then((function(e){return e&&e.features&&e.features.length===n.length?Promise.resolve(e.features):Promise.resolve(n)}),(function(){return Promise.resolve(n)}))})):Promise.resolve(n)}function y(e){return!window.jimuConfig.isInBuilder||e!==o.AppMode.Design}function v(e){return{mapContainer:e.mapContainer,state:e.state,MapView:e.MapView,SceneView:e.SceneView,Extent:e.Extent,Viewpoint:e.Viewpoint,mapView:e.mapView,sceneView:e.sceneView,extentWatch:e.extentWatch,fatalErrorWatch:e.fatalErrorWatch,dsManager:e.dsManager,highLightHandles:e.highLightHandles,mapBaseViewEventHandles:e.mapBaseViewEventHandles,Color:e.Color,isRequestingMap:e.isRequestingMap}}function M(e,t){e.mapContainer=t.mapContainer,e.state=t.state,e.MapView=t.MapView,e.SceneView=t.SceneView,e.Extent=t.Extent,e.Viewpoint=t.Viewpoint,e.mapView=t.mapView,e.sceneView=t.sceneView,e.extentWatch=t.extentWatch,e.fatalErrorWatch=t.fatalErrorWatch,e.dsManager=t.dsManager,e.highLightHandles=t.highLightHandles,e.mapBaseViewEventHandles=t.mapBaseViewEventHandles,e.Color=t.Color,e.isRequestingMap=t.isRequestingMap}},367:function(e,t,n){"use strict";n.r(t);var o,i,a=n(0),s=n(4),r=n(1),p=n(27),l=a.React.createContext({mapWidgetId:null,mapWidgetHeight:null,isShowMapSwitchBtn:!1,isFullScreen:!1,dataSourceIds:[],activeDataSourceId:null,switchMap:function(){},fullScreenMap:function(){},initialMapState:null,mobilePanelContainer:null,onMobilePanelContentChange:function(e){}}),c=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,a){function s(e){try{p(o.next(e))}catch(e){a(e)}}function r(e){try{p(o.throw(e))}catch(e){a(e)}}function p(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}p((o=o.apply(e,t||[])).next())}))},d=function(e,t){var n,o,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}},h=n(108);!function(e){e.Loading="LOADING",e.Loadok="LOADOK",e.LoadError="LOADERROR"}(i||(i={}));var m,f,g,w,b,y,v,M,S,x,I=function(e){function t(t){var n=e.call(this,t)||this;n.highLightHandles={},n.mapBaseViewEventHandles={},n.dsManager=a.DataSourceManager.getInstance(),n.onExtented=null,n.isFirstReceiveMessage=!0,n.isRequestingMap=!1,n.__unmount=!1,n.startRenderMap=function(){Object(s.loadArcGISJSAPIModules)(["esri/geometry/Extent","esri/Viewpoint"]).then((function(e){n.Extent=e[0],n.Viewpoint=e[1],n.__unmount||n.setState({isModulesLoaded:!0})}))},n.analysisMapView=function(){return n.mapView?Promise.resolve():n.MapView?n.initMapView():Object(s.loadArcGISJSAPIModules)(["esri/geometry/Geometry","esri/webmap/InitialViewProperties","esri/Basemap","esri/layers/TileLayer","esri/views/MapView","esri/WebMap","esri/portal/Portal","esri/portal/PortalItem","esri/Color"]).then((function(e){return n.Geometry=e[0],n.InitialViewProperties=e[1],n.Basemap=e[2],n.TileLayer=e[3],n.MapView=e[4],n.WebMap=e[5],n.Portal=e[6],n.PortalItem=e[7],n.Color=e[8],n.initMapView()}))},n.analysisSceneView=function(){return n.sceneView?Promise.resolve():n.SceneView?n.initSceneView():Object(s.loadArcGISJSAPIModules)(["esri/views/SceneView","esri/WebScene","esri/portal/Portal","esri/portal/PortalItem","esri/Color"]).then((function(e){return n.SceneView=e[0],n.WebScene=e[1],n.Portal=e[2],n.PortalItem=e[3],n.Color=e[4],n.initSceneView()}))},n.generateViewPointFromInitialMapState=function(e){return"2d"===e.viewType?new n.Viewpoint({targetGeometry:n.Extent.fromJSON(e.extent),rotation:e.rotation}):n.Viewpoint.fromJSON(e.viewPoint)},n.cloneMap=function(){var e=null,t=n.getDsJsonFromDsId(n.props.dataSourceId),o=null;if(t.type===s.DataSourceTypes.WebMap&&(o=n.WebMap),t.type===s.DataSourceTypes.WebScene&&(o=n.WebScene),t.portalUrl){var i=new n.Portal({url:a.portalUrlUtils.getHostUrlByOrgUrl(t.portalUrl)});e=new o({portalItem:new n.PortalItem({id:t.itemId,portal:i})})}else e=new o({portalItem:new n.PortalItem({id:t.itemId})});return a.dataSourceUtils.getWhetherUseProxy()?e.load().then((function(){return e.when((function(){return(e.tables?e.tables.toArray():[]).forEach((function(e){var t=a.dataSourceUtils.getUrlByLayer(e);if(t){var n=a.dataSourceUtils.getDataSourceProxyUrl(t);n&&(e.url=n)}})),e.allLayers.toArray().forEach((function(e){var t=a.dataSourceUtils.getUrlByLayer(e);if(t){var n=a.dataSourceUtils.getDataSourceProxyUrl(t);n&&(e.url=n)}})),Promise.resolve(e)}))})):Promise.resolve(e)},n.getInitViewPointForDefaultWebMap=function(){var e=n.props.defaultMapInfo&&n.props.defaultMapInfo.defaultExtent;return n.props.baseWidgetProps.config.initialMapState&&n.props.baseWidgetProps.config.initialMapState.viewPoint?n.generateViewPointFromInitialMapState(n.props.baseWidgetProps.config.initialMapState):new n.Viewpoint({targetGeometry:new n.Extent({xmin:e&&e.xmin,ymin:e&&e.ymin,xmax:e&&e.xmax,ymax:e&&e.ymax,spatialReference:{wkid:e.spatialReference.wkid}})})},n.getDefaultWebMap=function(){var e,t=n.props.defaultMapInfo&&n.props.defaultMapInfo.defaultExtent;return e=new n.Viewpoint({targetGeometry:new n.Extent({xmin:t&&t.xmin,ymin:t&&t.ymin,xmax:t&&t.xmax,ymax:t&&t.ymax,spatialReference:{wkid:t.spatialReference.wkid}})}),new n.WebMap({portalItem:{id:n.props.defaultMapInfo.defaultMapId,portal:{url:n.props.baseWidgetProps.portalUrl}},initialViewProperties:new n.InitialViewProperties({spatialReference:t&&t.spatialReference,viewpoint:e})})},n.initMapView=function(){return u(n,void 0,Promise,(function(){var e,t,n,o,s,r=this;return d(this,(function(p){switch(p.label){case 0:return this.extentWatch=null,this.fatalErrorWatch=null,this.mapView&&!this.isRequestingMap?[2,Promise.resolve()]:this.isRequestingMap?[2]:(this.isRequestingMap=!0,this.props.isDefaultMap?(t=this.getDefaultWebMap(),e={map:t,container:this.mapContainer,viewpoint:this.getInitViewPointForDefaultWebMap(),rotation:this.props.baseWidgetProps.config.initialMapState&&this.props.baseWidgetProps.config.initialMapState.rotation},[3,3]):[3,1]);case 1:return[4,this.cloneMap()];case 2:n=p.sent(),e=this.props.baseWidgetProps.config.initialMapState?{map:n,container:this.mapContainer,viewpoint:this.props.baseWidgetProps.config.initialMapState&&this.generateViewPointFromInitialMapState(this.props.baseWidgetProps.config.initialMapState)}:{map:n,container:this.mapContainer},p.label=3;case 3:if(!window.jimuConfig.isInBuilder&&this.props.baseWidgetProps.queryObject[this.props.baseWidgetProps.id]){o=this.props.baseWidgetProps.queryObject[this.props.baseWidgetProps.id].substr("extent=".length),s=void 0;try{s=new this.Extent(JSON.parse(o))}catch(e){console.error("Bad extent URL parameter.")}s&&(e.extent=s)}return this.mapView||(this.mapView=new this.MapView(e),this.mapView.popup.spinnerEnabled=!1,this.mapView.ui.exbMapTools={},(this.props.isDefaultMap||this.mapDs&&this.mapDs.id===this.props.dataSourceId)&&this.createJimuMapView(),this.mapView.when((function(){r.setState({mapLoadStatus:i.Loadok},(function(){r.props.onMapLoaded(r.props.dataSourceId,i.Loadok)})),r.extentWatch||(r.extentWatch=r.mapView.watch("extent",(function(e){e&&(clearTimeout(r.onExtented),r.onExtented=setTimeout((function(){if(e)if(r.mapView.isReceiveExtentChange)r.mapView.isReceiveExtentChange=!1;else{var t=new a.ExtentChangeMessage(r.props.baseWidgetProps.id,e);t.addRelatedWidgetId(r.props.baseWidgetProps.id),r.props.onExtentChanged(r.props.dataSourceId,t)}}),200))}))),r.fatalErrorWatch||(r.fatalErrorWatch=r.mapView.watch("fatalError",(function(e){e&&(r.mapView.isInCaching?r.setState({isMapCrashed:!0}):(console.error("Fatal Error! View has lost its WebGL context. Attempting to recover..."),r.mapView.tryFatalErrorRecovery()))}))),setTimeout((function(){r.goHome(!1).then((function(){var e=new a.ExtentChangeMessage(r.props.baseWidgetProps.id,r.mapView.extent);e.addRelatedWidgetId(r.props.baseWidgetProps.id),r.props.onExtentChanged(r.props.dataSourceId,e),r.props.onViewChanged&&r.props.onViewChanged({dataSourceId:r.props.dataSourceId,viewpoint:r.mapView.viewpoint.clone()})}))}),500)})),this.isRequestingMap=!1,this.bindMapBaseViewEvent(this.mapView)),[2,Promise.resolve()]}}))}))},n.initSceneView=function(){return u(n,void 0,Promise,(function(){var e,t,n=this;return d(this,(function(o){switch(o.label){case 0:return this.extentWatch=null,this.fatalErrorWatch=null,this.sceneView&&!this.isRequestingMap?[2,Promise.resolve()]:this.isRequestingMap?[2]:(this.isRequestingMap=!0,[4,this.cloneMap()]);case 1:return e=o.sent(),t=this.props.baseWidgetProps.config.initialMapState?{map:e,container:this.mapContainer,qualityProfile:"low",viewpoint:this.props.baseWidgetProps.config.initialMapState&&this.generateViewPointFromInitialMapState(this.props.baseWidgetProps.config.initialMapState)}:{map:e,container:this.mapContainer,qualityProfile:"low"},this.sceneView?[2,Promise.resolve()]:(this.sceneView=new this.SceneView(t),this.sceneView.popup.spinnerEnabled=!1,this.sceneView.ui.exbMapTools={},this.mapDs&&this.mapDs.id===this.props.dataSourceId&&this.createJimuMapView(),this.sceneView.when((function(){n.setState({mapLoadStatus:i.Loadok},(function(){n.props.onMapLoaded(n.props.dataSourceId,i.Loadok)})),n.extentWatch||(n.extentWatch=n.sceneView.watch("extent",(function(e){e&&(clearTimeout(n.onExtented),n.onExtented=setTimeout((function(){if(e)if(n.sceneView.isReceiveExtentChange)n.sceneView.isReceiveExtentChange=!1;else{var t=new a.ExtentChangeMessage(n.props.baseWidgetProps.id,e);t.addRelatedWidgetId(n.props.baseWidgetProps.id),n.props.onExtentChanged(n.props.dataSourceId,t)}}),200))}))),n.fatalErrorWatch||(n.fatalErrorWatch=n.sceneView.watch("fatalError",(function(e){e&&(n.sceneView.isInCaching?n.setState({isMapCrashed:!0}):(n.sceneView.tryFatalErrorRecovery(),console.error("Fatal Error! View has lost its WebGL context. Attempting to recover...")))}))),setTimeout((function(){n.goHome(!1).then((function(){var e=new a.ExtentChangeMessage(n.props.baseWidgetProps.id,n.sceneView.extent);e.addRelatedWidgetId(n.props.baseWidgetProps.id),n.props.onExtentChanged(n.props.dataSourceId,e),n.props.onViewChanged&&n.props.onViewChanged({dataSourceId:n.props.dataSourceId,viewpoint:n.sceneView.viewpoint.clone()})}))}),500)})),this.isRequestingMap=!1,this.bindMapBaseViewEvent(this.sceneView),[2,Promise.resolve()])}}))}))},n.updateMapView=function(e){var t=n.props.baseWidgetProps.id+"-"+n.props.dataSourceId,o=null;t&&(o=s.MapViewManager.getInstance().getJimuMapViewById(t)),o&&o.getIsEditing()||(e.disablePopUp?(n.mapView.popup.close(),n.mapView.popup.autoOpenEnabled=!1):n.mapView.popup.autoOpenEnabled=!0,o&&(o.isEnablePopup=!e.disablePopUp)),e.selectionHighlightColor&&(n.mapView.highlightOptions.color=new n.Color(e.selectionHighlightColor)),n.mapView.ui&&(n.mapView.ui.components=[])},n.updateSceneView=function(e){var t=n.props.baseWidgetProps.id+"-"+n.props.dataSourceId,o=null;t&&(o=s.MapViewManager.getInstance().getJimuMapViewById(t)),o&&o.getIsEditing()||(e.disablePopUp?(n.sceneView.popup.close(),n.sceneView.popup.autoOpenEnabled=!1):n.sceneView.popup.autoOpenEnabled=!0,o&&(o.isEnablePopup=!e.disablePopUp)),e.selectionHighlightColor&&(n.sceneView.highlightOptions.color=new n.Color(e.selectionHighlightColor)),n.sceneView.ui&&(n.sceneView.ui.components=[])},n.bindMapBaseViewEvent=function(e){e&&(n.mapBaseViewEventHandles["mouse-wheel"]&&(n.mapBaseViewEventHandles["mouse-wheel"].remove(),n.mapBaseViewEventHandles["mouse-wheel"]=null),n.mapBaseViewEventHandles["mouse-wheel"]=e.on("mouse-wheel",(function(t){if(n.props.baseWidgetProps.config.disableScroll)return t.stopPropagation(),void n.handleDisableWheel();n.props.onViewChanged&&n.props.onViewChanged({dataSourceId:n.props.dataSourceId,viewpoint:e.viewpoint.clone()})})),n.mapBaseViewEventHandles.drag&&(n.mapBaseViewEventHandles.drag.remove(),n.mapBaseViewEventHandles.drag=null),n.mapBaseViewEventHandles.drag=e.on("drag",(function(){n.props.onViewChanged&&n.props.onViewChanged({dataSourceId:n.props.dataSourceId,viewpoint:e.viewpoint.clone()})})),n.mapBaseViewEventHandles.click&&(n.mapBaseViewEventHandles.click.remove(),n.mapBaseViewEventHandles.click=null),n.mapBaseViewEventHandles.click=e.on("click",(function(){for(var e in n.highLightHandles)n.highLightHandles[e].remove()})))},n.createJimuMapView=function(){s.MapViewManager.getInstance().createJimuMapView({mapWidgetId:n.props.baseWidgetProps.id,datasourceId:n.props.dataSourceId,view:n.mapView||n.sceneView,isEnablePopup:n.props.baseWidgetProps.config&&!n.props.baseWidgetProps.config.disablePopUp});var e=n.mapView||n.sceneView;if(e)e.when((function(){var e=n.props.baseWidgetProps.id+"-"+n.props.dataSourceId,t=s.MapViewManager.getInstance().getJimuMapViewById(e);if(t){if(!t.view)return void s.MapViewManager.getInstance().destroyJimuMapView(e);t.whenJimuMapViewLoaded().then((function(){t.view?(n.props.onJimuMapViewCreated(),n.setState({mapBaseJimuMapView:t})):s.MapViewManager.getInstance().destroyJimuMapView(e)}))}}));else{var t=n.props.baseWidgetProps.id+"-"+n.props.dataSourceId;s.MapViewManager.getInstance().destroyJimuMapView(t)}},n.onDataSourceCreated=function(e){n.mapDs=e,n.mapDs.id===n.props.dataSourceId&&(n.mapView||n.sceneView)&&n.createJimuMapView(),n.setState({isMapCrashed:!1})},n.onCreateDataSourceFailed=function(e){console.warn(e),n.mapDs=null,n.setState({mapLoadStatus:i.LoadError,isMapCrashed:!1},(function(){n.props.onMapLoaded(n.props.dataSourceId,i.LoadError),n.createJimuMapView()}))},n.setViewPoint=function(e){e&&n.getDsJsonFromDsId(n.props.dataSourceId)&&(n.getDsJsonFromDsId(n.props.dataSourceId).type===s.DataSourceTypes.WebMap&&n.mapView&&(n.mapView.viewpoint=e),n.getDsJsonFromDsId(n.props.dataSourceId).type===s.DataSourceTypes.WebScene&&n.sceneView&&(n.sceneView.viewpoint=e))},n.getMapLoadStatus=function(){return n.state.mapLoadStatus},n.getViewPoint=function(){return n.getDsJsonFromDsId(n.props.dataSourceId)?n.getDsJsonFromDsId(n.props.dataSourceId).type===s.DataSourceTypes.WebMap?n.mapView&&n.mapView.viewpoint?n.mapView.viewpoint.clone():null:n.getDsJsonFromDsId(n.props.dataSourceId).type===s.DataSourceTypes.WebScene?n.sceneView&&n.sceneView.viewpoint?(n.sceneView.goTo(n.sceneView.viewpoint.camera,{animate:!1}),n.sceneView.viewpoint.clone()):null:void 0:null},n.getViewType=function(){return n.getDsJsonFromDsId(n.props.dataSourceId).type},n.goToTilt=function(e){n.sceneView&&n.sceneView.goTo({tilt:e})},n.goHome=function(e){if(!n.getDsJsonFromDsId(n.props.dataSourceId))return Promise.resolve();var t=n.getMapBaseInitViewPoint();return n.getDsJsonFromDsId(n.props.dataSourceId).type===s.DataSourceTypes.WebMap&&n.mapView?n.mapView.goTo(t,{animate:e}):n.getDsJsonFromDsId(n.props.dataSourceId).type===s.DataSourceTypes.WebScene&&n.sceneView?n.sceneView.goTo(t,{animate:e}):Promise.resolve()},n.getMapBaseInitViewPoint=function(){var e,t,o,i,a,s;return n.props.isDefaultMap?n.getInitViewPointForDefaultWebMap():n.props.baseWidgetProps.config.initialMapState?n.generateViewPointFromInitialMapState(n.props.baseWidgetProps.config.initialMapState):n.mapView?null===(o=null===(t=null===(e=n.mapView.map)||void 0===e?void 0:e.initialViewProperties)||void 0===t?void 0:t.viewpoint)||void 0===o?void 0:o.clone():n.sceneView?null===(s=null===(a=null===(i=n.sceneView.map)||void 0===i?void 0:i.initialViewProperties)||void 0===a?void 0:a.viewpoint)||void 0===s?void 0:s.clone():void 0},n.getDsJsonFromDsId=function(e){var t=Object(a.getAppStore)().getState().appConfig.dataSources[e];return t||{}},n.handleAction=function(e,t){if(e.zoomToFeatureActionValue)if(e.zoomToFeatureActionValue.relatedWidgets&&e.zoomToFeatureActionValue.relatedWidgets.indexOf(n.props.baseWidgetProps.id)>-1)n.props.onMutableStatePropsChanged(n.props.dataSourceId,"zoomToFeatureActionValue",null);else{var o=t,i=e.zoomToFeatureActionValue.relatedWidgets?e.zoomToFeatureActionValue.relatedWidgets:[],r=e.zoomToFeatureActionValue.value,l=null;if(r.layerId&&(l=o.map.layers.find((function(e){return e.id===r.layerId}))),"zoom-to-extent"===r.type)s.zoomToUtils.zoomTo(o,r.features[0],r.zoomToOption).then((function(){var e=t;e.isReceiveExtentChange=!0,i.push(n.props.baseWidgetProps.id);var o=new a.ExtentChangeMessage(n.props.baseWidgetProps.id,e.extent);o.setRelatedWidgetIds(i),n.props.onExtentChanged(n.props.dataSourceId,o)}),(function(){o.isReceiveExtentChange=!0}));else{var c=null;c=l?{layer:l,graphics:r.features}:r.features,Object(p.h)(o,c.layer,c&&c.graphics?c.graphics:c).then((function(e){l?c.graphics=e:c=e,s.zoomToUtils.zoomTo(o,c,r.zoomToOption).then((function(){o.isReceiveExtentChange=!0,i.push(n.props.baseWidgetProps.id);var e=new a.ExtentChangeMessage(n.props.baseWidgetProps.id,o.extent);e.setRelatedWidgetIds(i),n.props.onExtentChanged(n.props.dataSourceId,e)}),(function(){o.isReceiveExtentChange=!0}))}))}n.props.onMutableStatePropsChanged(n.props.dataSourceId,"zoomToFeatureActionValue",null)}if(e.panToActionValue){if(e.panToActionValue.relatedWidgets&&e.panToActionValue.relatedWidgets.indexOf(n.props.baseWidgetProps.id)>-1)n.props.onMutableStatePropsChanged(n.props.dataSourceId,"panToActionValue",null);else{var u=t,d=e.panToActionValue.relatedWidgets?e.panToActionValue.relatedWidgets:[],h=e.panToActionValue.value;Object(p.i)(h.features,u.spatialReference).then((function(e){Object(p.g)(t,e).then((function(){t.isReceiveExtentChange=!0,d.push(n.props.baseWidgetProps.id);var e=new a.ExtentChangeMessage(n.props.baseWidgetProps.id,u.extent);e.setRelatedWidgetIds(d),n.props.onExtentChanged(n.props.dataSourceId,e)}),(function(){t.isReceiveExtentChange=!0}))}))}t.isReceiveExtentChange=!0,n.props.onMutableStatePropsChanged(n.props.dataSourceId,"panToActionValue",null)}if(e.newFeatureSetActionValue&&!e.newFeatureSetActionValue.promise){var m=Object(p.b)(t,e.newFeatureSetActionValue.value);m?(n.props.onMutableStatePropsChanged(n.props.dataSourceId,"newFeatureSetActionValue.promise",m),m.then((function(){n.props.onMutableStatePropsChanged(n.props.dataSourceId,"newFeatureSetActionValue",null)}))):n.props.onMutableStatePropsChanged(n.props.dataSourceId,"newFeatureSetActionValue",null)}if(e.changedFeatureSetActionValue&&(Object(p.l)(t,e.changedFeatureSetActionValue),n.props.onMutableStatePropsChanged(n.props.dataSourceId,"changedFeatureSetActionValue",null)),e.selectFeatureActionValue){for(var f in t.popup.close(),n.highLightHandles)n.highLightHandles[f].remove();var g=Object(p.k)(t,e.selectFeatureActionValue);g&&(n.highLightHandles[g.layerId]=g.handle),setTimeout((function(){n.props.onMutableStatePropsChanged(n.props.dataSourceId,"selectFeatureActionValue",null)}),500)}if(e.flashActionValue){var w=n.props.baseWidgetProps.id+"-"+n.props.dataSourceId,b=s.MapViewManager.getInstance().getJimuMapViewById(w);e.flashActionValue.querySQL&&Object(p.d)(b,e.flashActionValue.layerDataSourceId,e.flashActionValue.querySQL),n.props.onMutableStatePropsChanged(n.props.dataSourceId,"flashActionValue",null)}if(e.filterActionValue){w=n.props.baseWidgetProps.id+"-"+n.props.dataSourceId,b=s.MapViewManager.getInstance().getJimuMapViewById(w);Object(p.c)(b,e.filterActionValue.layerDataSourceId,e.filterActionValue.querySQL),n.props.onMutableStatePropsChanged(n.props.dataSourceId,"filterActionValue",null)}},n.formatMessage=function(e){return n.props.baseWidgetProps.intl.formatMessage({id:e,defaultMessage:r.defaultMessages[e]})},n.handleDisableWheel=function(){n.widgetContainer.style.pointerEvents="none",setTimeout((function(){n.widgetContainer.style.pointerEvents="auto"}),50)},n.getMapSwitchForErrorMap=function(){return a.React.createElement(l.Consumer,null,(function(e){var t=e.isShowMapSwitchBtn,o=(e.dataSourceIds,e.activeDataSourceId,e.switchMap);return a.React.createElement("div",{className:"mapswitch-container",style:{display:t?"block":"none",marginBottom:"xsmall"===n.props.widthBreakpoint?10:0}},a.React.createElement("div",{onClick:function(e){e.preventDefault(),o()},className:"jimu-widget esri-widget--button"},a.React.createElement(r.Icon,{icon:h,width:16,height:16,className:"mapswitch-icon"})))}))},n.recoverMap=function(){n.mapView&&(n.mapView.tryFatalErrorRecovery(),n.setState({isMapCrashed:!1})),n.sceneView&&(n.sceneView.tryFatalErrorRecovery(),n.setState({isMapCrashed:!1}))};var o=a.MutableStoreManager.getInstance().getStateValue([n.props.baseWidgetProps.id,"restoreData",n.props.baseWidgetProps.id+"-restoreData-"+n.props.dataSourceId]);return o?(Object(p.j)(n,o),a.MutableStoreManager.getInstance().updateStateValue(n.props.baseWidgetProps.id,"restoreData."+n.props.baseWidgetProps.id+"-restoreData-"+n.props.dataSourceId,null),n.bindMapBaseViewEvent(n.mapView||n.sceneView),n.mapView&&(n.mapView.isInCaching=!1,n.mapView.tryFatalErrorRecovery()),n.sceneView&&(n.sceneView.isInCaching=!1,n.sceneView.tryFatalErrorRecovery())):n.state={mapLoadStatus:i.Loading,widthBreakpoint:null,mapBaseJimuMapView:null,dataSourceId:null,widgetHeight:null,isMapCrashed:!1},n}return c(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,0===this.widgetContainer.getElementsByClassName("widget-map").length&&(this.mapContainer||(this.mapContainer=document&&document.createElement("div"),this.mapContainer.className="jimu-widget widget-map"),this.widgetContainer.appendChild(this.mapContainer)),!this.props.startLoadModules||this.state.isModulesLoaded?(this.props.dataSourceId||this.props.isDefaultMap)&&(this.getDsJsonFromDsId(this.props.dataSourceId)||this.props.isDefaultMap)&&(this.props.isDefaultMap?this.analysisMapView().then((function(){e.updateMapView(e.props.baseWidgetProps.config)})):(this.getDsJsonFromDsId(this.props.dataSourceId).type===s.DataSourceTypes.WebMap&&this.analysisMapView().then((function(){e.updateMapView(e.props.baseWidgetProps.config)})),this.getDsJsonFromDsId(this.props.dataSourceId).type===s.DataSourceTypes.WebScene&&this.analysisSceneView().then((function(){e.updateSceneView(e.props.baseWidgetProps.config)})))):this.startRenderMap()},t.prototype.componentDidUpdate=function(e){var t=this;if(this.state.isModulesLoaded){e.isMapInVisibleArea!==this.props.isMapInVisibleArea&&this.props.baseWidgetProps.useDataSources&&2===this.props.baseWidgetProps.useDataSources.length&&(this.props.isMapInVisibleArea&&(this.mapView&&(this.mapView.isInCaching=!1,this.mapView.tryFatalErrorRecovery()),this.sceneView&&(this.sceneView.isInCaching=!1,this.sceneView.tryFatalErrorRecovery())),this.props.isMapInVisibleArea||(this.mapView&&(this.mapView.isInCaching=!0),this.sceneView&&(this.sceneView.isInCaching=!0)));var n=this.props.dataSourceId,o=e.dataSourceId,a=this.getDsJsonFromDsId(n).itemId,r=this.getDsJsonFromDsId(o).itemId;if(n!==o||a!==r){this.mapView=null,this.sceneView=null,this.isRequestingMap=!1,this.mapDs=null;var p=this.getDsJsonFromDsId(o)&&this.props.baseWidgetProps.id+"-"+o;if(p&&s.MapViewManager.getInstance().destroyJimuMapView(p),this.state.mapLoadStatus===i.LoadError&&!this.getDsJsonFromDsId(n))return;this.setState({mapLoadStatus:i.Loading})}this.props.isDefaultMap&&(this.sceneView=null,this.isRequestingMap=!1,this.analysisMapView().then((function(){if(t.updateMapView(t.props.baseWidgetProps.config),t.mapView&&t.props.baseWidgetProps.mutableStateProps&&t.props.baseWidgetProps.mutableStateProps){var e=t.props.baseWidgetProps.id+"-"+t.props.dataSourceId,n=s.MapViewManager.getInstance().getJimuMapViewById(e);n&&n.whenJimuMapViewLoaded().then((function(){setTimeout((function(){t.handleAction(t.props.baseWidgetProps.mutableStateProps,t.mapView),t.isFirstReceiveMessage=!1}),t.isFirstReceiveMessage?500:0)}))}}))),this.getDsJsonFromDsId(n)&&(this.getDsJsonFromDsId(n).type===s.DataSourceTypes.WebMap&&(this.sceneView=null,this.isRequestingMap=!1,this.analysisMapView().then((function(){if(t.updateMapView(t.props.baseWidgetProps.config),t.mapView&&t.props.baseWidgetProps.mutableStateProps&&t.props.baseWidgetProps.mutableStateProps){var e=t.props.baseWidgetProps.id+"-"+t.props.dataSourceId,n=s.MapViewManager.getInstance().getJimuMapViewById(e);n&&n.whenJimuMapViewLoaded().then((function(){setTimeout((function(){t.handleAction(t.props.baseWidgetProps.mutableStateProps,t.mapView),t.isFirstReceiveMessage=!1}),t.isFirstReceiveMessage?500:0)}))}}))),this.getDsJsonFromDsId(n).type===s.DataSourceTypes.WebScene&&(this.mapView=null,this.isRequestingMap=!1,this.analysisSceneView().then((function(){if(t.updateSceneView(t.props.baseWidgetProps.config),t.sceneView&&t.props.baseWidgetProps.mutableStateProps&&t.props.baseWidgetProps.mutableStateProps){var e=t.props.baseWidgetProps.id+"-"+t.props.dataSourceId,n=s.MapViewManager.getInstance().getJimuMapViewById(e);n&&n.whenJimuMapViewLoaded().then((function(){setTimeout((function(){t.handleAction(t.props.baseWidgetProps.mutableStateProps,t.sceneView),t.isFirstReceiveMessage=!1}),t.isFirstReceiveMessage?500:0)}))}}))))}},t.getDerivedStateFromProps=function(e,t){return e.dataSourceId!==t.dataSourceId?{dataSourceId:e.dataSourceId,mapLoadStatus:i.Loading}:null},t.prototype.componentWillUnmount=function(){this.__unmount=!0;var e=Object(a.getAppStore)().getState().appConfig.widgets;if(e[this.props.baseWidgetProps.id]&&e[this.props.baseWidgetProps.id].useDataSources===this.props.baseWidgetProps.useDataSources&&this.state.mapLoadStatus!==i.Loading){var t=Object(p.e)(this);this.mapView&&(this.mapView.isInCaching=!0),this.sceneView&&(this.sceneView.isInCaching=!0),a.MutableStoreManager.getInstance().updateStateValue(this.props.baseWidgetProps.id,"restoreData."+this.props.baseWidgetProps.id+"-restoreData-"+this.props.dataSourceId,t)}else{this.props.onViewChanged&&this.props.onViewChanged({dataSourceId:this.props.dataSourceId,viewpoint:null});var n=this.props.baseWidgetProps.id+"-"+this.props.dataSourceId;s.MapViewManager.getInstance().destroyJimuMapView(n),this.mapView&&!this.mapView.destroyed&&(this.mapView.container=null,this.mapView=null),this.sceneView&&!this.sceneView.destroyed&&(this.sceneView.container=null,this.sceneView=null),this.highLightHandles={},this.extentWatch=null,this.fatalErrorWatch=null,this.mapDs=null,this.isRequestingMap=!1}},t.prototype.render=function(){var e=this,t=null;if(this.props.baseWidgetProps.useDataSources)for(var n=0;n<this.props.baseWidgetProps.useDataSources.length;n++)this.props.baseWidgetProps.useDataSources[n].dataSourceId==this.props.dataSourceId&&(t=this.props.baseWidgetProps.useDataSources[n]);return a.React.createElement("div",{className:"jimu-widget",style:{position:"relative"},ref:function(t){e.widgetContainer=t}},this.state.mapLoadStatus===i.Loading&&a.React.createElement("div",{className:"jimu-widget widget-map-background"},a.React.createElement("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})),this.state.mapLoadStatus===i.LoadError&&a.React.createElement("div",{className:"jimu-widget widget-map-background"},this.getMapSwitchForErrorMap(),a.React.createElement("div",{className:"jimu-widget d-flex justify-content-center align-items-center"},this.formatMessage("mapFailure"))),!this.props.isDefaultMap&&a.React.createElement("div",{style:{position:"absolute",display:"none"}},a.React.createElement(a.DataSourceComponent,{useDataSource:t,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed})))},t}(a.React.PureComponent),j=n(5),V=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),O=function(e){function t(t){var n=e.call(this,t)||this;return n.cloneLayoutRef=null,n.insertFixedDom=function(e,t){if(e&&t){var n=e.getElementsByClassName("exbmap-ui-layout");n&&n[0]?e.insertBefore(t,n[0]):e.appendChild(t)}},n.isItemAccepted=function(e,t){var o,i,s=null==e?void 0:e.itemType,r=null===(o=null==e?void 0:e.manifest)||void 0===o?void 0:o.widgetType;return s!==a.LayoutItemType.Section&&r!==a.WidgetType.Layout&&(null===(i=null==e?void 0:e.manifest)||void 0===i?void 0:i.name)!==n.props.widgetManifestName},n.getMapFixedLayout=function(){if(window.jimuConfig.isInBuilder){var e=n.props.LayoutEntry,t=n.props.layouts&&n.props.layouts.MapFixedLayout;return Object(a.jsx)(e,{layouts:t||null,isInWidget:!0,className:Object(a.classNames)("w-100 h-100",{"widget-map-usemask":!Object(p.a)(n.props.appMode),"map-is-live-mode":Object(p.a)(n.props.appMode)}),isItemAccepted:n.isItemAccepted})}t=n.props.layouts&&n.props.layouts.MapFixedLayout;return Object(a.jsx)(j.FixedLayoutViewer,{layouts:t?Object(a.Immutable)(t):null,className:"w-100 h-100 map-is-live-mode"})},n.state={},n.fixedLayoutRef=document.createElement("div"),n.fixedLayoutRef.className="w-100 h-100",n.fixedLayoutRef.style.position="absolute",n.fixedLayoutRef.style.zIndex="0",n}return V(t,e),t.prototype.componentDidMount=function(){this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.container&&this.insertFixedDom(this.props.jimuMapView.view.ui.container,this.fixedLayoutRef)},t.prototype.componentDidUpdate=function(e,t){var n=this;if(e.jimuMapView&&this.props.jimuMapView){if(e.jimuMapView&&e.jimuMapView.view&&e.jimuMapView.view.ui){var o=e.jimuMapView.view.ui.container.getElementsByClassName("layout-clone");if(o&&o.length>0)for(var i=0;i<o.length;i++)o[i].remove()}e.jimuMapView.id!==this.props.jimuMapView.id&&(e.jimuMapView&&e.jimuMapView.view&&e.jimuMapView.view.ui&&(this.cloneLayoutRef=this.fixedLayoutRef.cloneNode(!0),this.cloneLayoutRef.classList.add("layout-clone"),this.insertFixedDom(e.jimuMapView.view.ui.container,this.cloneLayoutRef),setTimeout((function(){n.cloneLayoutRef&&n.cloneLayoutRef.parentNode&&n.cloneLayoutRef.parentNode.removeChild(n.cloneLayoutRef),n.cloneLayoutRef=null}),500),e.jimuMapView.view.ui.container.contains(this.fixedLayoutRef)&&e.jimuMapView.view.ui.container.removeChild(this.fixedLayoutRef)),this.props.jimuMapView&&this.props.jimuMapView.view&&this.insertFixedDom(this.props.jimuMapView.view.ui.container,this.fixedLayoutRef))}},t.prototype.render=function(){return this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.container?Object(a.jsx)("div",null,a.ReactDOM.createPortal(this.getMapFixedLayout(),this.fixedLayoutRef)):this.getMapFixedLayout()},t}(a.React.PureComponent),P=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(a.React.PureComponent),T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),L=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveY=0,t.startY=0,t.isRegisted=!1,t.registerTouchEvent=function(e){e&&!t.isRegisted&&(e.addEventListener("touchstart",(function(e){t.moveY=0;var n=e.touches[0];t.startY=n.clientY}),{passive:!1}),e.addEventListener("touchmove",(function(n){var o=n.touches[0];t.moveY=-1*(o.clientY-t.startY),t.startY=o.clientY,e.scrollTop=e.scrollTop+t.moveY}),{passive:!1}),e.addEventListener("touchend",(function(e){t.moveY=0,t.startY=0}),{passive:!1}),t.isRegisted=!0)},t}return T(t,e),t.prototype.getStyle=function(){return Object(a.css)(m||(m=L(["\n      overflow: auto;\n      pointer-events: auto;\n      "],["\n      overflow: auto;\n      pointer-events: auto;\n      "])))},t.prototype.render=function(){var e=this;return Object(a.jsx)("div",{css:this.getStyle(),className:this.props.className,style:this.props.style,ref:function(t){e.registerTouchEvent(t)}},this.props.children)},t}(a.React.PureComponent),R=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),t.prototype.componentWillUnmount=function(){this.props.onDestroyed&&this.props.onDestroyed()},t.prototype.render=function(){return a.React.createElement(a.React.Fragment,null,this.props.children)},t}(a.React.PureComponent),D=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),k=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},W=n(122),A=n(123),_=function(e){function t(t){var n=e.call(this,t)||this;n.toolName=null,n.isContainedToMobilePanel=!1,n.generation=0,n._getContent=function(){return n.props.toolJson.isOnlyExpanded?Object(a.jsx)("div",{css:n._cssStyle(),className:"exbmap-ui exbmap-ui-tool-panel"},Object(a.jsx)(a.ErrorBoundary,null,n.getExpandPanel())):n.props.isMobile?n._renderMobileTool():n._renderPCTool()},n.onResize=function(e,t){e&&t&&(n.generation=t,n.forceUpdate())},n.handleToggleMobilePanel=function(){n.props.onActiveToolInfoChange(null)};var o=n.props.jimuMapView&&n.props.jimuMapView.view&&n.props.jimuMapView.view.container;return r.MobilePanelManager.getInstance().checkDomIsContained(o)&&(n.isContainedToMobilePanel=!0),n.modifiers=[{name:"flip",options:{padding:0}},{name:"preventOverflow",options:{boundary:o}}],n}return D(t,e),t.prototype._cssStyle=function(){return Object(a.css)(f||(f=k(['\n      .exbmap-basetool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:after {\n        background-color: #6e6e6e;\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      /* pointer-events: auto;\n      box-shadow: 0 1px 2px rgba(0,0,0,0.3);\n      position: relative;\n\n      .exbmap-ui-tool-icon {\n        fill: black;\n        left: 8px;\n        top: 8px;\n        position: absolute;\n        display: block;\n      }\n\n      .exbmap-ui-expand-content {\n        transition: opacity 250ms ease-in-out, margin 250ms ease-in-out;\n        min-height: 10px;\n        min-width: 10px;\n        padding-top: ',";\n        padding-bottom: ",";\n        padding-left: ",";\n        padding-right: ",";\n\n        .exbmap-ui-expand-content-header {\n          margin-bottom: ",";\n        }\n\n        .panel-title {\n          font-size: ",';\n          color: #000000;\n        }\n      }\n\n      .expand-placement-bottom {\n        padding-top: 0.25rem !important;\n      }\n\n      .expand-placement-left {\n        padding-right: 0.25rem !important;\n      }\n\n      .expand-placement-right {\n        padding-left: 0.25rem !important;\n      }\n\n      .expand-placement-top {\n        padding-bottom: 0.25rem !important;\n      }\n\n      .exbmap-basetool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:after {\n        background-color: #6e6e6e;\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      } */\n    '],['\n      .exbmap-basetool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:after {\n        background-color: #6e6e6e;\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      /* pointer-events: auto;\n      box-shadow: 0 1px 2px rgba(0,0,0,0.3);\n      position: relative;\n\n      .exbmap-ui-tool-icon {\n        fill: black;\n        left: 8px;\n        top: 8px;\n        position: absolute;\n        display: block;\n      }\n\n      .exbmap-ui-expand-content {\n        transition: opacity 250ms ease-in-out, margin 250ms ease-in-out;\n        min-height: 10px;\n        min-width: 10px;\n        padding-top: ',";\n        padding-bottom: ",";\n        padding-left: ",";\n        padding-right: ",";\n\n        .exbmap-ui-expand-content-header {\n          margin-bottom: ",";\n        }\n\n        .panel-title {\n          font-size: ",';\n          color: #000000;\n        }\n      }\n\n      .expand-placement-bottom {\n        padding-top: 0.25rem !important;\n      }\n\n      .expand-placement-left {\n        padding-right: 0.25rem !important;\n      }\n\n      .expand-placement-right {\n        padding-left: 0.25rem !important;\n      }\n\n      .expand-placement-top {\n        padding-bottom: 0.25rem !important;\n      }\n\n      .exbmap-basetool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:after {\n        background-color: #6e6e6e;\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      } */\n    '])),a.polished.rem(10),a.polished.rem(10),a.polished.rem(20),a.polished.rem(20),a.polished.rem(10),a.polished.rem(16))},t.prototype.onShowPanel=function(){},t.prototype.onClosePanel=function(){},t.prototype.destroy=function(){},t.getIsNeedSetting=function(){return!0},t.prototype._onIconClick=function(e){var t=this.getIcon()&&this.getIcon().onIconClick;t&&t(e),this.getExpandPanel()&&(this.props.activeToolInfo&&this.props.activeToolInfo.activeToolName===this.toolName?this.props.onActiveToolInfoChange(null):(this.props.onActiveToolInfoChange({activeToolName:this.toolName,activeToolTitle:this.getTitle()}),this.onShowPanel()))},t.prototype._initIconContainer=function(e){e&&!this.iconContainer&&(this.iconContainer=e,this.forceUpdate())},t.prototype._renderPCTool=function(){var e=this,t=this.getIcon();t||(t={icon:W,onIconClick:function(){}});var n=this.getExpandPanel(),o=this.props.activeToolInfo&&this.props.activeToolInfo.activeToolName;return this.generation=this.generation+1,Object(a.jsx)("div",{className:"exbmap-ui exbmap-ui-tool",css:this._cssStyle(),style:{width:"32px",height:"32px"}},Object(a.jsx)("div",{style:{},ref:function(t){e._initIconContainer(t)},className:Object(a.classNames)("exbmap-ui-tool esri-widget--button",{"exbmap-ui-tool-icon-selected":this.toolName===o&&n}),title:this.props.toolJson.isShowIconTitle?this.getTitle():"",onClick:function(t){e._onIconClick(t)}},Object(a.jsx)(r.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:t.icon})),this.iconContainer&&this.toolName===o&&n&&Object(a.jsx)(E,{onDestroyed:function(){e.onClosePanel()}},Object(a.jsx)(r.Popper,{className:"exbmap-ui-popper",reference:this.iconContainer,open:!(this.toolName!==o||!n),placement:this.props.toolJson.panelPlacement,modifiers:this.modifiers,version:this.generation,offset:[0,4]},Object(a.jsx)(l.Consumer,null,(function(t){var o=t.mapWidgetHeight;return Object(a.jsx)("div",{css:e._cssStyle(),className:e.getExpandPanelPlacementClassName()},Object(a.jsx)("div",{className:"exbmap-ui-expand-content"},Object(a.jsx)("div",{className:"w-100 justify-content-between d-flex exbmap-ui-expand-content-header"},Object(a.jsx)("div",{className:"panel-title text-truncate",style:{maxWidth:"210px"},title:e.getTitle()},e.getTitle()),Object(a.jsx)("div",{onClick:function(){e.props.onActiveToolInfoChange(null)},style:{cursor:"pointer"}},Object(a.jsx)(r.Icon,{width:20,height:20,icon:A}))),Object(a.jsx)(a.ErrorBoundary,null,Object(a.jsx)("div",{style:{maxHeight:o-55+"px",overflowY:"Search"!==e.toolName?"auto":"inherit"}},n),Object(a.jsx)(a.ReactResizeDetector,{handleHeight:!0,onResize:e.onResize}))))})))))},t.prototype._renderMobileTool=function(){var e=this,t=this.getIcon();t||(t={icon:W,onIconClick:function(){}});var n=this.getExpandPanel(),o=this.props.activeToolInfo&&this.props.activeToolInfo.activeToolName;return Object(a.jsx)(l.Consumer,null,(function(i){var s=i.mobilePanelContainer;return Object(a.jsx)("div",{className:"exbmap-ui exbmap-ui-tool",css:e._cssStyle()},Object(a.jsx)("div",{style:{},ref:function(t){e.iconContainer=t},className:Object(a.classNames)("exbmap-ui-tool esri-widget--button",{"exbmap-ui-tool-icon-selected":e.toolName===o&&n}),title:e.props.toolJson.isShowIconTitle?e.getTitle():"",onClick:function(t){e._onIconClick(t)}},Object(a.jsx)(r.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:t.icon})),e.toolName===o&&n&&a.ReactDOM.createPortal(Object(a.jsx)(E,{onDestroyed:function(){e.onClosePanel()}},Object(a.jsx)("div",{className:"w-100 h-100 d-flex flex-column",css:e._cssStyle()},Object(a.jsx)(N,{className:"w-100 h-100"},Object(a.jsx)(a.ErrorBoundary,null,e.getExpandPanel())))),s))}))},t.prototype.getExpandPanelPlacementClassName=function(){return this.props.toolJson.panelPlacement?"expand-placement-"+this.props.toolJson.panelPlacement.split("-")[0]:null},t.prototype.render=function(){return this._getContent()},t}(C),B=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),z=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Zoom",n}return B(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"ZoomLabel",defaultMessage:r.defaultMessages.ZoomLabel})},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){return a.React.createElement(H,{jimuMapView:this.props.jimuMapView})},t}(_),H=function(e){function t(t){var n=e.call(this,t)||this;return n.Zoom=null,n.state={apiLoaded:!1},n}return B(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Zoom"]).then((function(t){e.Zoom=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(){this.state.apiLoaded&&this.container&&(this.ZoomBtn&&(this.container.innerHTML=""),this.ZoomBtn=new this.Zoom({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.ZoomBtn&&(this.ZoomBtn.destroy(),this.ZoomBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{ref:function(t){e.container=t}})},t}(a.React.PureComponent),G=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),F=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Home",n.getHomeContent=function(e){return a.React.createElement(U,{jimuMapView:n.props.jimuMapView,initialMapState:e})},n}return G(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"HomeLabel",defaultMessage:r.defaultMessages.HomeLabel})},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){var e=this;return a.React.createElement(l.Consumer,null,(function(t){var n=t.initialMapState;return e.getHomeContent(n)}))},t}(_),U=function(e){function t(t){var n=e.call(this,t)||this;return n.Home=null,n.generateViewPointFromInitialMapState=function(e){return"2d"===e.viewType?new n.Viewpoint({targetGeometry:n.Extent.fromJSON(e.extent),rotation:e.rotation}):n.Viewpoint.fromJSON(e.viewPoint)},n.state={apiLoaded:!1},n}return G(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Home","esri/geometry/Extent","esri/Viewpoint"]).then((function(t){e.Home=t[0],e.Extent=t[1],e.Viewpoint=t[2],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(e){this.state.apiLoaded&&this.container&&(this.homeBtn&&(this.container.innerHTML=""),this.homeBtn=new this.Home({container:this.container,view:this.props.jimuMapView.view,viewpoint:this.props.initialMapState?this.generateViewPointFromInitialMapState(this.props.initialMapState):this.props.jimuMapView.view.map.initialViewProperties.viewpoint}),e.initialMapState!==this.props.initialMapState&&(this.props.jimuMapView.view?this.props.jimuMapView.view.goTo(this.homeBtn.viewpoint,{animate:!1}):(this.homeBtn.destroy(),this.homeBtn=null)))},t.prototype.componentWillUnmount=function(){this.homeBtn&&(this.homeBtn.destroy(),this.homeBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{className:"esri-widget--button",ref:function(t){e.container||(e.container=t)}})},t}(a.React.PureComponent),J=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),q=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Compass",n}return J(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"CompassLabel",defaultMessage:r.defaultMessages.CompassLabel})},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){return a.React.createElement(Y,{jimuMapView:this.props.jimuMapView})},t}(_),Y=function(e){function t(t){var n=e.call(this,t)||this;return n.Compass=null,n.state={apiLoaded:!1},n}return J(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Compass"]).then((function(t){e.Compass=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(){this.state.apiLoaded&&this.container&&(this.CompassBtn&&(this.container.innerHTML=""),this.CompassBtn=new this.Compass({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.CompassBtn&&(this.CompassBtn.destroy(),this.CompassBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{ref:function(t){e.container=t}})},t}(a.React.PureComponent),Z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Q=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Locate",n}return Z(t,e),t.prototype.getTitle=function(){return"Locate"},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){return a.React.createElement(K,{jimuMapView:this.props.jimuMapView})},t}(_),K=function(e){function t(t){var n=e.call(this,t)||this;return n.Locate=null,n.state={apiLoaded:!1},n}return Z(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Locate"]).then((function(t){e.Locate=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(){this.state.apiLoaded&&this.container&&(this.LocateBtn&&(this.container.innerHTML=""),this.LocateBtn=new this.Locate({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.LocateBtn&&(this.LocateBtn.destroy(),this.LocateBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{className:"esri-widget--button",ref:function(t){e.container=t}})},t}(a.React.PureComponent),X=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Navigation",n}return X(t,e),t.prototype.getTitle=function(){return"Navigation"},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){return a.React.createElement(ee,{jimuMapView:this.props.jimuMapView})},t}(_),ee=function(e){function t(t){var n=e.call(this,t)||this;return n.Navigation=null,n.state={apiLoaded:!1},n}return X(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/NavigationToggle"]).then((function(t){e.Navigation=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(){this.state.apiLoaded&&this.container&&(this.NavigationBtn&&(this.container.innerHTML=""),this.NavigationBtn=new this.Navigation({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.NavigationBtn&&(this.NavigationBtn.destroy(),this.NavigationBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{ref:function(t){e.container=t}})},t}(a.React.PureComponent),te=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ne=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},oe=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Search",n}return te(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"SearchLabel",defaultMessage:r.defaultMessages.SearchLabel})},t.prototype.getIcon=function(){return{icon:n(124)}},t.prototype.getExpandPanel=function(){return this.props.isMobile?Object(a.jsx)("div",{style:{minHeight:"32px",position:"relative",width:"100%"}},Object(a.jsx)(ie,{jimuMapView:this.props.jimuMapView})):Object(a.jsx)("div",{style:{minWidth:"250px",minHeight:"32px",position:"relative"}},Object(a.jsx)(ie,{jimuMapView:this.props.jimuMapView}))},t}(_),ie=function(e){function t(t){var n=e.call(this,t)||this;return n.Search=null,n.Portal=null,n.state={apiLoaded:!1},n}return te(t,e),t.prototype.getStyle=function(){return Object(a.css)(g||(g=ne(["\n      /* border: solid 1px rgba(110,110,110,0.3); */\n    "],["\n      /* border: solid 1px rgba(110,110,110,0.3); */\n    "])))},t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Search","esri/portal/Portal"]).then((function(t){e.Search=t[0],e.Portal=t[1],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(){this.state.apiLoaded&&this.container&&(this.SearchBtn&&(this.container.innerHTML=""),this.SearchBtn=new this.Search({container:this.container,view:this.props.jimuMapView.view,portal:new this.Portal({url:Object(a.getAppStore)().getState().portalUrl})}))},t.prototype.componentWillUnmount=function(){this.SearchBtn&&(this.SearchBtn.destroy(),this.SearchBtn=null)},t.prototype.render=function(){var e=this;return Object(a.jsx)("div",{css:this.getStyle(),className:"w-100",ref:function(t){e.container=t}},!this.state.apiLoaded&&Object(a.jsx)("div",{className:"exbmap-basetool-loader"}))},t}(a.React.PureComponent),ae=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),se=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Layers",n.handleTabIndexChange=function(e){n.setState({activeTabIndex:e})},n.state={activeTabIndex:0},n}return ae(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"LayersLabel",defaultMessage:r.defaultMessages.LayersLabel})},t.prototype.getIcon=function(){return{icon:n(125)}},t.prototype.getExpandPanel=function(){var e=this;return a.React.createElement("div",{style:{width:this.props.isMobile?"100%":"250px",minHeight:"32px",position:"relative"},className:Object(a.classNames)({"exbmap-ui-pc-expand-maxheight":!this.props.isMobile})},a.React.createElement(r.Nav,{tabs:!0},a.React.createElement(r.NavItem,null,a.React.createElement(r.NavLink,{active:0===this.state.activeTabIndex,onClick:function(){e.handleTabIndexChange(0)}},this.props.intl.formatMessage({id:"LayersLabelLayer",defaultMessage:r.defaultMessages.LayersLabelLayer}))),a.React.createElement(r.NavItem,null,a.React.createElement(r.NavLink,{active:1===this.state.activeTabIndex,onClick:function(){e.handleTabIndexChange(1)}},this.props.intl.formatMessage({id:"LayersLabelLegend",defaultMessage:r.defaultMessages.LayersLabelLegend})))),a.React.createElement("div",{className:"mt-1"}),0===this.state.activeTabIndex&&a.React.createElement(re,{jimuMapView:this.props.jimuMapView}),1===this.state.activeTabIndex&&a.React.createElement(pe,{jimuMapView:this.props.jimuMapView}))},t}(_),re=function(e){function t(t){var n=e.call(this,t)||this;return n.LayerList=null,n.state={apiLoaded:!1},n}return ae(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/LayerList"]).then((function(t){e.LayerList=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(e){this.state.apiLoaded&&this.container&&(e.jimuMapView&&this.props.jimuMapView&&e.jimuMapView.id!==this.props.jimuMapView.id?this.LayerListBtn&&(this.LayerListBtn.view=this.props.jimuMapView.view,this.LayerListBtn.renderNow()):this.LayerListBtn=new this.LayerList({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.LayerListBtn&&(this.LayerListBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{ref:function(t){e.container=t},style:{width:"100%",minHeight:"32px",position:"relative"}},!this.state.apiLoaded&&a.React.createElement("div",{className:"exbmap-basetool-loader"}))},t}(a.React.PureComponent),pe=function(e){function t(t){var n=e.call(this,t)||this;return n.Legend=null,n.state={apiLoaded:!1},n}return ae(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Legend"]).then((function(t){e.Legend=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(e){this.state.apiLoaded&&this.container&&(e.jimuMapView&&this.props.jimuMapView&&e.jimuMapView.id!==this.props.jimuMapView.id?this.LegendBtn&&(this.LegendBtn.view=this.props.jimuMapView.view,this.LegendBtn.renderNow()):this.LegendBtn=new this.Legend({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.LegendBtn&&(this.LegendBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{ref:function(t){e.container=t},style:{width:"100%",minHeight:"32px",position:"relative"}},!this.state.apiLoaded&&a.React.createElement("div",{className:"exbmap-basetool-loader"}))},t}(a.React.PureComponent),le=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ce=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="BaseMap",n}return le(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"BaseMapLabel",defaultMessage:r.defaultMessages.BaseMapLabel})},t.prototype.getIcon=function(){return{icon:n(126)}},t.prototype.getExpandPanel=function(){return a.React.createElement(ue,{jimuMapView:this.props.jimuMapView,isMobile:this.props.isMobile})},t}(_),ue=function(e){function t(t){var n=e.call(this,t)||this;return n.BaseMap=null,n.state={apiLoaded:!1},n}return le(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/BasemapGallery"]).then((function(t){e.BaseMap=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(e){this.state.apiLoaded&&this.container&&(e.jimuMapView&&this.props.jimuMapView&&e.jimuMapView.id!==this.props.jimuMapView.id?this.BaseMapBtn&&(this.BaseMapBtn.view=this.props.jimuMapView.view,this.BaseMapBtn.renderNow()):this.BaseMapBtn=new this.BaseMap({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.BaseMapBtn&&(this.BaseMapBtn.destroy(),this.BaseMapBtn=null)},t.prototype.render=function(){var e=this;return this.props.isMobile?a.React.createElement("div",{ref:function(t){e.container=t},style:{width:"100%",minHeight:"32px",maxWidth:"none",maxHeight:"none",overflowY:"auto",position:"relative"}},!this.state.apiLoaded&&a.React.createElement("div",{className:"exbmap-basetool-loader"})):a.React.createElement("div",{ref:function(t){e.container=t},style:{width:"250px",minHeight:"32px",position:"relative"},className:"exbmap-ui-pc-expand-maxheight"},!this.state.apiLoaded&&a.React.createElement("div",{className:"exbmap-basetool-loader"}))},t}(a.React.PureComponent),de=n(57),he=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),me=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},fe=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="MapSwitch",n.switchMap=function(){},n.getContent=function(e,t,o,i){if(e){if(n.props.isMobile)return Object(a.jsx)("div",{className:"exbmap-ui-tool esri-widget--button",onClick:i},Object(a.jsx)(r.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:n.getIcon().icon}));var s=Object(a.getAppStore)().getState().appConfig.dataSources;return Object(a.jsx)("div",{css:n.getStyle(),onClick:i},Object(a.jsx)("div",{title:s[t[0]]?s[t[0]].label:null,className:Object(a.classNames)("mapthumb-item",{front:t[0]!==o},{back:t[0]===o})},Object(a.jsx)(de.a,{mapItemId:s[t[0]]?s[t[0]].itemId:null,portUrl:s[t[0]]?s[t[0]].portalUrl:null})),Object(a.jsx)("div",{title:s[t[1]]?s[t[1]].label:null,className:Object(a.classNames)("mapthumb-item",{front:t[1]!==o},{back:t[1]===o})},Object(a.jsx)(de.a,{mapItemId:s[t[1]]?s[t[1]].itemId:null,portUrl:s[t[1]]?s[t[1]].portalUrl:null})))}return null},n.getIconContent=function(t,o,i,a){return t?(n.switchMap=a,e.prototype.render.call(n)):null},n}return he(t,e),t.getIsNeedSetting=function(){return!1},t.prototype.getStyle=function(){return Object(a.css)(w||(w=me(["\n      width: ",";\n      height: ",";\n      cursor: pointer;\n      position: relative;\n\n      .mapthumb-item {\n        position: absolute;\n        width: ",";\n        height: ",";\n        transition: bottom 0.5s, left 0.5s, top 0.5s, right 0.5s, z-index 0.5s;\n      }\n\n      .front {\n        z-index: 1;\n        bottom: 0;\n        left: 0;\n      }\n\n      .back {\n        z-index: 0;\n        top: 0;\n        right: 0;\n      }\n    "],["\n      width: ",";\n      height: ",";\n      cursor: pointer;\n      position: relative;\n\n      .mapthumb-item {\n        position: absolute;\n        width: ",";\n        height: ",";\n        transition: bottom 0.5s, left 0.5s, top 0.5s, right 0.5s, z-index 0.5s;\n      }\n\n      .front {\n        z-index: 1;\n        bottom: 0;\n        left: 0;\n      }\n\n      .back {\n        z-index: 0;\n        top: 0;\n        right: 0;\n      }\n    "])),a.polished.rem(68),a.polished.rem(52),a.polished.rem(64),a.polished.rem(48))},t.prototype.getTitle=function(){return"MapSwitch"},t.prototype.getIcon=function(){var e=this;return{icon:n(108),onIconClick:function(){e.switchMap()}}},t.prototype.getExpandPanel=function(){var e=this;return this.props.toolJson.isOnlyExpanded?Object(a.jsx)(l.Consumer,null,(function(t){var n=t.isShowMapSwitchBtn,o=t.dataSourceIds,i=t.activeDataSourceId,a=t.switchMap;return e.getContent(n,o,i,a)})):null},t.prototype.render=function(){var t=this;return this.props.toolJson.isOnlyExpanded?e.prototype.render.call(this):Object(a.jsx)(l.Consumer,null,(function(e){var n=e.isShowMapSwitchBtn,o=e.dataSourceIds,i=e.activeDataSourceId,a=e.switchMap;return t.getIconContent(n,o,i,a)}))},t}(_),ge=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),we=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Fullscreen",n.isFullScreen=!1,n.fullScreenMap=function(){},n.getContent=function(t,o){return n.fullScreenMap=t,n.isFullScreen=o,e.prototype.render.call(n)},n}return ge(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"FullScreenLabel",defaultMessage:r.defaultMessages.FullScreenLabel})},t.prototype.getIcon=function(){var e=this;return{icon:this.isFullScreen?n(127):n(128),onIconClick:function(t){e.fullScreenMap()}}},t.prototype.getExpandPanel=function(){return null},t.prototype.render=function(){var e=this;return a.React.createElement(l.Consumer,null,(function(t){var n=t.fullScreenMap,o=t.isFullScreen;return e.getContent(n,o)}))},t}(_),be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ye=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="ScaleBar",n}return be(t,e),t.prototype.getTitle=function(){return"ScaleBar"},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){return a.React.createElement(ve,{jimuMapView:this.props.jimuMapView})},t}(_),ve=function(e){function t(t){var n=e.call(this,t)||this;return n.ScaleBar=null,n.state={apiLoaded:!1},n}return be(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/ScaleBar"]).then((function(t){e.ScaleBar=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(){this.state.apiLoaded&&this.container&&(this.ScaleBarBtn&&(this.container.innerHTML=""),this.ScaleBarBtn=new this.ScaleBar({container:this.container,view:this.props.jimuMapView.view,unit:"dual"}))},t.prototype.componentWillUnmount=function(){this.ScaleBarBtn&&(this.ScaleBarBtn.destroy(),this.ScaleBarBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{ref:function(t){e.container=t}})},t}(a.React.PureComponent),Me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Se=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Attribution",n}return Me(t,e),t.getIsNeedSetting=function(){return!1},t.prototype.getTitle=function(){return"Attribution"},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){return a.React.createElement(xe,{jimuMapView:this.props.jimuMapView})},t}(_),xe=function(e){function t(t){var n=e.call(this,t)||this;return n.Attribution=null,n.state={apiLoaded:!1},n}return Me(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Attribution"]).then((function(t){e.Attribution=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(e){this.state.apiLoaded&&this.container&&(e.jimuMapView&&this.props.jimuMapView&&e.jimuMapView.id!==this.props.jimuMapView.id?this.AttributionBtn&&(this.AttributionBtn.view=this.props.jimuMapView.view,this.AttributionBtn.renderNow()):this.AttributionBtn=new this.Attribution({container:this.container,view:this.props.jimuMapView.view}))},t.prototype.componentWillUnmount=function(){this.AttributionBtn&&(this.AttributionBtn.destroy(),this.AttributionBtn=null)},t.prototype.render=function(){var e=this;return a.React.createElement("div",{style:{position:"relative"},ref:function(t){e.container=t}})},t}(a.React.PureComponent),Ie=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),je=function(e){function t(t){var o=e.call(this,t)||this;return o.toolName="Measure",o.measureModules2D=[{name:"Line",title:"Line",path:"DistanceMeasurement2D",src:n(109)},{name:"Polygon",title:"Polygon",path:"AreaMeasurement2D",src:n(110)}],o.measureModules3D=[{name:"Line",title:"Line",path:"DirectLineMeasurement3D",src:n(109)},{name:"Polygon",title:"Polygon",path:"AreaMeasurement3D",src:n(110)}],o.handleMeasurceInstanceCreated=function(e,t){var n=o.state.measureInstances;n[t]=e,o.setState({measureInstances:n})},o.onTabClick=function(e){if(o.state.activeTabIndex!==e){o.setState({activeTabIndex:e});for(var t=0;t<o.state.measureInstances.length;t++)t!==e&&o.state.measureInstances[t]&&(o.state.measureInstances[t].visible=!1),t===e&&o.state.measureInstances[t]&&(o.state.measureInstances[t].visible=!0)}},o.onClosePanel=function(){for(var e=0;e<o.state.measureInstances.length;e++)o.state.measureInstances[e]&&(o.state.measureInstances[e].visible=!1)},o.onShowPanel=function(){for(var e=0;e<o.state.measureInstances.length;e++)e!==o.state.activeTabIndex&&o.state.measureInstances[e]&&(o.state.measureInstances[e].visible=!1),e===o.state.activeTabIndex&&o.state.measureInstances[e]&&(o.state.measureInstances[e].visible=!0)},o.getNavTab=function(){return"2d"===o.props.jimuMapView.view.type?a.React.createElement(r.Nav,{tabs:!0},o.measureModules2D.map((function(e,t){return a.React.createElement(r.NavItem,{key:t},a.React.createElement(r.NavLink,{active:o.state.activeTabIndex===t,onClick:function(){o.onTabClick(t)}},a.React.createElement(r.Icon,{width:16,height:16,className:"m-0",icon:e.src})))}))):"3d"===o.props.jimuMapView.view.type?a.React.createElement(r.Nav,{tabs:!0},o.measureModules3D.map((function(e,t){return a.React.createElement(r.NavItem,{key:t},a.React.createElement(r.NavLink,{active:o.state.activeTabIndex===t,onClick:function(){o.onTabClick(t)}},a.React.createElement(r.Icon,{width:16,height:16,className:"m-0",icon:e.src})))}))):null},o.getMeasureModule=function(){return"2d"===o.props.jimuMapView.view.type?o.measureModules2D[o.state.activeTabIndex]:o.measureModules3D[o.state.activeTabIndex]},o.state={activeTabIndex:0,measureInstances:[null,null]},o}return Ie(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"MeasureLabel",defaultMessage:r.defaultMessages.MeasureLabel})},t.prototype.getIcon=function(){return{icon:n(129)}},t.prototype.destroy=function(){for(var e=0;e<this.state.measureInstances.length;e++)this.state.measureInstances[e]&&!this.state.measureInstances[e].destroyed&&this.state.measureInstances[e].destroy()},t.prototype.getExpandPanel=function(){return a.React.createElement("div",{style:{width:this.props.isMobile?"100%":"250px",position:"relative"},className:Object(a.classNames)({"exbmap-ui-pc-expand-maxheight":!this.props.isMobile})},this.getNavTab(),a.React.createElement(Ve,{activeTabIndex:this.state.activeTabIndex,jimuMapView:this.props.jimuMapView,measureModule:this.getMeasureModule(),measureInstance:this.state.measureInstances[this.state.activeTabIndex],onMeasurceInstanceCreated:this.handleMeasurceInstanceCreated}))},t}(_),Ve=function(e){function t(t){var n=e.call(this,t)||this;return n.MeasureInstance=null,n.checkContainer=function(){"0"!==n.container.style.opacity&&0!==n.container.style.opacity||(n.container.style.opacity=1,n.container.style.height="")},n.state={apiLoaded:!1},n}return Ie(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.apiLoaded||Object(s.loadArcGISJSAPIModules)(["esri/widgets/"+this.props.measureModule.path]).then((function(t){e.MeasureClass=t[0],e.setState({apiLoaded:!0})}))},t.prototype.componentDidUpdate=function(e){var t,n;if(e.activeTabIndex===this.props.activeTabIndex&&e.measureModule===this.props.measureModule){if(this.state.apiLoaded&&this.parentContainer&&this.container){var o;if(e.jimuMapView&&this.props.jimuMapView&&e.jimuMapView.id!==this.props.jimuMapView.id)this.props.measureInstance.view=this.props.jimuMapView.view,this.props.measureInstance.renderNow(),this.props.measureInstance.viewModel.newMeasurement();else if(this.props.measureInstance)if(this.props.measureInstance.view===this.props.jimuMapView.view)this.parentContainer.getElementsByClassName("measure-container")&&this.parentContainer.getElementsByClassName("measure-container")[0]&&this.parentContainer.getElementsByClassName("measure-container")[0].remove(),this.parentContainer.appendChild(this.props.measureInstance.container),"measured"!==this.props.measureInstance.viewModel.state&&"measuring"!==this.props.measureInstance.viewModel.state&&this.props.measureInstance.viewModel.newMeasurement();else if((null===(n=null===(t=this.props.measureInstance)||void 0===t?void 0:t.view)||void 0===n?void 0:n.type)!==this.props.jimuMapView.view.type)this.props.measureInstance.destroy(),this.parentContainer.getElementsByClassName("measure-container")&&this.parentContainer.getElementsByClassName("measure-container")[0]&&this.parentContainer.getElementsByClassName("measure-container")[0].remove(),this.container.innerHTML="",this.container.style.opacity=1,this.container.style.height="",this.parentContainer.appendChild(this.container),(o=new this.MeasureClass({container:this.container,view:this.props.jimuMapView.view})).viewModel.newMeasurement(),this.props.onMeasurceInstanceCreated(o,this.props.activeTabIndex);else this.props.measureInstance.view=this.props.jimuMapView.view,this.props.measureInstance.renderNow(),this.props.measureInstance.viewModel.newMeasurement();else(o=new this.MeasureClass({container:this.container,view:this.props.jimuMapView.view})).viewModel.newMeasurement(),this.props.onMeasurceInstanceCreated(o,this.props.activeTabIndex);this.checkContainer()}}else this.reload()},t.prototype.reload=function(){var e=this;this.container.childNodes&&this.container.childNodes[0]&&(this.container.style.opacity=0,this.container.style.height="35px"),this.setState({apiLoaded:!1},(function(){Object(s.loadArcGISJSAPIModules)(["esri/widgets/"+e.props.measureModule.path]).then((function(t){e.MeasureClass=t[0],e.setState({apiLoaded:!0})}))}))},t.prototype.render=function(){var e=this;return a.React.createElement("div",{className:"w-100",style:{width:"250px",position:"relative",minHeight:"32px"},ref:function(t){e.parentContainer=t}},a.React.createElement("div",{className:"measure-container",ref:function(t){e.container=t}}),!this.state.apiLoaded&&a.React.createElement("div",{className:"exbmap-basetool-loader"}))},t}(a.React.PureComponent),Oe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pe=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ce={style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18},Te={tags:["solid"],title:"Blue Thin",style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"},Le={style:"esriSFSSolid",color:[79,129,189,77],type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}},Ne=n(81),Re=n(82),Ee=n(111),De=n(112),ke=n(113),We=n(114),Ae=n(115),_e=function(e){function t(t){var n=e.call(this,t)||this;return n.currentActiveTool="rectangle",n.jsonUtils=null,n.resultGraphics=[],n.toggleIsSelectActive=function(){n.setState({isActive:!n.state.isActive})},n.getSelectToolIcon=function(){return"Point"===n.state.currentSelectType?We:"Rectangle"===n.state.currentSelectType?Re:"Lasso"===n.state.currentSelectType?Ee:"Circle"===n.state.currentSelectType?De:"Line"===n.state.currentSelectType?ke:Re},n.toggleSelectTypePopup=function(){n.setState({isShowSelectTypePopup:!n.state.isShowSelectTypePopup})},n.toggleResultPopup=function(){n.setState({isShowResultPopup:!n.state.isShowResultPopup})},n.setCurrentSelectType=function(e){n.initialSketchTool(),"Point"===e&&(n.sketchViewModel.create("point"),n.currentActiveTool="point"),"Rectangle"===e&&(n.sketchViewModel.create("rectangle"),n.currentActiveTool="rectangle"),"Lasso"===e&&(n.sketchViewModel.create("polygon"),n.currentActiveTool="polygon"),"Circle"===e&&(n.sketchViewModel.create("circle"),n.currentActiveTool="circle"),"Line"===e&&(n.sketchViewModel.create("polyline"),n.currentActiveTool="polyline"),n.setState({currentSelectType:e,isShowSelectTypePopup:!1,isActive:!0})},n.clearSelect=function(){n.props.jimuMapView.clearSelectedFeatures()},n.state={isShowResultPopup:!1,isShowSelectTypePopup:!1,currentSelectType:"Rectangle",sketchInitialed:!1,isActive:!1,spatialRelationship:"intersects",resultGraphics:[],isQuerying:!1},n}return Oe(t,e),t.prototype.getCSSStyle=function(){var e=this.props.theme,t=e.arcgis.components.button.variants.default.default.bg,n=e.arcgis.components.button.variants.default.default.border;return Object(a.css)(b||(b=Pe(["\n      .select-tool-container {\n        ","\n        ","\n      }\n\n      .select-tool-btn {\n        width: 32px;\n        height: 32px;\n      }\n\n      .content-bg {\n        background-color: ",";\n      }\n\n      .content-title {\n        font-size: ",";\n        font-weight: bold;\n      }\n\n      .select-tool-type-mobile-container-shell {\n        overflow-x: auto;\n      }\n\n      .select-tool-type-mobile-container-shell::-webkit-scrollbar {\n        height: 0 !important;\n        display: none;\n      }\n\n      .select-tool-type-mobile-container {\n        width: 400px;\n      }\n\n      .select-tool-type {\n        width: 64px;\n        height: 64px;\n        border: 1px solid ",";\n        cursor: pointer;\n      }\n\n      .select-tool-type-choosed {\n        border: 1px solid ",";\n        position: relative;\n      }\n\n      .select-tool-type-choosed:after {\n        width: 0;\n        height: 0;\n        border-top: 8px solid ",';\n        border-left: 8px solid transparent;\n        position: absolute;\n        top: 0;\n        right: 0;\n        content: "";\n      }\n\n      .select-tool-type-text {\n        font-size: ',';\n      }\n\n      .select-tool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .select-tool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .select-tool-loader:after {\n        background-color: ',';\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n    '],["\n      .select-tool-container {\n        ","\n        ","\n      }\n\n      .select-tool-btn {\n        width: 32px;\n        height: 32px;\n      }\n\n      .content-bg {\n        background-color: ",";\n      }\n\n      .content-title {\n        font-size: ",";\n        font-weight: bold;\n      }\n\n      .select-tool-type-mobile-container-shell {\n        overflow-x: auto;\n      }\n\n      .select-tool-type-mobile-container-shell::-webkit-scrollbar {\n        height: 0 !important;\n        display: none;\n      }\n\n      .select-tool-type-mobile-container {\n        width: 400px;\n      }\n\n      .select-tool-type {\n        width: 64px;\n        height: 64px;\n        border: 1px solid ",";\n        cursor: pointer;\n      }\n\n      .select-tool-type-choosed {\n        border: 1px solid ",";\n        position: relative;\n      }\n\n      .select-tool-type-choosed:after {\n        width: 0;\n        height: 0;\n        border-top: 8px solid ",';\n        border-left: 8px solid transparent;\n        position: absolute;\n        top: 0;\n        right: 0;\n        content: "";\n      }\n\n      .select-tool-type-text {\n        font-size: ',';\n      }\n\n      .select-tool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .select-tool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .select-tool-loader:after {\n        background-color: ',';\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n    '])),t&&"background-color: "+t+";",n&&"border: "+n.color+" "+n.width+" solid;",e.colors.palette.light[100],a.polished.rem(13),e.colors.palette.light[400],e.colors.primary,e.colors.primary,a.polished.rem(12),e.colors.primary)},t.prototype.componentDidMount=function(){var e=this;this.state.sketchInitialed||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Sketch/SketchViewModel","esri/layers/GraphicsLayer","esri/tasks/support/Query","esri/symbols/support/jsonUtils","esri/geometry/geometryEngine"]).then((function(t){e.SketchViewModel=t[0],e.GraphicsLayer=t[1],e.Query=t[2],e.jsonUtils=t[3],e.geometryEngine=t[4],e.props.jimuMapView.view.when((function(){e.initialSketchTool(),e.setState({sketchInitialed:!0})}))}))},t.prototype.componentDidUpdate=function(e,t){return t.sketchInitialed!==this.state.sketchInitialed&&this.state.sketchInitialed?(this.initialSketchTool(),void(this.state.isActive&&this.currentActiveTool&&this.sketchViewModel.create(this.currentActiveTool))):e.jimuMapView&&this.props.jimuMapView&&e.jimuMapView.id!==this.props.jimuMapView.id&&this.state.sketchInitialed?(this.initialSketchTool(),this.sketchViewModel.view=this.props.jimuMapView.view,void(this.state.isActive&&this.currentActiveTool&&this.sketchViewModel.create(this.currentActiveTool))):void(t.isActive!==this.state.isActive&&(this.initialSketchTool(),this.state.isActive?this.sketchViewModel.create(this.currentActiveTool):(this.sketchViewModel.destroy(),this.sketchViewModel=null)))},t.prototype.componentWillUnmount=function(){this.sketchViewModel&&this.sketchViewModel.destroy()},t.prototype.initialSketchTool=function(){var e=this;this.SketchViewModel&&(this.sketchViewModel||(this.sketchViewModel=new this.SketchViewModel({view:this.props.jimuMapView.view,layer:new this.GraphicsLayer,pointSymbol:this.jsonUtils.fromJSON(Ce),polylineSymbol:this.jsonUtils.fromJSON(Te),polygonSymbol:this.jsonUtils.fromJSON(Le)}),this.sketchViewModel.on("create",(function(t){"complete"===t.state&&(e.sketchViewModel.create(e.currentActiveTool),e.setState({isQuerying:!0}),e.props.jimuMapView.selectFeaturesByGraphic(t.graphic,e.state.spatialRelationship).then((function(){e.setState({isQuerying:!1})})))}))))},t.prototype.render=function(){var e=this;return Object(a.jsx)("div",{css:this.getCSSStyle()},Object(a.jsx)("div",{className:"d-flex align-items-center justify-content-center select-tool-container",ref:function(t){e.btnContainer=t}},Object(a.jsx)("div",{className:"d-flex"},Object(a.jsx)("div",{className:"d-flex"},Object(a.jsx)("button",{onClick:this.toggleIsSelectActive,className:Object(a.classNames)("esri-widget--button  border-0 select-tool-btn d-flex align-items-center justify-content-center",{active:this.state.isActive}),disabled:!this.state.sketchInitialed},Object(a.jsx)(r.Icon,{width:16,height:16,icon:this.getSelectToolIcon()})),Object(a.jsx)("button",{onClick:this.toggleSelectTypePopup,style:{width:18},className:Object(a.classNames)("esri-widget--button border-0 pl-1 pr-1 select-tool-btn d-flex align-items-center justify-content-center",{active:this.state.isShowSelectTypePopup}),disabled:!this.state.sketchInitialed},Object(a.jsx)(r.Icon,{width:8,height:8,icon:Ne}))),Object(a.jsx)("button",{className:"select-tool-btn d-flex align-items-center justify-content-center select-tool-btn-hover esri-widget--button border-0",ref:function(t){e.selectResultContainer=t},onClick:this.clearSelect,disabled:!this.state.sketchInitialed},Object(a.jsx)(r.Icon,{width:16,height:16,icon:Ae})),Object(a.jsx)(r.Popper,{css:this.getCSSStyle(),reference:this.btnContainer,open:this.state.isShowSelectTypePopup,placement:"bottom-start",toggle:this.toggleSelectTypePopup},Object(a.jsx)("div",{className:"p-3 content-bg",style:{display:"flex",flexDirection:"column"}},Object(a.jsx)("div",{className:"content-title"},this.props.intl.formatMessage({id:"SelectionTool",defaultMessage:r.defaultMessages.SelectionTool})),Object(a.jsx)("div",{className:"mt-2 mb-2"},Object(a.jsx)("div",{className:"d-flex mb-2"},Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-2 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Rectangle"===this.state.currentSelectType}),onClick:function(){e.setCurrentSelectType("Rectangle")}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:Re}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:this.props.intl.formatMessage({id:"SelectionToolRectangle",defaultMessage:r.defaultMessages.SelectionToolRectangle})},this.props.intl.formatMessage({id:"SelectionToolRectangle",defaultMessage:r.defaultMessages.SelectionToolRectangle}))),Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-2 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Lasso"===this.state.currentSelectType}),onClick:function(){e.setCurrentSelectType("Lasso")}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:Ee}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:this.props.intl.formatMessage({id:"SelectionToolLasso",defaultMessage:r.defaultMessages.SelectionToolLasso})},this.props.intl.formatMessage({id:"SelectionToolLasso",defaultMessage:r.defaultMessages.SelectionToolLasso}))),Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Circle"===this.state.currentSelectType}),onClick:function(){e.setCurrentSelectType("Circle")}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:De}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:this.props.intl.formatMessage({id:"SelectionToolCircle",defaultMessage:r.defaultMessages.SelectionToolCircle})},this.props.intl.formatMessage({id:"SelectionToolCircle",defaultMessage:r.defaultMessages.SelectionToolCircle})))),Object(a.jsx)("div",{className:"d-flex"},Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-2 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Line"===this.state.currentSelectType}),onClick:function(){e.setCurrentSelectType("Line")}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:ke}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:this.props.intl.formatMessage({id:"SelectionToolLine",defaultMessage:r.defaultMessages.SelectionToolLine})},this.props.intl.formatMessage({id:"SelectionToolLine",defaultMessage:r.defaultMessages.SelectionToolLine}))),Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Point"===this.state.currentSelectType}),onClick:function(){e.setCurrentSelectType("Point")}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:We}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:this.props.intl.formatMessage({id:"SelectionToolPoint",defaultMessage:r.defaultMessages.SelectionToolPoint})},this.props.intl.formatMessage({id:"SelectionToolPoint",defaultMessage:r.defaultMessages.SelectionToolPoint}))))),Object(a.jsx)("div",{className:"content-title"},this.props.intl.formatMessage({id:"SelectionMode",defaultMessage:r.defaultMessages.SelectionMode})),Object(a.jsx)("div",null,Object(a.jsx)("div",{className:"d-flex align-items-center mt-2"},Object(a.jsx)(r.Radio,{style:{cursor:"pointer"},checked:"intersects"===this.state.spatialRelationship,onChange:function(){e.setState({spatialRelationship:"intersects"})}}),Object(a.jsx)("label",{className:"m-0 ml-2 content-title",style:{cursor:"pointer"},onClick:function(){e.setState({spatialRelationship:"intersects"})}},this.props.intl.formatMessage({id:"SelectionWithin",defaultMessage:r.defaultMessages.SelectionWithin}))),Object(a.jsx)("div",{className:"d-flex align-items-center mt-2"},Object(a.jsx)(r.Radio,{style:{cursor:"pointer"},checked:"contains"===this.state.spatialRelationship,onChange:function(){e.setState({spatialRelationship:"contains"})}}),Object(a.jsx)("label",{className:"m-0 ml-2 content-title",style:{cursor:"pointer"},onClick:function(){e.setState({spatialRelationship:"contains"})}},this.props.intl.formatMessage({id:"SelectionContain",defaultMessage:r.defaultMessages.SelectionContain})))))))),(this.state.isQuerying||!this.state.sketchInitialed)&&Object(a.jsx)("div",{className:"select-tool-loader"}))},t}(a.React.PureComponent),Be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ze=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},He={style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18},Ge={tags:["solid"],title:"Blue Thin",style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"},Fe={style:"esriSFSSolid",color:[79,129,189,77],type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}},Ue=n(82),Je=n(111),qe=n(112),Ye=n(113),Ze=n(114),Qe=n(130),Ke=function(e){function t(t){var n=e.call(this,t)||this;return n.jsonUtils=null,n.currentActiveTool="rectangle",n.setCurrentSelectType=function(e){n.initialSketchTool(),e!==n.state.currentSelectType&&("Point"===e&&(n.props.isActive&&n.sketchViewModel.create("point"),n.currentActiveTool="point"),"Rectangle"===e&&(n.props.isActive&&n.sketchViewModel.create("rectangle"),n.currentActiveTool="rectangle"),"Lasso"===e&&(n.props.isActive&&n.sketchViewModel.create("polygon"),n.currentActiveTool="polygon"),"Circle"===e&&(n.props.isActive&&n.sketchViewModel.create("circle"),n.currentActiveTool="circle"),"Line"===e&&(n.props.isActive&&n.sketchViewModel.create("polyline"),n.currentActiveTool="polyline"),n.setState({currentSelectType:e},(function(){(!n.props.activeToolInfo||n.props.activeToolInfo&&n.props.activeToolInfo.activeToolName!==n.props.toolName)&&n.props._onIconClick(null)})))},n.toggleIsSelectActive=function(){n.props._onIconClick(null)},n.handleIsShowSelectSetting=function(){n.setState({isShowSelectSetting:!n.state.isShowSelectSetting})},n.getSelectToolIcon=function(){return"Point"===n.state.currentSelectType?Ze:"Rectangle"===n.state.currentSelectType?Ue:"Lasso"===n.state.currentSelectType?Je:"Circle"===n.state.currentSelectType?qe:"Line"===n.state.currentSelectType?Ye:Ue},n.getMobilePanelForSelectSetting=function(){return Object(a.jsx)(l.Consumer,null,(function(e){var t=e.mapWidgetId;return Object(a.jsx)(r.MobilePanel,{mapWidgetId:t+"-with-select-container",title:"",open:n.state.isShowSelectSetting,toggle:function(){n.handleIsShowSelectSetting()}},Object(a.jsx)("div",{className:"w-100"},n.getMobilePanelSettingContent()))}))},n.getMobilePanelSettingContent=function(){return Object(a.jsx)("div",{css:n.getCSSStyle()},Object(a.jsx)("div",{className:"content-title mt-1 mb-2"},n.props.intl.formatMessage({id:"SelectionTool",defaultMessage:r.defaultMessages.SelectionTool})),Object(a.jsx)("div",{className:"w-100 select-tool-type-mobile-container-shell"},Object(a.jsx)("div",{className:"select-tool-type-mobile-container"},Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-3 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Rectangle"===n.state.currentSelectType}),onClick:function(){n.setCurrentSelectType("Rectangle")},style:{float:"left"}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:Ue}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:n.props.intl.formatMessage({id:"SelectionToolRectangle",defaultMessage:r.defaultMessages.SelectionToolRectangle})},n.props.intl.formatMessage({id:"SelectionToolRectangle",defaultMessage:r.defaultMessages.SelectionToolRectangle}))),Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-3 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Lasso"===n.state.currentSelectType}),onClick:function(){n.setCurrentSelectType("Lasso")},style:{float:"left"}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:Je}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:n.props.intl.formatMessage({id:"SelectionToolLasso",defaultMessage:r.defaultMessages.SelectionToolLasso})},n.props.intl.formatMessage({id:"SelectionToolLasso",defaultMessage:r.defaultMessages.SelectionToolLasso}))),Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-3 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Circle"===n.state.currentSelectType}),onClick:function(){n.setCurrentSelectType("Circle")},style:{float:"left"}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:qe}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:n.props.intl.formatMessage({id:"SelectionToolCircle",defaultMessage:r.defaultMessages.SelectionToolCircle})},n.props.intl.formatMessage({id:"SelectionToolCircle",defaultMessage:r.defaultMessages.SelectionToolCircle}))),Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-3 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Line"===n.state.currentSelectType}),onClick:function(){n.setCurrentSelectType("Line")},style:{float:"left"}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:Ye}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:n.props.intl.formatMessage({id:"SelectionToolLine",defaultMessage:r.defaultMessages.SelectionToolLine})},n.props.intl.formatMessage({id:"SelectionToolLine",defaultMessage:r.defaultMessages.SelectionToolLine}))),Object(a.jsx)("div",{className:Object(a.classNames)("select-tool-type mr-3 d-flex flex-column align-items-center justify-content-center select-tool-btn-hover",{"select-tool-type-choosed":"Point"===n.state.currentSelectType}),onClick:function(){n.setCurrentSelectType("Point")},style:{float:"left"}},Object(a.jsx)(r.Icon,{width:16,height:16,icon:Ze}),Object(a.jsx)("div",{className:"select-tool-type-text mt-1 w-100 text-truncate pl-1 pr-1 d-flex justify-content-center",title:n.props.intl.formatMessage({id:"SelectionToolPoint",defaultMessage:r.defaultMessages.SelectionToolPoint})},n.props.intl.formatMessage({id:"SelectionToolPoint",defaultMessage:r.defaultMessages.SelectionToolPoint}))))),Object(a.jsx)("div",{className:"content-title mt-1 mb-2"},n.props.intl.formatMessage({id:"SelectionMode",defaultMessage:r.defaultMessages.SelectionMode})),Object(a.jsx)("div",null,Object(a.jsx)("div",{className:"d-flex align-items-center mt-2"},Object(a.jsx)(r.Radio,{style:{cursor:"pointer"},checked:"intersects"===n.state.spatialRelationship,onChange:function(){n.setState({spatialRelationship:"intersects"})}}),Object(a.jsx)("label",{className:"m-0 ml-2 content-title",style:{cursor:"pointer"},onClick:function(){n.setState({spatialRelationship:"intersects"})}},n.props.intl.formatMessage({id:"SelectionWithin",defaultMessage:r.defaultMessages.SelectionWithin}))),Object(a.jsx)("div",{className:"d-flex align-items-center mt-2"},Object(a.jsx)(r.Radio,{style:{cursor:"pointer"},checked:"contains"===n.state.spatialRelationship,onChange:function(){n.setState({spatialRelationship:"contains"})}}),Object(a.jsx)("label",{className:"m-0 ml-2 content-title",style:{cursor:"pointer"},onClick:function(){n.setState({spatialRelationship:"contains"})}},n.props.intl.formatMessage({id:"SelectionContain",defaultMessage:r.defaultMessages.SelectionContain})))))},n.state={currentSelectType:"Rectangle",sketchInitialed:!1,spatialRelationship:"intersects",isQuerying:!1,isShowSelectSetting:!1},n}return Be(t,e),t.prototype.getCSSStyle=function(){var e=this.props.theme;return Object(a.css)(y||(y=ze(["\n      background-color: 'initial';\n\n      .select-tool-btn-hover: hover {\n        background-color: ",";;\n      }\n\n      .content-title {\n        font-size: ",";\n        font-weight: bold;\n      }\n\n      .select-tool-type-mobile-container-shell {\n        overflow-x: auto;\n      }\n\n      .select-tool-type-mobile-container-shell::-webkit-scrollbar {\n        height: 0 !important;\n        display: none;\n      }\n\n      .select-tool-type-mobile-container {\n        width: 400px;\n      }\n\n      .select-tool-type {\n        width: 64px;\n        height: 64px;\n        border: 1px solid ",";\n        cursor: pointer;\n      }\n\n      .select-tool-type-choosed {\n        border: 1px solid ",";\n        position: relative;\n      }\n\n      .select-tool-type-choosed:after {\n        width: 0;\n        height: 0;\n        border-top: 8px solid ",';\n        border-left: 8px solid transparent;\n        position: absolute;\n        top: 0;\n        right: 0;\n        content: "";\n      }\n\n      .select-tool-type-text {\n        font-size: ',';\n      }\n\n      .select-tool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .select-tool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .select-tool-loader:after {\n        background-color: ',';\n        width: 40%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n    '],["\n      background-color: 'initial';\n\n      .select-tool-btn-hover: hover {\n        background-color: ",";;\n      }\n\n      .content-title {\n        font-size: ",";\n        font-weight: bold;\n      }\n\n      .select-tool-type-mobile-container-shell {\n        overflow-x: auto;\n      }\n\n      .select-tool-type-mobile-container-shell::-webkit-scrollbar {\n        height: 0 !important;\n        display: none;\n      }\n\n      .select-tool-type-mobile-container {\n        width: 400px;\n      }\n\n      .select-tool-type {\n        width: 64px;\n        height: 64px;\n        border: 1px solid ",";\n        cursor: pointer;\n      }\n\n      .select-tool-type-choosed {\n        border: 1px solid ",";\n        position: relative;\n      }\n\n      .select-tool-type-choosed:after {\n        width: 0;\n        height: 0;\n        border-top: 8px solid ",';\n        border-left: 8px solid transparent;\n        position: absolute;\n        top: 0;\n        right: 0;\n        content: "";\n      }\n\n      .select-tool-type-text {\n        font-size: ',';\n      }\n\n      .select-tool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .select-tool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .select-tool-loader:after {\n        background-color: ',';\n        width: 40%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n    '])),a.polished.rgba(e.colors.palette.primary[500],.1),a.polished.rem(13),e.colors.palette.light[400],e.colors.primary,e.colors.primary,a.polished.rem(12),e.colors.primary)},t.prototype.componentDidMount=function(){var e=this;this.state.sketchInitialed||Object(s.loadArcGISJSAPIModules)(["esri/widgets/Sketch/SketchViewModel","esri/layers/GraphicsLayer","esri/tasks/support/Query","esri/symbols/support/jsonUtils","esri/geometry/geometryEngine"]).then((function(t){e.SketchViewModel=t[0],e.GraphicsLayer=t[1],e.Query=t[2],e.jsonUtils=t[3],e.geometryEngine=t[4],e.props.jimuMapView.view.when((function(){e.initialSketchTool(),e.setState({sketchInitialed:!0})}))}))},t.prototype.componentDidUpdate=function(e,t){var n=e.activeToolInfo&&e.activeToolInfo.activeToolName,o=this.props.activeToolInfo&&this.props.activeToolInfo.activeToolName;return n!==o&&o!==this.props.toolName&&o&&this.setState({isShowSelectSetting:!1}),t.sketchInitialed!==this.state.sketchInitialed&&this.state.sketchInitialed?(this.initialSketchTool(),void(this.props.isActive&&this.currentActiveTool&&this.sketchViewModel.create(this.currentActiveTool))):e.jimuMapView&&this.props.jimuMapView&&e.jimuMapView.id!==this.props.jimuMapView.id&&this.state.sketchInitialed?(this.initialSketchTool(),this.sketchViewModel.view=this.props.jimuMapView.view,void(this.props.isActive&&this.currentActiveTool&&this.sketchViewModel.create(this.currentActiveTool))):void(e.isActive!==this.props.isActive&&(this.initialSketchTool(),this.props.isActive?this.sketchViewModel.create(this.currentActiveTool):(this.sketchViewModel.destroy(),this.sketchViewModel=null)))},t.prototype.componentWillUnmount=function(){this.sketchViewModel&&this.sketchViewModel.destroy()},t.prototype.initialSketchTool=function(){var e=this;this.SketchViewModel&&(this.sketchViewModel||(this.sketchViewModel=new this.SketchViewModel({view:this.props.jimuMapView.view,layer:new this.GraphicsLayer,pointSymbol:this.jsonUtils.fromJSON(He),polylineSymbol:this.jsonUtils.fromJSON(Ge),polygonSymbol:this.jsonUtils.fromJSON(Fe)}),this.sketchViewModel.on("create",(function(t){"complete"===t.state&&(e.sketchViewModel.create(e.currentActiveTool),e.setState({isQuerying:!0}),e.props.jimuMapView.selectFeaturesByGraphic(t.graphic,e.state.spatialRelationship).then((function(){e.setState({isQuerying:!1})})))}))))},t.prototype.render=function(){return Object(a.jsx)("div",{css:this.getCSSStyle()},this.state.sketchInitialed&&Object(a.jsx)("div",{onClick:this.toggleIsSelectActive,style:{},className:Object(a.classNames)("exbmap-ui-tool border-0 esri-widget--button",{"exbmap-ui-tool-icon-selected":this.props.isActive})},Object(a.jsx)(r.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:this.getSelectToolIcon()})),!this.state.sketchInitialed&&Object(a.jsx)("div",{style:{},className:Object(a.classNames)("exbmap-ui-tool border-0 esri-widget--button")},Object(a.jsx)(r.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:this.getSelectToolIcon()})),Object(a.jsx)("div",{className:"border border-top-0 w-100",style:{height:"1px"}}),this.state.sketchInitialed&&Object(a.jsx)("div",{onClick:this.handleIsShowSelectSetting,style:{},className:Object(a.classNames)("exbmap-ui-tool border-0 esri-widget--button")},Object(a.jsx)(r.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:Qe})),!this.state.sketchInitialed&&Object(a.jsx)("div",{style:{},className:Object(a.classNames)("exbmap-ui-tool border-0 esri-widget--button")},Object(a.jsx)(r.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:Qe})),this.state.isShowSelectSetting&&this.getMobilePanelForSelectSetting(),(this.state.isQuerying||!this.state.sketchInitialed)&&Object(a.jsx)("div",{className:"select-tool-loader"}))},t}(a.React.PureComponent),Xe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$e=function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="Select",n.state={},n}return Xe(t,e),t.prototype.getTitle=function(){return this.props.intl.formatMessage({id:"SelectLabel",defaultMessage:r.defaultMessages.SelectLabel})},t.prototype.getIcon=function(){return{icon:n(82)}},t.prototype.getExpandPanel=function(){var e=this;return this.props.isMobile?Object(a.jsx)(Ke,{isActive:this.toolName===(this.props.activeToolInfo&&this.props.activeToolInfo.activeToolName),activeToolInfo:this.props.activeToolInfo,toolName:this.toolName,onActiveToolInfoChange:this.props.onActiveToolInfoChange,_onIconClick:function(){e._onIconClick()},theme:this.props.theme,intl:this.props.intl,jimuMapView:this.props.jimuMapView}):Object(a.jsx)(_e,{theme:this.props.theme,intl:this.props.intl,jimuMapView:this.props.jimuMapView})},t}(_),et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return et(t,e),t.prototype.componentDidMount=function(){this.computerSelectedGraphics()},t.prototype.componentDidUpdate=function(){this.computerSelectedGraphics()},t.prototype.computerSelectedGraphics=function(){if(this.props.onSelectedGraphicsChanged){for(var e=this.props.jimuMapView.jimuLayerViews,t=Object.keys(e),n=[],o=0;o<t.length;o++){var i=e[t[o]].layerDataSourceId,s=a.DataSourceManager.getInstance().getDataSource(i);if(s)for(var r=s.getSelectedRecords(),p=0;p<r.length;p++){var l=r[p].feature.clone();n.push(l)}}this.props.onSelectedGraphicsChanged(n)}},t.prototype.render=function(){return null},t}(a.React.PureComponent),nt=a.ReactRedux.connect((function(e,t){return e.appStateInBuilder?{dataSourcesInfo:e.appStateInBuilder&&e.appStateInBuilder.dataSourcesInfo,viewInfos:e.appStateInBuilder&&e.appStateInBuilder.jimuMapViewsInfo}:{dataSourcesInfo:e&&e.dataSourcesInfo,viewInfos:e&&e.jimuMapViewsInfo}}))(tt),ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),it=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},at=n(131),st=n(115),rt={Zoom:z,Home:F,Navigation:$,Locate:Q,Compass:q,Search:oe,Layers:se,BaseMap:ce,Measure:je,MapSwitch:fe,FullScreen:we,ScaleBar:ye,Attribution:Se,Select:$e,SelectState:function(e){function t(t){var n=e.call(this,t)||this;return n.toolName="SelectState",n.handleSelectedGraphicsChanged=function(e){n.setState({selectedGraphics:e})},n.zoomToSelectedFeatures=function(){n.props.jimuMapView.view&&n.props.jimuMapView.view.goTo(n.state.selectedGraphics)},n.clearSelectedFeatures=function(){n.props.jimuMapView.clearSelectedFeatures()},n.state={selectedGraphics:[]},n}return ot(t,e),t.prototype.getStyle=function(){return Object(a.css)(v||(v=it(["\n      background-color: ",";\n\n      .divide-line {\n        border-right: 1px solid ",";\n        height: 100%;\n      }\n    "],["\n      background-color: ",";\n\n      .divide-line {\n        border-right: 1px solid ",";\n        height: 100%;\n      }\n    "])),this.props.theme.arcgis.components.button.variants.default.default.bg,this.props.theme.colors.palette.dark[400])},t.prototype.getTitle=function(){return""},t.prototype.getIcon=function(){return null},t.prototype.getExpandPanel=function(){return this.props.isMobile?Object(a.jsx)("div",{css:this.getStyle(),className:"w-100 d-flex justify-content-between align-items-center",style:{height:"40px"}},Object(a.jsx)("div",{className:"ml-2"},this.props.intl.formatMessage({id:"SelectionSelectedFeatures",defaultMessage:r.defaultMessages.SelectionSelectedFeatures})+":"+this.state.selectedGraphics.length),Object(a.jsx)("div",{className:"d-flex"},Object(a.jsx)("div",{className:"h-100 border border-top-0 border-bottom-0 d-flex justify-content-center align-items-center",style:{width:"40px",cursor:"pointer"},onClick:this.zoomToSelectedFeatures},Object(a.jsx)(r.Icon,{width:18,height:18,icon:at})),Object(a.jsx)("div",{className:"h-100 d-flex justify-content-center align-items-center",style:{width:"40px",cursor:"pointer"},onClick:this.clearSelectedFeatures},Object(a.jsx)(r.Icon,{width:18,height:18,icon:st}))),Object(a.jsx)(nt,{jimuMapView:this.props.jimuMapView,onSelectedGraphicsChanged:this.handleSelectedGraphicsChanged})):Object(a.jsx)(a.React.Fragment,null,Object(a.jsx)(r.Button,{onClick:this.zoomToSelectedFeatures},Object(a.jsx)(r.Icon,{width:16,height:16,icon:at,className:"mr-2"}),this.props.intl.formatMessage({id:"SelectionSelectedFeatures",defaultMessage:r.defaultMessages.SelectionSelectedFeatures})+":"+this.state.selectedGraphics.length),Object(a.jsx)(nt,{jimuMapView:this.props.jimuMapView,onSelectedGraphicsChanged:this.handleSelectedGraphicsChanged}))},t}(_)},pt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),lt=function(e){function t(t){return e.call(this,t)||this}return pt(t,e),t.prototype.componentDidMount=function(){var e=this.refs.baseToolInstance;(!rt[this.props.toolName].getIsNeedSetting()||this.props.toolConfig&&this.props.toolConfig["can"+this.props.toolName])&&(this.props.jimuMapView.view.ui.exbMapTools[this.props.toolName]=e)},t.prototype.componentWillUnmount=function(){if(rt[this.props.toolName].getIsNeedSetting()){var e=this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.exbMapTools[this.props.toolName];e&&e.destroy&&(e.destroy(),delete this.props.jimuMapView.view.ui.exbMapTools[this.props.toolName])}},t.prototype.render=function(){var e=rt[this.props.toolName];return e?Object(a.jsx)("div",{className:Object(a.classNames)(this.props.className,"exbmap-ui exbmap-ui-tool-shell divitem",this.props.layoutConfig.elements[this.props.toolName].className,{"exbmap-ui-hidden-element":this.props.isHidden,"mb-0 mr-0":this.props.isLastElement,"rounded-pill":["Compass"].indexOf(this.props.toolName)>-1}),style:this.props.layoutConfig.elements[this.props.toolName].style},Object(a.jsx)(e,{ref:"baseToolInstance",toolJson:this.props.layoutConfig.elements[this.props.toolName],toolName:this.props.toolName,isMobile:this.props.isMobile,jimuMapView:this.props.jimuMapView,activeToolInfo:this.props.activeToolInfo,onActiveToolInfoChange:this.props.onActiveToolInfoChange,intl:this.props.intl,theme:this.props.theme})):this.props.isMobile?Object(a.jsx)("span",null):null},t}(C),ct=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ut=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},dt=function(e){function t(n){var o=e.call(this,n)||this;return o.moveY=0,o.startY=0,o.sliding=!1,o.startDrag=!1,o.currentBottomPanelHeight=0,o.thumbMapElementNames=["FullScreen","Zoom","MapSwitch"],o.checkIsHiddenElement=function(e){return!!o.props.hiddenElementNames&&o.props.hiddenElementNames.indexOf(e)>-1},o.start=function(e,t){if(o.startDrag=!0,"touch"===t){o.moveY=0;var n=e.touches[0];o.startY=n.clientY}"mouse"===t&&(o.moveY=0,o.startY=e.clientY),document.getElementById(o.props.jimuMapView.id+"-bottom-panel").classList.remove("expand-mobile-panel-transition")},o.move=function(e,t){if("touch"===t){o.sliding=!0;var n=e.touches[0];o.moveY=-1*(n.clientY-o.startY)}if("mouse"===t&&o.startDrag&&(o.sliding=!0,o.moveY=-1*(e.clientY-o.startY)),"mouse"!==t||o.startDrag){var i=150;o.state.bottomPanelHeight+o.moveY>i&&(i=o.state.bottomPanelHeight+o.moveY),document.getElementById(o.props.jimuMapView.id+"-bottom-panel").style.height=i+"px",o.currentBottomPanelHeight=i;var a=o.state.widgetHeight-i;a>360&&o.props.onSetHiddenElementNames([]),a>200&&a<=360&&o.props.onSetHiddenElementNames(o.props.layoutConfig.mobileResponsiveStrategy.stage1),a>54&&a<=200&&o.props.onSetHiddenElementNames(o.props.layoutConfig.mobileResponsiveStrategy.stage2),a<54&&o.props.onSetHiddenElementNames(o.props.layoutConfig.mobileResponsiveStrategy.stage3)}},o.end=function(e,t){if("mouse"!==t||o.startDrag){if(o.startDrag=!1,o.sliding=!1,document.getElementById(o.props.jimuMapView.id+"-bottom-panel").classList.add("expand-mobile-panel-transition"),"touch"===t&&Math.abs(o.moveY)<10)return document.getElementById(o.props.jimuMapView.id+"-bottom-panel").style.height=o.state.bottomPanelHeight+"px",void(o.currentBottomPanelHeight=o.state.bottomPanelHeight);if(o.moveY>=0){var n=0;n=o.currentBottomPanelHeight>=150&&o.currentBottomPanelHeight<.6*o.state.widgetHeight?.6*o.state.widgetHeight:o.currentBottomPanelHeight>=.6*o.state.widgetHeight&&o.currentBottomPanelHeight<o.state.widgetHeight?o.state.widgetHeight-20:150,o.setState({bottomPanelHeight:n},(function(){o.checkResponsive()})),o.currentBottomPanelHeight=n}else{n=0;n=o.currentBottomPanelHeight>150&&o.currentBottomPanelHeight<.6*o.state.widgetHeight?150:o.currentBottomPanelHeight>=.6*o.state.widgetHeight&&o.currentBottomPanelHeight<o.state.widgetHeight?.6*o.state.widgetHeight:150,o.setState({bottomPanelHeight:n},(function(){o.checkResponsive()})),o.currentBottomPanelHeight=n}}},o.checkResponsive=function(){if(o.state.isThumbMap)o.props.onSetHiddenElementNames([]);else if(0!==o.state.bottomPanelHeight){var e=o.state.widgetHeight-o.state.bottomPanelHeight;e>360&&o.props.onSetHiddenElementNames([]),e>200&&e<=360&&o.props.onSetHiddenElementNames(o.props.layoutConfig.mobileResponsiveStrategy.stage1),e>54&&e<=200&&o.props.onSetHiddenElementNames(o.props.layoutConfig.mobileResponsiveStrategy.stage2),e<54&&o.props.onSetHiddenElementNames(o.props.layoutConfig.mobileResponsiveStrategy.stage3)}else o.props.onSetHiddenElementNames([])},o.onResize=function(e,t){e&&t&&o.setState({widgetWidth:e,widgetHeight:t,isThumbMap:!1},(function(){o.checkResponsive()}))},o.returnNullNode=function(e){return o.props.isMobile?Object(a.jsx)("span",{key:e}):null},o.checkIsLastElement=function(e,t){var n=t.toolName,i=o.props.layoutConfig,a=i.layout[e.groupName].children,s=a.indexOf(n);if(s===a.length-1)return!0;if(s<a.length-1){for(var r=!0,p=s+1;p<a.length;p++){var l=a[p];if("GROUP"!==i.elements[a[p]].type&&(!rt[l].getIsNeedSetting()||o.props.toolConfig&&o.props.toolConfig["can"+l]||i.lockToolNames&&i.lockToolNames.indexOf(l)>-1)){r=!1;break}}return r}},o.handleToggleMobilePanel=function(){o.props.onActiveToolInfoChange(null)},o.handlePanelHeightChange=function(e,t){o.setState({bottomPanelHeight:t},(function(){o.checkResponsive()}))},o.getMobilePanelInContext=function(){return Object(a.jsx)(l.Consumer,null,(function(e){var t=e.mobilePanelContainer,n=e.mapWidgetId;return Object(a.jsx)(r.MobilePanel,{mapWidgetId:n,title:o.props.activeToolInfo&&o.props.activeToolInfo.activeToolTitle,open:!!o.props.activeToolInfo,toggle:function(){o.handleToggleMobilePanel()}},Object(a.jsx)("div",{className:"w-100 h-100",ref:function(e){t&&e&&e.appendChild(t)}}))}))},o.getGroupContent=function(e){if(e){var n=e.layout[o.props.groupName]&&e.layout[o.props.groupName].children;return o.checkIsShowGroup(e,n)?Object(a.jsx)("div",{id:o.props.isMainGroup?o.props.mapWidgetId:void 0,css:o.getStyle(),className:Object(a.classNames)("exbmap-ui exbmap-ui-group",o.props.className,{"exbmap-ui-hidden-element":o.props.isHidden}),style:o.props.style},n.map((function(n,i){return e.elements[n]?"GROUP"===e.elements[n].type?Object(a.jsx)(t,{mapWidgetId:o.props.mapWidgetId,isHidden:o.checkIsHiddenElement(n),className:e.elements[n].className,style:e.elements[n].style,key:i,layoutConfig:e,toolConfig:o.props.toolConfig,isMobile:o.props.isMobile,intl:o.props.intl,jimuMapView:o.props.jimuMapView,groupName:n,activeToolInfo:o.props.activeToolInfo,hiddenElementNames:o.props.hiddenElementNames,onActiveToolInfoChange:o.props.onActiveToolInfoChange,theme:o.props.theme,isThumbMap:o.props.isMainGroup?o.state.isThumbMap:o.props.isThumbMap}):"TOOL"===e.elements[n].type?"Navigation"===e.elements[n].toolName&&o.props.jimuMapView&&o.props.jimuMapView.view&&"2d"===o.props.jimuMapView.view.type?o.returnNullNode(i):!rt[n].getIsNeedSetting()||o.props.toolConfig&&o.props.toolConfig["can"+n]||e.lockToolNames&&e.lockToolNames.indexOf(n)>-1?Object(a.jsx)(lt,{isHidden:o.checkIsHiddenElement(n),key:i,layoutConfig:e,activeToolInfo:o.props.activeToolInfo,toolConfig:o.props.toolConfig,jimuMapView:o.props.jimuMapView,toolName:n,theme:o.props.theme,onActiveToolInfoChange:o.props.onActiveToolInfoChange,intl:o.props.intl,isMobile:o.props.isMobile,isLastElement:o.checkIsLastElement(e.elements[o.props.groupName],e.elements[n])}):o.returnNullNode(i):o.returnNullNode(i):o.returnNullNode(i)})),o.props.isMobile&&o.props.isMainGroup&&Object(a.jsx)(a.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:o.onResize}),o.props.isMainGroup&&o.props.isMobile&&o.props.activeToolInfo&&"Select"!==o.props.activeToolInfo.activeToolName&&o.getMobilePanelInContext(),o.props.isMainGroup&&Object(a.jsx)("div",{className:"exbmap-ui w-100",style:{position:"relative",pointerEvents:"auto",overflow:"hidden",touchAction:"none",display:!o.props.isMobile||o.state.isThumbMap||o.props.isThumbMap?"none":"block"}},Object(a.jsx)("div",{className:o.props.mapWidgetId+"-bottom-panel exbmap-ui w-100 expand-mobile-panel",style:{overflow:"hidden",pointerEvents:"auto",position:"relative",touchAction:"none"}},Object(a.jsx)("div",{className:"w-100 h-100"},Object(a.jsx)(a.ReactResizeDetector,{handleHeight:!0,onResize:o.handlePanelHeightChange}))))):o.returnNullNode()}return o.returnNullNode()},o.checkIsShowGroup=function(e,t){if(t&&0!==t.length){var n=[];o.findAllToolNames(e,t,n);for(var i=!1,a=0;a<n.length;a++)if(o.props.toolConfig["can"+n[a]]||!rt[n[a]].getIsNeedSetting()||e.lockToolNames&&e.lockToolNames.indexOf(n[a])>-1){i=!0;break}return i}return!1},o.findAllToolNames=function(e,t,n){if(t&&0!==t.length)for(var i=0;i<t.length;i++)if("GROUP"===e.elements[t[i]].type){var a=e.elements[t[i]].groupName;o.findAllToolNames(e,e.layout[a]&&e.layout[a].children,n)}else n.push(t[i])},o.state={bottomPanelHeight:0,isThumbMap:!!o.props.isMobile},o}return ct(t,e),t.prototype.getStyle=function(){var e=this.props.layoutConfig.layout[this.props.groupName]&&this.props.layoutConfig.layout[this.props.groupName].position,t=this.props.layoutConfig.elements[this.props.groupName].direction;return Object(a.css)(M||(M=ut(["\n      position: ",";\n      top: ","px;\n      bottom: ","px;\n      left: ","px;\n      right: ","px;\n      display: flex;\n      flex-flow: ",";\n      align-items: flex-start;\n\n      > .exbmap-ui + .exbmap-ui {\n        margin-top: ",";\n        margin-left: ",";\n      }\n\n      .exbmap-ui-group-expand-icon {\n        fill: black;\n        left: 8px;\n        top: 8px;\n        position: absolute;\n        display: block;\n      }\n\n      .expand-mobile-panel {\n        box-shadow: rgba(0, 0, 0, 0.3) 0px 0px 2px;\n        border-radius: 10px 10px 0px 0px;\n      }\n\n      .expand-mobile-panel-transition {\n        transition: height 0.3s;\n      }\n\n      .expand-mobile-panel-touch-container {\n        top: 0;\n        position: absolute;\n        width: 100%;\n        height: 31px;\n      }\n\n      .expand-mobile-panel-bar {\n        width: 36px;\n        height: 4px;\n        background-color: #434343;\n        border-radius: 2px;\n      }\n      "],["\n      position: ",";\n      top: ","px;\n      bottom: ","px;\n      left: ","px;\n      right: ","px;\n      display: flex;\n      flex-flow: ",";\n      align-items: flex-start;\n\n      > .exbmap-ui + .exbmap-ui {\n        margin-top: ",";\n        margin-left: ",";\n      }\n\n      .exbmap-ui-group-expand-icon {\n        fill: black;\n        left: 8px;\n        top: 8px;\n        position: absolute;\n        display: block;\n      }\n\n      .expand-mobile-panel {\n        box-shadow: rgba(0, 0, 0, 0.3) 0px 0px 2px;\n        border-radius: 10px 10px 0px 0px;\n      }\n\n      .expand-mobile-panel-transition {\n        transition: height 0.3s;\n      }\n\n      .expand-mobile-panel-touch-container {\n        top: 0;\n        position: absolute;\n        width: 100%;\n        height: 31px;\n      }\n\n      .expand-mobile-panel-bar {\n        width: 36px;\n        height: 4px;\n        background-color: #434343;\n        border-radius: 2px;\n      }\n      "])),e?"absolute":"relative",e?e.top:null,e?e.bottom:null,e?e.left:null,e?e.right:null,"vertical"===t?"column":"row","vertical"===t?"10px":0,"horizontal"===t?"10px":0)},t.prototype.componentDidUpdate=function(e,t){var n=this;if(this.props.activeToolInfo!==e.activeToolInfo){if(this.props.activeToolInfo&&e.activeToolInfo)return;this.props.activeToolInfo&&!e.activeToolInfo&&this.props.isMobile&&this.props.isMainGroup&&(this.setState({bottomPanelHeight:150},(function(){n.checkResponsive()})),this.currentBottomPanelHeight=150),!this.props.activeToolInfo&&e.activeToolInfo&&this.props.isMobile&&this.props.isMainGroup&&(this.setState({bottomPanelHeight:0},(function(){n.checkResponsive()})),this.currentBottomPanelHeight=0)}},t.prototype.render=function(){return this.props.isMainGroup&&this.props.isMobile&&this.props.toolConfig&&this.props.toolConfig.canSelect?Object(a.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0}},Object(a.jsx)("div",{id:this.props.mapWidgetId+"-with-select-container",style:{position:"absolute",top:0,left:0,bottom:40,right:0}},Object(a.jsx)("div",{className:"w-100 h-100",style:{position:"relative"}},this.getGroupContent(this.props.layoutConfig))),Object(a.jsx)("div",{style:{position:"absolute",left:0,bottom:0,right:0,height:40}},Object(a.jsx)("div",{className:"w-100 h-100",style:{position:"relative"}},Object(a.jsx)(lt,{isHidden:!1,layoutConfig:this.props.layoutConfig,activeToolInfo:this.props.activeToolInfo,toolConfig:this.props.toolConfig,jimuMapView:this.props.jimuMapView,toolName:"SelectState",theme:this.props.theme,onActiveToolInfoChange:this.props.onActiveToolInfoChange,intl:this.props.intl,isMobile:this.props.isMobile,isLastElement:!0})))):this.getGroupContent(this.props.layoutConfig)},t}(C),ht=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),mt=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},ft=function(e){function t(t){var n=e.call(this,t)||this;return n.cloneLayoutRef=null,n.getMaxHeightForPcExpand=function(e){if(e){if(e<65)return null;var t=e-65;return t<300?t:300}return null},n.handSetHiddenElementNames=function(e){n.setState({hiddenElementNames:e})},n.getLayoutContent=function(e){return e&&n.props.toolConfig?Object(a.jsx)("div",{css:n.getStyle()},Object.keys(e.layout).map((function(t,o){return e.elements[t]&&"GROUP"===e.elements[t].type&&e.layout[t].position?Object(a.jsx)(dt,{mapWidgetId:n.props.mapWidgetId,className:e.elements[t].className,style:e.elements[t].style,isResponsive:e.elements[t].isResponsive,isMobile:n.props.isMobile,isMainGroup:!0,key:o,layoutConfig:e,toolConfig:n.props.toolConfig,activeToolInfo:n.props.activeToolInfo,jimuMapView:n.props.jimuMapView,groupName:t,onActiveToolInfoChange:n.props.onActiveToolInfoChange,hiddenElementNames:e.mobileResponsiveStrategy&&n.state.hiddenElementNames,intl:n.props.intl,onSetHiddenElementNames:n.handSetHiddenElementNames,theme:n.props.theme}):null}))):null},n.state={toolsContentInMobileExpandPanel:null,hiddenElementNames:[]},n.contentRef=document.createElement("div"),n.contentRef.className="exbmap-ui esri-ui-inner-container exbmap-ui-layout",n}return ht(t,e),t.prototype.getStyle=function(){return Object(a.css)(S||(S=mt(['\n      z-index: 0;\n\n      .expand-panel-transition {\n        transition: opacity 0.3s, right 0.3s;\n      }\n\n      .scale-attribution-xy-group {\n        > div:first-of-type:nth-last-of-type(1) {\n          width: 100%;\n          max-width: 100% !important;\n        }\n      }\n\n      .exbmap-ui-hidden-element {\n        display: none !important;\n      }\n/* \n      .exbmap-basetool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:after {\n        background-color: #6e6e6e;\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      } */\n\n      .exbmap-ui-pc-expand-maxheight {\n        max-height: ',"px;\n        overflow: auto\n      }\n      "],['\n      z-index: 0;\n\n      .expand-panel-transition {\n        transition: opacity 0.3s, right 0.3s;\n      }\n\n      .scale-attribution-xy-group {\n        > div:first-of-type:nth-last-of-type(1) {\n          width: 100%;\n          max-width: 100% !important;\n        }\n      }\n\n      .exbmap-ui-hidden-element {\n        display: none !important;\n      }\n/* \n      .exbmap-basetool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:before {\n        background-color: rgba(110,110,110,0.3);\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:after {\n        background-color: #6e6e6e;\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      } */\n\n      .exbmap-ui-pc-expand-maxheight {\n        max-height: ',"px;\n        overflow: auto\n      }\n      "])),this.getMaxHeightForPcExpand(this.props.widgetHeight))},t.prototype.componentDidMount=function(){this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.container&&this.props.jimuMapView.view.ui.container.appendChild(this.contentRef)},t.prototype.componentDidUpdate=function(e){var t,n,o=this;if(e.appMode!==this.props.appMode&&this.props.appMode===a.AppMode.Design&&this.props.onActiveToolInfoChange(null),e.jimuMapView&&e.jimuMapView.view&&e.jimuMapView.view.ui){var i=e.jimuMapView.view.ui.container.getElementsByClassName("tool-layout-clone");if(i&&i.length>0)for(var s=0;s<i.length;s++)i[s].remove()}(null===(t=e.jimuMapView)||void 0===t?void 0:t.id)!==(null===(n=this.props.jimuMapView)||void 0===n?void 0:n.id)&&(this.cloneLayoutRef=this.contentRef.cloneNode(!0),this.cloneLayoutRef.classList.add("tool-layout-clone"),setTimeout((function(){o.cloneLayoutRef&&o.cloneLayoutRef.parentNode&&o.cloneLayoutRef.parentNode.removeChild(o.cloneLayoutRef),o.cloneLayoutRef=null}),500),e.jimuMapView.view&&e.jimuMapView.view.ui&&e.jimuMapView.view.ui.container&&(e.jimuMapView.view.ui.container.appendChild(this.cloneLayoutRef),e.jimuMapView.view.ui.container.removeChild(this.contentRef)),this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.container&&this.props.jimuMapView.view.ui.container.appendChild(this.contentRef))},t.prototype.render=function(){return this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.container?Object(a.jsx)("div",null,a.ReactDOM.createPortal(this.getLayoutContent(this.props.layoutConfig),this.contentRef)):null},t}(a.React.PureComponent),gt=[{elements:{leftTopContainer:{type:"GROUP",groupName:"leftTopContainer",direction:"horizontal"},navigator:{type:"GROUP",groupName:"navigator",direction:"vertical"},interact:{type:"GROUP",groupName:"interact",direction:"vertical",isResponsive:!0},bottom:{type:"GROUP",groupName:"bottom",direction:"vertical",className:"w-100"},"bottom-line1":{type:"GROUP",groupName:"bottom-line1",direction:"horizontal",className:"d-flex align-items-center justify-content-between w-100 scale-attribution-xy-group",style:{marginBottom:0,marginTop:0}},"bottom-line2":{type:"GROUP",groupName:"bottom-line2",direction:"horizontal",className:"d-flex align-items-end justify-content-between w-100",style:{paddingLeft:"15px",paddingRight:"15px",marginBottom:"10px"}},"SelectState-FullScreen-Container":{type:"GROUP",groupName:"SelectState-FullScreen-Container",direction:"vertical",className:"align-items-end"},attributionGroup:{type:"GROUP",groupName:"attributionGroup",direction:"horizontal",style:{maxWidth:"60%"}},Zoom:{type:"TOOL",toolName:"Zoom",isOnlyExpanded:!0,isShowIconTitle:!1},Home:{type:"TOOL",toolName:"Home",isOnlyExpanded:!0,isShowIconTitle:!1},Compass:{type:"TOOL",toolName:"Compass",isOnlyExpanded:!0,isShowIconTitle:!1},Navigation:{type:"TOOL",toolName:"Navigation",isOnlyExpanded:!0,isShowIconTitle:!1},Locate:{type:"TOOL",toolName:"Locate",isOnlyExpanded:!0,isShowIconTitle:!1},Layers:{type:"TOOL",toolName:"Layers",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},BaseMap:{type:"TOOL",toolName:"BaseMap",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},Select:{type:"TOOL",toolName:"Select",isOnlyExpanded:!0,isShowIconTitle:!0},SelectState:{type:"TOOL",toolName:"SelectState",isOnlyExpanded:!0,isShowIconTitle:!1,style:{boxShadow:"0 1px 2px 0 rgba(0,0,0,0)"}},Measure:{type:"TOOL",toolName:"Measure",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},MapSwitch:{type:"TOOL",toolName:"MapSwitch",isOnlyExpanded:!0,isShowIconTitle:!0},FullScreen:{type:"TOOL",toolName:"FullScreen",isOnlyExpanded:!1,isShowIconTitle:!0},ScaleBar:{type:"TOOL",toolName:"ScaleBar",isOnlyExpanded:!0,isShowIconTitle:!1},Attribution:{type:"TOOL",toolName:"Attribution",isOnlyExpanded:!0,isShowIconTitle:!1,className:"w-100"},Search:{type:"TOOL",toolName:"Search",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"}},layout:{leftTopContainer:{children:["navigator","Select"],position:{top:15,left:15}},navigator:{children:["Zoom","Home","Navigation","Locate","Compass"]},interact:{children:["Search","Layers","BaseMap","Measure"],position:{top:15,right:15}},"bottom-line1":{children:["ScaleBar","attributionGroup"]},"bottom-line2":{children:["MapSwitch","SelectState-FullScreen-Container"]},"SelectState-FullScreen-Container":{children:["FullScreen","SelectState"]},bottom:{children:["bottom-line2","bottom-line1"],position:{bottom:0,left:0}},attributionGroup:{children:["Attribution"]}}},{elements:{navigator:{type:"GROUP",groupName:"navigator",direction:"vertical",className:"align-items-end"},interact:{type:"GROUP",groupName:"interact",direction:"horizontal",isResponsive:!0},fullScreenGroup:{type:"GROUP",groupName:"fullScreenGroup",direction:"horizontal"},bottom:{type:"GROUP",groupName:"bottom",direction:"vertical",className:"w-100"},"bottom-line1":{type:"GROUP",groupName:"bottom-line1",direction:"horizontal",className:"d-flex align-items-center justify-content-between w-100 scale-attribution-xy-group",style:{marginBottom:0,marginTop:0}},"bottom-line2":{type:"GROUP",groupName:"bottom-line2",direction:"horizontal",className:"d-flex align-items-end justify-content-between w-100",style:{paddingLeft:"15px",paddingRight:"15px",marginBottom:"10px"}},attributionGroup:{type:"GROUP",groupName:"attributionGroup",direction:"horizontal",style:{maxWidth:"60%"},className:"attibute-group"},Zoom:{type:"TOOL",toolName:"Zoom",isOnlyExpanded:!0,isShowIconTitle:!1},Home:{type:"TOOL",toolName:"Home",isOnlyExpanded:!0,isShowIconTitle:!1},Compass:{type:"TOOL",toolName:"Compass",isOnlyExpanded:!0,isShowIconTitle:!1},Navigation:{type:"TOOL",toolName:"Navigation",isOnlyExpanded:!0,isShowIconTitle:!1},Locate:{type:"TOOL",toolName:"Locate",isOnlyExpanded:!0,isShowIconTitle:!1},Layers:{type:"TOOL",toolName:"Layers",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"},BaseMap:{type:"TOOL",toolName:"BaseMap",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"},Select:{type:"TOOL",toolName:"Select",isOnlyExpanded:!0,isShowIconTitle:!0},SelectState:{type:"TOOL",toolName:"SelectState",isOnlyExpanded:!0,isShowIconTitle:!1,style:{boxShadow:"0 1px 2px 0 rgba(0,0,0,0)"}},Measure:{type:"TOOL",toolName:"Measure",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"},MapSwitch:{type:"TOOL",toolName:"MapSwitch",isOnlyExpanded:!0,isShowIconTitle:!0},FullScreen:{type:"TOOL",toolName:"FullScreen",isOnlyExpanded:!1,isShowIconTitle:!0},ScaleBar:{type:"TOOL",toolName:"ScaleBar",isOnlyExpanded:!0,isShowIconTitle:!1},Attribution:{type:"TOOL",toolName:"Attribution",isOnlyExpanded:!0,isShowIconTitle:!1,className:"w-100"},Search:{type:"TOOL",toolName:"Search",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"}},layout:{navigator:{children:["Compass","Locate","Navigation","Zoom","Home","SelectState"]},interact:{children:["Search","Layers","BaseMap","Measure","Select"],position:{top:15,left:15}},fullScreenGroup:{children:["FullScreen"],position:{top:15,right:15}},"bottom-line1":{children:["ScaleBar","attributionGroup"]},"bottom-line2":{children:["MapSwitch","navigator"]},bottom:{children:["bottom-line2","bottom-line1"],position:{bottom:0,left:0}},attributionGroup:{children:["Attribution"]}}}],wt=[{elements:{mainGroup:{type:"GROUP",groupName:"mainGroup",direction:"vertical",style:{position:"absolute"},className:"d-flex flex-column"},topGroup:{type:"GROUP",groupName:"topGroup",direction:"horizontal",className:"d-flex w-100 align-items-center justify-content-between",style:{padding:"10px"}},midGroup:{type:"GROUP",groupName:"midGroup",direction:"horizontal",className:"flex-grow-1 d-flex w-100 justify-content-between",style:{position:"relative"}},"midGroup-left":{type:"GROUP",groupName:"midGroup-left",direction:"vertical",className:"h-100 d-flex flex-column-reverse",style:{paddingLeft:"10px",paddingRight:"10px",paddingBottom:"10px",position:"absolute",top:0,left:0,bottom:0}},"midGroup-left-content":{type:"GROUP",groupName:"midGroup-left-content",direction:"vertical"},"midGroup-right":{type:"GROUP",groupName:"midGroup-right",direction:"vertical",className:"h-100 d-flex flex-column justify-content-between",style:{paddingRight:"10px",paddingLeft:"10px",paddingBottom:"10px",position:"absolute",top:0,right:0,bottom:0}},"midGroup-right-content-top":{type:"GROUP",groupName:"midGroup-right-content-top",direction:"vertical"},"midGroup-right-content-bottom":{type:"GROUP",groupName:"midGroup-right-content-bottom",direction:"vertical"},bottomGroup:{type:"GROUP",groupName:"bottomGroup",direction:"vertical"},Search:{type:"TOOL",toolName:"Search",isOnlyExpanded:!0,isShowIconTitle:!1,className:"flex-grow-1"},FullScreen:{type:"TOOL",toolName:"FullScreen",isOnlyExpanded:!1,isShowIconTitle:!0},Locate:{type:"TOOL",toolName:"Locate",isOnlyExpanded:!0,isShowIconTitle:!1},Compass:{type:"TOOL",toolName:"Compass",isOnlyExpanded:!0,isShowIconTitle:!1,className:"mb-0"},MapSwitch:{type:"TOOL",toolName:"MapSwitch",isOnlyExpanded:!0,isShowIconTitle:!0},Zoom:{type:"TOOL",toolName:"Zoom",isOnlyExpanded:!0,isShowIconTitle:!1},Home:{type:"TOOL",toolName:"Home",isOnlyExpanded:!0,isShowIconTitle:!1},Layers:{type:"TOOL",toolName:"Layers",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},BaseMap:{type:"TOOL",toolName:"BaseMap",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},Select:{type:"TOOL",toolName:"Select",isOnlyExpanded:!0,isShowIconTitle:!1},SelectState:{type:"TOOL",toolName:"SelectState",isOnlyExpanded:!0,isShowIconTitle:!1},Measure:{type:"TOOL",toolName:"Measure",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"}},layout:{mainGroup:{children:["topGroup","midGroup","bottomGroup"],position:{top:0,left:0,bottom:0,right:0}},topGroup:{children:["Search","FullScreen"]},midGroup:{children:["midGroup-left","midGroup-right"]},"midGroup-left":{children:["midGroup-left-content"]},"midGroup-left-content":{children:["Compass","MapSwitch"]},"midGroup-right":{children:["midGroup-right-content-top","midGroup-right-content-bottom"]},"midGroup-right-content-top":{children:["Layers","BaseMap","Measure","Select"]},"midGroup-right-content-bottom":{children:["Zoom","Home","Locate"]}},mobileResponsiveStrategy:{stage1:["midGroup-left-content","midGroup-right-content-bottom"],stage2:["midGroup-left-content","midGroup-right-content-bottom","midGroup-right-content-top"],stage3:["topGroup","midGroup-left-content","midGroup-right-content-bottom","midGroup-right-content-top"]},lockToolNames:[]}],bt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),yt={firstMapVisible:[{zIndex:6,opacity:1},{zIndex:5,opacity:0}],secondMapVisible:[{zIndex:5,opacity:0},{zIndex:6,opacity:1}]},vt=function(e){function t(t){var n=e.call(this,t)||this;n.mutableStatePropsMap={},n.__unmount=!1,n.reInitWidgetInstance=function(e){n.state=e,n.isReIniting=!0},n.changeInitialMapDataSourceID=function(e,t){if(n.props.baseWidgetProps.useDataSources&&n.props.baseWidgetProps.useDataSources.length>1){var o=n.refs.firstMapInstance,i=n.refs.secondMapInstance;n.state.currentMapIndex?n.state.firstMapDsId&&n.state.firstMapDsId===e?(n.startChangeInitialMapAnimation(t),o.goHome(!1)):i.goHome(!1):n.state.secondMapDsId&&n.state.secondMapDsId===e?(n.startChangeInitialMapAnimation(t),i.goHome(!1)):o.goHome(!1)}},n.startChangeInitialMapAnimation=function(e){var t,o=Object.assign({},n.state),i=n.refs.firstMapInstance,a=n.refs.secondMapInstance;n.state.currentMapIndex?(o.currentMapIndex=0,o.multiMapStyle=yt.firstMapVisible,(t=a&&a.getViewPoint&&a.getViewPoint())&&i&&i.setViewPoint&&i.setViewPoint(t),n.setState(o,(function(){e()}))):(o.currentMapIndex=1,o.multiMapStyle=yt.secondMapVisible,(t=i&&i.getViewPoint&&i.getViewPoint())&&a&&a.setViewPoint&&a.setViewPoint(t),n.setState(o,(function(){e()})))},n.switchMap=function(){if(!n.props.baseWidgetProps.useDataSources||n.props.baseWidgetProps.useDataSources.length<2)return Promise.resolve();var e=Object.assign({},n.state);e.useAnimation=!0;var t,o=n.refs.firstMapInstance,i=n.refs.secondMapInstance;n.state.currentMapIndex?(e.currentMapIndex=0,e.multiMapStyle=yt.firstMapVisible,(t=i&&i.getViewPoint&&i.getViewPoint())&&o&&o.setViewPoint&&o.setViewPoint(t)):(e.currentMapIndex=1,e.multiMapStyle=yt.secondMapVisible,(t=o&&o.getViewPoint&&o.getViewPoint())&&i&&i.setViewPoint&&i.setViewPoint(t));if(o&&i){var a=o.getViewType(),s=i.getViewType();a&&s&&a!==s&&(o.goToTilt(0),i.goToTilt(0),n.state.currentMapIndex?setTimeout((function(){o.goToTilt(45)}),300):setTimeout((function(){i.goToTilt(45)}),300))}return new Promise((function(t,o){n.setState(e,(function(){n.confirmJimuMapViewIsActive(),setTimeout((function(){n.setState({useAnimation:!1},(function(){return t()}))}),500)}))}))},n.handleMutableStatePropsChanged=function(e,t,o){n.mutableStatePropsMap[t]?-1===n.mutableStatePropsMap[t].indexOf(e)&&n.mutableStatePropsMap[t].push(e):n.mutableStatePropsMap[t]=[e];var i=[],s=n.refs.firstMapInstance,r=n.refs.secondMapInstance;s&&s.getViewType()&&i.push(n.state.firstMapDsId),r&&r.getViewType()&&i.push(n.state.secondMapDsId);for(var p=!0,l=0;l<i.length;l++)if(-1===n.mutableStatePropsMap[t].indexOf(i[l])){p=!1;break}p&&(delete n.mutableStatePropsMap[t],a.MutableStoreManager.getInstance().updateStateValue(n.props.baseWidgetProps.id,t,o))},n.handleViewChanged=function(e){if(null===e.viewpoint){var t=n.refs.firstMapInstance,o=n.refs.secondMapInstance;return t&&t.goHome(!1),void(o&&o.goHome(!1))}var i=n.getCurrentVisibleDsId();if(i===e.dataSourceId){if(n.state.firstMapDsId&&n.state.firstMapDsId!==i)(t=n.refs.firstMapInstance)&&t.setViewPoint(e.viewpoint);if(n.state.secondMapDsId&&n.state.secondMapDsId!==i)(o=n.refs.secondMapInstance)&&o.setViewPoint(e.viewpoint)}},n.handleExtentChanged=function(e,t){n.getCurrentVisibleDsId()===e&&a.MessageManager.getInstance().publishMessage(t)},n.handleMapLoaded=function(e,t){n.forceUpdate()},n.handleJimuMapViewCreated=function(){n.__unmount||n.confirmJimuMapViewIsActive()},n.confirmJimuMapViewIsActive=function(){if(n.props.isDefaultMap){var e=n.props.baseWidgetProps.id+"-null";(a=s.MapViewManager.getInstance().getJimuMapViewById(e))&&n.setActiveJimuMapView(a,!0)}else{var t=[];n.state.firstMapDsId&&t.push(n.state.firstMapDsId),n.state.secondMapDsId&&t.push(n.state.secondMapDsId);for(var o=n.getCurrentVisibleDsId(),i=0;i<t.length;i++){var a;e=n.props.baseWidgetProps.id+"-"+t[i];(a=s.MapViewManager.getInstance().getJimuMapViewById(e))&&(t[i]===o?n.setActiveJimuMapView(a,!0):n.setActiveJimuMapView(a,!1))}}},n.isShowMapSwitchBtn=function(){var e=n.refs.firstMapInstance,t=n.refs.secondMapInstance;return!(!e||!t)&&(e.getMapLoadStatus()!==i.Loading&&t.getMapLoadStatus()!==i.Loading||void 0)},n.getCurrentVisibleDsId=function(){return 1===n.state.multiMapStyle[0].opacity?n.state.firstMapDsId:n.state.secondMapDsId},n.handleViewGroupCreate=function(e){n.props.onViewGroupCreate&&n.props.onViewGroupCreate(e)},n.handleMobilePanelContentChange=function(e){n.setState({mobilePanelContent:e})},n.handleActiveToolInfoChange=function(e){n.setState({activeToolInfo:e})},n.getLayoutConfig=function(){return"xsmall"===n.props.widthBreakpoint?wt[0]:n.props.baseWidgetProps.config.layoutIndex?gt[n.props.baseWidgetProps.config.layoutIndex]:gt[0]};var o,r=a.MutableStoreManager.getInstance().getStateValue([n.props.baseWidgetProps.id,"restoreData",n.props.baseWidgetProps.id+"-restoreData-multimap"]);r?((o=document.createElement("div")).id=n.props.baseWidgetProps.id+"-bottom-panel",o.className="w-100 h-100",r.mobilePanelContainer=o,n.reInitWidgetInstance(r),a.MutableStoreManager.getInstance().updateStateValue(n.props.baseWidgetProps.id,"restoreData."+n.props.baseWidgetProps.id+"-restoreData-multimap",null)):((o=document.createElement("div")).id=n.props.baseWidgetProps.id+"-bottom-panel",o.className="w-100 h-100",n.state={currentMapIndex:0,multiMapStyle:yt.firstMapVisible,firstMapDsId:null,secondMapDsId:null,useAnimation:!1,useDataSources:null,currentJimuMapViewId:null,mobilePanelContent:null,mobilePanelContainer:o,activeToolInfo:null});return n.mutableStatePropsMap={},n.useMapWidgetIds=n.props.baseWidgetProps.id?Object(a.Immutable)([n.props.baseWidgetProps.id]):Object(a.Immutable)([]),n}return bt(t,e),t.prototype.componentDidMount=function(){if(Object(a.getAppStore)().getState().mapWidgetsInfo&&(Object(a.getAppStore)().getState().mapWidgetsInfo[this.props.baseWidgetProps.id]||Object(a.getAppStore)().dispatch(a.appActions.MapWidgetInfoAdded(this.props.baseWidgetProps.id,Object(a.Immutable)({mapWidgetId:this.props.baseWidgetProps.id})))),this.__unmount=!1,!this.isReIniting&&this.props.baseWidgetProps.useDataSources){var e=this.props.baseWidgetProps.config.initialMapDataSourceID;e?e===(this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId)?this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId}):e===(this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId)?this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId}):this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId}):this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId})}},t.prototype.componentWillUnmount=function(){this.__unmount=!0;var e=Object(a.getAppStore)().getState().appConfig.widgets;if(e[this.props.baseWidgetProps.id]&&e[this.props.baseWidgetProps.id].useDataSources===this.props.baseWidgetProps.useDataSources){var t={currentMapIndex:this.state.currentMapIndex,multiMapStyle:this.state.multiMapStyle,firstMapDsId:this.state.firstMapDsId,secondMapDsId:this.state.secondMapDsId,useAnimation:this.state.useAnimation,currentJimuMapViewId:this.state.currentJimuMapViewId};a.MutableStoreManager.getInstance().updateStateValue(this.props.baseWidgetProps.id,"restoreData."+this.props.baseWidgetProps.id+"-restoreData-multimap",t)}e[this.props.baseWidgetProps.id]||Object(a.getAppStore)().dispatch(a.appActions.MapWidgetInfoRemoved(this.props.baseWidgetProps.id))},t.getDerivedStateFromProps=function(e,n){return e.baseWidgetProps.useDataSources!==n.useDataSources?t.getChangedState(n.firstMapDsId,n.secondMapDsId,e.baseWidgetProps.useDataSources):null},t.prototype.componentDidUpdate=function(e,t,n){if(this.props.baseWidgetProps.stateProps&&this.props.baseWidgetProps.stateProps.initialMapDataSourceID){var o=this.props.baseWidgetProps.stateProps.initialMapDataSourceID;if(this.state.firstMapDsId===o){var i=this.refs.firstMapInstance;i&&i.goHome(!1)}if(this.state.secondMapDsId===o){var s=this.refs.secondMapInstance;s&&s.goHome(!1)}this.props.baseWidgetProps.dispatch(a.appActions.widgetStatePropChange(this.props.baseWidgetProps.id,"initialMapDataSourceID",null))}this.isReIniting?this.isReIniting=!1:(this.props.baseWidgetProps.config.initialMapDataSourceID!==e.baseWidgetProps.config.initialMapDataSourceID&&this.changeInitialMapDataSourceID(this.props.baseWidgetProps.config.initialMapDataSourceID,this.confirmJimuMapViewIsActive),this.props.baseWidgetProps.useDataSources!==e.baseWidgetProps.useDataSources&&this.confirmJimuMapViewIsActive())},t.prototype.setActiveJimuMapView=function(e,t){t?(e.setIsActive(t),this.setState({currentJimuMapViewId:e.id})):e.setIsActive(t)},t.prototype.render=function(){var e=this;return a.React.createElement(l.Provider,{value:{mapWidgetId:this.props.baseWidgetProps.id,mapWidgetHeight:this.props.widgetHeight,isShowMapSwitchBtn:this.props.baseWidgetProps.useDataSources&&this.props.baseWidgetProps.useDataSources.length>1&&this.isShowMapSwitchBtn(),dataSourceIds:[this.state.firstMapDsId,this.state.secondMapDsId],activeDataSourceId:this.getCurrentVisibleDsId(),switchMap:this.switchMap,fullScreenMap:this.props.fullScreenMap,isFullScreen:this.props.isFullScreen,mobilePanelContainer:this.state.mobilePanelContainer,onMobilePanelContentChange:this.handleMobilePanelContentChange,initialMapState:this.props.baseWidgetProps.config&&this.props.baseWidgetProps.config.initialMapState}},!this.props.isDefaultMap&&a.React.createElement("div",{className:"jimu-widget",style:{position:"relative"}},a.React.createElement("div",{className:Object(a.classNames)("jimu-widget",{"multisourcemap-item-appear":this.state.useAnimation&&this.state.multiMapStyle[0].opacity,"multisourcemap-item-disappear":this.state.useAnimation&&!this.state.multiMapStyle[0].opacity,"multisourcemap-item-appear-noanimate":this.state.multiMapStyle[0].opacity,"multisourcemap-item-disappear-noanimate":!this.state.multiMapStyle[0].opacity}),style:{position:"absolute",zIndex:this.state.multiMapStyle[0].zIndex}},this.state.firstMapDsId&&a.React.createElement(I,{ref:"firstMapInstance",onViewChanged:this.handleViewChanged,baseWidgetProps:this.props.baseWidgetProps,onMapLoaded:this.handleMapLoaded,onMutableStatePropsChanged:this.handleMutableStatePropsChanged,onExtentChanged:function(t,n){e.handleExtentChanged(t,n)},onJimuMapViewCreated:this.handleJimuMapViewCreated,startLoadModules:this.props.startLoadModules,dataSourceId:this.state.firstMapDsId,widthBreakpoint:this.props.widthBreakpoint,isMapInVisibleArea:this.props.isMapInVisibleArea})),a.React.createElement("div",{className:Object(a.classNames)("jimu-widget",{"multisourcemap-item-appear":this.state.useAnimation&&this.state.multiMapStyle[1].opacity,"multisourcemap-item-disappear":this.state.useAnimation&&!this.state.multiMapStyle[1].opacity,"multisourcemap-item-appear-noanimate":this.state.multiMapStyle[1].opacity,"multisourcemap-item-disappear-noanimate":!this.state.multiMapStyle[1].opacity}),style:{position:"absolute",zIndex:this.state.multiMapStyle[1].zIndex}},this.state.secondMapDsId&&a.React.createElement(I,{ref:"secondMapInstance",onViewChanged:this.handleViewChanged,baseWidgetProps:this.props.baseWidgetProps,onMapLoaded:this.handleMapLoaded,onMutableStatePropsChanged:this.handleMutableStatePropsChanged,onExtentChanged:function(t,n){e.handleExtentChanged(t,n)},onJimuMapViewCreated:this.handleJimuMapViewCreated,startLoadModules:this.props.startLoadModules,dataSourceId:this.state.secondMapDsId,widthBreakpoint:this.props.widthBreakpoint,isMapInVisibleArea:this.props.isMapInVisibleArea}))),this.props.isDefaultMap&&a.React.createElement("div",{className:"jimu-widget",style:{position:"relative"}},a.React.createElement("div",{className:Object(a.classNames)("jimu-widget multisourcemap-item-appear-noanimate"),style:{position:"absolute",zIndex:6}},a.React.createElement(I,{ref:"firstMapInstance",isDefaultMap:this.props.isDefaultMap,onViewChanged:this.handleViewChanged,baseWidgetProps:this.props.baseWidgetProps,onMapLoaded:this.handleMapLoaded,onMutableStatePropsChanged:this.handleMutableStatePropsChanged,dataSourceId:null,onExtentChanged:function(t,n){e.handleExtentChanged(t,n)},onJimuMapViewCreated:this.handleJimuMapViewCreated,startLoadModules:this.props.startLoadModules,widthBreakpoint:this.props.widthBreakpoint,isMapInVisibleArea:this.props.isMapInVisibleArea,defaultMapInfo:this.props.defaultMapInfo}))),this.state.currentJimuMapViewId&&a.React.createElement(O,{jimuMapView:s.MapViewManager.getInstance().getJimuMapViewById(this.state.currentJimuMapViewId),appMode:this.props.baseWidgetProps.appMode,layouts:this.props.baseWidgetProps.layouts,LayoutEntry:this.props.baseWidgetProps.builderSupportModules&&this.props.baseWidgetProps.builderSupportModules.LayoutEntry,widgetManifestName:this.props.baseWidgetProps.manifest.name}),this.state.currentJimuMapViewId&&s.MapViewManager.getInstance().getJimuMapViewById(this.state.currentJimuMapViewId)&&a.React.createElement(ft,{mapWidgetId:this.props.baseWidgetProps.id,isMobile:"xsmall"===this.props.widthBreakpoint,jimuMapView:s.MapViewManager.getInstance().getJimuMapViewById(this.state.currentJimuMapViewId),appMode:this.props.baseWidgetProps.appMode,layouts:this.props.baseWidgetProps.layouts,intl:this.props.baseWidgetProps.intl,LayoutEntry:this.props.baseWidgetProps.builderSupportModules&&this.props.baseWidgetProps.builderSupportModules.LayoutEntry,layoutConfig:this.getLayoutConfig(),toolConfig:this.props.baseWidgetProps.config.toolConifg?this.props.baseWidgetProps.config.toolConifg:{},activeToolInfo:this.state.activeToolInfo,onActiveToolInfoChange:this.handleActiveToolInfoChange,theme:this.props.baseWidgetProps.theme,widgetManifestName:this.props.baseWidgetProps.manifest.name,widgetHeight:"xsmall"===this.props.widthBreakpoint?null:this.props.widgetHeight}),a.React.createElement(s.JimuMapViewComponent,{useMapWidgetIds:this.useMapWidgetIds,onViewGroupCreate:this.handleViewGroupCreate}))},t.getChangedState=function(e,t,n){var o={};if(n&&n[0]){for(var i=[],a=[],s=0;s<n.length;s++)e!==n[s].dataSourceId?i.push(n[s].dataSourceId):a.push(n[s].dataSourceId);a.length>0?(o.firstMapDsId=e,o.secondMapDsId=i[0]):0===a.length&&(i.indexOf(t)>-1?(i.splice(i.indexOf(t),1),o.firstMapDsId=i[0],o.secondMapDsId=t):(o.firstMapDsId=i[0],o.secondMapDsId=i[1]))}else o.firstMapDsId=null,o.secondMapDsId=null;return o.firstMapDsId!==e?o.firstMapDsId?(o.multiMapStyle=yt.firstMapVisible,o.currentMapIndex=0):o.secondMapDsId?(o.multiMapStyle=yt.secondMapVisible,o.currentMapIndex=1):(o.multiMapStyle=yt.firstMapVisible,o.currentMapIndex=0):o.secondMapDsId?o.secondMapDsId!==t&&(o.multiMapStyle=yt.secondMapVisible,o.currentMapIndex=1):(o.multiMapStyle=yt.firstMapVisible,o.currentMapIndex=0),o},t}(a.React.PureComponent),Mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),St=function(e){function t(t){var n=e.call(this,t)||this;return n.state={defaultMapInfo:null},n}return Mt(t,e),t.prototype.componentDidMount=function(){var e=this;s.portalUtils.getDefaultWebMap(this.props.baseWidgetProps.portalUrl).then((function(t){e.setState({defaultMapInfo:t})}))},t.prototype.render=function(){return a.React.createElement("div",{className:"w-100 h-100"},!this.state.defaultMapInfo&&a.React.createElement("div",{className:"widget-map jimu-widget widget-map-background"},a.React.createElement("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})),this.state.defaultMapInfo&&a.React.createElement("div",{className:Object(a.classNames)("jimu-widget",{"map-is-design-mode":!Object(p.a)(this.props.baseWidgetProps.appMode)})},this.props.isMapInVisibleArea&&a.React.createElement(vt,{key:0,fullScreenMap:this.props.fullScreenMap,baseWidgetProps:this.props.baseWidgetProps,startLoadModules:this.props.startLoadModules,isDefaultMap:!0,ref:this.props.setMultiSourceMapInstance,onViewGroupCreate:this.props.onViewGroupCreate,widgetHeight:this.props.widgetHeight,widthBreakpoint:this.props.widthBreakpoint,isFullScreen:this.props.isFullScreen,isMapInVisibleArea:this.props.isMapInVisibleArea,defaultMapInfo:this.state.defaultMapInfo})))},t}(a.React.PureComponent),xt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),It=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},jt=function(e){function t(t){var n=e.call(this,t)||this;return n.multiSourceMapInstance=null,n.startRenderMap=function(){setTimeout((function(){n.setState({startLoadModules:!0})}),100)},n.getPlaceHolderImage=function(){var e=n.props.config.placeholderImage,t=a.SessionManager.getInstance().getMainSession();e&&(new RegExp("^(.)+/sharing/rest/content/items/(.)+/info/(.)+").test(e)&&(e=t?e+"?token="+t.token:e));return e},n.fullScreenMap=function(){if(a.utils.isTouchDevice())if("fixed"===n.container.style.position)n.container.style.height=n.containerClientRect.height+"px",n.container.style.width=n.containerClientRect.width+"px",n.container.style.top=n.containerClientRect.top+"px",n.container.style.left=n.containerClientRect.left+"px",setTimeout((function(){n.container.style.transition=null,n.container.style.position="relative",n.container.style.height="100%",n.container.style.width="100%",n.container.style.top="0",n.container.style.left="0",n.container.style.backgroundColor="none",n.parentContainer.appendChild(n.container),n.setState({isFullScreen:!1})}),100);else{var e=n.container.getBoundingClientRect();n.containerClientRect=e,n.container.style.height=e.height+"px",n.container.style.width=e.width+"px",n.container.style.position="fixed",n.container.style.top=e.top+"px",n.container.style.left=e.left+"px",document&&document.body.appendChild(n.container),setTimeout((function(){n.container.style.transition="top 0.3s, bottom 0.3s, left 0.3s, right 0.3s, height 0.3s, width 0.3s",n.container.style.top="0px",n.container.style.left="0px",n.container.style.right="0px",n.container.style.bottom="0px",n.container.style.height=null,n.container.style.width=null,n.container.style.backgroundColor="#fff",n.setState({isFullScreen:!0})}),100)}else{var t=n.container;if(!document)return;if(document.addEventListener("webkitfullscreenchange",(function(e){document.fullscreenElement||document.webkitFullscreenElement||n.setState({isFullScreen:!1})})),document.addEventListener("fullscreenchange",(function(e){document.fullscreenElement||document.webkitFullscreenElement||n.setState({isFullScreen:!1})})),document.fullscreenElement===t)return document.exitFullscreen(),void n.setState({isFullScreen:!1});if(document.webkitFullscreenElement===t)return document.webkitCancelFullScreen(),void n.setState({isFullScreen:!1});var o=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(o)n.setState({isFullScreen:!0}),o.call(t);else if(void 0!==window.ActiveXObject){var i=new ActiveXObject("WScript.Shell");null!==i&&i.SendKeys("{F11}")}}},n.handleViewGroupCreate=function(e){e&&e.setMapWidgetInstance(n)},n.switchMap=function(){return n.multiSourceMapInstance?n.multiSourceMapInstance.switchMap():Promise.resolve()},n.setMultiSourceMapInstance=function(e){n.multiSourceMapInstance=e},n.onResize=function(e,t){e&&t&&(e<=545&&e>0?n.setState({widthBreakpoint:"xsmall",widgetHeight:t}):n.setState({widthBreakpoint:"other",widgetHeight:t}))},n.getInnerContent=function(e){return n.state.startLoadModules?n.props.useDataSources&&n.props.useDataSources[0]&&n.props.useDataSources[0].dataSourceId?Object(a.jsx)("div",{className:"jimu-widget",ref:function(e){n.parentContainer=e}},Object(a.jsx)("div",{css:n.getStyle(),className:"jimu-widget",ref:function(e){n.container=e}},Object(a.jsx)("div",{className:Object(a.classNames)("jimu-widget",{"map-is-design-mode":!Object(p.a)(n.props.appMode)})},(e||2===n.props.useDataSources.length)&&Object(a.jsx)(vt,{key:1,fullScreenMap:n.fullScreenMap,baseWidgetProps:n.props,startLoadModules:n.state.startLoadModules,ref:n.setMultiSourceMapInstance,onViewGroupCreate:n.handleViewGroupCreate,widgetHeight:n.state.widgetHeight,widthBreakpoint:n.state.widthBreakpoint,isFullScreen:n.state.isFullScreen,isMapInVisibleArea:e})),Object(a.jsx)(a.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:n.onResize}))):Object(a.jsx)("div",{className:"jimu-widget",ref:function(e){n.parentContainer=e}},Object(a.jsx)("div",{css:n.getStyle(),className:"jimu-widget",ref:function(e){n.container=e}},Object(a.jsx)("div",{className:Object(a.classNames)("jimu-widget",{"map-is-design-mode":!Object(p.a)(n.props.appMode)})},e&&Object(a.jsx)(St,{fullScreenMap:n.fullScreenMap,baseWidgetProps:n.props,startLoadModules:n.state.startLoadModules,isDefaultMap:!0,setMultiSourceMapInstance:n.setMultiSourceMapInstance,onViewGroupCreate:n.handleViewGroupCreate,widgetHeight:n.state.widgetHeight,widthBreakpoint:n.state.widthBreakpoint,isFullScreen:n.state.isFullScreen,isMapInVisibleArea:e})),Object(a.jsx)(a.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:n.onResize}))):Object(a.jsx)("div",{css:n.getStyle(),className:"jimu-widget"},Object(a.jsx)("div",{className:"widget-map jimu-widget"},Object(a.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})))},n.state={widthBreakpoint:null,widgetHeight:null,isFullScreen:!1},n}return xt(t,e),t.prototype.getStyle=function(){var e=this.props.theme;return Object(a.css)(x||(x=It(["\n      position: relative;\n\n      .map-is-live-mode {\n        .exbmap-ui {\n          pointer-events: auto !important;\n        }\n\n        .is-widget {\n          pointer-events: auto !important;\n        }\n      }\n\n      .widget-map-usemask {\n        pointer-events: auto !important;\n      }\n\n      .map-is-design-mode {\n        .exbmap-ui,\n        .exbmap-ui-tool {\n          pointer-events: none !important;\n        }\n\n        .is-widget {\n          pointer-events: auto !important;\n        }\n      }\n\n      .widget-map{\n        padding: 0;\n        margin: 0;\n        height: 100%;\n        width: 100%;\n        z-index: -1;\n        .overview-container{\n          position: absolute;\n          top: 12px;\n          right: 12px;\n          width: 300px;\n          height: 200px;\n          border: 1px solid black;\n          z-index: 1;\n        }\n\n        .extent-container{\n          background-color: rgba(0, 0, 0, 0.5);\n          position: absolute;\n          z-index: 2;\n        }\n\n        .extent-btn-container{\n          button{\n            outline: none;\n          }\n          .previous-extent-btn{\n            color: #111;\n          }\n          .next-extent-btn{\n            color: #222;\n          }\n        }\n      }\n\n      .exbmap-ui-layout{\n        z-index: 0;\n      }\n\n      .mapswitch-container {\n        position: absolute;\n        z-index: 7;\n        width: 32px;\n        height: 32px;\n        bottom: 10px;\n        left: 10px;\n        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3)\n      }\n\n      .mapswitch-icon {\n        fill: black;\n        left: 8px;\n        top: 8px;\n        position: absolute;\n        display: block;\n      }\n\n      .widget-map-background {\n        background-color: ",";\n        position: absolute;\n        z-index: 1;\n      }\n\n      .widget-map-crashed {\n        background-color: ",";\n        position: absolute;\n        z-index: 1;\n        top: 0;\n\n        .widget-map-crashed-label-padding {\n          padding-left: ",";\n          padding-right: ",";\n        }\n\n        .widget-map-crashed-label {\n          font-size: ",";\n          color: ",";\n          font-weight: bold;\n          text-align: center;\n        }\n      }\n\n      @keyframes appear {\n        0%{opacity:0}\n        25%{opacity:.25}\n        50%{opacity:.5;}\n        75%{opacity:.75}\n        100%{opacity:1;}\n      }\n\n      @keyframes disappear {\n        0%{opacity:1}\n        25%{opacity:.75}\n        50%{opacity:.5;}\n        75%{opacity:.25}\n        100%{opacity:0;}\n      }\n\n      .multisourcemap-item-appear {\n        animation: appear 300ms;\n        -webkit-animation: appear 300ms;\n        -moz-animation: appear 300ms;\n        animation-fill-mode: forwards;\n        -webkit-animation-fill-mode: forwards;\n        -moz-animation-fill-mode: forwards;\n        animation-timing-function: ease-in;\n        -webkit-animation-timing-function: ease-in;\n        -moz-animation-timing-function: ease-in;\n      }\n\n      .multisourcemap-item-disappear {\n        animation: disappear 300ms;\n        -webkit-animation: disappear 300ms;\n        -moz-animation: disappear 300ms;\n        animation-fill-mode: forwards;\n        -webkit-animation-fill-mode: forwards;\n        -moz-animation-fill-mode: forwards;\n        animation-timing-function: ease-in;\n        -webkit-animation-timing-function: ease-in;\n        -moz-animation-timing-function: ease-in;\n      }\n\n      .multisourcemap-item-appear-noanimate {\n        opacity: 1;\n      }\n\n      .multisourcemap-item-disappear-noanimate {\n        opacity: 0;\n      }\n      "],["\n      position: relative;\n\n      .map-is-live-mode {\n        .exbmap-ui {\n          pointer-events: auto !important;\n        }\n\n        .is-widget {\n          pointer-events: auto !important;\n        }\n      }\n\n      .widget-map-usemask {\n        pointer-events: auto !important;\n      }\n\n      .map-is-design-mode {\n        .exbmap-ui,\n        .exbmap-ui-tool {\n          pointer-events: none !important;\n        }\n\n        .is-widget {\n          pointer-events: auto !important;\n        }\n      }\n\n      .widget-map{\n        padding: 0;\n        margin: 0;\n        height: 100%;\n        width: 100%;\n        z-index: -1;\n        .overview-container{\n          position: absolute;\n          top: 12px;\n          right: 12px;\n          width: 300px;\n          height: 200px;\n          border: 1px solid black;\n          z-index: 1;\n        }\n\n        .extent-container{\n          background-color: rgba(0, 0, 0, 0.5);\n          position: absolute;\n          z-index: 2;\n        }\n\n        .extent-btn-container{\n          button{\n            outline: none;\n          }\n          .previous-extent-btn{\n            color: #111;\n          }\n          .next-extent-btn{\n            color: #222;\n          }\n        }\n      }\n\n      .exbmap-ui-layout{\n        z-index: 0;\n      }\n\n      .mapswitch-container {\n        position: absolute;\n        z-index: 7;\n        width: 32px;\n        height: 32px;\n        bottom: 10px;\n        left: 10px;\n        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3)\n      }\n\n      .mapswitch-icon {\n        fill: black;\n        left: 8px;\n        top: 8px;\n        position: absolute;\n        display: block;\n      }\n\n      .widget-map-background {\n        background-color: ",";\n        position: absolute;\n        z-index: 1;\n      }\n\n      .widget-map-crashed {\n        background-color: ",";\n        position: absolute;\n        z-index: 1;\n        top: 0;\n\n        .widget-map-crashed-label-padding {\n          padding-left: ",";\n          padding-right: ",";\n        }\n\n        .widget-map-crashed-label {\n          font-size: ",";\n          color: ",";\n          font-weight: bold;\n          text-align: center;\n        }\n      }\n\n      @keyframes appear {\n        0%{opacity:0}\n        25%{opacity:.25}\n        50%{opacity:.5;}\n        75%{opacity:.75}\n        100%{opacity:1;}\n      }\n\n      @keyframes disappear {\n        0%{opacity:1}\n        25%{opacity:.75}\n        50%{opacity:.5;}\n        75%{opacity:.25}\n        100%{opacity:0;}\n      }\n\n      .multisourcemap-item-appear {\n        animation: appear 300ms;\n        -webkit-animation: appear 300ms;\n        -moz-animation: appear 300ms;\n        animation-fill-mode: forwards;\n        -webkit-animation-fill-mode: forwards;\n        -moz-animation-fill-mode: forwards;\n        animation-timing-function: ease-in;\n        -webkit-animation-timing-function: ease-in;\n        -moz-animation-timing-function: ease-in;\n      }\n\n      .multisourcemap-item-disappear {\n        animation: disappear 300ms;\n        -webkit-animation: disappear 300ms;\n        -moz-animation: disappear 300ms;\n        animation-fill-mode: forwards;\n        -webkit-animation-fill-mode: forwards;\n        -moz-animation-fill-mode: forwards;\n        animation-timing-function: ease-in;\n        -webkit-animation-timing-function: ease-in;\n        -moz-animation-timing-function: ease-in;\n      }\n\n      .multisourcemap-item-appear-noanimate {\n        opacity: 1;\n      }\n\n      .multisourcemap-item-disappear-noanimate {\n        opacity: 0;\n      }\n      "])),e.colors.white,a.polished.rgba(e.colors.white,.85),a.polished.rem(24),a.polished.rem(24),a.polished.rem(13),e.colors.black)},t.prototype.componentDidMount=function(){this.state.startLoadModules||!window.jimuConfig.isInBuilder&&this.props.config.canPlaceHolder||this.startRenderMap()},t.prototype.componentWillUnmount=function(){Object(a.getAppStore)().getState().appConfig.widgets[this.props.id]||a.MutableStoreManager.getInstance().updateStateValue(this.props.id,"restoreData",null)},t.prototype.render=function(){var e=this;return Object(a.jsx)("div",{className:"w-100 h-100"},Object(a.jsx)(j.PageVisibilityContext.Consumer,null,(function(t){return Object(a.jsx)(j.ViewportVisibilityContext.Consumer,null,(function(n){return e.getInnerContent(Object(p.a)(e.props.appMode)?n:t)}))})))},t.mapExtraStateProps=function(e){return{appMode:e&&e.appRuntimeInfo&&e.appRuntimeInfo.appMode,queryObject:e.queryObject}},t}(a.React.PureComponent);t.default=jt},4:function(e,t){e.exports=o},5:function(e,t){e.exports=i},57:function(e,t,n){"use strict";var o,i=n(0),a=n(1),s=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=function(e){function t(t){var n=e.call(this,t)||this;return n.unmount=!1,n.setMapThumbUrl=function(e){if(e||n.setState({mapThumbUrl:null}),n.props.portUrl&&n.props.portUrl!==Object(i.getAppStore)().getState().portalUrl)i.esri.restPortal.searchItems({q:"id:"+e,portal:n.props.portUrl+"/sharing/rest"}).then((function(e){if(!n.unmount)if(e.results[0]){var t=n.props.portUrl+"/sharing/rest/content/items/"+e.results[0].id+"/info/"+e.results[0].thumbnail;n.setState({mapThumbUrl:t})}else n.setState({mapThumbUrl:null})}));else{var t=Object(i.getAppStore)().getState().portalUrl;i.esri.restPortal.searchItems({q:"id:"+e,authentication:i.SessionManager.getInstance().getMainSession(),portal:t+"/sharing/rest"}).then((function(e){if(!n.unmount)if(e.results[0]){var o=i.SessionManager.getInstance().getMainSession(),a=null;a=o&&o.token?t+"/sharing/rest/content/items/"+e.results[0].id+"/info/"+e.results[0].thumbnail+"?token="+o.token:t+"/sharing/rest/content/items/"+e.results[0].id+"/info/"+e.results[0].thumbnail,n.setState({mapThumbUrl:a})}else n.setState({mapThumbUrl:null})}))}},n.state={mapThumbUrl:null},n}return s(t,e),t.prototype.componentDidMount=function(){this.unmount=!1,this.setMapThumbUrl(this.props.mapItemId)},t.prototype.componentDidUpdate=function(e,t){e.mapItemId!==this.props.mapItemId&&this.setMapThumbUrl(this.props.mapItemId)},t.prototype.componentWillUnmount=function(){this.unmount=!0},t.prototype.render=function(){return this.state.mapThumbUrl?i.React.createElement(a.ImageWithParam,{imageParam:{url:this.state.mapThumbUrl}}):i.React.createElement(a.ImageWithParam,{imageParam:{}})},t}(i.React.PureComponent);t.a=r},81:function(e,t){e.exports='<svg viewBox="0 0 9 5" xmlns="http://www.w3.org/2000/svg"><path d="M4.128 4.587L.751.834A.5.5 0 011.123 0h6.754a.5.5 0 01.372.834L4.872 4.587a.5.5 0 01-.744 0z" fill="#000" fill-rule="evenodd"></path></svg>'},82:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M.25 3l8.642 4.969-3.422.738 2.723 5.45-2.886 1.667-2.724-5.45-2.351 2.595L.25 3zm.996 1.726l-.01 5.644 1.527-1.684 2.909 5.771 1.155-.667-2.91-5.77 2.222-.48-4.893-2.814zM16 0v11H8.5v-1H15V1H6v2.5H5V0h11z" fill="#363636" fill-rule="nonzero"></path></svg>'}}))}}}));