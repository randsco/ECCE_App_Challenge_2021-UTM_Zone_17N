System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-arcgis","jimu-for-builder"],(function(e){var t,n,s,i,r;return{setters:[function(e){t=e},function(e){n=e},function(e){s=e},function(e){i=e},function(e){r=e}],execute:function(){e(function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=413)}({0:function(e,n){e.exports=t},1:function(e,t){e.exports=n},2:function(e,t){e.exports=s},365:function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.462 12l10.235 10.235a1.034 1.034 0 11-1.462 1.462L12 13.462 1.765 23.697a1.034 1.034 0 11-1.462-1.462L10.538 12 .303 1.765A1.034 1.034 0 111.765.303L12 10.538 22.235.303a1.034 1.034 0 111.462 1.462L13.462 12z" fill="#000" fill-rule="nonzero"></path></svg>'},366:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 32"><path d="M19.6 26.267a2.8 2.8 0 01-2.8 2.8h-3.733C5.85 29.067 0 23.217 0 16S5.85 2.933 13.067 2.933H16.8a2.8 2.8 0 010 5.6h-3.733a7.467 7.467 0 100 14.934H16.8a2.8 2.8 0 012.8 2.8zm8.4-2.8h3.733a7.467 7.467 0 100-14.934H28a2.8 2.8 0 010-5.6h3.733C38.95 2.933 44.8 8.783 44.8 16s-5.85 13.067-13.067 13.067H28a2.8 2.8 0 010-5.6zM15.867 13.2h13.067a2.8 2.8 0 010 5.6H15.867a2.8 2.8 0 010-5.6z"></path></svg>'},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var s=new(function(){function e(){}return e.prototype.setQueryObject=function(e){var t=e?e.survey123:"",n=t?decodeURIComponent(t+""):"",s=this._urlParamToJson(n);this.queryObj=s},e.prototype.getSurvey123HostUrl=function(){var e="https://survey123.arcgis.com",t=window.jimuConfig.hostEnv;return this.queryObj&&this.queryObj.env&&["dev","prod","qa","beta"].indexOf(this.queryObj.env)>=0&&(t=this.queryObj.env),"dev"===t&&(e="https://survey123dev.arcgis.com"),"qa"===t&&(e="https://survey123qa.arcgis.com"),"beta"===t&&(e="https://survey123beta.arcgis.com"),e},e.prototype.getSurvey123HostAPIUrl=function(){return this.getSurvey123HostUrl()+"/api/jsapi/3.11"},e.prototype.createSurvey=function(e,t,n,s){var i=this;return s=Object.assign({snippet:""},s||{}),Promise.resolve(!0).then((function(){if(!(e&&t&&n&&n.token&&n.username))throw new Error("missing title, tags, username or token")})).then((function(){var r=i.getSurvey123HostUrl()+"/api/survey/create",a={title:e,tags:t.join(","),snippet:s.snippet,thumbnailUrl:s.thumbnailUrl,token:n.token,username:n.username,portalUrl:n.portalUrl||"https://www.arcgis.com"};return fetch(r,{mode:"cors",method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(a)}).then((function(e){if(e.ok)return e.json();throw e}))}))},e.prototype.isPortal=function(e){return!["www.arcgis.com","devext.arcgis.com","qaext.arcgis.com"].find((function(t,n){return-1!==e.indexOf(t)}))},e.prototype.querySurvey=function(e,t){var n=this;return t=Object.assign({isShared:!1,isPublished:!0,isSearchAll:!0,queryFromClient:!1,surveyClientAPI:null},t||{}),Promise.resolve(!0).then((function(){if(!e||!e.token||!e.username)throw new Error("missing token or username")})).then((function(){var s={isShared:t.isShared,isPublished:t.isPublished,isSearchAll:t.isSearchAll,token:e.token,username:e.username,portalUrl:e.portalUrl||"https://www.arcgis.com"};if(t.queryFromClient)return t.surveyClientAPI?t.surveyClientAPI.survey123.searchSurvey(s).then((function(e){if(e&&e.results)return e.results;throw e})):(console.log("Survey client api is not provided."),null);var i=n.getSurvey123HostUrl()+"/api/survey/search";return i=i+"?"+Object.keys(s).map((function(e){return e+"="+s[e]})).join("&"),fetch(i,{mode:"cors",method:"GET"}).then((function(e){if(e.ok)return e.json();throw e})).then((function(e){if(e&&e.results)return e.results;if(e&&Array.isArray(e))return e;throw e}))}))},e.prototype.getSurvey123DesignerUrl=function(e,t){t=Object.assign({},t||{});var n=this.getSurvey123HostUrl()+"/surveys/"+e+"/design?embed=exb";return t.portalUrl&&"https://www.arcgis.com"!==t.portalUrl&&(n+="&portalUrl="+t.portalUrl),("https://survey123dev.arcgis.com"===this.getSurvey123HostUrl()&&!t.portalUrl||"https://www.arcgis.com"===t.portalUrl)&&(n+="&portalUrl="+t.portalUrl),n},e.prototype.getSurvey123WebformUrl=function(e,t){t=Object.assign({queryParams:[]},t||{});var n=this.getSurvey123HostUrl()+"/share/"+e;return t.queryParams.length>0&&(n+="?"+t.queryParams.join("&")),n},e.prototype.flatQuestions=function(e){var t=this,n=[];return e.forEach((function(e){e.questions?"esriQuestionTypeRepeat"!==e.type&&(n=n.concat(t.flatQuestions(e.questions))):n.push(e)})),n},e.prototype.getSurveyQuestionFields=function(e,t){var n=this;return Promise.resolve(!0).then((function(){if(!e||!t||!t.token)throw new Error("missing surveyItemId or token")})).then((function(){var s=n.getSurvey123HostUrl()+"/api/survey/"+e+"/form",i={token:t.token};return s=s+"?"+Object.keys(i).map((function(e){return e+"="+i[e]})).join("&"),fetch(s,{mode:"cors",method:"GET"}).then((function(e){if(e.ok)return e.json();throw e}))})).then((function(e){var t=[];e&&e.questions&&e.questions.length>0&&n.flatQuestions(e.questions).forEach((function(e){var n=(e.type+"").replace("esriQuestionType","");(e.fieldName||["geopoint","polyline","polygon"].indexOf(n.toLowerCase())>=0)&&t.push({name:e.fieldName||e.name,label:e.label})}));return t}))},e.prototype._urlParamToJson=function(e){var t=this;if(!e)return null;var n=(e+="").split(";");if(n.length<2&&e.split(":").length<2)return e.split(",").length>1?e.split(","):e;var s={};return n.forEach((function(e){var n=(e+"").split(":");if(n.length>1){var i=n[0],r=(Array.isArray(n.slice(1))?n.slice(1):[]).join(":");r.length&&"{"===r[0]&&(r=t._stringToJson(r)),"string"==typeof r&&r.split(",").length>1&&(r=r.split(",")),s[i]=r}})),s},e.prototype._stringToJson=function(e){var t=e;try{t=JSON.parse(e)}catch(n){t=e}return t},e}())},4:function(e,t){e.exports=i},413:function(e,t,n){"use strict";n.r(t);var s,i=n(0),r=n(8),a=n(2),o=n(4),l=n(1),u=n(39),c={chooseSurvey:"Select which survey to run in the widget:",createNewSurveyLabel:"Create new survey",chooseSurveyLabel:"Select existing survey",selectSurveyTip:"Please select",searchHint:"Search",surveyDetailLabel:"Survey Details:",currentSurveyLabel:"Current survey",resetSurveyLabel:"Reset survey",summaryLabel:"Summary",insertLabel:"Insert",surveyTitleLabel:"Name",surveyTitleRequiredMsg:"The name of the survey is required.",surveyTitleDuplicateMsg:"A survey with this name already exists, please use a different name.",surveyTagLabel:"Tags",surveyTagHint:"Separate tags with commas",surveyTagsRequiredMsg:"One or more tags are required.",surveySummaryLabel:"Summary",createSurveyBtn:"Create",editSurveyBtn:"Edit survey",appearanceTitle:"Appearance",showOptionsBarLabel:"Show options bar",showOptionsHeaderLabel:"Show survey header",showOptionsDesLabel:"Show survey description",showOptionsFooterLabel:"Show survey footer",useSurveyTheme:"Enable survey theme",resetSurveyTip:"Reset survey will remove all settings to this survey widget.",confirmResetSurveyTip:"Are you sure you want to continue?",sendDataToSurveyTitle:"Send data to this survey",sendDataToSurveyDesc:"Attributes and geometry of a feature in the source layer can be sent to survey questions.",sendDataDisabled1:"Please add a map widget that contains at least one feature layer to use this capability.",sourceLayer:"Source layer",selectSourceWidget:"Select an interactive map",selectSourceLayer:"Select the source layer",triggerEventListTitle:"Trigger event for sending data",triggerEventSelect:"When an existing feature is selected",triggerEventAdd:"When a new feature is added",triggerEventDesc1:"Data will be sent to this survey when a feature is selected in the layer.",addConnTitle:"Field/question connections",addConnSelectField:"Select a field",addConnSelectQuestion:"Select a survey question",addConnFailed1:"The survey question type is not compatible with the field type.",addConnBtn:"Add connection",geometryLabel:"*Shape",geometryTypePoint:"Point",geometryTypeMultiPoint:"MultiPoint",geometryTypePolyline:"Polyline",geometryTypePolygon:"Polygon",errmsgGeneralLoading:"An error occurred while loading.",errmsgGeneralCreatingNewSvy:"An error occurred while creating the new survey. Pleasey try again later.",msgUnsavedBeforeLeaving:"Changes you made may not be saved."},p=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var d,g,y=(d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},v=function(e){function t(t){var s=e.call(this,t)||this;return s.supportedMapTypes=Object(i.Immutable)([o.ArcGISDataSourceTypes.WebMap]),s.supportedLayerTypes=Object(i.Immutable)([i.DataSourceTypes.FeatureLayer]),s.dsManager=i.DataSourceManager.getInstance(),s.state={newSurveyTitle:null,newSurveyTags:null,newSurveyTitleDirty:!1,newSurveyTagsDirty:!1,newSurveySnippet:null,newSurveyItemId:null,newSurveyThumbnailUrls:["https://survey123.arcgis.com/assets/img/default-thumbnails/Image01.png","https://survey123.arcgis.com/assets/img/default-thumbnails/Image02.png","https://survey123.arcgis.com/assets/img/default-thumbnails/Image03.png"],newSurveyMsg:null,newSurveyLoading:!1,existSurveyMsg:null,existSurveys:[],selectedSurvey:null,modalIsOpen:!1,mode:"none",isCheckedSurveyItemId:!1,isShowSurveyQuestionField:!1,surveyQuestionFields:[],selectedQuestionField:null,createSurveyErrorMsg:null,surveyStatusCode:0,isShowCloseDesignerAlert:!1,surveyChanged:!1,dsMapView:null,dsFeatureLayer:null,dsFeatureLayerFields:[],mapWidgetList:[],addMapping:null,editMapping:null},s.newDefaultValue={key:"",value:""},s.API={survey123:null,Survey123WebForm:null},s.isPortal=!1,s.iconRefresh=n(71),s.closeIcon24=n(365),s.iconLink=n(366),s.iconRemove=n(59),s.componentDidMount=function(){var e=s.props.useDataSources,t=e&&e.length?e[0].dataSourceId:null;if(t){var n=s.dsManager.getDataSource(t),r=n?n.layer:null;s.setState({dsFeatureLayer:r,dsFeatureLayerFields:s.getLayerFields(r)})}s.isPortal=!i.portalUrlUtils.isAGOLDomain(s.props.config.portalUrl||s.props.portalUrl)},s.loadSurveyAPI=function(){var e=u.a.getSurvey123HostAPIUrl();return s.API.survey123?Promise.resolve(s.API.survey123):i.moduleLoader.loadModule(e).then((function(e){return s.API=e,e}))},s.getLayerFields=function(e){if(!e)return[];var t=Object.assign({},{fields:e.fields}).fields;if("feature"!==e.type)return t;if((t||[]).find((function(e){return"geometry"===e.name})))return t;var n=e.geometryType,i=s.nls("geometryType"+n.substr(0,1).toUpperCase()+n.substr(1));return t.push({alias:s.nls("geometryLabel")+"("+i+")",name:"geometry"}),t},s.onValueChanged=function(e){var t=e.currentTarget;s.props.onSettingChange({id:s.props.id,config:s.props.config.set(t.name,t.value)})},s.nls=function(e){return s.props.intl.formatMessage({id:e,defaultMessage:c[e]})},s.addDefaultValue=function(e){s.newDefaultValue.key&&s.newDefaultValue.value&&(s.newDefaultValue={key:"",value:""})},s.addDesigerHandler=function(){window.addEventListener("message",(function(e){if(e.data){var t=e.data;try{"string"==typeof e.data&&(t=JSON.parse(e.data)||{})}catch(e){}if("survey123:design:onFormPublished"===t.event&&t.data){var n=s.state.surveyStatusCode||0;n++,r.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:s.props.id,propKey:"surveyStatusCode",value:n}),s.setState({surveyStatusCode:n}),s.handleCloseModal()}else"survey123:design:onFormUnsaved"===t.event&&t.data?s.setState({surveyChanged:!0}):"survey123:design:onFormSaved"===t.event&&t.data&&s.setState({surveyChanged:!1})}}))},s.getFielAlias=function(e){var t=(s.state.dsFeatureLayerFields||[]).find((function(t){return t.name===e}));return t?t.alias||t.name:e},s.getQuestionLabel=function(e){var t=(s.state.surveyQuestionFields||[]).find((function(t){return t.name===e}));return t?t.label||t.name:e},s.onNewSurveyValueChanged=function(e){var t,n=e.currentTarget;n.name&&s.setState(((t={})[n.name]=n.value,t)),"newSurveyTags"===n.name&&s.setState({newSurveyTagsDirty:!0}),"newSurveyTitle"===n.name&&s.setState({newSurveyTitleDirty:!0})},s.onExistSurveyChanged=function(e){var t=e.currentTarget;if(t.value&&"null"!==t.value){var n=s.state.existSurveys.find((function(e){return e.id===t.value}));s.updateMapWidgetList(),s.setState({selectedSurvey:n})}},s.createSurvey=function(){return Promise.resolve(!0).then((function(){return!s.isPortal||s.loadSurveyAPI()})).then((function(){var e,t=s.state.newSurveyTitle,n=(s.state.newSurveyTags||"").split(",").map((function(e){return e.trim()})),i=s.state.newSurveySnippet;if(t||s.setState({newSurveyTitleDirty:!0}),s.state.newSurveyTags||s.setState({newSurveyTagsDirty:!0}),!t||!n||!n.length)throw new Error("");s.setState({newSurveyMsg:"",newSurveyLoading:!0});var r=parseInt(10*Math.random()+"")%3,a=s.state.newSurveyThumbnailUrls[r];if(s.isPortal){var o={title:t,tags:n,token:s.props.token,thumbnailUrl:a,portalUrl:s.props.config.portalUrl||s.props.portalUrl};return s.API.survey123.createSurvey(o)}return u.a.createSurvey(t,n,{token:s.props.token,username:null===(e=s.props.user)||void 0===e?void 0:e.username,portalUrl:s.props.config.portalUrl||s.props.portalUrl},{snippet:i,thumbnailUrl:a})})).then((function(e){if(s.isPortal&&e.id||!s.isPortal&&!0===e.success)return s.updateMapWidgetList(),s.setState({createSurveyErrorMsg:null,newSurveyItemId:e.id,selectedSurvey:e,newSurveyLoading:!1}),e.id;if(e.error&&e.error.code+""=="400")return s.setState({createSurveyErrorMsg:s.props.intl.formatMessage({id:"surveyTitleDuplicateMsg",defaultMessage:c.surveyTitleDuplicateMsg}),newSurveyLoading:!1,newSurveyTitleDirty:!1}),null;throw e})).then((function(e){e&&(s.props.onSettingChange({id:s.props.id,config:s.props.config.set("hides",["navbar","header","description","footer","theme"])}),s.showSurvey123DesignerModal(e))})).catch((function(e){e&&s.setState({newSurveyMsg:e.message?e.message:"string"==typeof e?e:"",newSurveyLoading:!1}),console.error(e)}))},s.querySurvey=function(e){return e=Object.assign({isShared:!1,isPublished:!0},e||{}),Promise.resolve(!0).then((function(){return!s.isPortal||s.loadSurveyAPI()})).then((function(){var t;if(s.props.config.surveyItemId&&s.props.config.selectedSurvey){var n=s.props.config.selectedSurvey;return setTimeout((function(){s.props.onSettingChange({id:s.props.id,config:s.props.config.set("surveyItemId",n.id)}),s.updateMapWidgetList(),s.setState({existSurveyMsg:null,mode:"settings",selectedSurvey:n})}),0),u.a.querySurvey({username:null===(t=s.props.user)||void 0===t?void 0:t.username,token:s.props.token,portalUrl:s.props.config.portalUrl||s.props.portalUrl},{isShared:e.isShared,isPublished:e.isPublished,queryFromClient:s.isPortal,surveyClientAPI:s.API}).then((function(e){s.setState({existSurveys:e})}))}})).then((function(){return"none"===s.state.mode&&s.setState({mode:"survey-createSurvey"}),s.setState({existSurveyMsg:'<div class="survey-list-loading-outter"><div class="jimu-secondary-loading"></div></div>'}),u.a.querySurvey({username:s.props.user.username,token:s.props.token,portalUrl:s.props.config.portalUrl||s.props.portalUrl},{isShared:e.isShared,isPublished:e.isPublished,queryFromClient:s.isPortal,surveyClientAPI:s.API})})).then((function(e){s.setState({existSurveyMsg:null,existSurveys:e});var t=s.props.config.surveyItemId;if(t){var n=e.find((function(e){return e.id===t}));n&&(s.updateMapWidgetList(),s.setState({selectedSurvey:n}),s.props.onSettingChange({id:s.props.id,config:s.props.config.set("selectedSurvey",n)}))}})).catch((function(e){s.setState({mode:"survey-createSurvey",existSurveyMsg:'<p class="error-message">'+s.props.intl.formatMessage({id:"errmsgGeneralLoading",defaultMessage:c.errmsgGeneralLoading})+"</p>"}),console.log(e)}))},s.getSurveyQuestionFields=function(){var e=s.props.config.surveyItemId;return Promise.resolve(!0).then((function(){if(e&&s.props.token)return u.a.getSurveyQuestionFields(e,{token:s.props.token})})).then((function(e){return e&&s.setState({surveyQuestionFields:e}),e}))},s.showSettingPage=function(){s.setState({mode:"settings"}),s.getSurveyQuestionFields()},s.handleCloseModal=function(){if(s.state.surveyChanged)s.setState({isShowCloseDesignerAlert:!0});else{s.setState({modalIsOpen:!1}),s.setState({surveyChanged:!1}),s.showSettingPage();var e=s.state.newSurveyItemId||s.props.config.surveyItemId;e&&s.props.onSettingChange({id:s.props.id,config:s.props.config.set("surveyItemId",e).set("timestamp",Date.now())})}},s.handleCloseDesignerAlert=function(e){s.setState({isShowCloseDesignerAlert:!1}),e&&(s.setState({surveyChanged:!1}),setTimeout((function(){s.handleCloseModal()}),0))},s.getThumbnailUrl=function(){var e=s.props.config.portalUrl||s.props.portalUrl||"https://www.arcgis.com",t=s.state.selectedSurvey.id,n=s.state.selectedSurvey.thumbnail;return(n+"").startsWith("http://")||(n+"").startsWith("https://")?n:e+"/sharing/rest/content/items/"+t+"/info/"+n+"?token="+s.props.token},s.setSurveyItemId=function(){var e=s.state.selectedSurvey;e&&e.id&&(s.props.onSettingChange({id:s.props.id,config:s.props.config.set("surveyItemId",e.id).set("hides",["navbar","header","description","footer","theme"])}),s.setState({mode:"settings"}))},s.editSurvey=function(){s.showSurvey123DesignerModal()},s.setAppearance=function(e,t){var n=[].concat(s.props.config.hides||[]);if(e&&n.indexOf(t)>=0){var i=n.indexOf(t);n.splice(i,1)}else n.push(t);s.props.onSettingChange({id:s.props.id,config:s.props.config.set("hides",n)})},s.onMapWidgetSelected=function(e){e&&e.length||s.clearMapping(),s.props.onSettingChange({id:s.props.id,useMapWidgetIds:e})},s.updateMapWidgetList=function(){var e=window._appState,t=window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder&&e.appStateInBuilder.appConfig:e.appConfig,n=t&&t.widgets,i=n?Object.keys(n).filter((function(e){return n[e]&&n[e].manifest&&n[e].manifest.properties&&n[e].manifest.properties.canCreateMapView})).map((function(e){return n[e]})):[];s.setState({mapWidgetList:i})},s.activeLinkDataChange=function(e){var t=e.currentTarget.checked;t&&s.updateMapWidgetList(),s.props.onSettingChange({id:s.props.id,config:s.props.config.set("activeLinkData",t)})},s.onFieldSelected=function(e,t,n){s.props.onSettingChange({id:s.props.id,config:s.props.config.setIn(["title","field"],t.name),useDataSources:[{dataSourceId:s.props.useDataSources[0].dataSourceId,mainDataSourceId:s.props.useDataSources[0].mainDataSourceId,dataViewId:s.props.useDataSources[0].dataViewId,rootDataSourceId:s.props.useDataSources[0].rootDataSourceId,fields:[t.name]}]})},s.onDataSourceSelected=function(e){e||s.clearMapping();var t=e?e.datasourceId:null,n=s.dsManager.getDataSource(t),r=n?n.layer:null;t&&n&&r||s.clearMapping(),s.setState({dsFeatureLayer:r,dsFeatureLayerFields:s.getLayerFields(r)});var a=e?e.rootDatasourceId:null;s.props.onSettingChange({id:s.props.id,useDataSources:[{dataSourceId:t,mainDataSourceId:t,rootDataSourceId:a}],config:s.props.config.set("layerViewInfo",e).set("fieldQuestionMapping",null)},[{id:s.props.id+"-output",label:s.props.label+" Query Result",type:i.DataSourceTypes.FeatureLayer,originDataSources:[{dataSourceId:t,mainDataSourceId:t,rootDataSourceId:a}]}])},s.addMapppingChange=function(e,t){var n=t.currentTarget.value,i=s.state.addMapping?s.state.addMapping.field:null,r=s.state.addMapping?s.state.addMapping.question:null;"field"===e?i=n:r=n,s.setState({addMapping:{field:i,question:r}})},s.clearMapping=function(){},s.onDataSourceRemoved=function(){},s.triggerEventTypeChange=function(){},s.showEditMappingPanel=function(e,t){if((s.state.editMapping||{}).index!==e){var n=s.props.config.fieldQuestionMapping||[];n=e>=0&&e<n.length?n[e]:null;var i=Object.assign({},n);i.index=e,s.setState({editMapping:i,addMapping:null})}},s.changeEditMapping=function(e,t){var n=t.currentTarget.value,i=Object.assign({},s.state.editMapping||{});"field"===e?i.field=n:i.question=n,s.setState({editMapping:i})},s.editMapping=function(e){var t=[].concat(s.props.config.fieldQuestionMapping||[]),n=s.state.editMapping||{};e>=0&&e<t.length&&(t[e]={field:n.field,question:n.question}),s.props.onSettingChange({id:s.props.id,config:s.props.config.set("fieldQuestionMapping",t)})},s.activeAddFieldQuestionConnPanel=function(){s.setState({addMapping:{field:null,question:null},editMapping:null})},s.deactiveAddFieldQuestionConnPanel=function(){s.setState({addMapping:null})},s.deleteConnection=function(e,t){t&&t.stopPropagation();var n=[].concat(s.props.config.fieldQuestionMapping||[]);e>=0&&e<n.length&&n.splice(e,1),s.props.onSettingChange({id:s.props.id,config:s.props.config.set("fieldQuestionMapping",n)})},s.addFieldQuestionConn=function(e){var t=s.state.addMapping.field,n=s.state.addMapping.question;if(t&&n){var i=[].concat(s.props.config.fieldQuestionMapping||[]);i.push({field:t,question:n}),s.props.onSettingChange({id:s.props.id,config:s.props.config.set("fieldQuestionMapping",i)}),s.deactiveAddFieldQuestionConnPanel()}else console.log("Please ensure field/question is not null.")},s.onSurveyQuestionFieldChanged=function(e){var t=e.currentTarget.value;t&&"null"!==t&&s.props.onSettingChange({id:s.props.id,config:s.props.config.set("selectedSurveyQuestionFields",[t])})},s.isDsConfigured=function(){return!(!s.props.useDataSources||1!==s.props.useDataSources.length)},s.resetSurvey=function(){s.props.onSettingChange({id:s.props.id,config:s.props.config.set("surveyItemId",null).set("hides",[]).set("embeds",["fullScreen","onSubmitted"]).set("selectedSurveyQuestionFields",[]).set("fieldQuestionMapping",[]).set("activeLinkData",!1).set("dsType",null).set("selectedSurvey",null)}),s.setState({mode:"survey-createSurvey",selectedSurvey:null,isCheckedSurveyItemId:!1,surveyQuestionFields:[],dsMapView:null,dsFeatureLayer:null,dsFeatureLayerFields:[]})},u.a.setQueryObject(s.props.queryObject),s.isPortal=!i.portalUrlUtils.isAGOLDomain(s.props.config.portalUrl||s.props.portalUrl),s.querySurvey(),s.addDesigerHandler(),s}return y(t,e),t.prototype.showSurvey123DesignerModal=function(e){e=e||this.props.config.surveyItemId;var t=i.SessionManager.getInstance(),n=this.props.config.portalUrl||this.props.portalUrl;if(!e)throw new Error("cannot get survey item id to open survey123 designer");var s=u.a.getSurvey123DesignerUrl(e,{portalUrl:n}),r=t.getMainSession();r&&r.token&&r.username&&r.tokenDuration&&(s+="#access_token="+r.token+"&username="+r.username+"&expires_in="+r.tokenDuration),this.setState({modalIsOpen:!0,newSurveyMsg:null});var a=this,o=0,l=setInterval((function(){a.state.modalIsOpen||a.setState({modalIsOpen:!0}),o++;var e=document.getElementById("survey123-designer");(e||o>100)&&(clearInterval(l),e.src=s)}),50)},t.prototype.render=function(){var e,t=this;return this.state.selectedSurvey&&this.props.config.surveyItemId&&!1===this.state.isCheckedSurveyItemId&&(this.setState({isCheckedSurveyItemId:!0}),this.showSettingPage()),Object(i.jsx)("div",{css:(e=this.props.theme,Object(i.css)(s||(s=p(["\n    &.survey123{\n        .survey123__section {\n\n            input + span {\n              // margin-left:5px; \n            }\n            .jimu-widget-setting--section-header.row >h6 {\n              font-size: 0.875rem;\n              color: ",";\n            }\n\n            .survey-list-msg {\n              padding: 0 5px;\n            }\n            .survey-list-loading-outter {\n              position: relative;\n              top: -18px;\n            }\n            .survey123__section-createSurvey, .select-survey-section {\n              .error-message {\n                color: ",";\n              }\n            }\n            .select-survey-section {\n              hr.split-line {\n                display: none;\n              }\n            }\n            .create-survey-container {\n              .jimu-widget-setting--row.items {\n                margin-top: 1.2rem;\n                display: block;\n                h6 {\n                  color: ",";\n                }\n                div.w-100 {\n                  font-size: 0.8125rem;\n                  line-height: 1.1875rem;\n                  margin-top: 0.3125rem;\n\n                }\n              }\n              .jimu-widget-setting--row >label {\n                font-size: 0.875rem;\n                font-weight: 400;\n                +p.w-100 {\n                  font-size: 0.8125rem;\n                  line-height: 1.1875rem;\n                  margin-top: 0.3125rem;\n                }\n              }\n            }\n        \n            .appearance, .section-title {\n              display: flex;\n              justify-content: space-between;\n              width:100%;\n              h6 {\n                margin-bottom: 0;\n              }\n            }\n\n            .select{\n              select {\n                width: 100%;\n              }\n            }\n\n            .mapping-container {\n              padding: 0.615em;\n              background: ",";\n              border-radius: 2px;\n              margin: 0.6em 0;\n              position: relative;\n              button:disabled, button[disabled] {\n                background:  #555555;\n              }\n              >select {\n                height: 26px;\n                vertical-align: middle;\n                font-size: 1em;\n                line-height: 26px;\n                padding: 0 22px 0 6px;\n                &:first-of-type {\n                  margin-bottom: 8px;\n                }\n              }\n              .btn-group {\n                width: 100%;\n                overflow: hidden;\n                .icon-remove-mapping {\n                  padding: 0 0.25em;\n                  margin-left: 0;\n                  margin-right: 0;\n                  svg.left-icon {\n                    margin-right: 0;\n                    margin-left: 0;\n                  }\n                }\n                button {\n                  margin: 8px 0 8px 8px;\n                  height: 26px;\n                  line-height: 26px;\n                  padding: 0;\n                  padding: 0px 14px;\n                }\n              }\n              >.link-info {\n                > p {\n                  margin-bottom: 0;\n                  line-height: 2em;\n                }\n                > div.center-line {\n                  width: 96%;\n                  height: 1px;\n                  background: ",";\n                  text-align: center;\n                  margin: 0.5em 2% 0.5em 2%;\n                  >.connect {\n                    display: inline-block;\n                    width: 26px;\n                    height: 20px;\n                    background: ",";\n                    position: relative;\n                    top: -10px;\n                  }\n                }\n                > div.delete-connect {\n                  display: none;\n                  position: absolute;\n                  right: 0;\n                  top: 0;\n                  cursor: pointer;\n                  background: ",";\n                  text-align: center;\n                  width: 24px;\n                  height: 24px;\n                }\n                &:hover > div.delete-connect {\n                  display: block;\n                }\n              }\n              \n            }\n\n            .setting-row {\n              margin: 0.5rem 0 0 0;\n              display: flex;\n              flex-flow: row wrap;\n              align-items: center;\n            }\n        \n            .section-title h5{\n              display: inline-block;\n              font-weight: 500;\n            }\n            \n            .section-title h6{\n              word-break: break-word;\n            }\n\n            .fea-layer-outter {\n              flex-wrap:wrap;\n            }\n\n            .use-feature-layer-setting {\n              width: 100%;\n              margin-top: 0.92em;\n            }\n            .feature-layer-dropdown {\n              width: 100%;\n              margin: 0.5rem 0 0 0;\n            }\n            &-resetSurvey {\n              position:relative;\n              // top: -8px;\n              height: 26px;\n              float:right;\n              line-height: 8px;\n\n              svg {\n                margin:0px !important;\n              }\n            }\n\n            .cursor-pointer{\n              &:hover{\n                cursor:pointer;\n              }\n            }\n              \n            &-surveyMenu {}\n        \n            &-selectExistingSurvey {}\n        \n            &-createSurvey {\n              overflow-y: hidden;\n              \n              span.isRequired{\n                position:relative;\n                /* left:-180px; */\n                color: ",";\n                top: 4px;\n                left: 4px;\n              }\n              input {\n                margin-top: 0.5em;\n              }\n            }\n        \n            &-surveySettings {\n              \n            }\n          }\n    }\n  "],["\n    &.survey123{\n        .survey123__section {\n\n            input + span {\n              // margin-left:5px; \n            }\n            .jimu-widget-setting--section-header.row >h6 {\n              font-size: 0.875rem;\n              color: ",";\n            }\n\n            .survey-list-msg {\n              padding: 0 5px;\n            }\n            .survey-list-loading-outter {\n              position: relative;\n              top: -18px;\n            }\n            .survey123__section-createSurvey, .select-survey-section {\n              .error-message {\n                color: ",";\n              }\n            }\n            .select-survey-section {\n              hr.split-line {\n                display: none;\n              }\n            }\n            .create-survey-container {\n              .jimu-widget-setting--row.items {\n                margin-top: 1.2rem;\n                display: block;\n                h6 {\n                  color: ",";\n                }\n                div.w-100 {\n                  font-size: 0.8125rem;\n                  line-height: 1.1875rem;\n                  margin-top: 0.3125rem;\n\n                }\n              }\n              .jimu-widget-setting--row >label {\n                font-size: 0.875rem;\n                font-weight: 400;\n                +p.w-100 {\n                  font-size: 0.8125rem;\n                  line-height: 1.1875rem;\n                  margin-top: 0.3125rem;\n                }\n              }\n            }\n        \n            .appearance, .section-title {\n              display: flex;\n              justify-content: space-between;\n              width:100%;\n              h6 {\n                margin-bottom: 0;\n              }\n            }\n\n            .select{\n              select {\n                width: 100%;\n              }\n            }\n\n            .mapping-container {\n              padding: 0.615em;\n              background: ",";\n              border-radius: 2px;\n              margin: 0.6em 0;\n              position: relative;\n              button:disabled, button[disabled] {\n                background:  #555555;\n              }\n              >select {\n                height: 26px;\n                vertical-align: middle;\n                font-size: 1em;\n                line-height: 26px;\n                padding: 0 22px 0 6px;\n                &:first-of-type {\n                  margin-bottom: 8px;\n                }\n              }\n              .btn-group {\n                width: 100%;\n                overflow: hidden;\n                .icon-remove-mapping {\n                  padding: 0 0.25em;\n                  margin-left: 0;\n                  margin-right: 0;\n                  svg.left-icon {\n                    margin-right: 0;\n                    margin-left: 0;\n                  }\n                }\n                button {\n                  margin: 8px 0 8px 8px;\n                  height: 26px;\n                  line-height: 26px;\n                  padding: 0;\n                  padding: 0px 14px;\n                }\n              }\n              >.link-info {\n                > p {\n                  margin-bottom: 0;\n                  line-height: 2em;\n                }\n                > div.center-line {\n                  width: 96%;\n                  height: 1px;\n                  background: ",";\n                  text-align: center;\n                  margin: 0.5em 2% 0.5em 2%;\n                  >.connect {\n                    display: inline-block;\n                    width: 26px;\n                    height: 20px;\n                    background: ",";\n                    position: relative;\n                    top: -10px;\n                  }\n                }\n                > div.delete-connect {\n                  display: none;\n                  position: absolute;\n                  right: 0;\n                  top: 0;\n                  cursor: pointer;\n                  background: ",";\n                  text-align: center;\n                  width: 24px;\n                  height: 24px;\n                }\n                &:hover > div.delete-connect {\n                  display: block;\n                }\n              }\n              \n            }\n\n            .setting-row {\n              margin: 0.5rem 0 0 0;\n              display: flex;\n              flex-flow: row wrap;\n              align-items: center;\n            }\n        \n            .section-title h5{\n              display: inline-block;\n              font-weight: 500;\n            }\n            \n            .section-title h6{\n              word-break: break-word;\n            }\n\n            .fea-layer-outter {\n              flex-wrap:wrap;\n            }\n\n            .use-feature-layer-setting {\n              width: 100%;\n              margin-top: 0.92em;\n            }\n            .feature-layer-dropdown {\n              width: 100%;\n              margin: 0.5rem 0 0 0;\n            }\n            &-resetSurvey {\n              position:relative;\n              // top: -8px;\n              height: 26px;\n              float:right;\n              line-height: 8px;\n\n              svg {\n                margin:0px !important;\n              }\n            }\n\n            .cursor-pointer{\n              &:hover{\n                cursor:pointer;\n              }\n            }\n              \n            &-surveyMenu {}\n        \n            &-selectExistingSurvey {}\n        \n            &-createSurvey {\n              overflow-y: hidden;\n              \n              span.isRequired{\n                position:relative;\n                /* left:-180px; */\n                color: ",";\n                top: 4px;\n                left: 4px;\n              }\n              input {\n                margin-top: 0.5em;\n              }\n            }\n        \n            &-surveySettings {\n              \n            }\n          }\n    }\n  "])),e.colors.palette.dark[600],e.colors.danger,e.colors.palette.dark[500],e.colors.secondary,e.colors.palette.secondary[800],e.colors.secondary,e.colors.palette.secondary[400],e.colors.danger)),className:"jimu-widget-setting survey123"},Object(i.jsx)("div",{className:"survey123__section",style:-1!==this.state.mode.indexOf("survey-")?{display:"block"}:{display:"none"}},Object(i.jsx)(a.SettingSection,null,Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("p",null,this.props.intl.formatMessage({id:"chooseSurvey",defaultMessage:c.chooseSurvey}))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)(l.Radio,{name:"survey-survey",className:"cursor-pointer",id:"survey-survey-createNewSurvey",checked:"survey-createSurvey"===this.state.mode,onChange:function(){t.setState({mode:"survey-createSurvey"})}}),Object(i.jsx)(l.Label,{for:"survey-survey-createNewSurvey",className:"cursor-pointer"},"  ",this.props.intl.formatMessage({id:"createNewSurveyLabel",defaultMessage:c.createNewSurveyLabel}))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)(l.Radio,{name:"survey-survey",className:"cursor-pointer",id:"survey-survey-chooseExistingSurvey",checked:"survey-selectExistingSurvey"===this.state.mode,onChange:function(){t.setState({mode:"survey-selectExistingSurvey"})}}),Object(i.jsx)(l.Label,{for:"survey-survey-chooseExistingSurvey",className:"cursor-pointer"},"  ",this.props.intl.formatMessage({id:"chooseSurveyLabel",defaultMessage:c.chooseSurveyLabel})))),Object(i.jsx)("div",{className:"survey123__section-selectExistingSurvey",style:"survey-selectExistingSurvey"===this.state.mode?{display:"block"}:{display:"none"}},Object(i.jsx)(a.SettingSection,{className:"select-survey-section"},Object(i.jsx)(a.SettingRow,null,Object(i.jsx)(l.Select,{onChange:this.onExistSurveyChanged,disabled:0===this.state.existSurveys.length,value:this.state.selectedSurvey?this.state.selectedSurvey.id:"null",style:{width:"100%",padding:"2px 5px"}},Object(i.jsx)("option",{value:"null"},this.props.intl.formatMessage({id:"selectSurveyTip",defaultMessage:c.selectSurveyTip})),this.state.existSurveys.length>0?this.state.existSurveys.map((function(e){return Object(i.jsx)("option",{value:e.id,key:e.id},e.title)})):"")),Object(i.jsx)("div",{className:"survey-list-msg",dangerouslySetInnerHTML:{__html:this.state.existSurveyMsg}})),Object(i.jsx)("div",{style:{display:this.state.selectedSurvey?"block":"none"}},Object(i.jsx)(a.SettingSection,{title:this.nls("surveyDetailLabel"),className:"create-survey-container"},this.state.selectedSurvey?[Object(i.jsx)(a.SettingRow,{key:"surveyThumnail"},Object(i.jsx)("img",{src:this.getThumbnailUrl(),style:{width:"100%",height:"auto"}})),Object(i.jsx)(a.SettingRow,{key:"surveyTitle"},Object(i.jsx)("span",{style:{wordBreak:"break-word",fontSize:"0.8125rem",color:"#FFFFFF"}},this.state.selectedSurvey.title)),this.state.selectedSurvey.snippet?Object(i.jsx)(a.SettingRow,{className:"items",key:"surveySnippet"},Object(i.jsx)("h6",null,this.nls("summaryLabel")),Object(i.jsx)("div",{className:"w-100"},this.state.selectedSurvey.snippet)):null,Object(i.jsx)(a.SettingRow,{key:"surveyInsertBtn"},Object(i.jsx)(l.Button,{type:"primary",className:"w-100",onClick:this.setSurveyItemId},this.props.intl.formatMessage({id:"insertLabel",defaultMessage:c.insertLabel})))]:null))),Object(i.jsx)("div",{className:"survey123__section-createSurvey",style:"survey-createSurvey"===this.state.mode?{display:"block"}:{display:"none"}},Object(i.jsx)(a.SettingSection,null,Object(i.jsx)("div",{className:"w-100 d-flex flex-wrap align-items-center justify-content-between setting-header setting-title pb-2"},Object(i.jsx)("div",null,this.nls("surveyTitleLabel"),Object(i.jsx)("span",{className:"isRequired"},"*")),Object(i.jsx)(l.TextInput,{className:"w-100",value:this.state.newSurveyTitle||"",name:"newSurveyTitle",onChange:this.onNewSurveyValueChanged}),!this.state.newSurveyTitle&&this.state.newSurveyTitleDirty?Object(i.jsx)("div",{className:"error-message"},this.props.intl.formatMessage({id:"surveyTitleRequiredMsg",defaultMessage:c.surveyTitleRequiredMsg})):"",this.state.createSurveyErrorMsg&&!this.state.newSurveyTitleDirty?Object(i.jsx)("div",{className:"error-message"},this.props.intl.formatMessage({id:"surveyTitleDuplicateMsg",defaultMessage:c.surveyTitleDuplicateMsg})):""),Object(i.jsx)("div",{className:"w-100 d-flex flex-wrap align-items-center justify-content-between setting-header setting-title pb-2"},Object(i.jsx)("div",null,this.nls("surveyTagLabel"),Object(i.jsx)("span",{className:"isRequired"},"*")),Object(i.jsx)(l.TextInput,{className:"w-100",value:this.state.newSurveyTags||"",name:"newSurveyTags",onChange:this.onNewSurveyValueChanged}),!this.state.newSurveyTags&&this.state.newSurveyTagsDirty?Object(i.jsx)("div",{className:"error-message"},this.props.intl.formatMessage({id:"surveyTagsRequiredMsg",defaultMessage:c.surveyTagsRequiredMsg})):""),Object(i.jsx)("div",{className:"w-100 d-flex flex-wrap align-items-center justify-content-between setting-header setting-title pb-2"},Object(i.jsx)("div",null,this.nls("surveySummaryLabel")),Object(i.jsx)(l.TextInput,{className:"w-100",value:this.state.newSurveySnippet||"",name:"newSurveySnippet",onChange:this.onNewSurveyValueChanged})),Object(i.jsx)(a.SettingRow,{flow:"wrap"},Object(i.jsx)(l.Button,{type:"primary",className:"w-100",disabled:!0===this.state.newSurveyLoading,onClick:this.createSurvey},this.props.intl.formatMessage({id:"createSurveyBtn",defaultMessage:c.createSurveyBtn})),Object(i.jsx)("span",{style:{color:"#ff0000",marginTop:"10px"}},this.state.newSurveyMsg),Object(i.jsx)("div",{className:"w-100",style:{position:"relative",display:"block",marginTop:"50px"}},Object(i.jsx)("div",{className:"jimu-secondary-loading",style:!0===this.state.newSurveyLoading?{display:"block"}:{display:"none"}})))))),Object(i.jsx)("div",{className:"survey123__section",style:-1!==this.state.mode.indexOf("settings")?{display:"block"}:{display:"none"}},Object(i.jsx)(a.SettingSection,null,Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("div",{className:"section-title"},Object(i.jsx)("h6",null,this.state.selectedSurvey?this.state.selectedSurvey.title:""),Object(i.jsx)(l.Button,{className:"survey123__section-resetSurvey",onClick:function(){return t.setState({mode:"confirmResetSurvey"})}},Object(i.jsx)(l.Icon,{size:"8",icon:this.iconRefresh})))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)(l.Button,{className:"w-100",color:"primary",type:"primary",onClick:this.editSurvey},this.props.intl.formatMessage({id:"editSurveyBtn",defaultMessage:c.editSurveyBtn})))),Object(i.jsx)(a.SettingSection,{title:this.nls("appearanceTitle")},Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("div",{className:"appearance"},Object(i.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsBarLabel",defaultMessage:c.showOptionsBarLabel})),Object(i.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.config.hides.indexOf("navbar")<0,onChange:function(e){t.setAppearance(e.target.checked,"navbar")}}))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("div",{className:"appearance"},Object(i.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsHeaderLabel",defaultMessage:c.showOptionsHeaderLabel})),Object(i.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.config.hides.indexOf("header")<0,onChange:function(e){t.setAppearance(e.target.checked,"header")}}))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("div",{className:"appearance"},Object(i.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsDesLabel",defaultMessage:c.showOptionsDesLabel})),Object(i.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.config.hides.indexOf("description")<0,onChange:function(e){t.setAppearance(e.target.checked,"description")}}))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("div",{className:"appearance"},Object(i.jsx)("span",null,this.props.intl.formatMessage({id:"showOptionsFooterLabel",defaultMessage:c.showOptionsFooterLabel})),Object(i.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.config.hides.indexOf("footer")<0,onChange:function(e){t.setAppearance(e.target.checked,"footer")}}))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("div",{className:"appearance"},Object(i.jsx)("span",null,this.props.intl.formatMessage({id:"useSurveyTheme",defaultMessage:c.useSurveyTheme})),Object(i.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.config.hides.indexOf("theme")<0,onChange:function(e){t.setAppearance(e.target.checked,"theme")}})))),Object(i.jsx)(a.SettingSection,null,Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("div",{className:"section-title"},Object(i.jsx)("h6",null,this.nls("sendDataToSurveyTitle")),Object(i.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.config.activeLinkData,onChange:this.activeLinkDataChange}))),this.props.config.activeLinkData&&Object(i.jsx)(i.React.Fragment,null,this.state.mapWidgetList&&this.state.mapWidgetList.length>0?Object(i.jsx)(i.React.Fragment,null,Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("span",{className:"w-100"},this.nls("sendDataToSurveyDesc"))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("span",null,this.nls("selectSourceWidget"))),Object(i.jsx)("div",{className:"setting-row"},Object(i.jsx)(a.JimuMapViewSelector,{onSelect:this.onMapWidgetSelected,useMapWidgetIds:this.props.useMapWidgetIds})),Object(i.jsx)(a.SettingRow,{className:"fea-layer-outter"},Object(i.jsx)(a.SettingRow,{className:"use-feature-layer-setting"},Object(i.jsx)("span",null,this.nls("selectSourceLayer"))),Object(i.jsx)("div",{className:"feature-layer-dropdown"},Object(i.jsx)(a.JimuLayerViewSelector,{onSelect:this.onDataSourceSelected,useMapWidgetIds:this.props.useMapWidgetIds,jimuLayerViewInfo:this.props.config&&this.props.config.layerViewInfo}))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("span",{className:"w-100"},this.nls("triggerEventDesc1"))),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("span",null,this.nls("addConnTitle"))),this.props.useMapWidgetIds&&this.props.useMapWidgetIds.length&&this.props.config&&this.props.config.layerViewInfo&&this.props.config.layerViewInfo.datasourceId?Object(i.jsx)(i.React.Fragment,null,this.props.config.fieldQuestionMapping&&this.props.config.fieldQuestionMapping.length>0?Object(i.jsx)("div",null,this.props.config.fieldQuestionMapping.asMutable().map((function(e,n){var s=e.field,r=e.question;return Object(i.jsx)("div",{key:s+"_"+r+"_"+n,className:"mapping-container"},t.state.editMapping&&t.state.editMapping.index===n?Object(i.jsx)(i.React.Fragment,null,Object(i.jsx)(l.Select,{value:t.state.editMapping.field||"",style:{marginBottom:"8px"},onChange:function(e){return t.changeEditMapping("field",e)}},t.state.dsFeatureLayerFields.map((function(e){return Object(i.jsx)("option",{key:"edit_"+e.name+"_"+n,value:e.name},e.alias||e.name)}))),Object(i.jsx)(l.Select,{value:t.state.editMapping.question||"",onChange:function(e){return t.changeEditMapping("question",e)}},t.state.surveyQuestionFields.length>0&&t.state.surveyQuestionFields.map((function(e){return Object(i.jsx)("option",{key:"edit_"+e.name+"_"+n,value:e.name},e.label)}))),Object(i.jsx)("div",{className:"btn-group"},Object(i.jsx)(l.Button,{className:"float-left icon-remove-mapping",type:"primary",color:"primary",onClick:function(){t.deleteConnection(n),t.setState({editMapping:null})}},Object(i.jsx)(l.Icon,{size:"16",style:{marginLeft:"0",marginRight:"0"},icon:t.iconRemove})),Object(i.jsx)(l.Button,{className:"float-right",type:"secondary",onClick:function(){t.setState({editMapping:null})}},t.nls("cancel")),Object(i.jsx)(l.Button,{className:"float-right",type:"primary",color:"primary",onClick:function(){t.editMapping(n),t.setState({editMapping:null})}},t.nls("ok")))):Object(i.jsx)(i.React.Fragment,null,Object(i.jsx)("div",{className:"link-info",onClick:function(e){return t.showEditMappingPanel(n,e)}},Object(i.jsx)("p",null,t.getFielAlias(s)),Object(i.jsx)("div",{className:"center-line"},Object(i.jsx)("div",{className:"connect"},Object(i.jsx)(l.Icon,{size:"16",icon:t.iconLink}))),Object(i.jsx)("p",null,t.getQuestionLabel(r)),Object(i.jsx)("div",{className:"delete-connect",onClick:function(e){return t.deleteConnection(n,e)}},Object(i.jsx)(l.Icon,{size:"12",icon:t.iconRemove})))))}))):"",this.state.addMapping&&this.state.dsFeatureLayer&&this.state.dsFeatureLayerFields&&this.state.dsFeatureLayerFields.length>0&&Object(i.jsx)("div",{className:"mapping-container"},Object(i.jsx)(l.Select,{value:this.state.addMapping.field||"null",style:{marginBottom:"8px"},onChange:function(e){return t.addMapppingChange("field",e)}},Object(i.jsx)("option",{key:"add_field_default",value:"null"},this.nls("addConnSelectField")),this.state.dsFeatureLayerFields.map((function(e){return Object(i.jsx)("option",{key:"add_"+e.name,value:e.name},e.alias||e.name)}))),Object(i.jsx)(l.Select,{value:this.state.addMapping.question||"null",onChange:function(e){return t.addMapppingChange("question",e)}},Object(i.jsx)("option",{key:"add_question_default",value:"null"},this.nls("addConnSelectQuestion")),this.state.surveyQuestionFields.length>0&&this.state.surveyQuestionFields.map((function(e){return Object(i.jsx)("option",{key:"add_"+e.name,value:e.name},e.label)}))),Object(i.jsx)("div",{className:"btn-group"},Object(i.jsx)(l.Button,{className:"float-right",type:"secondary",onClick:this.deactiveAddFieldQuestionConnPanel},this.nls("cancel")),Object(i.jsx)(l.Button,{className:"float-right",type:"primary",disabled:!this.state.addMapping.field||"null"===this.state.addMapping.field||!this.state.addMapping.question||"null"===this.state.addMapping.question,onClick:this.addFieldQuestionConn},this.nls("ok"))))):"",Object(i.jsx)(a.SettingRow,null,Object(i.jsx)(l.Button,{className:"w-100",type:"primary",disabled:null!==this.state.addMapping||null!==this.state.editMapping||!(this.props.useMapWidgetIds&&this.props.useMapWidgetIds.length&&this.props.config&&this.props.config.layerViewInfo&&this.props.config.layerViewInfo.datasourceId),onClick:this.activeAddFieldQuestionConnPanel},this.nls("addConnBtn")))):Object(i.jsx)(a.SettingRow,null,Object(i.jsx)("span",null,this.nls("sendDataDisabled1")))))),Object(i.jsx)("div",{className:"survey123__section",style:-1!==this.state.mode.indexOf("confirmResetSurvey")?{display:"block"}:{display:"none"}},Object(i.jsx)(a.SettingSection,{title:this.nls("resetSurveyLabel")},Object(i.jsx)(a.SettingRow,null,this.props.intl.formatMessage({id:"resetSurveyTip",defaultMessage:c.resetSurveyTip})),this.props.intl.formatMessage({id:"confirmResetSurveyTip",defaultMessage:c.confirmResetSurveyTip}),Object(i.jsx)(a.SettingRow,null),Object(i.jsx)(a.SettingRow,null,Object(i.jsx)(l.Button,{type:"primary",onClick:function(){return t.resetSurvey()}},this.nls("yes")),Object(i.jsx)(l.Button,{onClick:function(){return t.showSettingPage()}},this.nls("no"))))),Object(i.jsx)(l.Modal,{isOpen:this.state.modalIsOpen,className:"w-100 h-100 p-0 m-0",css:Object(i.css)(g||(g=h(["\n          z-index: 100000;\n          overflow: hidden;\n          max-width: 100% !important;\n          .modal-content{\n            width: 100%;\n            height: 100%;\n          }\n        "],["\n          z-index: 100000;\n          overflow: hidden;\n          max-width: 100% !important;\n          .modal-content{\n            width: 100%;\n            height: 100%;\n          }\n        "])))},Object(i.jsx)("div",{style:{width:"100%",height:"80px",padding:"23px 60px 23px 30px",color:"#ffffff",backgroundColor:"#000000"}},Object(i.jsx)("p",{style:{fontSize:"24px",marginBottom:0,lineHeight:"33px"}},this.props.intl.formatMessage({id:"editSurveyBtn",defaultMessage:c.editSurveyBtn})),Object(i.jsx)("button",{color:"primary",onClick:this.handleCloseModal,style:{position:"absolute",top:"28px",right:"30px",backgroundColor:"#000000",color:"#ffffff",border:"0px",cursor:"pointer",padding:0}},Object(i.jsx)(l.Icon,{size:"24",icon:this.closeIcon24}))),Object(i.jsx)("iframe",{id:"survey123-designer",width:"100%",style:{height:"calc(100% - 90px)",width:"100%",border:"0px"}}),Object(i.jsx)(l.AlertPopup,{isOpen:this.state.isShowCloseDesignerAlert,okLabel:this.nls("ok"),title:this.props.label,toggle:this.handleCloseDesignerAlert},Object(i.jsx)("div",{style:{fontSize:"1rem"}},this.nls("msgUnsavedBeforeLeaving")))))},t}(i.React.PureComponent);t.default=v},59:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M2.561 7.876l1.138 20.023C3.699 30.164 5.83 32 8.459 32h15.724c2.629 0 4.76-1.836 4.76-4.101l1.095-20.023H2.562zm28.806-1.42c.005-.844.008-.901.008-.957 0-2.202-1.483-3.411-3.472-3.411l-5.537.005C22.366.937 21.082 0 19.768 0h-6.893c-1.314 0-2.64.937-2.64 2.093l-5.543-.005c-2.197 0-3.472 1.473-3.472 3.411 0 .057.003.113.008.957h30.139zm-10.306 6.682c0-.638.588-1.156 1.314-1.156s1.314.517 1.314 1.156v13.24c0 .638-.588 1.156-1.314 1.156s-1.314-.517-1.314-1.156v-13.24zm-6.077 0c0-.638.589-1.156 1.315-1.156s1.314.517 1.314 1.156v13.24c0 .638-.588 1.156-1.314 1.156s-1.315-.517-1.315-1.156v-13.24zm-6.074 0c0-.638.588-1.156 1.315-1.156s1.314.517 1.314 1.156v13.24c0 .638-.589 1.156-1.314 1.156s-1.315-.517-1.315-1.156v-13.24z"></path></svg>'},71:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19.637 15.866L30.951 27.18a2.667 2.667 0 01-3.771 3.771L15.866 19.637 4.552 30.951A2.667 2.667 0 01.781 27.18l11.314-11.314L.781 4.552A2.667 2.667 0 014.552.781l11.314 11.314L27.18.781a2.667 2.667 0 013.771 3.771L19.637 15.866z"></path></svg>'},8:function(e,t){e.exports=r}}))}}}));