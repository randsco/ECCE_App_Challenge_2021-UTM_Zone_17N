System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-for-builder","jimu-ui/advanced/data-source-selector"],(function(e){var i,t,a,n,s;return{setters:[function(e){i=e},function(e){t=e},function(e){a=e},function(e){n=e},function(e){s=e}],execute:function(){e(function(e){var i={};function t(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=i,t.d=function(e,i,a){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var n in e)t.d(a,n,function(i){return e[i]}.bind(null,n));return a},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=407)}({0:function(e,t){e.exports=i},1:function(e,i){e.exports=t},11:function(e,i){e.exports=s},2:function(e,i){e.exports=a},305:function(e,i){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA5IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA5IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjkzIiBoZWlnaHQ9IjU0IiByeD0iMiIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMzIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMTIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjE5IiB3aWR0aD0iODUiIGhlaWdodD0iMSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjE5IiB3aWR0aD0iMTYiIGhlaWdodD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTIiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMzAiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNDgiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjI0IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNTIiIHk9IjMyIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjM5IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjQ2IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjUzIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjI0IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNzMiIHk9IjMyIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjM5IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjQ2IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},306:function(e,i){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA5IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA5IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjkzIiBoZWlnaHQ9IjU0IiByeD0iMiIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMzIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMTIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjEyIiB3aWR0aD0iMzgiIGhlaWdodD0iOCIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTQiIHk9IjE0IiB3aWR0aD0iMjgiIGhlaWdodD0iNCIgZmlsbD0iIzE4MTgxOCIvPg0KPHBhdGggZD0iTTQ0IDE1SDQ4TDQ2IDE3TDQ0IDE1WiIgZmlsbD0iIzE4MTgxOCIvPg0KPHJlY3QgeD0iNTIiIHk9IjI0IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNTIiIHk9IjMyIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjM5IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjQ2IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjUzIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjI0IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNzMiIHk9IjMyIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjM5IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjQ2IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},407:function(e,i,t){"use strict";t.r(i);var a,n,s,o=t(0),l=t(1),r=t(2),c=t(11),I={newSheet:"New sheet",sheetStyle:"Arrangement style",layerConfig:"Sheet configuration",enableAttachements:"Show attachments",enableSearch:"Search",searchFields:"Select searching fields",countSelected:"{selectedCount} items selected",fullMatch:"Exact match",allowCsv:"Allow exporting to CSV",enableSelect:"Select records",enableEdit:"Allow editing",enableRefresh:"Refresh",configFields:"Configure fields",dropdown:"Dropdown",configTips:"Select fields for initial display"},d=(a=function(e,i){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}a(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),g=function(e,i){return Object.defineProperty?Object.defineProperty(e,"raw",{value:i}):e.raw=i,e},u=t(91),p=function(e){function i(i){var t=e.call(this,i)||this;return t.supportedDsTypes=Object(o.Immutable)([c.AllDataSourceTypes.FeatureLayer]),t.nameChange=function(e){if(e&&e.target&&e.target.value){var i=e.target.value.trim();t.props.optionChange("name",i)}},t.handleCheckboxChange=function(e){var i=e.currentTarget;i&&t.props.optionChange(i.dataset.field,i.checked)},t.formatMessage=function(e,i){var a=Object.assign({},I,l.defaultMessages);return t.props.intl.formatMessage({id:e,defaultMessage:a[e]},i)},t.displaySelectedFields=function(e){return t.formatMessage("countSelected",{selectedCount:e.length})},t.onFieldChange=function(e){0!==e.length&&t.props.optionChange("tableFields",e)},t.onDataSourceCreated=function(e){t.setState({dataSource:e})},t.getSearchingFields=function(e){var i=t.state.dataSource;if(i){var a=i.getSchema();if(a&&a.fields){var n=[];return Object.keys(a.fields).forEach((function(i){var t=a.fields[i];e?t.type==o.JimuFieldType.String&&n.push({value:i,label:a.fields[i].alias||a.fields[i].name}):n.push({value:i,label:a.fields[i].alias||a.fields[i].name})})),n}}return[]},t.handleChooseSearchingFieldsChange=function(e,i,a){t.props.optionChange("searchFields",a.join(","))},t.state={dataSource:void 0},t}return d(i,e),i.prototype.getStyle=function(e){return Object(o.css)(n||(n=g(["\n      .layer-config-panel{\n        .setting-header {\n          padding: "," "," "," ","\n        }\n        .setting-title {\n          font-size: ",";\n          .layer-config-label{\n            color: ",";\n          }\n        }\n        .setting-container {\n          height: calc(100% - ",");\n          overflow: auto;\n          .table-options{\n            .table-options-item{\n              display: flex;\n              justify-content: space-between;\n              margin-bottom: 8px;\n            }\n          }\n          .ds-container{\n            position: absolute;\n            display: none;\n          }\n          .component-field-selector{\n            .search-input{\n              width: 100%;\n            }\n            .field-list{\n              max-height: 300px;\n            }\n          }\n          .config-word-break{\n            word-break: break-all;\n          }\n        }\n      }\n    "],["\n      .layer-config-panel{\n        .setting-header {\n          padding: "," "," "," ","\n        }\n        .setting-title {\n          font-size: ",";\n          .layer-config-label{\n            color: ",";\n          }\n        }\n        .setting-container {\n          height: calc(100% - ",");\n          overflow: auto;\n          .table-options{\n            .table-options-item{\n              display: flex;\n              justify-content: space-between;\n              margin-bottom: 8px;\n            }\n          }\n          .ds-container{\n            position: absolute;\n            display: none;\n          }\n          .component-field-selector{\n            .search-input{\n              width: 100%;\n            }\n            .field-list{\n              max-height: 300px;\n            }\n          }\n          .config-word-break{\n            word-break: break-all;\n          }\n        }\n      }\n    "])),o.polished.rem(10),o.polished.rem(16),o.polished.rem(0),o.polished.rem(16),o.polished.rem(16),e.colors.palette.dark[600],o.polished.rem(58))},i.prototype.render=function(){var e,i,t=this,a=this.props,n=a.useDataSource,s=a.optionChange,I=a.theme,d=a.tableFields,g=a.searchFields,p=this.state.dataSource,h=[];return d&&d.length>0&&d.map((function(e){h.push(e.jimuName)})),Object(o.jsx)("div",{className:"w-100 h-100",css:this.getStyle(I)},Object(o.jsx)("div",{className:"w-100 h-100 layer-config-panel"},Object(o.jsx)("div",{className:"w-100 d-flex align-items-center justify-content-between setting-header setting-title pb-2"},Object(o.jsx)("h5",{className:"text-truncate layer-config-label mt-2"},this.formatMessage("layerConfig")),Object(o.jsx)(l.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-2",onClick:this.props.onClose},Object(o.jsx)(l.Icon,{icon:u,size:"16"}))),Object(o.jsx)("div",{className:"setting-container"},Object(o.jsx)(r.SettingSection,{title:this.formatMessage("data")},Object(o.jsx)(r.SettingRow,null,Object(o.jsx)(c.DataSourceSelector,{types:this.supportedDsTypes,disableRemove:function(){return!0},useDataSources:n?Object(o.Immutable)([n]):Object(o.Immutable)([]),mustUseDataSource:!0,onChange:this.props.dataSourceChange,closeDataSourceListOnChange:!0}))),Object(o.jsx)(r.SettingSection,{title:this.formatMessage("label")},Object(o.jsx)(r.SettingRow,null,Object(o.jsx)(l.TextInput,{type:"text",className:"w-100",value:this.props.name?this.props.name:"",onChange:this.nameChange}))),Object(o.jsx)(r.SettingSection,{title:this.formatMessage("configFields")},Object(o.jsx)(r.SettingRow,null,this.formatMessage("configTips")),Object(o.jsx)(r.SettingRow,null,Object(o.jsx)(c.FieldSelector,{useDataSources:n?Object(o.Immutable)([n]):Object(o.Immutable)([]),onChange:this.onFieldChange,selectedFields:Object(o.Immutable)(h),isMultiple:!0,isSearchInputHidden:!1,isDataSourceDropDownHidden:!0})),(null===(i=null===(e=p)||void 0===e?void 0:e.layerDefinition)||void 0===i?void 0:i.hasAttachments)&&Object(o.jsx)(r.SettingRow,null,Object(o.jsx)("div",{className:"d-flex w-100"},Object(o.jsx)(l.Checkbox,{"data-field":"enableAttachements",onClick:this.handleCheckboxChange,checked:this.props.enableAttachements}),Object(o.jsx)("div",{className:"ml-2 config-word-break",title:this.formatMessage("enableAttachements")},this.formatMessage("enableAttachements"))))),n&&Object(o.jsx)(r.SettingSection,{title:this.formatMessage("tools")},Object(o.jsx)("div",{className:"w-100 table-options"},Object(o.jsx)("div",{className:"table-options-item",key:"enableSearch"},Object(o.jsx)("span",{className:"text-break",style:{width:"80%"}},this.formatMessage("enableSearch")),Object(o.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.enableSearch||!1,onChange:function(e){s("enableSearch",e.target.checked)}}))),Object(o.jsx)("div",{className:"ds-container"},Object(o.jsx)(o.DataSourceComponent,{useDataSource:Object(o.Immutable)(n),onDataSourceCreated:this.onDataSourceCreated})),this.props.enableSearch&&Object(o.jsx)(r.SettingRow,{flow:"wrap",label:this.formatMessage("searchFields")},Object(o.jsx)("div",{className:"d-flex w-100 search-container",style:{zIndex:3}},Object(o.jsx)(l.MultiSelect,{items:Object(o.Immutable)(this.getSearchingFields(!0)),values:g&&Object(o.Immutable)(g.split(",")),className:"search-multi-select",fluid:!0,onClickItem:this.handleChooseSearchingFieldsChange,displayByValues:this.displaySelectedFields})),Object(o.jsx)("div",{className:"d-flex w-100",style:{marginTop:"10px"}},Object(o.jsx)(l.Checkbox,{"data-field":"searchExact",onClick:this.handleCheckboxChange,checked:this.props.searchExact}),Object(o.jsx)("div",{className:"ml-2 config-word-break",title:this.formatMessage("fullMatch")},this.formatMessage("fullMatch")))),Object(o.jsx)(r.SettingRow,null,Object(o.jsx)("div",{className:"w-100 table-options"},["enableSelect","enableRefresh"].map((function(e,i){return Object(o.jsx)("div",{className:"table-options-item",key:i},Object(o.jsx)("span",{className:"text-break",style:{width:"80%"}},t.formatMessage(e)),Object(o.jsx)(l.Switch,{className:"can-x-switch",checked:t.props[e]||!1,onChange:function(i){s(e,i.target.checked)}}))}))))))))},i}(o.React.PureComponent),h=t(8),m=t(55),f=function(){var e=function(i,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(i,t)};return function(i,t){function a(){this.constructor=i}e(i,t),i.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}(),b=function(e,i){return Object.defineProperty?Object.defineProperty(e,"raw",{value:i}):e.raw=i,e},D=function(){return(D=Object.assign||function(e){for(var i,t=1,a=arguments.length;t<a;t++)for(var n in i=arguments[t])Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);return e}).apply(this,arguments)},j=t(71),M=function(e){function i(i){var t=e.call(this,i)||this;return t.updateDsHash=function(e){t.dsHash={};var i=0;e.map((function(e){t.dsHash[i]=e.useDataSource,i++}))},t.getNewConfigId=function(e){var i;return e+"-"+(((null===(i=t.props.config)||void 0===i?void 0:i.layersConfig.length)>0?t.getArrayMaxId(t.props.config.layersConfig):0)+1)},t.dataSourceChangeSave=function(e){if(e){var i=Object(o.Immutable)(e[0]),a=t.dsManager.getDataSource(i.dataSourceId),n=a&&a.getSchema(),s=["CreationDate","Creator","EditDate","Editor","GlobalID"],l=Object.values(n.fields),r=l.filter((function(e){return s.indexOf(e.jimuName)<0}));t.dsManager.createDataSourceByUseDataSource(Object(o.Immutable)(e[0])).then((function(e){var a,n={id:t.getNewConfigId(e.id),name:e.getLabel(),useDataSource:i,allFields:l,tableFields:r,enableAttachements:!1,enableEdit:!1,allowCsv:!1,enableSearch:!1,searchFields:"",enableRefresh:!0,enableSelect:!0};if(t.props.config.layersConfig[t.index]){var s=t.props.config.layersConfig.asMutable({deep:!0});s.splice(t.index,1,n),a=Object(o.Immutable)(s)}else a=t.props.config.layersConfig.concat([Object(o.Immutable)(n)]);t.dsHash[t.index]=i,t.updateDsHash(a);var c={id:t.props.id,config:t.props.config.set("layersConfig",a),useDataSources:t.getUseDataSourcesByDsHash()};t.props.onSettingChange(c)}))}},t.onCloseLayerPanel=function(){t.setState({showLayerPanel:!1}),t.index=0},t.getUniqueValues=function(e,i){return void 0===e&&(e=[]),void 0===i&&(i=[]),e.concat(i).filter((function(e,i,t){return t.indexOf(e)===i}))},t.getUseDataSourcesByDsHash=function(){var e={};Object.keys(t.dsHash).map((function(i){var a,n=t.dsHash[i].dataSourceId;a=e[n]?Object(o.Immutable)({dataSourceId:t.dsHash[i].dataSourceId,mainDataSourceId:t.dsHash[i].mainDataSourceId,dataViewId:t.dsHash[i].dataViewId,rootDataSourceId:t.dsHash[i].rootDataSourceId,fields:t.getUniqueValues(e[n].fields,t.dsHash[i].fields)}):t.dsHash[i],e[n]=a}));var i=[];return Object.keys(e).map((function(t){i.push(e[t])})),i},t.removeLayer=function(e){t.index===e&&t.onCloseLayerPanel();var i=t.props.config.layersConfig.asMutable({deep:!0});i.splice(e,1);var a=t.props.config.set("layersConfig",i);delete t.dsHash[e],t.updateDsHash(i);var n={id:t.props.id,config:a,useDataSources:t.getUseDataSourcesByDsHash()};t.props.onSettingChange(n),t.index>e&&t.index--,h.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t.props.id,propKey:"removeLayerFlag",value:!0})},t.optionChangeSave=function(e,i){if(t.props.config.layersConfig[t.index]){var a=t.props.config.layersConfig.asMutable({deep:!0}),n=Object(o.Immutable)(a[t.index]).set(e,i);a.splice(t.index,1,n.asMutable({deep:!0}));var s={id:t.props.id,config:t.props.config.set("layersConfig",a)};t.props.onSettingChange(s)}h.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t.props.id,propKey:"removeLayerFlag",value:!0})},t.getStyle=function(e){return Object(o.css)(s||(s=b(["\n      .widget-setting-table{\n        .filter-item {\n          display: flex;\n          padding: 0.5rem 0.75rem;\n          margin-bottom: 0.25rem;\n          line-height: 23px;\n          cursor: pointer;\n          background-color: ",";\n\n          .filter-item-icon{\n            width: 14px;\n            margin-right: 0.5rem;\n          }\n          .filter-item-name{\n            word-break: break-all;\n          }\n        }\n\n        .filter-item-active {\n          border-left: 2px solid ",";\n        }\n\n        .arrange-style-container{\n          .arrange_container{\n            margin-top: 10px;\n            display: flex;\n            .jimu-btn {\n              padding: 0;\n              background: ",";\n              &.active{\n                border: 1px solid ",";\n              }\n            }\n          }\n        }\n      }\n    "],["\n      .widget-setting-table{\n        .filter-item {\n          display: flex;\n          padding: 0.5rem 0.75rem;\n          margin-bottom: 0.25rem;\n          line-height: 23px;\n          cursor: pointer;\n          background-color: ",";\n\n          .filter-item-icon{\n            width: 14px;\n            margin-right: 0.5rem;\n          }\n          .filter-item-name{\n            word-break: break-all;\n          }\n        }\n\n        .filter-item-active {\n          border-left: 2px solid ",";\n        }\n\n        .arrange-style-container{\n          .arrange_container{\n            margin-top: 10px;\n            display: flex;\n            .jimu-btn {\n              padding: 0;\n              background: ",";\n              &.active{\n                border: 1px solid ",";\n              }\n            }\n          }\n        }\n      }\n    "])),e.colors.secondary,e.colors.palette.primary[600],e.colors.palette.light[200],e.colors.palette.primary[600])},t.formatMessage=function(e,i){var a=Object.assign({},I,l.defaultMessages);return t.props.intl.formatMessage({id:e,defaultMessage:a[e]},i)},t.onShowLayerPanel=function(e){var i=t.state.showLayerPanel;e===t.index?t.setState({showLayerPanel:!i}):(t.setState({showLayerPanel:!0,refreshPanel:!t.state.refreshPanel}),t.index=e)},t.switchTableType=function(e){if(e!==t.props.config.arrangeType){var i={id:t.props.id,config:t.props.config.set("arrangeType",e)};t.props.onSettingChange(i)}},t.index=0,t.dsManager=o.DataSourceManager.getInstance(),t.updateDsHash(t.props.config.layersConfig?t.props.config.layersConfig:[]),t.state={showLayerPanel:!1,refreshPanel:!1},t}return f(i,e),i.prototype.getArrayMaxId=function(e){var i=e.map((function(e){return e.id.split("-").reverse()[0]}));return i.length>0?Math.max.apply(null,i):0},i.prototype.render=function(){var e=this,i=this.state.showLayerPanel,a=this.props,n=a.theme,s=a.config;return Object(o.jsx)("div",{css:this.getStyle(n)},Object(o.jsx)("div",{className:"widget-setting-table"},Object(o.jsx)(r.SettingSection,{className:"border-0"},Object(o.jsx)(r.SettingRow,null,Object(o.jsx)(l.Button,{className:"w-100 text-dark set-link-btn",type:"primary",onClick:function(){e.onShowLayerPanel(s.layersConfig.length)}},Object(o.jsx)("div",{className:"w-100 px-2 text-truncate"},this.formatMessage("newSheet"))))),Object(o.jsx)(r.SettingSection,{className:"pt-0"},Object(o.jsx)("div",{className:"filter-items-container mt-2"},s.layersConfig.asMutable().map((function(t,a){return Object(o.jsx)("div",{key:a,className:Object(o.classNames)("filter-item",i&&e.index===a?"filter-item-active":"")},Object(o.jsx)("div",{className:"filter-item-name flex-grow-1",onClick:function(){e.onShowLayerPanel(a)}},t.name),Object(o.jsx)(l.Button,{size:"sm",icon:!0,onClick:function(){return e.removeLayer(a)}},Object(o.jsx)(l.Icon,{icon:j,size:12})))})),s.layersConfig.length===this.index&&i?Object(o.jsx)("div",{className:"d-flex pt-2 pb-2 mb-1 filter-item filter-item-active"},Object(o.jsx)("div",{className:"filter-item-name flex-grow-1"},"......")):null)),s.layersConfig.length>0&&Object(o.jsx)(r.SettingSection,{className:"arrange-style-container",title:this.formatMessage("sheetStyle")},Object(o.jsx)(r.SettingRow,{className:"arrange_container"},Object(o.jsx)(l.Tooltip,{title:this.formatMessage("tabs"),placement:"bottom"},Object(o.jsx)(l.Button,{onClick:function(){return e.switchTableType(m.a.Tabs)},icon:!0,size:"sm",type:"tertiary",active:s.arrangeType===m.a.Tabs},Object(o.jsx)(l.Icon,{autoFlip:!0,width:109,height:70,icon:t(305)}))),Object(o.jsx)(l.Tooltip,{title:this.formatMessage("dropdown"),placement:"bottom"},Object(o.jsx)(l.Button,{onClick:function(){return e.switchTableType(m.a.Dropdown)},className:"ml-2",icon:!0,size:"sm",type:"tertiary",active:s.arrangeType===m.a.Dropdown},Object(o.jsx)(l.Icon,{autoFlip:!0,width:109,height:70,icon:t(306)}))))),Object(o.jsx)(r.SidePopper,{isOpen:i&&!o.urlUtils.getAppIdPageIdFromUrl().pageId,position:"right"},Object(o.jsx)(p,D({},s.layersConfig.asMutable({deep:!0})[this.index],{intl:this.props.intl,theme:n,useDataSource:this.dsHash[this.index]?this.dsHash[this.index]:null,dataSourceChange:this.dataSourceChangeSave,optionChange:this.optionChangeSave,onClose:this.onCloseLayerPanel})))))},i.mapExtraStateProps=function(e,i){var t,a;return{dsJsons:e.appStateInBuilder.appConfig.dataSources,activeTabId:e&&(null===(a=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.widgetsState[i.id])||void 0===a?void 0:a.activeTabId)}},i}(o.React.PureComponent);i.default=M},55:function(e,i,t){"use strict";var a;t.d(i,"a",(function(){return a})),function(e){e.Dropdown="DROPDOWN",e.Tabs="TABS"}(a||(a={}))},71:function(e,i){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19.637 15.866L30.951 27.18a2.667 2.667 0 01-3.771 3.771L15.866 19.637 4.552 30.951A2.667 2.667 0 01.781 27.18l11.314-11.314L.781 4.552A2.667 2.667 0 014.552.781l11.314 11.314L27.18.781a2.667 2.667 0 013.771 3.771L19.637 15.866z"></path></svg>'},8:function(e,i){e.exports=n},91:function(e,i){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 6.598L14.308.29a.991.991 0 011.402 1.402L9.402 8l6.308 6.308a.991.991 0 01-1.402 1.402L8 9.402 1.692 15.71A.991.991 0 01.29 14.308L6.598 8 .29 1.692A.991.991 0 011.692.29L8 6.598z" fill="#000" fill-rule="nonzero"></path></svg>'}}))}}}));