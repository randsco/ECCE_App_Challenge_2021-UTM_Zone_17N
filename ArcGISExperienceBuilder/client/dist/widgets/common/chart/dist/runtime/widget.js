System.register(["jimu-core","jimu-ui","jimu-ui/advanced/chart"],(function(e){var t,n,r;return{setters:[function(e){t=e},function(e){n=e},function(e){r=e}],execute:function(){e(function(e){var t={};function n(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return e[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)n.d(r,u,function(t){return e[t]}.bind(null,u));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=200)}({0:function(e,n){e.exports=t},1:function(e,t){e.exports=n},200:function(e,t,n){"use strict";n.r(t);var r=n(0),u=n(38),i=n(44),o=n(28),a=Object(r.Immutable)({}),c=Object(r.Immutable)({});t.default=function(e){var t,n,l,d=r.React.useState(null),f=d[0],s=d[1],v=e.useDataSources,p=e.id,y=e.config,b=null===(t=null==v?void 0:v[0])||void 0===t?void 0:t.dataSourceId,g=null==y?void 0:y.type,m=null!==(n=null==y?void 0:y.data)&&void 0!==n?n:a,S=null!==(l=null==y?void 0:y.display)&&void 0!==l?l:c,j=m.categoryField,F=m.numericFields,O=m.categoryType,B=m.orderByFields,h=m.statisticType,R=m.maxCategories,T=S.series,x=S.axes,M=S.background,D=Object(r.getAppStore)().getState().appContext.isInBuilder,I=r.ReactRedux.useSelector((function(e){return e.theme})),C=r.React.useMemo((function(){return Object(i.h)(M,I)}),[M,I]),E=r.React.useState([]),_=E[0],G=E[1],P=r.React.useState(),A=P[0],U=P[1];r.React.useEffect((function(){var e={categoryField:j,statisticType:h,numericFields:F,categoryType:O,orderByFields:B},t=Object(o.g)(g,e)?Object(i.g)(g,e,B):Object(r.Immutable)({});U(t),G([])}),[j,F,O,B,g,h]);var w=r.React.useMemo((function(){return Object(i.d)(T,D)}),[D,T]),N=r.React.useMemo((function(){return Object(i.d)(x,D)}),[D,x]),Y=r.React.useMemo((function(){return Object(i.b)(_,O,F,B,R,b)}),[_,O,F,b,B,R]),k=r.React.useMemo((function(){var e=Object(i.a)(Y,w,N,C);return Object(i.e)(e,I)}),[Y,w,N,C,I]);return r.React.createElement("div",{className:"widget-chart jimu-widget"},r.React.createElement(u.Chart,{config:k}),r.React.createElement(r.DataSourceComponent,{localId:p,query:A,onDataSourceCreated:s,onDataSourceInfoChange:function(e){var t;if((null==e?void 0:e.status)===r.DataSourceStatus.Loaded){var n=null!==(t=null==f?void 0:f.getRecords())&&void 0!==t?t:[],u=Object(i.f)(n);G(u)}},useDataSource:null==v?void 0:v[0]}))}},23:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.ByFeature="BYFEATURE",e.ByGroup="BYGROUP",e.ByField="BYFIELD"}(r||(r={}))},28:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return p}));var r=n(23),u=n(38),i=n(0),o="FieldName",a="FieldValue",c=99,l={},d=function(e,t){var n;if(l[e])return l[e];var r=i.DataSourceManager.getInstance().getDataSource(t),u=null==r?void 0:r.getSchema(),o=null===(n=null==u?void 0:u.fields)||void 0===n?void 0:n[e];return l[e]=o,o},f={},s=function(e){if(f[e])return f[e];var t=i.DataSourceManager.getInstance().getDataSource(e),n=null==t?void 0:t.getSchema(),r=null==n?void 0:n.fields;return l[e]=r,r},v=function(e,t){if(e===u.ChartType.Serial){var n=null==t?void 0:t.categoryType;if(n===r.a.ByFeature)return!(!(null==t?void 0:t.categoryField)||!(null==t?void 0:t.numericFields));if(n===r.a.ByGroup)return!!((null==t?void 0:t.categoryField)&&(null==t?void 0:t.numericFields)&&t.statisticType);if(n===r.a.ByField)return!(!(null==t?void 0:t.numericFields)||!t.statisticType)}return!0},p=function(e,t,n){return e===r.a.ByFeature?t:e===r.a.ByGroup?t+"_"+n:e===r.a.ByField?""+t:void 0}},38:function(e,t){e.exports=r},44:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return v})),n.d(t,"f",(function(){return p})),n.d(t,"h",(function(){return y})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return j}));var r=n(38),u=n(0),i=n(1),o=n(23),a=n(28),c={},l=function(e){if(c[e])return c[e];var t=u.DataSourceManager.getInstance().getDataSource(e).getIdField();return c[e]=t,t},d=function(e){if("[object Object]"===Object.prototype.toString.call(e)){var t={};return Object.entries(e).forEach((function(e){var n=e[0],r=e[1];t[n]=d(r)})),t}if("[object Array]"===Object.prototype.toString.call(e)){var n=[];return e.forEach((function(e,t){n[t]=d(e)})),n}return e},f=function(e,t){var n=(null==e?void 0:e.asMutable)?e.asMutable({deep:!0}):e;return t?d(n):n},s=function(e,t,n,r){return{type:"chart",id:"exb-chart",background:r,dataSource:e,series:t||[],axes:n||[]}},v=function(e,t,n,r,u,i){var c,l,d,f,s,v=null===(l=null===(c=null==r?void 0:r[0])||void 0===c?void 0:c.split(" "))||void 0===l?void 0:l[0],p=null===(f=null===(d=null==r?void 0:r[0])||void 0===d?void 0:d.split(" "))||void 0===f?void 0:f[1],y=e;return t===o.a.ByField&&(y=null===(s=null==n?void 0:n.asMutable())||void 0===s?void 0:s.map((function(t){var n,r,u,o,c=null!==(u=null===(r=Object(a.d)(t,i))||void 0===r?void 0:r.alias)&&void 0!==u?u:t;return(n={})[a.a]=c,n[a.b]=null===(o=null==e?void 0:e[0])||void 0===o?void 0:o[t],n}))),(v&&t===o.a.ByGroup||t===o.a.ByField)&&(y=y.sort((function(e,t){var n=e[v],r=t[v],u=0;return"string"==typeof n&&(n=n.toUpperCase(),r=r.toUpperCase()),n!==r&&(u=n>r?1:-1,u="ASC"===p?u:-u),u}))),{type:"inline",data:y=y.slice(0,u),processed:!0}},p=function(e){return e.map((function(e){return e.getData()})).filter((function(e){return!!e}))},y=function(e,t){var n;if("string"!=typeof e||!e)return e;var r=i.utils.getColorValue(e,t),o=u.polished.parseToRgb(r);return o?[o.red,o.green,o.blue,255*(null!==(n=o.alpha)&&void 0!==n?n:1)]:void 0},b=function(e,t,n,r){"color"===n&&(t[n]=y(r,e))},g=function(e,t,n,r){"[object Object]"===Object.prototype.toString.call(e)?Object.entries(e).forEach((function(n){var r=n[0],u=n[1];g(u,t,e,r)})):"[object Array]"===Object.prototype.toString.call(e)?e.forEach((function(n,r){g(n,t,e,r)})):t(n,r,e)},m=function(e,t){return g(e,b.bind(null,t),null,null),e},S=function(e,t,n){return t.map((function(t){return{onStatisticField:t,outStatisticFieldName:Object(a.f)(n,t,e),statisticType:e}}))},j=function(e,t,n){var i,a=null;if(e===r.ChartType.Serial){var c=null==t?void 0:t.categoryType,l=null==t?void 0:t.categoryField,d=null==t?void 0:t.statisticType,f=null!==(i=null==t?void 0:t.numericFields)&&void 0!==i?i:Object(u.Immutable)([]);if(c===o.a.ByFeature)a={outFields:f.concat(l),orderByFields:n};else if(c===o.a.ByGroup){a={groupByFieldsForStatistics:[l],outStatistics:S(d,f,c),orderByFields:n}}else if(c===o.a.ByField){a={outStatistics:S(d,f,c),orderByFields:n}}return Object(u.Immutable)(a)}}}}))}}}));