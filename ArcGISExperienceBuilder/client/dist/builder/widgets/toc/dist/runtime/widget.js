System.register(["jimu-core","jimu-ui","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-layouts/layout-runtime","jimu-layouts/layout-builder","jimu-core/dnd"],(function(e){var t,n,o,i,a,r,l;return{setters:[function(e){t=e},function(e){n=e},function(e){o=e},function(e){i=e},function(e){a=e},function(e){r=e},function(e){l=e}],execute:function(){e(function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=109)}([function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t){e.exports=a},,function(e,t){e.exports=r},,,function(e,t){e.exports=l},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s}));var o,i=n(0),a=n(1),r=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(t){var n=e.call(this,t)||this;return n.onDropDownToggle=function(e){var t=n.state.isOpen;e.stopPropagation(),!n.dontDismiss&&n.setState({isOpen:!t}),n.dontDismiss=!1},n.onItemClick=function(e,t){t.autoHide||void 0===t.autoHide?n.setState({isOpen:!1}):n.dontDismiss=!0,t.event(e),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.state={isOpen:!1},n}return r(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.items,r=t.toggleContent,l=t.direction,s=t.disabled,c=t.title,d=t.icon,u=t.caret,p=this.state.isOpen;return Object(i.jsx)("div",{className:"d-flex align-items-center"},Object(i.jsx)(a.Dropdown,{direction:l||"down",size:"sm",toggle:this.onDropDownToggle,isOpen:p},Object(i.jsx)(a.DropdownButton,{title:c,arrow:u,icon:d||void 0===d,disabled:s,size:"sm",type:"tertiary"},r||Object(i.jsx)(a.Icon,{size:12,icon:n(15)})),Object(i.jsx)(a.DropdownMenu,null,o.map((function(t,n){var o;return(t.visible||void 0===t.visible)&&(t.isBtn?Object(i.jsx)(i.React.Fragment,{key:n},t.label):Object(i.jsx)(a.DropdownItem,{key:n,title:null!==(o=t.title)&&void 0!==o?o:"",className:"no-user-select",onClick:function(n){return e.onItemClick(n,t)}},t.label))})))))},t.defaultProps={caret:!1},t}(i.React.PureComponent),s=function(e){function t(t){var n=e.call(this,t)||this;return n.onItemClick=function(e,t){t.event(e),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.state={},n}return r(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.items,r=t.toggleContent,l=t.direction,s=t.disabled,c=t.title,d=t.icon,u=t.caret;return Object(i.jsx)(a.DropdownSubMenuItem,{direction:l},Object(i.jsx)(a.DropdownButton,{title:c,arrow:u,icon:d||void 0===d,disabled:s,size:"sm",type:"tertiary"},r||Object(i.jsx)(a.Icon,{size:12,icon:n(15)})),Object(i.jsx)(a.DropdownMenu,null,o.map((function(t,n){var o,r;return(t.visible||void 0===t.visible)&&(t.isBtn?Object(i.jsx)(a.DropdownSubMenuItem,{key:n,title:null!==(o=t.title)&&void 0!==o?o:"",onClick:function(n){return e.onItemClick(n,t)}},t.label):Object(i.jsx)(a.DropdownItem,{key:n,title:null!==(r=t.title)&&void 0!==r?r:"",className:"no-user-select",onClick:function(n){return e.onItemClick(n,t)}},t.label))}))))},t}(i.React.PureComponent)},,,,function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7 1a6 6 0 100 12A6 6 0 007 1zm0 13a7 7 0 115.621-2.828l-.222.284 3.405 3.404a.668.668 0 01-.944.944L11.456 12.4A6.974 6.974 0 017 14z" fill="#000" fill-rule="evenodd"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M9.5 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zm-4.75 0a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zM0 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm0 2C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10zm8.282-1.718a.961.961 0 011.359 0l4.077 4.077a.961.961 0 01-1.359 1.36l-4.077-4.078a.961.961 0 010-1.36z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg"><path d="M2.307 6.479L4.677 4l-2.37-2.479a.517.517 0 010-.708.464.464 0 01.677 0l2.71 2.833a.517.517 0 010 .708l-2.71 2.833a.464.464 0 01-.677 0 .517.517 0 010-.708z"></path><path d="M0 0h8v8H0z" fill="none"></path></svg>'},,,,,,,,,,function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M2 5.055V11h2V8a1 1 0 011-1h2a1 1 0 011 1v3h2V4.969L6.043 1 2 5.055zM1 6.058l-.149.15a.497.497 0 01-.705 0 .501.501 0 010-.708L5.338.293a.995.995 0 011.41 0l5.106 5.121a.501.501 0 010 .707.497.497 0 01-.705 0L11 5.971V11a1 1 0 01-1 1H2a1 1 0 01-1-1V6.058zM5 11h2V8H5v3z" fill="#000" fill-rule="nonzero"></path></svg>'},,,function(e,t){e.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M20 18a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2h16a2 2 0 012 2v16zm-1-3H1v3a1 1 0 001 1h16a1 1 0 001-1v-3zm0-9H1v8h18V6zm-1-5H2a1 1 0 00-1 1v3h18V2a1 1 0 00-1-1z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 1h14v5H1V1zM0 7V0h16v7H0zm1 3h14v5H1v-5zm-1 6V9h16v7H0z" fill="#F0F0F0"></path></svg>'},,function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M5.47 9.521L.162 3.981a.592.592 0 010-.813.534.534 0 01.779 0L6 8.448l5.06-5.28a.534.534 0 01.779 0 .592.592 0 010 .813l-5.31 5.54a.726.726 0 01-1.058 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},,,,,,,,,,function(e,t,n){"use strict";e.exports=function(e,t,n,o,i,a,r,l){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,o,i,a,r,l],d=0;(s=new Error(t.replace(/%s/g,(function(){return c[d++]})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports='<svg viewBox="0 0 15 17" xmlns="http://www.w3.org/2000/svg"><path d="M10.086 0a1 1 0 01.707.293l3.914 3.914a1 1 0 01.293.707V15a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2h8.086zM10 1H2a1 1 0 00-1 1v13a1 1 0 001 1h11a1 1 0 001-1V5h-4V1zM7.5 5a.5.5 0 01.5.5V8h2.5a.5.5 0 010 1H8v2.5a.5.5 0 01-1 0V9H4.5a.5.5 0 010-1H7V5.5a.5.5 0 01.5-.5z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 8" xmlns="http://www.w3.org/2000/svg"><path d="M6 5.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm0 1a2.5 2.5 0 110-5 2.5 2.5 0 010 5zM6 1c-2.124 0-3.714.967-4.867 3C2.286 6.033 3.876 7 6 7s3.714-.967 4.867-3C9.714 1.967 8.124 1 6 1zm0 7C3.333 8 1.333 6.667 0 4c1.333-2.667 3.333-4 6-4s4.667 1.333 6 4c-1.333 2.667-3.333 4-6 4z"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 10" xmlns="http://www.w3.org/2000/svg"><path d="M6.62 6.366L4.635 4.379a1.5 1.5 0 001.987 1.987zm.746-.745a1.5 1.5 0 00-1.987-1.987l1.987 1.987zM3.899 3.644l-.825-.825C2.322 3.314 1.678 4.038 1.133 5 2.286 7.033 3.876 8 6 8c.702 0 1.345-.106 1.934-.32L7.356 7.1A2.5 2.5 0 013.9 3.645zm.745-.745A2.5 2.5 0 018.1 6.355l.826.826c.752-.495 1.396-1.219 1.941-2.181C9.714 2.967 8.124 2 6 2c-.702 0-1.345.106-1.934.32l.578.579zM2.354 2.1L1.155.9A.527.527 0 011.9.154l1.4 1.4C4.107 1.184 5.008 1 6 1c2.667 0 4.667 1.333 6 4-.634 1.268-1.419 2.235-2.355 2.9l1.2 1.2a.527.527 0 01-.745.746l-1.4-1.4C7.893 8.816 6.992 9 6 9 3.333 9 1.333 7.667 0 5c.634-1.268 1.419-2.235 2.355-2.9z"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M5.47 3.229L.162 8.769a.592.592 0 000 .813.534.534 0 00.779 0L6 4.302l5.06 5.28a.534.534 0 00.779 0 .592.592 0 000-.813l-5.31-5.54a.726.726 0 00-1.058 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 10 12" xmlns="http://www.w3.org/2000/svg"><path d="M1 0h8a1 1 0 011 1v10a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1zm0 1v10h8V1H1zm2 2h4a.5.5 0 010 1H3a.5.5 0 010-1zm0 2.5h4a.5.5 0 010 1H3a.5.5 0 010-1z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 0c3.314 0 6 2.574 6 5.75S9.314 11.5 6 11.5c-.78 0-1.524-.142-2.207-.402-.395-.15-1.66.151-3.793.902l.198-.52C.784 9.893.967 8.91.747 8.53A5.538 5.538 0 010 5.75C0 2.574 2.686 0 6 0zm0 1C3.23 1 1 3.136 1 5.75c0 .809.212 1.587.613 2.28.282.49.294 1.153.068 2.09l-.08.304.155-.044c1.092-.306 1.81-.391 2.297-.248l.094.031A5.212 5.212 0 006 10.5c2.77 0 5-2.136 5-4.75S8.77 1 6 1zM4 3H3v5h1V6h2v2h1V3H6v2H4V3zm4 2h1v3H8V5zm1-2H8v1h1V3z" fill="#000"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 15 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 0a2 2 0 012 2v9a2 2 0 01-2 2H5l-5 3V2a2 2 0 012-2h11zm0 1H2a1 1 0 00-.993.883L1 2v12.233L4.723 12H13a1 1 0 00.993-.883L14 11V2a1 1 0 00-.883-.993L13 1zM7.5 3a.5.5 0 01.5.5V6h2.5a.5.5 0 010 1H8v2.5a.5.5 0 01-1 0V7H4.5a.5.5 0 010-1H7V3.5a.5.5 0 01.5-.5z" fill="#C5C5C5" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16.572 18.746V32h13.257V18.746H16.572zM0 32h13.257V18.746H0V32zM0 2.179v13.254h13.257V2.179H0zM22.629 0l-9.371 9.377 9.371 9.369L32 9.377 22.629 0z"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12 0a2 2 0 012 2v4h4a2 2 0 012 2v10a2 2 0 01-2 2H8a2 2 0 01-2-2v-4H2a2 2 0 01-2-2V2a2 2 0 012-2h10zm6 7h-4v5a2 2 0 01-2 2H7v4a1 1 0 001 1h10a1 1 0 001-1V8a1 1 0 00-1-1zm-6-6H2a1 1 0 00-1 1v10a1 1 0 001 1h4V8a2 2 0 012-2h5V2a1 1 0 00-1-1zm1 6H8a1 1 0 00-1 1v5h5a1 1 0 001-1V7z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1 18a1 1 0 001 1v1a2 2 0 01-2-2zm19 0a2 2 0 01-2 2v-1a1 1 0 001-1h1zM5 19v1H3v-1h2zm4 0v1H7v-1h2zm4 0v1h-2v-1h2zm4 0v1h-2v-1h2zM1 15v2H0v-2h1zm19 0v2h-1v-2h1zM1 11v2H0v-2h1zm19 0v2h-1v-2h1zM1 7v2H0V7h1zm19 0v2h-1V7h1zM1 3v2H0V3h1zm19 0v2h-1V3h1zM2 0v1a1 1 0 00-.993.883L1 2H0A2 2 0 011.85.005L2 0zm16 0a2 2 0 012 2h-1a1 1 0 00-1-1zM5 0v1H3V0h2zm4 0v1H7V0h2zm4 0v1h-2V0h2zm4 0v1h-2V0h2z" fill="#000" fill-rule="evenodd"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 1h10v10H1V1zM0 12V0h12v12H0zm3-8h6v4H3V4zM2 9V3h8v6H2z" fill="#C5C5C5"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1 0h10a1 1 0 011 1v2a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1zm0 1v2h10V1H1zm0 4h2a1 1 0 011 1v5a1 1 0 01-1 1H1a1 1 0 01-1-1V6a1 1 0 011-1zm0 1v5h2V6H1zm5-1h5a1 1 0 011 1v5a1 1 0 01-1 1H6a1 1 0 01-1-1V6a1 1 0 011-1zm0 1v5h5V6H6z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 4" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 3a.5.5 0 010 1H.5a.5.5 0 010-1h15zm0-3a.5.5 0 010 1H.5a.5.5 0 010-1h15z" fill="#000" fill-rule="evenodd"></path></svg>'},,,,function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"generateLayoutMap",(function(){return ye})),n.d(o,"findLowestAncestor",(function(){return Ie})),n.d(o,"findParentLayoutItem",(function(){return we})),n.d(o,"findLayoutId",(function(){return Fe})),n.d(o,"findLayoutItem",(function(){return xe})),n.d(o,"findSectionId",(function(){return je})),n.d(o,"findParentViewId",(function(){return Oe})),n.d(o,"getContentIdInLayoutItem",(function(){return Se})),n.d(o,"getContentsInLayout",(function(){return Ce})),n.d(o,"getContentsInLayoutRecursive",(function(){return Pe})),n.d(o,"getContainerLayoutItem",(function(){return De})),n.d(o,"getLayoutItemIds",(function(){return ke})),n.d(o,"getLayoutInfosByType",(function(){return Ae})),n.d(o,"getWidgetIdThatUseTheLayoutId",(function(){return Me})),n.d(o,"getContentContainerInfo",(function(){return ze})),n.d(o,"getRelatedLayoutItemsInWidgetByLayoutInfo",(function(){return Ze})),n.d(o,"getRelatedLayoutInfosInWidgetByLayoutInfo",(function(){return Ge})),n.d(o,"getLayoutInfosHoldcontent",(function(){return Je})),n.d(o,"getBrowserSizeModeByLayoutIdAndWidgetId",(function(){return Ue})),n.d(o,"getBrowserSizeModeByLayoutId",(function(){return We})),n.d(o,"getChildrenContents",(function(){return _e})),n.d(o,"getContentLayoutInfosInOneSizeMode",(function(){return Ve})),n.d(o,"getContentsInView",(function(){return Re})),n.d(o,"getContentsInPageHeader",(function(){return Ee})),n.d(o,"getContentsInPageFooter",(function(){return Ne})),n.d(o,"getContentsInPageBody",(function(){return Le})),n.d(o,"getContentsInScreen",(function(){return Be})),n.d(o,"getContentsInLayoutWithLayoutWidgetOnly",(function(){return Te})),n.d(o,"getContentsInTheSameContainer",(function(){return Xe})),n.d(o,"getParentWidgetIdOfContent",(function(){return He})),n.d(o,"getSectionInfo",(function(){return Ye})),n.d(o,"getPendingLayoutItemsInPage",(function(){return Ke})),n.d(o,"getPendingLayoutItemsInDialog",(function(){return $e})),n.d(o,"getPendingLayoutItemsInLayoutWithDeep",(function(){return tt})),n.d(o,"getPendingLayoutItemsFromOtherSizeMode",(function(){return nt})),n.d(o,"getPendingLayoutItemsFromOtherSizeModeInPage",(function(){return Qe})),n.d(o,"getPendingLayoutItemsFromOtherSizeModeInDialog",(function(){return et}));var i,a,r,l,s,c,d,u,p,g,f,m=n(0),v=n(2),h=n(1),b=n(6),y=n(3),I=n(4),w={tocChooseTemplate:"Select a page template",newPage:"New page",pages_upper:"Pages",content_upper:"Content",body_upper:"Body",tocLoading:"Loading",addPage:"Add page",addLink:"Add link",addFolder:"Add folder",addDialog:"Add window",makeHome:"Make homepage",makeSplash:"Set as splash",opendWithPages:"Opend with {pages}.",hideFromMenu:"Hide from menu",showFromMenu:"Show in menu",body:"Body",header:"Header",footer:"Footer",outline:"Outline",tocSetLink:"Set link",certainly:"OK",removePageTip:"There is(are) {subCount} subpage(s) in {label}, do you really want to remove it?",fullScreenApp:"Fullscreen app",fullScreenAppTip:"Best for creating a web app that takes the full area of the browser window.",scrollingPage:"Scrolling page",scrollingPageTip:"Best for creating a web page that scrolls in the browser window.",arrange:"Arrange",align:"Align"},x=n(9),j=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),O=function(e){function t(t){var n=e.call(this,t)||this;return n.formatMessage=function(e){return n.props.intl.formatMessage({id:e,defaultMessage:w[e]})},n.handleArrowClick=function(e){var t=n.props,o=t.onArrowClick,i=t.itemJson;o&&o(i),e.stopPropagation()},n.handleClick=function(e){var t=n.props,o=t.itemJson,i=t.editable;o.allowEditable&&i&&e.stopPropagation()},n.handleDoubleClickItem=function(e){var t=n.props,o=t.itemJson,i=t.onDoubleClick;i&&i(o,e),e.stopPropagation()},n.renameItemClick=function(e){e&&e.stopPropagation(),n.editor.current&&(setTimeout((function(){var e,t;n.editor.current.focus(),window.getSelection&&document.createRange?((t=document.createRange()).selectNodeContents(n.editor.current),(e=window.getSelection()).removeAllRanges(),e.addRange(t)):((e=document.createRange()).setStart(n.editor.current.firstChild,n.editor.current.innerText.length),e.select())}),1),n.editor.current.onkeydown=function(e){"Enter"===e.key&&(e.preventDefault(),n.onRenameBlur(null))})},n.onRenameBlur=function(e){if(n.editor.current){var t=n.editor.current.innerText;n.editor.current.innerText="",setTimeout((function(){n.editor.current.innerText=t}),10),setTimeout((function(){n.props.renameItem&&n.props.renameItem(n.props.itemJson,t)||(n.editor.current.innerText=n.props.itemJson.label)}),30)}},n.editor=m.React.createRef(),n}return j(t,e),t.prototype.componentDidMount=function(){this.props.editable&&this.renameItemClick()},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.itemJson,o=t.editable;n.allowEditable&&o!==e.editable&&o&&this.renameItemClick()},t}(m.React.Component),S=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),C=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},P=function(e){function t(t){var n=e.call(this,t)||this;return n.onDropHover=function(e){n.state.dropType!==e&&n.setState({dropType:e})},n.getStyle=function(){var e,t,o=Object(m.getAppStore)().getState(),i=null===(e=null==o?void 0:o.appContext)||void 0===e?void 0:e.isRTL,r=n.props,l=r.theme,s=r.editable,c=r.itemJson,d=r.isTocDragging,u=c.mustShowArrow,p=c.children,g=c.level,f=c.isActive,v=c.isExpand,h=n.state,b=h.isDragging,y=h.isHovering;return Object(m.css)(a||(a=C(["\n      height: ","px;\n      width: auto;\n      min-width: 100%;\n      align-items: center;\n      cursor: pointer;\n      ","\n\n      &.drag-move-into {\n        border: 1px solid ",";\n      }\n\n      :hover {\n        ","\n        .dropDown {\n          .btn {\n            display: ",";\n          }\n          z-index: 2;\n        }\n        .page-item-visible-btn {\n          display: ",";\n          z-index: 2;\n        }\n        .page-item-home-btn {\n          display: ",";\n          z-index: 2;\n        }\n      }\n\n      &.active {\n        ","\n        border: 0;\n      }\n\n      .toc-item-dropzone {\n        touch-action: none;\n        position: relative;\n\n        .toc-item-drag:hover {\n          cursor: pointer !important;\n        }\n\n        .toc-item-drag {\n          pointer-events: ",";\n          visibility: ",";\n          z-index: 1;\n          position: absolute;\n          left: 0;\n          top: 0;\n          right: 0;\n          bottom: 0;\n          background-color: ",";\n          box-shadow: ",";\n        }\n\n        .toc-item {\n          padding: 0;\n          border: 0;\n          position: relative;\n          .toc-item-content {\n            margin-left: ","px;\n            position: relative;\n            .toc-arrow {\n              z-index: 2;\n              padding-right: ",";\n              visibility: ",";\n              .toc-arrow-icon {\n                fill: ",";\n                transform-origin: center;\n                transform: ",";\n                transition: transform .5s;\n              }\n            }\n\n            .left-and-right {\n              overflow-x: hidden;\n              margin-left: -5px;\n              .left-content {\n                align-items: center;\n                overflow-x: hidden;\n                flex: auto;\n                .editor {\n                  overflow: hidden;\n                  text-overflow: ",";\n                  white-space: nowrap;\n                  font-size: ",'rem;\n                  user-select: none;\n                  flex: auto;\n                  text-align: start;\n                }\n                [contenteditable="true"] {\n                  -webkit-user-select: text;\n                  background-color: ',";\n                }\n                .header-icon {\n                  margin-right: 0.3rem;\n                  flex: none;\n                }\n              }\n            }\n          }\n\n          &.toc-drag-move-last {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          &.toc-drag-move-first {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          .drag-move-out-order-bottom {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          .drag-move-out-order-top {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n        }\n      }\n    "],["\n      height: ","px;\n      width: auto;\n      min-width: 100%;\n      align-items: center;\n      cursor: pointer;\n      ","\n\n      &.drag-move-into {\n        border: 1px solid ",";\n      }\n\n      :hover {\n        ","\n        .dropDown {\n          .btn {\n            display: ",";\n          }\n          z-index: 2;\n        }\n        .page-item-visible-btn {\n          display: ",";\n          z-index: 2;\n        }\n        .page-item-home-btn {\n          display: ",";\n          z-index: 2;\n        }\n      }\n\n      &.active {\n        ","\n        border: 0;\n      }\n\n      .toc-item-dropzone {\n        touch-action: none;\n        position: relative;\n\n        .toc-item-drag:hover {\n          cursor: pointer !important;\n        }\n\n        .toc-item-drag {\n          pointer-events: ",";\n          visibility: ",";\n          z-index: 1;\n          position: absolute;\n          left: 0;\n          top: 0;\n          right: 0;\n          bottom: 0;\n          background-color: ",";\n          box-shadow: ",";\n        }\n\n        .toc-item {\n          padding: 0;\n          border: 0;\n          position: relative;\n          .toc-item-content {\n            margin-left: ","px;\n            position: relative;\n            .toc-arrow {\n              z-index: 2;\n              padding-right: ",";\n              visibility: ",";\n              .toc-arrow-icon {\n                fill: ",";\n                transform-origin: center;\n                transform: ",";\n                transition: transform .5s;\n              }\n            }\n\n            .left-and-right {\n              overflow-x: hidden;\n              margin-left: -5px;\n              .left-content {\n                align-items: center;\n                overflow-x: hidden;\n                flex: auto;\n                .editor {\n                  overflow: hidden;\n                  text-overflow: ",";\n                  white-space: nowrap;\n                  font-size: ",'rem;\n                  user-select: none;\n                  flex: auto;\n                  text-align: start;\n                }\n                [contenteditable="true"] {\n                  -webkit-user-select: text;\n                  background-color: ',";\n                }\n                .header-icon {\n                  margin-right: 0.3rem;\n                  flex: none;\n                }\n              }\n            }\n          }\n\n          &.toc-drag-move-last {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          &.toc-drag-move-first {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          .drag-move-out-order-bottom {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          .drag-move-out-order-top {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n        }\n      }\n    "])),30,b?"z-index: 100;":"",l.colors.palette.primary[700],f||d?"":"background-color: "+l.colors.palette.light[400]+";",d?"none":"inline-flex",d?"none":"inline-flex",c.showDefault?d&&!(null===(t=null==c?void 0:c.data)||void 0===t?void 0:t.isDefault)?"none":"inline-flex":"none",d?"":"background-color: "+l.colors.primary+";",y?"all":"none",c.allowEditable&&s?"hidden":"visible",b?m.polished.rgba(l.colors.palette.light[400],.6):"transparent",b?l.boxShadows.lg:l.boxShadows.none,10*g,m.polished.rem(1),u||p&&p.length>0?"visible":"hidden",l.colors.black,"rotate("+(v?90:i?180:0)+"deg)",s?"clip":"ellipsis",.875,l.colors.white,l.colors.palette.primary[700],l.colors.palette.primary[700],l.colors.palette.primary[700],l.colors.palette.primary[700])},n.state={dropType:"none",isDragging:!1,isHovering:!1},n.dropZoneRef=m.React.createRef(),n.dragRef=m.React.createRef(),n}return S(t,e),t.prototype.componentWillUnmount=function(){this.dragInteractable&&(this.dragInteractable.unset(),this.dragInteractable=null),this.dropZoneInteractable&&(this.dropZoneInteractable.unset(),this.dropZoneInteractable=null)},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var n=this.props,o=n.canDnd,i=n.canDragFunc,a=n.canDropFunc,r=n.onDidDrop,l=n.canOrderFunc,s=n.canDropIntoFunc,c=n.itemJson,d=c.index;if(o&&this.dropZoneRef.current&&this.dragRef.current){var u=null;this.dragRef.current.setAttribute("itemJson",JSON.stringify(c)),this.dropZoneInteractable=Object(x.interact)(this.dropZoneRef.current).dropzone({accept:".toc-item-drag",overlap:"pointer",ondropmove:function(e){var n=e.relatedTarget,o=e.target,i=JSON.parse(n.getAttribute("itemJson"));if(a&&a(c.data,i.data)){var r=o.getBoundingClientRect(),u=r.bottom-r.top,p=2*u/3,g=1*u/3,f=u/2,m=e.dragEvent.client.y-r.top,v=t.state.dropType;v=l&&l(i.data,c.data)?s&&s(i.data,c.data)?m>p?"bottom":m<g?"top":"moveInto":0===d?m>f?"bottom":"top":"bottom":s&&s(i.data,c.data)?"moveInto":"none",t.onDropHover(v)}},ondragleave:function(e){t.onDropHover("none")},ondrop:function(e){var n=t.state.dropType;if("none"!==n){var o=e.relatedTarget,i=JSON.parse(o.getAttribute("itemJson"));r&&r(i,c,n),t.onDropHover("none")}}}),i&&i(c.data)&&(this.dragInteractable=Object(x.interact)(this.dragRef.current).draggable({inertia:!1,modifiers:[],autoScroll:!0,onstart:function(e){t.setState({isDragging:!0});var n=t.props.onTocDragStatusChage;n&&n(!0)},onmove:function(e){var n=e.clientX,o=e.clientY,i=e.clientX0,a=e.clientY0,r=e.target,l=parseFloat(r.getAttribute("start-x"))||0,s=parseFloat(r.getAttribute("start-y"))||0,c=n-i+l,d=o-a+s,p=-r.clientWidth/2,g=r.clientWidth/2;c<p?c=p:c>g&&(c=g);var f=t.props,m=f.parentBoundBottom,v=f.parentBoundTop;if(m>-1&&v>-1){var h=v-a,b=m-a;d<=h?d=h:d>=b&&(d=b)}u&&cancelAnimationFrame(u),u=requestAnimationFrame((function(){r.style.webkitTransform=r.style.transform="translate("+c+"px, "+d+"px)",u=null}))},onend:function(e){var n=e.target;u&&cancelAnimationFrame(u),n.style.webkitTransform=n.style.transform="translate(0px, 0px)",t.setState({isDragging:!1});var o=t.props.onTocDragStatusChage;o&&o(!1)}}))}},t.prototype.componentDidUpdate=function(t){e.prototype.componentDidUpdate.call(this,t)},t.prototype.render=function(){var e,t,o,i=this,a=this.props,r=a.itemJson,l=a.renderRightContent,s=a.editable,c=a.canDnd,d=a.theme,u=a.isFirstItem,p=a.isLastItem,g=a.tocDraggingStatus,f=a.isTocDragging,v=r.icon,b=r.isActive,y=this.state,I=y.dropType,w=y.isDragging;o=v&&v.svg?v:{svg:v};var x="moveInto"===I?"drag-move-into":"",j="drag-move-out-order-"+I,O="";f&&"on"!==g&&("bottom"===g&&p?O="toc-drag-move-last":"top"===g&&u&&(O="toc-drag-move-first"));var S=null===(t=null===(e=Object(m.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.theme;return Object(m.jsx)("div",{className:"d-flex "+(b?"active":"")+"   "+x,css:this.getStyle(),onMouseEnter:function(e){return i.setState({isHovering:!0})},onMouseLeave:function(e){return i.setState({isHovering:!1})}},Object(m.jsx)("div",{ref:this.dropZoneRef,className:"toc-item-dropzone h-100 w-100"},Object(m.jsx)("div",{className:"d-flex w-100 h-100",onDoubleClick:this.handleDoubleClickItem,onClick:this.handleClick},Object(m.jsx)("div",{className:"d-flex justify-content-between w-100 toc-item "+O},Object(m.jsx)("div",{className:"d-flex toc-item-content "+j+" w-100"},Object(m.jsx)(h.Button,{className:"toc-arrow",icon:!0,type:"tertiary",onClick:this.handleArrowClick},Object(m.jsx)(h.Icon,{className:"toc-arrow-icon",icon:n(18),size:8})),Object(m.jsx)("div",{className:"left-and-right d-flex justify-content-between w-100"},Object(m.jsx)("div",{className:"d-flex left-content "+(l?"pr-0":"pr-2")},v&&Object(m.jsx)(h.Icon,{autoFlip:r.needFlip,className:"header-icon",color:o.properties&&m.themeUtils.color(o.properties.color,S)||d.colors.palette.dark[600],size:12,icon:o.svg}),Object(m.jsx)("div",{title:r.label,className:"item-label editor",ref:this.editor,onBlur:this.onRenameBlur,contentEditable:r.allowEditable&&s,suppressContentEditableWarning:!0},r.label)),l&&l(r)))),c&&Object(m.jsx)("div",{className:"toc-item-drag",ref:this.dragRef},w&&Object(m.jsx)("div",{className:"d-flex justify-content-between w-100 toc-item"},Object(m.jsx)("div",{className:"d-flex toc-item-content w-100"},Object(m.jsx)(h.Button,{icon:!0,type:"tertiary",className:"toc-arrow"},Object(m.jsx)(h.Icon,{className:"toc-arrow-icon",icon:n(18),size:8})),Object(m.jsx)("div",{className:"left-and-right d-flex justify-content-between w-100"},Object(m.jsx)("div",{className:"d-flex left-content "+(l?"pr-0":"pr-2")},v&&Object(m.jsx)(h.Icon,{className:"header-icon",size:12,icon:v}),Object(m.jsx)("div",{title:r.label,className:"item-label editor"},r.label)),l&&l(r))))))))},t}(O),T=n(10),D=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),k=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},A=function(e){function t(t){var n=e.call(this,t)||this;return n.handleCloseBtn=function(){n.isActionClick=!1,n.setState({isOpen:!1});var e=n.props,t=e.toggle;void 0!==e.isOpen&&t&&t()},n.handleActionClick=function(){n.isActionClick=!0,n.setState({isOpen:!1});var e=n.props,t=e.toggle;void 0!==e.isOpen&&t&&t()},n.handleToggle=function(){var e=n.props,t=e.isOpen;if(e.tapBlankClose){n.setState({isOpen:!t});var o=n.props,i=o.toggle;void 0!==o.isOpen&&i&&i()}},n.onModalClosed=function(){var e=n.props.onClosed;e&&e(n.isActionClick),n.isActionClick=!1},n.formatMessage=function(e){var t=Object.assign({},w,m.defaultMessages);return n.props.intl.formatMessage({id:e,defaultMessage:t[e]})},n.getStyle=function(){var e=n.props.theme;return Object(m.css)(r||(r=k(["\n      .modal-header {\n        .close {\n          color: ",";\n          opacity: 1;\n          transition: color .15s ease-in-out;\n          &:not(:disabled):not(.disabled):hover,\n          &:not(:disabled):not(.disabled):focus {\n            opacity: 1;\n          }\n        }\n      }\n      .modal-body{\n        overflow-y: auto;\n        max-height: 360px;\n      }\n      .modal-content{\n        width: auto;\n      }\n      .modal-footer{\n        .btn {\n          min-width: 80px;\n          + .btn {\n            margin-left: 10px;\n          }\n        }\n      }\n      &.modal-dialog{\n        width: auto;\n      }\n      .choose-template-description{\n        width: 100%;\n        font-size: ","rem;\n        user-select:none;\n      }\n    "],["\n      .modal-header {\n        .close {\n          color: ",";\n          opacity: 1;\n          transition: color .15s ease-in-out;\n          &:not(:disabled):not(.disabled):hover,\n          &:not(:disabled):not(.disabled):focus {\n            opacity: 1;\n          }\n        }\n      }\n      .modal-body{\n        overflow-y: auto;\n        max-height: 360px;\n      }\n      .modal-content{\n        width: auto;\n      }\n      .modal-footer{\n        .btn {\n          min-width: 80px;\n          + .btn {\n            margin-left: 10px;\n          }\n        }\n      }\n      &.modal-dialog{\n        width: auto;\n      }\n      .choose-template-description{\n        width: 100%;\n        font-size: ","rem;\n        user-select:none;\n      }\n    "])),e.colors.palette.dark[600],14/17)},n.state={isOpen:!!t.isOpen},n}return D(t,e),t.prototype.componentDidUpdate=function(e){var t=e.isOpen;void 0!==t&&void 0===this.props.isOpen&&this.setState({isOpen:t})},t.prototype.render=function(){var e=this.props.isOpen,t=this.props.isRemove;return e=void 0===e?this.state.isOpen:e,Object(m.jsx)(h.Modal,{css:this.getStyle(),isOpen:e,onClosed:this.onModalClosed,toggle:this.handleToggle,centered:!0},Object(m.jsx)(h.ModalHeader,{tag:"h4",toggle:this.handleCloseBtn},this.props.title),Object(m.jsx)(h.ModalBody,null,Object(m.jsx)("div",{style:{marginLeft:"10px"}},this.props.children)),Object(m.jsx)(h.ModalFooter,null,Object(m.jsx)(h.Button,{type:t?"danger":"primary",onClick:this.handleActionClick},t?this.formatMessage("delete"):this.formatMessage("certainly")),Object(m.jsx)(h.Button,{onClick:this.handleCloseBtn},this.formatMessage("cancel"))))},t}(m.React.PureComponent),M=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),z=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},L=n(93),B=n(34),R=Object(m.jsx)(h.Icon,{className:"add-page-more-icon",size:12,icon:B}),E=Object.assign({},w,m.defaultMessages,I.defaultMessages,h.defaultMessages),N={value:"",openType:y.OpenTypes.NewWindow,linkType:m.LinkType.WebAddress},F=void 0,J=[{name:"offset",options:{offset:[0,10]}}],H=function(e){function t(t){var o=e.call(this,t)||this;return o.getTotalLines=function(){var e=o.state.itemJson,t=0;return e.children&&e.children.forEach((function(e){var n,o;t++,e.isExpand&&(t+=null!==(o=null===(n=e.children)||void 0===n?void 0:n.length)&&void 0!==o?o:0)})),t},o.getTreeContentHeight=function(){return 30*o.getTotalLines()},o.handleOnTocDragStatusChange=function(e){o.setState({isTocDragging:e,itemJson:o.getItemJsonByPages()})},o.handleOnTocDraggingStatusChange=function(e){o.setState({tocDraggingStatus:e,itemJson:o.getItemJsonByPages()})},o.handleChooseTemplate=function(e){o.setState({isTemplatePopoverOpen:!1}),o.props.addPageWithType("page",e)},o.handleToggleTemplatePopover=function(){var e=o.state.isTemplatePopoverOpen;o.setState({isTemplatePopoverOpen:!e})},o.closeTemplatePopover=function(){o.state.isTemplatePopoverOpen&&o.setState({isTemplatePopoverOpen:!1})},o.handleRemovePage=function(e){Object(v.getAppConfigAction)().appConfig.pageStructure.find((function(t){return t[e.id]&&t[e.id].length>0}))?(o.setState({willRemovePage:e}),o.handleToggleRemovePopover()):(F===e.id&&o.setState({isShowLinkSetting:!1}),o.props.removePage(e.id))},o.handleToggleRemovePopover=function(){var e=o.state.isRemovePopoverOpen;o.setState({isRemovePopoverOpen:!e})},o.singleAndDoubleClickTimeout=void 0,o.handleClickItem=function(e){e.data.type!==m.PageType.Folder&&e.data.type!==m.PageType.Link&&(o.singleAndDoubleClickTimeout&&(clearTimeout(o.singleAndDoubleClickTimeout),o.singleAndDoubleClickTimeout=void 0),o.singleAndDoubleClickTimeout=setTimeout((function(){o.setState({currentSelectedItemId:e.id,itemJson:h.TreeUtils.activeAndExpandNodesByActiveIds(o.state.itemJson,[e.id])},(function(){o.props.onClickPage(e.data.id)}))}),200))},o.handleOnTocDoubleClick=function(e,t){o.singleAndDoubleClickTimeout&&(clearTimeout(o.singleAndDoubleClickTimeout),o.singleAndDoubleClickTimeout=void 0),o.props.changeEditablePageItemId(e.id),t.stopPropagation()},o.handleOnSetLinkClick=function(e,t){F&&e.data.id===F&&o.state.isShowLinkSetting||(F=e.data.id,o.resetLinkParam(F),o.state.isShowLinkSetting?o.setState({isShowLinkSetting:!1},(function(){o.setState({isShowLinkSetting:!0})})):o.setState({isShowLinkSetting:!0}),t.stopPropagation())},o.handleExpand=function(e){if(e.children&&!(e.children.length<1)||e.mustShowArrow){var t=o.expandIds;e.isExpand?t.indexOf(e.id)>-1&&t.splice(t.indexOf(e.id),1):t.indexOf(e.id)<0&&t.push(e.id),o.setState({itemJson:h.TreeUtils.expandNodesByExpandIds(o.state.itemJson,t)})}},o.handleArrowClick=function(e){o.handleExpand(e)},o.handleSearchTextChange=function(e){o.setState({filterText:e},(function(){o.setState({itemJson:o.getItemJsonByPages()})}))},o.handleSearchSubmit=function(e){o.setState({filterText:e},(function(){o.setState({itemJson:o.getItemJsonByPages()})}))},o.handleSearchBtnClick=function(e){e.stopPropagation();var t=o.state.showSearch;t?o.handleSearchTextChange(""):o.searchInput&&(o.searchInput.focus(),o.searchInput.select()),o.setState({showSearch:!t})},o.handleSettingLinkConfirm=function(e){o.setState({isShowLinkSetting:!1}),o.changeUrl(e.value,e.openType)},o.changeUrl=function(e,t){var n=o.props.pages[F],i=Object(m.Immutable)(n).merge({linkUrl:e||"#",openTarget:t});Object(v.getAppConfigAction)().editPage(i).exec(),N.value=e,N.openType=t},o.renamePage=function(e,t){return o.props.changeEditablePageItemId(""),!!(t=null==t?void 0:t.trim())&&o.props.renamePage(e.data.id,t)},o.getFirstItemJson=function(){return o.state.itemJson.children[0]},o.getLastItemJson=function(){var e=o.state.itemJson,t=e.children[e.children.length-1];return t.isExpand&&t.children&&t.children.length>0&&(t=t.children[t.children.length-1]),t},o.getLastParentItemJson=function(){var e=o.state.itemJson;return e.children[e.children.length-1]},o.onDidDrop=function(e,t,n){if("moveInto"===n){o.props.movePageIntoPage(e.data.id,t.data.id);var i=o.expandIds;i.indexOf(t.id)<0&&(i.push(t.id),o.setState({itemJson:h.TreeUtils.expandNodesByExpandIds(o.state.itemJson,i)}))}else o.props.reOrderPage(e.data.id,t.data.id,n)},o.canDragFunc=function(e){return!0},o.canDropFunc=function(e,t){return e.id!==t.id},o.canDropIntoFunc=function(e,t){var n=Object(v.getAppConfigAction)().appConfig;return v.appConfigUtils.isFirstLevelPage(n,t.id)&&!v.appConfigUtils.isPageHasSubPage(n,e.id)&&e.type!==m.PageType.Folder},o.canOrderFunc=function(e,t){var n=Object(v.getAppConfigAction)().appConfig;return!(e.type===m.PageType.Folder&&!v.appConfigUtils.isFirstLevelPage(n,t.id))},o.formatMessage=function(e,t){return o.props.intl.formatMessage({id:e,defaultMessage:E[e]},t)},o.getItemJsonByPageJson=function(e,t,n){var i=e.id,a=o.expandIds,r=o.props.currentPageItemId,l=a.indexOf(i)>-1,s={id:i,data:e,label:e.label,index:t,level:n,isActive:r===i,isExpand:l,mustShowArrow:e.type===m.PageType.Folder,showDefault:e.type===m.PageType.Normal,allowEditable:!0,renderItem:o.renderPageContent};return s.icon=e.icon,s.icon||(s.icon=v.utils.getDefaultTocPageIcon(e)),s},o.getItemJsonByPages=function(e,t){e||(e=o.props.pages),t||(t=o.props.pageStructure);var n={id:"ROOT",children:[],label:""};if(!e||!t)return Object(m.Immutable)(n);var i=t.map((function(t,n){var i=Object.keys(t)[0],a=e[i],r=o.getItemJsonByPageJson(a,n,0),l=t[i];return r.children=[],l.forEach((function(t,n){var i=e[t],a=o.getItemJsonByPageJson(i,n,1);r.children.push(a)})),r}));if(o.props.isPageTemplateLoading){var a=Object(v.getAppConfigAction)().appConfig,r={id:v.appConfigUtils.getUniqueId(a,"page"),label:v.appConfigUtils.getUniqueLabel(a,"page",o.formatMessage("page")),type:m.PageType.Normal},l=o.getItemJsonByPageJson(r,t.length,0);l.children=[],(i=i.asMutable({deep:!0})).push(l)}n.children=i;var s=Object(m.Immutable)(n),c=o.state.filterText;if(c&&""!==c){var d=h.TreeUtils.filterTree(s,c.trim());s=h.TreeUtils.expandFilteredNodes(d,c.trim())}return s},o.getMoreDropDownItems=function(e){var t=e.data,n=[],i=Object(m.Immutable)({label:o.formatMessage("rename"),event:function(t){o.handleOnTocDoubleClick(e,t)},visible:!0});n.push(i);var a=Object(m.Immutable)({label:o.formatMessage("tocSetLink"),event:function(t){o.handleOnSetLinkClick(e,t)},visible:t.type===m.PageType.Link});n.push(a);var r=Object(m.Immutable)({label:o.formatMessage("duplicate"),event:function(e){e.stopPropagation(),o.props.duplicatePage(t.id)},visible:!0});n.push(r);var l=Object(v.getAppConfigAction)().appConfig,s=(l?v.appConfigUtils.getRealPageCountExcludeOnePage(l,t.id):0)<1,c=Object(m.Immutable)({label:o.formatMessage("delete"),event:function(e){o.handleRemovePage(t),e.stopPropagation()},visible:!s});return n.push(c),n},o.getAddPageDropDownItems=function(){var e=o.props.addPageWithType,t=[],n=Object(m.Immutable)({label:o.formatMessage("addLink"),event:function(t){F=e("link").id,o.resetLinkParam(F),o.setState({isShowLinkSetting:!0}),t.stopPropagation()},visible:!0});t.push(n);var i=Object(m.Immutable)({label:o.formatMessage("addFolder"),event:function(t){e("folder"),t.stopPropagation()},visible:!0});return t.push(i),t},o.renderPageItemRightContent=function(e){var t=o.props,i=t.theme,a=t.onDefaultClick,r=e.data,s=n(94),c=n(95),d=o.getMoreDropDownItems(e),u=Object(m.css)(l||(l=z(["\n      margin-right: calc(16px - ",");\n      .page-item-visible-btn {\n        display: ",";\n      }\n\n      .page-item-home-btn {\n        display: ",";\n        color: ",";\n      }\n\n      .dropDown {\n        display: inline-flex;\n        .btn {\n          display: none;\n        }\n      }\n\n    "],["\n      margin-right: calc(16px - ",");\n      .page-item-visible-btn {\n        display: ",";\n      }\n\n      .page-item-home-btn {\n        display: ",";\n        color: ",";\n      }\n\n      .dropDown {\n        display: inline-flex;\n        .btn {\n          display: none;\n        }\n      }\n\n    "])),i.components.button.sizes.sm.paddingX,r.isVisible?"none":"inline-flex",e.showDefault&&r.isDefault?"inline-flex":"none",e.showDefault&&r.isDefault?i.colors.black:i.colors.palette.dark[600]);return Object(m.jsx)("div",{className:"d-flex",css:u},Object(m.jsx)(h.Tooltip,{placement:"bottom",title:o.formatMessage("makeHome")},Object(m.jsx)(h.Button,{size:"sm",icon:!0,type:"tertiary",className:" page-item-home-btn page-item-icon",onClick:function(e){e.stopPropagation(),r.isDefault||a(r.id)}},Object(m.jsx)(h.Icon,{size:12,icon:n(28)}))),Object(m.jsx)(h.Tooltip,{placement:"bottom",title:r.isVisible?o.formatMessage("hideFromMenu"):o.formatMessage("showFromMenu")},Object(m.jsx)(h.Button,{size:"sm",type:"tertiary",className:"page-item-visible-btn page-item-icon",icon:!0,onClick:function(t){t.stopPropagation(),Object(v.getAppConfigAction)().editPageProperty(r.id,"isVisible",!e.data.isVisible).exec()}},Object(m.jsx)(h.Icon,{size:12,icon:r.isVisible?s:c}))),Object(m.jsx)("div",{title:o.formatMessage("more"),className:"dropDown page-item-icon"},Object(m.jsx)(T.a,{modifiers:J,direction:"down",theme:i,items:d})))},o.renderPageContent=function(e){var t,n,i,a=o.props,r=a.intl,l=a.theme,s=a.editablePageItemId,c=o.state,d=c.isTocDragging,u=c.tocDraggingStatus,p=null===(t=o.treeRef)||void 0===t?void 0:t.getBoundingClientRect();return Object(m.jsx)(P,{intl:r,itemJson:e,theme:l,canDnd:!0,isFirstItem:o.getFirstItemJson().id===e.id,editable:s===e.id,onArrowClick:o.handleArrowClick,isLastItem:o.getLastItemJson().id===e.id,isTocDragging:d,onTocDragStatusChage:o.handleOnTocDragStatusChange,tocDraggingStatus:u,parentBoundTop:null!==(n=null==p?void 0:p.top)&&void 0!==n?n:-1,renderRightContent:o.renderPageItemRightContent,renameItem:o.renamePage,parentBoundBottom:null!==(i=null==p?void 0:p.bottom)&&void 0!==i?i:-1,canDropIntoFunc:o.canDropIntoFunc,onDidDrop:o.onDidDrop,canDragFunc:o.canDragFunc,canDropFunc:o.canDropFunc,canOrderFunc:o.canOrderFunc,onDoubleClick:o.handleOnTocDoubleClick})},o.getWillRemovePageSubCount=function(){var e=Object(v.getAppConfigAction)().appConfig,t=o.state.willRemovePage;if(!e||!t)return 0;var n=e.pageStructure.find((function(e){return Object.keys(e)[0]===t.id}));return n?n[t.id].length:0},o.onExportClick=function(e){var t=o.props.currentPageItemId,n=Object(v.getAppConfigAction)().appConfig,i=[{layout:n.pages[t].layout,layouts:n.layouts,widgets:n.widgets,views:n.views,sections:n.sections,name:"Column layout",description:"Align widgets by columns",thumbnail:"./thumbnails/image2.png"}],a=i[0];a.layouts&&Object.keys(a.layouts).forEach((function(e){var t=a.layouts[e].without("id");t.content&&Object.keys(t.content).forEach((function(e){var n=t.content[e].without("id");t=t.setIn(["content",e],n)})),a.layouts=a.layouts.set(e,t)})),a.widgets&&Object.keys(a.widgets).forEach((function(e,t){var n=a.widgets[e];a.widgets=a.widgets.set(e,n.without("context","icon","label","manifest","_originManifest","version","useDataSources","useDataSourcesEnabled"))})),a.sections&&Object.keys(a.sections).forEach((function(e,t){var n=a.sections[e];a.sections=a.sections.set(e,n.without("id","label"))})),a.views&&Object.keys(a.views).forEach((function(e,t){var n=a.views[e];a.views=a.views.set(e,n.without("id","label"))})),console.log(JSON.stringify({pages:i}))},o.expandIds=[],o.state={currentSelectedItemId:t.currentPageItemId,filterText:"",itemJson:void 0,showSearch:!1,isTemplatePopoverOpen:!1,isTocDragging:!1,isRemovePopoverOpen:!1,willRemovePage:void 0,tocDraggingStatus:"on",isShowLinkSetting:!1},o.addPageDropdownItems=o.getAddPageDropDownItems(),o}return M(t,e),t.prototype.componentWillUnmount=function(){this.dropZoneInteractable&&(this.dropZoneInteractable.unset(),this.dropZoneInteractable=null)},t.prototype.componentDidUpdate=function(e){var t=this.props,n=!1,o={},i=e.pages,a=e.pageStructure,r=e.currentPageItemId,l=e.editablePageItemId,s=e.isPageTemplateLoading;if(t.currentPageItemId!==r||t.pages!==i||t.pageStructure!==a||t.editablePageItemId!==l||t.isPageTemplateLoading!==s)if(n=!0,t.pages===i&&a===t.pageStructure&&t.editablePageItemId===l||t.currentPageItemId===r)if(t.currentPageItemId!==r){c=h.TreeUtils.activeAndExpandNodesByActiveIds(this.state.itemJson,[t.currentPageItemId]);o={currentSelectedItemId:t.currentPageItemId,itemJson:h.TreeUtils.activeAndExpandNodesByActiveIds(this.state.itemJson,[t.currentPageItemId])},this.expandIds=h.TreeUtils.fetchAllExpandIds(c)}else o={itemJson:this.getItemJsonByPages(t.pages,t.pageStructure)};else{var c=h.TreeUtils.activeAndExpandNodesByActiveIds(this.getItemJsonByPages(t.pages,t.pageStructure),[t.currentPageItemId]);o={currentSelectedItemId:t.currentPageItemId,itemJson:c},this.expandIds=h.TreeUtils.fetchAllExpandIds(c)}n&&this.setState(o)},t.prototype.componentDidMount=function(){var e=this;this.setState({itemJson:this.getItemJsonByPages()}),this.dropZoneRef&&(this.dropZoneInteractable=Object(x.interact)(this.dropZoneRef).dropzone({accept:".toc-item-drag",overlap:"pointer",ondragenter:function(t){if(e.state.itemJson&&e.treeRef){var n=t.relatedTarget,o=t.dragEvent,i=e.treeRef.getBoundingClientRect().top,a=e.getTreeContentHeight(),r=JSON.parse(n.getAttribute("itemJson")),l=o.client;if(l.y<=i)e.getFirstItemJson().data.id!==r.data.id&&e.handleOnTocDraggingStatusChange("top");else if(l.y<=a+i)e.handleOnTocDraggingStatusChange("on");else{e.getLastParentItemJson().data.id!==r.data.id&&e.handleOnTocDraggingStatusChange("bottom")}}},ondragleave:function(t){e.handleOnTocDraggingStatusChange("on")},ondrop:function(t){var n=e.state.tocDraggingStatus;if("on"!==n){var o=void 0;if("bottom"===n)o=e.getLastParentItemJson();else o=e.getFirstItemJson();var i=t.relatedTarget,a=JSON.parse(i.getAttribute("itemJson"));e.onDidDrop(a,o,n),e.handleOnTocDraggingStatusChange("on")}},ondropdeactivate:function(e){}}))},t.prototype.resetLinkParam=function(e){var t=this.props.pages;N.value="",N.openType=y.OpenTypes.NewWindow;var n=t[e];n&&n.linkUrl&&"#"!=n.linkUrl&&(N.value=n.linkUrl),n&&n.openTarget&&(N.openType=n.openTarget)},t.prototype.render=function(){var e,t,n,o,i,a=this,r=this.state,l=r.itemJson,d=r.willRemovePage,u=r.isShowLinkSetting,p=this.props.theme,g=Object(v.getAppConfigAction)().appConfig,f=Object(m.css)(s||(s=z(["\n      height: 100%;\n      position: relative;\n      .toc-dropzone {\n        position: absolute;\n        pointer-events: none;\n      }\n      .text-data-600{\n        color: ",";\n      }\n      .page-list-top {\n        position: absolute;\n        right: 15px;\n        top: -48px;\n        .page-top-btns {\n          margin-right: -",";\n\n          .my-dropdown {\n            margin-left: -5px;\n            margin-right: 5px;\n          }\n        }\n      }\n      .page-tree {\n        height: 100%;\n        overflow-y: auto;\n        overflow-x: hidden;\n        .toc-item-dropzone {\n          .toc-item {\n            /* padding-left: ","; */\n          }\n        }\n      }\n    "],["\n      height: 100%;\n      position: relative;\n      .toc-dropzone {\n        position: absolute;\n        pointer-events: none;\n      }\n      .text-data-600{\n        color: ",";\n      }\n      .page-list-top {\n        position: absolute;\n        right: 15px;\n        top: -48px;\n        .page-top-btns {\n          margin-right: -",";\n\n          .my-dropdown {\n            margin-left: -5px;\n            margin-right: 5px;\n          }\n        }\n      }\n      .page-tree {\n        height: 100%;\n        overflow-y: auto;\n        overflow-x: hidden;\n        .toc-item-dropzone {\n          .toc-item {\n            /* padding-left: ","; */\n          }\n        }\n      }\n    "])),p.colors.palette.dark[600],p.components.button.sizes.sm.paddingX,m.polished.rem(4));return Object(m.jsx)("div",{css:f},Object(m.jsx)("div",{ref:function(e){return a.dropZoneRef=e},className:"toc-dropzone h-100 w-100"}),Object(m.jsx)("div",{className:"page-list-top"},Object(m.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},Object(m.jsx)("div",{className:"d-flex page-top-btns align-items-center"},Object(m.jsx)("div",{ref:function(e){return a.addPageRef=e},css:Object(m.css)(c||(c=z(["z-index: 11;"],["z-index: 11;"])))},Object(m.jsx)(h.Tooltip,{placement:"bottom",title:this.formatMessage("addPage")},Object(m.jsx)(h.Button,{icon:!0,disabled:!l,type:"tertiary",onClick:this.handleToggleTemplatePopover,size:"sm",className:"add-page-btn"},Object(m.jsx)(h.Icon,{className:"add-page-icon",width:15,height:17,icon:L})))),this.state.isTemplatePopoverOpen&&Object(m.jsx)(y.PageTemplatePopper,{theme:p,referenceElement:this.addPageRef,formatMessage:this.formatMessage,onItemSelect:this.handleChooseTemplate,onClose:this.closeTemplatePopover}),Object(m.jsx)(h.Tooltip,{placement:"bottom",title:this.formatMessage("more")},Object(m.jsx)(T.a,{items:this.addPageDropdownItems,theme:p,disabled:!l,direction:"down",toggleContent:R}))))),Object(m.jsx)(h.Tree,{forwardRef:function(e){a.treeRef=e},className:"page-tree mt-2",hideRoot:!0,itemJson:l,onClickItem:this.handleClickItem,handleExpand:this.handleExpand}),d&&Object(m.jsx)(A,{isRemove:!0,theme:p,tapBlankClose:!1,toggle:this.handleToggleRemovePopover,onClosed:function(e){F===d.id&&a.setState({isShowLinkSetting:!1}),e&&d&&a.props.removePage(d.id)},title:this.formatMessage("delete"),isOpen:this.state.isRemovePopoverOpen,intl:this.props.intl},this.formatMessage("removePageTip",{subCount:this.getWillRemovePageSubCount(),label:d.label})),u&&(null===(e=null==g?void 0:g.pages)||void 0===e?void 0:e[F])&&!(null===(t=m.urlUtils.getAppIdPageIdFromUrl())||void 0===t?void 0:t.pageId)&&Object(m.jsx)(y.LinkSettingPopup,{isOpen:u&&!(null===(n=m.urlUtils.getAppIdPageIdFromUrl())||void 0===n?void 0:n.pageId),isLinkPageSetting:!0,title:null===(i=null===(o=null==g?void 0:g.pages)||void 0===o?void 0:o[F])||void 0===i?void 0:i.label,pisition:"left",linkParam:N,onSettingCancel:function(){a.setState({isShowLinkSetting:!1})},onSettingConfirm:this.handleSettingLinkConfirm}))},t}(m.React.PureComponent),_=m.ReactRedux.connect((function(e){var t=e.appStateInBuilder&&e.appStateInBuilder.appConfig;return{pages:t&&t.pages,pageStructure:t&&t.pageStructure}}))(H),V=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),U=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},W=function(e){function t(t){var n=e.call(this,t)||this;return n.onDropHover=function(e){n.state.dropType!==e&&n.setState({dropType:e})},n.getStyle=function(){var e,t=Object(m.getAppStore)().getState(),o=null===(e=null==t?void 0:t.appContext)||void 0===e?void 0:e.isRTL,i=n.props,a=i.theme,r=i.editable,l=i.itemJson,s=i.isTocDragging,c=l.mustShowArrow,u=l.children,p=l.level,g=l.isActive,f=l.isExpand,v=n.state,h=v.isDragging,b=v.isHovering;return Object(m.css)(d||(d=U(["\n      height: ","px;\n      width: auto;\n      min-width: 100%;\n      align-items: center;\n      cursor: pointer;\n      ","\n\n      &.drag-move-into {\n        border: 1px solid ",";\n      }\n\n      :hover {\n        ","\n        .dialog-item-splash-btn, .dialog-item-page-btn {\n          display: inline-flex;\n          z-index: 2;\n        }\n        .dropDown {\n          .btn {\n            display: inline-flex;\n          }\n          z-index: 2;\n        }\n      }\n\n      &.active {\n        ","\n        border: 0;\n      }\n\n      .toc-dialog-dropzone {\n        touch-action: none;\n        position: relative;\n\n        .toc-dialog-drag:hover {\n          cursor: pointer !important;\n        }\n\n        .toc-dialog-drag {\n          pointer-events: ",";\n          visibility: ",";\n          z-index: 1;\n          position: absolute;\n          left: 0;\n          top: 0;\n          right: 0;\n          bottom: 0;\n          background-color: ",";\n          box-shadow: ",";\n        }\n\n        .toc-item {\n          padding: 0;\n          border: 0;\n          position: relative;\n          .toc-item-content {\n            margin-left: ","px;\n            position: relative;\n            .toc-arrow {\n              z-index: 2;\n              padding-right: ",";\n              visibility: hidden;\n               /* ","; */\n\n              .toc-arrow-icon {\n                fill: ",";\n                transform-origin: center;\n                transform: ",";\n                transition: transform .5s;\n              }\n            }\n\n            .left-and-right {\n              overflow-x: hidden;\n              margin-left: -5px;\n              .left-content {\n                align-items: center;\n                overflow-x: hidden;\n                flex: auto;\n                .editor {\n                  overflow: hidden;\n                  text-overflow: ",";\n                  white-space: nowrap;\n                  font-size: ",'rem;\n                  user-select: none;\n                  flex: auto;\n                  text-align: start;\n                }\n                [contenteditable="true"] {\n                  -webkit-user-select: text;\n                  background-color: ',";\n                }\n                .header-icon {\n                  margin-right: 0.3rem;\n                  flex: none;\n                }\n              }\n            }\n          }\n\n          &.toc-drag-move-last {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          &.toc-drag-move-first {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: red;\n              /* ","; */\n            }\n          }\n\n          .drag-move-out-order-bottom {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          .drag-move-out-order-top {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n        }\n      }\n    "],["\n      height: ","px;\n      width: auto;\n      min-width: 100%;\n      align-items: center;\n      cursor: pointer;\n      ","\n\n      &.drag-move-into {\n        border: 1px solid ",";\n      }\n\n      :hover {\n        ","\n        .dialog-item-splash-btn, .dialog-item-page-btn {\n          display: inline-flex;\n          z-index: 2;\n        }\n        .dropDown {\n          .btn {\n            display: inline-flex;\n          }\n          z-index: 2;\n        }\n      }\n\n      &.active {\n        ","\n        border: 0;\n      }\n\n      .toc-dialog-dropzone {\n        touch-action: none;\n        position: relative;\n\n        .toc-dialog-drag:hover {\n          cursor: pointer !important;\n        }\n\n        .toc-dialog-drag {\n          pointer-events: ",";\n          visibility: ",";\n          z-index: 1;\n          position: absolute;\n          left: 0;\n          top: 0;\n          right: 0;\n          bottom: 0;\n          background-color: ",";\n          box-shadow: ",";\n        }\n\n        .toc-item {\n          padding: 0;\n          border: 0;\n          position: relative;\n          .toc-item-content {\n            margin-left: ","px;\n            position: relative;\n            .toc-arrow {\n              z-index: 2;\n              padding-right: ",";\n              visibility: hidden;\n               /* ","; */\n\n              .toc-arrow-icon {\n                fill: ",";\n                transform-origin: center;\n                transform: ",";\n                transition: transform .5s;\n              }\n            }\n\n            .left-and-right {\n              overflow-x: hidden;\n              margin-left: -5px;\n              .left-content {\n                align-items: center;\n                overflow-x: hidden;\n                flex: auto;\n                .editor {\n                  overflow: hidden;\n                  text-overflow: ",";\n                  white-space: nowrap;\n                  font-size: ",'rem;\n                  user-select: none;\n                  flex: auto;\n                  text-align: start;\n                }\n                [contenteditable="true"] {\n                  -webkit-user-select: text;\n                  background-color: ',";\n                }\n                .header-icon {\n                  margin-right: 0.3rem;\n                  flex: none;\n                }\n              }\n            }\n          }\n\n          &.toc-drag-move-last {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          &.toc-drag-move-first {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: red;\n              /* ","; */\n            }\n          }\n\n          .drag-move-out-order-bottom {\n            :after{\n              content: '';\n              position: absolute;\n              left: 0;\n              top: auto;\n              bottom: 0;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n\n          .drag-move-out-order-top {\n            :before {\n              content: '';\n              position: absolute;\n              left: 0;\n              top: 0;\n              bottom: auto;\n              right: auto;\n              height: 2px;\n              width: 100%;\n              background-color: ",";\n            }\n          }\n        }\n      }\n    "])),30,h?"z-index: 100;":"",a.colors.palette.primary[700],g||s?"":"background-color: "+a.colors.palette.light[400]+";",s?"":"background-color: "+a.colors.primary+";",b?"all":"none",l.allowEditable&&r?"hidden":"visible",h?m.polished.rgba(a.colors.palette.light[400],.6):"transparent",h?a.boxShadows.lg:a.boxShadows.none,10*p,m.polished.rem(1),c||u&&u.length>0?"visible":"hidden",a.colors.black,"rotate("+(f?90:o?180:0)+"deg)",r?"clip":"ellipsis",.875,a.colors.white,a.colors.palette.primary[700],a.colors.palette.primary[700],a.colors.palette.primary[700],a.colors.palette.primary[700])},n.state={dropType:"none",isDragging:!1,isHovering:!1},n.dropZoneRef=m.React.createRef(),n.dragRef=m.React.createRef(),n}return V(t,e),t.prototype.componentWillUnmount=function(){this.dragInteractable&&(this.dragInteractable.unset(),this.dragInteractable=null),this.dropZoneInteractable&&(this.dropZoneInteractable.unset(),this.dropZoneInteractable=null)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.initDragEvent()},t.prototype.componentDidUpdate=function(t){e.prototype.componentDidUpdate.call(this,t)},t.prototype.initDragEvent=function(){var e,t=this,n=this.props,o=n.canDnd,i=n.canDropFunc,a=n.onDidDrop,r=n.itemJson;if(o&&this.dropZoneRef.current&&this.dragRef.current){var l=null;this.dragRef.current.setAttribute("itemJson",JSON.stringify(r));var s=(null===(e=r.data)||void 0===e?void 0:e.mode)===m.DialogMode.Fixed?".toc-fixed-dialog-drag":".toc-anchored-dialog-drag";this.dropZoneInteractable=Object(x.interact)(this.dropZoneRef.current).dropzone({accept:s,overlap:"pointer",ondropmove:function(e){var n=e.relatedTarget,o=e.target,a=JSON.parse(n.getAttribute("itemJson"));if(i&&i(r.data,a.data)){var l=o.getBoundingClientRect(),s=l.bottom-l.top,c=2*s/3,d=1*s/3,u=e.dragEvent.client.y-l.top,p=t.state.dropType;u>c?p="bottom":u<d&&(p="top"),t.onDropHover(p)}},ondragleave:function(e){t.onDropHover("none")},ondrop:function(e){var n=t.state.dropType;if("none"!==n){var o=e.relatedTarget,i=JSON.parse(o.getAttribute("itemJson"));a&&a(i,r,n),t.onDropHover("none")}}}),this.dragInteractable=Object(x.interact)(this.dragRef.current).draggable({inertia:!1,modifiers:[],autoScroll:!0,onstart:function(e){t.setState({isDragging:!0});var n=t.props.onTocDragStatusChage;n&&n(!0)},onmove:function(e){var n=e.clientX,o=e.clientY,i=e.clientX0,a=e.clientY0,r=e.target,s=parseFloat(r.getAttribute("start-x"))||0,c=parseFloat(r.getAttribute("start-y"))||0,d=n-i+s,u=o-a+c,p=-r.clientWidth/2,g=r.clientWidth/2;d<p?d=p:d>g&&(d=g);var f=t.props,m=f.parentBoundBottom,v=f.parentBoundTop;if(m>-1&&v>-1){var h=v-a,b=m-a;u<=h?u=h:u>=b&&(u=b)}l&&cancelAnimationFrame(l),l=requestAnimationFrame((function(){r.style.webkitTransform=r.style.transform="translate("+d+"px, "+u+"px)",l=null}))},onend:function(e){var n=e.target;l&&cancelAnimationFrame(l),n.style.webkitTransform=n.style.transform="translate(0px, 0px)",t.setState({isDragging:!1});var o=t.props.onTocDragStatusChage;o&&o(!1)}})}},t.prototype.render=function(){var e,t,o,i=this,a=this.props,r=a.itemJson,l=a.renderRightContent,s=a.editable,c=a.canDnd,d=a.theme,u=a.isFirstItem,p=a.isLastItem,g=a.tocDraggingStatus,f=a.isTocDragging,v=a.tocDraggingMode,b=r.icon,y=r.isActive,I=this.state,w=I.dropType,x=I.isDragging;o=b&&b.svg?b:{svg:b};var j="moveInto"===w?"drag-move-into":"",O="drag-move-out-order-"+w,S="";f&&"on"!==g&&v===r.data.mode&&("bottom"===g&&p?S="toc-drag-move-last":"top"===g&&u&&(S="toc-drag-move-first"));var C=null===(t=null===(e=Object(m.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.theme;return Object(m.jsx)("div",{className:"d-flex "+(y?"active":"")+"   "+j,css:this.getStyle(),onMouseEnter:function(e){return i.setState({isHovering:!0})},onMouseLeave:function(e){return i.setState({isHovering:!1})}},Object(m.jsx)("div",{ref:this.dropZoneRef,className:"toc-dialog-dropzone h-100 w-100"},Object(m.jsx)("div",{className:"d-flex w-100 h-100",onDoubleClick:this.handleDoubleClickItem,onClick:this.handleClick},Object(m.jsx)("div",{className:"d-flex justify-content-between w-100 toc-item "+S},Object(m.jsx)("div",{className:"d-flex toc-item-content "+O+" w-100"},Object(m.jsx)(h.Button,{className:"toc-arrow",icon:!0,type:"tertiary",onClick:this.handleArrowClick},Object(m.jsx)(h.Icon,{className:"toc-arrow-icon",icon:n(18),size:8})),Object(m.jsx)("div",{className:"left-and-right d-flex justify-content-between w-100"},Object(m.jsx)("div",{className:"d-flex left-content "+(l?"pr-0":"pr-2")},b&&Object(m.jsx)(h.Icon,{autoFlip:r.needFlip,className:"header-icon",color:o.properties&&m.themeUtils.color(o.properties.color,C)||d.colors.palette.dark[600],size:12,icon:o.svg}),Object(m.jsx)("div",{title:r.label,className:"item-label editor",ref:this.editor,onBlur:this.onRenameBlur,contentEditable:r.allowEditable&&s,suppressContentEditableWarning:!0},r.label)),l&&l(r)))),c&&Object(m.jsx)("div",{className:Object(m.classNames)("toc-dialog-drag",{"toc-fixed-dialog-drag":r.data.mode===m.DialogMode.Fixed,"toc-anchored-dialog-drag":r.data.mode===m.DialogMode.Anchored}),ref:this.dragRef},x&&Object(m.jsx)("div",{className:"d-flex justify-content-between w-100 toc-item"},Object(m.jsx)("div",{className:"d-flex toc-item-content w-100"},Object(m.jsx)(h.Button,{icon:!0,type:"tertiary",className:"toc-arrow"},Object(m.jsx)(h.Icon,{className:"toc-arrow-icon",icon:n(18),size:8})),Object(m.jsx)("div",{className:"left-and-right d-flex justify-content-between w-100"},Object(m.jsx)("div",{className:"d-flex left-content "+(l?"pr-0":"pr-2")},b&&Object(m.jsx)(h.Icon,{className:"header-icon",size:12,icon:b}),Object(m.jsx)("div",{title:r.label,className:"item-label editor"},r.label)),l&&l(r))))))))},t}(O),G=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Z=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},q=n(96),X=n(34),Y=[{name:"offset",options:{offset:[0,10]}}],K=function(e){function t(t){var o=e.call(this,t)||this;return o.getTotalLines=function(){var e=o.state.itemJson,t=0;return e.children&&e.children.forEach((function(e){var n,o;t++,e.isExpand&&(t+=null!==(o=null===(n=e.children)||void 0===n?void 0:n.length)&&void 0!==o?o:0)})),t},o.getTreeContentHeight=function(){return 30*o.getTotalLines()},o.handleOnTocDragStatusChange=function(e){var t,n=o.getItemJsonByDialogs();o.setState({isTocDragging:e,tocDraggingMode:null===(t=n.data)||void 0===t?void 0:t.mode,itemJson:n})},o.getFirstItemJson=function(e){return o.state.itemJson.children.filter((function(t){return t.data.mode===e&&0===t.data.index}))[0]},o.getLastItemJson=function(e){var t=o.state.itemJson.children.filter((function(t){return t.data.mode===e}));return t.filter((function(e){return e.data.index===t.length-1}))[0]},o.getLastParentItemJson=function(){var e=o.state.itemJson;return e.children[e.children.length-1]},o.handleOnTocDraggingStatusChange=function(e){o.setState({tocDraggingStatus:e,itemJson:o.getItemJsonByDialogs()})},o.onDidDrop=function(e,t,n){"moveInto"!==n&&o.props.reOrderDialog(e.data.id,t.data.id,n)},o.canDropFunc=function(e,t){return e.id!==t.id},o.handleChooseTemplate=function(e){o.setState({isTemplatePopoverOpen:!1}),o.props.addDialog(e)},o.handleToggleTemplatePopover=function(){var e=o.state.isTemplatePopoverOpen;o.setState({isTemplatePopoverOpen:!e})},o.closeTemplatePopover=function(){o.state.isTemplatePopoverOpen&&o.setState({isTemplatePopoverOpen:!1})},o.singleAndDoubleClickTimeout=void 0,o.handleClickItem=function(e){o.singleAndDoubleClickTimeout&&(clearTimeout(o.singleAndDoubleClickTimeout),o.singleAndDoubleClickTimeout=void 0),o.singleAndDoubleClickTimeout=setTimeout((function(){o.setState({currentSelectedItemId:e.id,itemJson:h.TreeUtils.activeAndExpandNodesByActiveIds(o.state.itemJson,[e.id])},(function(){o.props.onClickDialog(e.data.id)}))}),200)},o.handleOnTocDoubleClick=function(e,t){o.singleAndDoubleClickTimeout&&(clearTimeout(o.singleAndDoubleClickTimeout),o.singleAndDoubleClickTimeout=void 0),o.props.changeEditableDialogItemId(e.id),t.stopPropagation()},o.renameDialog=function(e,t){return o.props.changeEditableDialogItemId(""),!!(t=null==t?void 0:t.trim())&&o.props.renameDialog(e.data.id,t)},o.formatMessage=function(e,t){var n=Object.assign({},w,m.defaultMessages,h.defaultMessages);return o.props.intl.formatMessage({id:e,defaultMessage:n[e]},t)},o.getItemJsonByDialogJson=function(e){var t=e.id,n=o.props.currentDialogItemId,i={id:t,isSplash:!!e.isSplash,data:e,label:e.label,index:e.index,level:0,isActive:n===t,allowEditable:!0,renderItem:o.renderDialogContent};return i.icon=e.icon,i.icon||(i.icon=v.utils.getDefaultTocDialogIcon()),i},o.getItemJsonByDialogs=function(e){e||(e=o.props.dialogs);var t={id:"ROOT",children:[],label:""};if(!e)return Object(m.Immutable)(t);var n=Object.keys(e).map((function(t,n){var i=o.getItemJsonByDialogJson(e[t]);return i.children=[],i}));return t.children=n,Object(m.Immutable)(t)},o.getMoreDropDownItems=function(e){var t=e.data,n=[],i=Object(m.Immutable)({label:o.formatMessage("rename"),event:function(t){o.handleOnTocDoubleClick(e,t)},visible:!0});n.push(i);var a=Object(m.Immutable)({label:o.formatMessage("duplicate"),event:function(e){e.stopPropagation(),o.props.duplicateDialog(t.id)},visible:!0});n.push(a);var r=Object(m.Immutable)({label:o.formatMessage("delete"),event:function(e){o.props.removeDialog(t.id),e.stopPropagation()},visible:!0});return n.push(r),n},o.renderDialogItemRightContent=function(e){var t=o.props,i=t.theme,a=t.onSplashClick,r=e.data,l=o.getMoreDropDownItems(e),s=Object(m.css)(u||(u=Z(["\n      margin-right: calc(16px - ",");\n      .dialog-item-splash-btn {\n        display: ",";\n        color: ",";\n      }\n      .dropDown {\n        display: inline-flex;\n        .btn {\n          display: none;\n        }\n      }\n    "],["\n      margin-right: calc(16px - ",");\n      .dialog-item-splash-btn {\n        display: ",";\n        color: ",";\n      }\n      .dropDown {\n        display: inline-flex;\n        .btn {\n          display: none;\n        }\n      }\n    "])),i.components.button.sizes.sm.paddingX,e.isSplash?"inline-flex":"none",e.isSplash?i.colors.black:i.colors.palette.dark[600]),c=null;if(r.mode===m.DialogMode.Fixed){var d=v.utils.getPageListByDialogId(o.props.pages,r.id);d.length&&(c=o.formatMessage("opendWithPages",{pages:d.map((function(e){return e.label})).join(", ")}))}return Object(m.jsx)("div",{className:"d-flex",css:s},c?Object(m.jsx)(h.Tooltip,{placement:"bottom",title:c},Object(m.jsx)(h.Button,{size:"sm",icon:!0,type:"tertiary",style:{cursor:"inherit"},className:"dialog-item-page-btn dialog-item-icon"},Object(m.jsx)(h.Icon,{size:12,icon:n(97)}))):r.mode===m.DialogMode.Fixed&&Object(m.jsx)(h.Tooltip,{placement:"bottom",title:o.formatMessage("makeSplash")},Object(m.jsx)(h.Button,{size:"sm",icon:!0,type:"tertiary",className:"dialog-item-splash-btn dialog-item-icon",onClick:function(e){e.stopPropagation(),a(r.id)}},Object(m.jsx)(h.Icon,{size:12,icon:n(98)}))),Object(m.jsx)("div",{title:o.formatMessage("more"),className:"dropDown dialog-item-icon"},Object(m.jsx)(T.a,{modifiers:Y,direction:"down",theme:i,items:l})))},o.renderDialogContent=function(e){var t,n,i,a=o.props,r=a.intl,l=a.theme,s=a.editableDialogItemId,c=o.state,d=c.isTocDragging,u=c.tocDraggingStatus,p=c.tocDraggingMode,g=null===(t=e.data.mode===m.DialogMode.Fixed?o.treeRefForFixed:o.treeRefForAnchored)||void 0===t?void 0:t.getBoundingClientRect();return Object(m.jsx)(W,{intl:r,itemJson:e,theme:l,canDnd:!0,tocDraggingMode:p,isFirstItem:0===e.data.index,isLastItem:o.getLastItemJson(e.data.mode).id===e.id,isTocDragging:d,onTocDragStatusChage:o.handleOnTocDragStatusChange,tocDraggingStatus:u,parentBoundTop:null!==(n=null==g?void 0:g.top)&&void 0!==n?n:-1,parentBoundBottom:null!==(i=null==g?void 0:g.bottom)&&void 0!==i?i:-1,editable:s===e.id,renderRightContent:o.renderDialogItemRightContent,onDidDrop:o.onDidDrop,canDropFunc:o.canDropFunc,renameItem:o.renameDialog,onDoubleClick:o.handleOnTocDoubleClick})},o.getItemJsonByMode=function(e){var t=o.state.itemJson,n=t?{id:t.id,isActive:t.isActive,isExpand:t.isExpand,label:"",children:[]}:null;if(n){var i={};t.children.map((function(t){var n;(null===(n=t.data)||void 0===n?void 0:n.mode)===e&&(i[t.index]=t)})),Object.keys(i).map((function(e){n.children.push(i[e])}))}return n},o.state={currentSelectedItemId:t.currentDialogItemId,itemJson:void 0,isTemplatePopoverOpen:!1,isFixedGroupShown:!0,isAnchoredGroupShown:!0,isTocDragging:!1,tocDraggingMode:null,tocDraggingStatus:"on"},o}return G(t,e),t.prototype.componentWillUnmount=function(){this.dropZoneInteractable&&(this.dropZoneInteractable.unset(),this.dropZoneInteractable=null)},t.prototype.componentDidUpdate=function(e){var t=this.props,n=!1,o={},i=e.dialogs,a=e.currentDialogItemId,r=e.editableDialogItemId,l=e.forceRefresh;if(t.forceRefresh&&!l||t.currentDialogItemId!==a||t.dialogs!==i||t.editableDialogItemId!==r)if(n=!0,t.dialogs===i&&t.editableDialogItemId===r||t.currentDialogItemId===a)o=t.currentDialogItemId!==a?{currentSelectedItemId:t.currentDialogItemId,itemJson:h.TreeUtils.activeAndExpandNodesByActiveIds(this.state.itemJson,[t.currentDialogItemId])}:{itemJson:this.getItemJsonByDialogs(t.dialogs)};else{var s=h.TreeUtils.activeAndExpandNodesByActiveIds(this.getItemJsonByDialogs(t.dialogs),[t.currentDialogItemId]);o={currentSelectedItemId:t.currentDialogItemId,itemJson:s}}n&&this.setState(o)},t.prototype.componentDidMount=function(){this.setState({itemJson:this.getItemJsonByDialogs()}),this.initDragEvent(m.DialogMode.Fixed),this.initDragEvent(m.DialogMode.Anchored)},t.prototype.initDragEvent=function(e){var t=this,n=e===m.DialogMode.Fixed?".toc-fixed-dialog-drag":".toc-anchored-dialog-drag",o=e===m.DialogMode.Fixed?this.dropZoneRefForFixed:this.dropZoneRefForAnchored,i=e===m.DialogMode.Fixed?this.treeRefForFixed:this.treeRefForAnchored;o&&(this.dropZoneInteractable=Object(x.interact)(o).dropzone({accept:n,overlap:"pointer",ondragenter:function(n){if(t.state.itemJson&&i){var o=n.relatedTarget,a=n.dragEvent,r=i.getBoundingClientRect().top,l=t.getTreeContentHeight(),s=JSON.parse(o.getAttribute("itemJson")),c=a.client;if(c.y<=r)t.getFirstItemJson(e).data.id!==s.data.id&&t.handleOnTocDraggingStatusChange("top");else c.y<=l+r&&t.handleOnTocDraggingStatusChange("on")}},ondragleave:function(e){t.handleOnTocDraggingStatusChange("on")},ondrop:function(e){var n=e.relatedTarget,o=JSON.parse(n.getAttribute("itemJson")),i=t.state.tocDraggingStatus;if("on"!==i){var a="bottom"===i?t.getLastParentItemJson():t.getFirstItemJson(o.data.mode);t.onDidDrop(o,a,i),t.handleOnTocDraggingStatusChange("on")}},ondropdeactivate:function(e){}}))},t.prototype.render=function(){var e=this,t=this.state.itemJson,o=this.props.theme,i=Object(m.css)(p||(p=Z(["\n      height: 100%;\n      position: relative;\n      .toc-dropzone {\n        position: absolute;\n        pointer-events: none;\n      }\n      .text-data-600{\n        color: ",";\n      }\n      .dialog-list-top {\n        position: absolute;\n        right: 16px;\n        top: -44px;\n        .dialog-top-btns {\n          margin-right: -",";\n\n          .my-dropdown {\n            margin-left: -5px;\n            margin-right: 5px;\n          }\n        }\n      }\n      .dialog-list-content{\n        height: 100%;\n        overflow-y: auto;\n        overflow-x: hidden;\n\n        .dialog-group{\n          display: flex;\n          align-items: center;\n          padding: 0.25rem 0.575rem 0.25rem 1rem;\n          .dialog-group-title{\n            font-size: 14px;\n            color: ",";\n            flex-grow: 1;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n            overflow: hidden;\n          }\n        }\n\n        .dialog-tree {\n          overflow: hidden;\n        }\n      }\n    "],["\n      height: 100%;\n      position: relative;\n      .toc-dropzone {\n        position: absolute;\n        pointer-events: none;\n      }\n      .text-data-600{\n        color: ",";\n      }\n      .dialog-list-top {\n        position: absolute;\n        right: 16px;\n        top: -44px;\n        .dialog-top-btns {\n          margin-right: -",";\n\n          .my-dropdown {\n            margin-left: -5px;\n            margin-right: 5px;\n          }\n        }\n      }\n      .dialog-list-content{\n        height: 100%;\n        overflow-y: auto;\n        overflow-x: hidden;\n\n        .dialog-group{\n          display: flex;\n          align-items: center;\n          padding: 0.25rem 0.575rem 0.25rem 1rem;\n          .dialog-group-title{\n            font-size: 14px;\n            color: ",";\n            flex-grow: 1;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n            overflow: hidden;\n          }\n        }\n\n        .dialog-tree {\n          overflow: hidden;\n        }\n      }\n    "])),o.colors.palette.dark[600],o.components.button.sizes.sm.paddingX,o.colors.palette.dark[600]),a=this.getItemJsonByMode(m.DialogMode.Fixed),r=this.getItemJsonByMode(m.DialogMode.Anchored);return Object(m.jsx)("div",{css:i},Object(m.jsx)("div",{className:"dialog-list-top"},Object(m.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},Object(m.jsx)("div",{className:"d-flex dialog-top-btns align-items-center"},Object(m.jsx)("div",{ref:function(t){return e.addDialogRef=t},css:Object(m.css)(g||(g=Z(["z-index: 11;"],["z-index: 11;"])))},Object(m.jsx)(h.Tooltip,{placement:"bottom",title:this.formatMessage("addDialog")},Object(m.jsx)(h.Button,{icon:!0,disabled:!t,type:"tertiary",onClick:this.handleToggleTemplatePopover,size:"sm",className:"add-dialog-btn mt-1"},Object(m.jsx)(h.Icon,{className:"add-dialog-icon",width:15,height:17,icon:n(99)})))),this.state.isTemplatePopoverOpen&&Object(m.jsx)(y.DialogTemplatePopper,{theme:o,showList:!0,referenceElement:this.addDialogRef,formatMessage:this.formatMessage,onItemSelect:this.handleChooseTemplate,onClose:this.closeTemplatePopover})))),Object(m.jsx)("div",{className:"dialog-list-content"},Object(m.jsx)("div",null,Object(m.jsx)("div",{className:"dialog-group"},Object(m.jsx)("div",{className:"dialog-group-title"},this.formatMessage("fixedWindows")),Object(m.jsx)(h.Button,{icon:!0,size:"sm",type:"tertiary",disabled:!((null==a?void 0:a.children.length)>0),onClick:function(t){return e.setState({isFixedGroupShown:!e.state.isFixedGroupShown})}},Object(m.jsx)(h.Icon,{size:"12",icon:this.state.isFixedGroupShown?q:X}))),Object(m.jsx)(h.Collapse,{isOpen:this.state.isFixedGroupShown},Object(m.jsx)("div",{ref:function(t){return e.dropZoneRefForFixed=t},className:"toc-dropzone toc-dialog-dropzone w-100",style:{height:30*(null==a?void 0:a.children.length)+"px"}}),Object(m.jsx)(h.Tree,{forwardRef:function(t){e.treeRefForFixed=t},className:"dialog-tree",hideRoot:!0,itemJson:Object(m.Immutable)(a),onClickItem:this.handleClickItem})),Object(m.jsx)("div",{className:"dialog-group"},Object(m.jsx)("div",{className:"dialog-group-title"},this.formatMessage("anchoredWindows")),Object(m.jsx)(h.Button,{icon:!0,size:"sm",type:"tertiary",disabled:!((null==r?void 0:r.children.length)>0),onClick:function(t){return e.setState({isAnchoredGroupShown:!e.state.isAnchoredGroupShown})}},Object(m.jsx)(h.Icon,{size:"12",icon:this.state.isAnchoredGroupShown?q:X}))),Object(m.jsx)(h.Collapse,{isOpen:this.state.isAnchoredGroupShown},Object(m.jsx)("div",{ref:function(t){return e.dropZoneRefForAnchored=t},className:"toc-dropzone toc-dialog-dropzone w-100",style:{height:30*(null==r?void 0:r.children.length)+"px"}}),Object(m.jsx)(h.Tree,{forwardRef:function(t){e.treeRefForAnchored=t},className:"dialog-tree",hideRoot:!0,itemJson:Object(m.Immutable)(r),onClickItem:this.handleClickItem})))))},t}(m.React.PureComponent),Q=m.ReactRedux.connect((function(e){var t=e.appStateInBuilder&&e.appStateInBuilder.appConfig;return{pages:t&&t.pages,dialogs:t&&t.dialogs}}))(K),$=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ee=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};!function(e){e.Widget="WIDGET",e.Section="SECTION",e.View="View",e.ScreenGroup="SCREEN_GROUP",e.Screen="SCREEN",e.ScreenMainStage="SCREEN_MAIN_STAGE",e.ScreenSrollingPanel="SCREEN_SCROLLING_PANEL",e.Layout="LAYOUT",e.Label="Label"}(f||(f={}));var te,ne,oe=function(e){function t(t){var n=e.call(this,t)||this;return n.getStyle=function(){var e,t=Object(m.getAppStore)().getState(),o=null===(e=null==t?void 0:t.appContext)||void 0===e?void 0:e.isRTL,i=n.props,a=i.theme,r=i.editable,l=i.itemJson,s=l.mustShowArrow,c=l.children,d=l.level,u=l.isActive,p=l.isExpand;return Object(m.css)(te||(te=ee(["\n      height: ","px;\n      width: auto;\n      min-width: 100%;\n      align-items: center;\n      cursor: pointer;\n\n      :hover {\n        ","\n        .dropDown {\n          z-index: 2;\n          .btn {\n            visibility: visible;\n          }\n        }\n        .editor {\n          color: ",";\n        }\n      }\n\n      &.active {\n        background-color: ",";\n        border: 0;\n        .editor {\n          color: ",";\n        }\n      }\n\n      .toc-item {\n        padding: 0;\n        border: 0;\n        .toc-item-content {\n          margin-left: ","px;\n          position: relative;\n          .toc-arrow {\n            z-index: 2;\n            padding-right: ",";\n            visibility: ",";\n            .toc-arrow-icon {\n              fill: ",";\n              transform-origin: center;\n                transform: ",";\n                transition: transform .5s;\n            }\n          }\n\n          .left-and-right {\n            overflow-x: hidden;\n            margin-left: -5px;\n            /* margin-left: calc(8px - "," - 0.6875rem + ","); */\n            .left-content {\n              align-items: center;\n              overflow-x: hidden;\n              flex: auto;\n              .editor {\n                overflow: hidden;\n                text-overflow: ",";\n                white-space: nowrap;\n                font-size: ",'rem;\n                user-select: none;\n                flex: auto;\n                text-align: start;\n              }\n              [contenteditable="true"] {\n                -webkit-user-select: text;\n                background-color: ',";\n              }\n              .header-icon {\n                margin-right: 0.3rem;\n                flex: none;\n              }\n            }\n          }\n        }\n      }\n    "],["\n      height: ","px;\n      width: auto;\n      min-width: 100%;\n      align-items: center;\n      cursor: pointer;\n\n      :hover {\n        ","\n        .dropDown {\n          z-index: 2;\n          .btn {\n            visibility: visible;\n          }\n        }\n        .editor {\n          color: ",";\n        }\n      }\n\n      &.active {\n        background-color: ",";\n        border: 0;\n        .editor {\n          color: ",";\n        }\n      }\n\n      .toc-item {\n        padding: 0;\n        border: 0;\n        .toc-item-content {\n          margin-left: ","px;\n          position: relative;\n          .toc-arrow {\n            z-index: 2;\n            padding-right: ",";\n            visibility: ",";\n            .toc-arrow-icon {\n              fill: ",";\n              transform-origin: center;\n                transform: ",";\n                transition: transform .5s;\n            }\n          }\n\n          .left-and-right {\n            overflow-x: hidden;\n            margin-left: -5px;\n            /* margin-left: calc(8px - "," - 0.6875rem + ","); */\n            .left-content {\n              align-items: center;\n              overflow-x: hidden;\n              flex: auto;\n              .editor {\n                overflow: hidden;\n                text-overflow: ",";\n                white-space: nowrap;\n                font-size: ",'rem;\n                user-select: none;\n                flex: auto;\n                text-align: start;\n              }\n              [contenteditable="true"] {\n                -webkit-user-select: text;\n                background-color: ',";\n              }\n              .header-icon {\n                margin-right: 0.3rem;\n                flex: none;\n              }\n            }\n          }\n        }\n      }\n    "])),30,u?"":"background-color: "+a.colors.palette.light[400]+";",a.colors.black,a.colors.primary,a.colors.black,10*d,m.polished.rem(1),s||c&&c.length>0?"visible":"hidden",a.colors.black,"rotate("+(p?90:o?180:0)+"deg)",a.components.button.sizes.sm.paddingX,m.polished.rem(4),r?"clip":"ellipsis",.875,a.colors.white)},n.state={renderRightContentTool:!1},n}return $(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this)},t.prototype.componentDidUpdate=function(t){e.prototype.componentDidUpdate.call(this,t)},t.prototype.render=function(){var e,t,o,i=this,a=this.props,r=a.itemJson,l=a.renderRightContent,s=a.editable,c=a.theme,d=r.icon,u=r.isActive;o=d&&d.svg?d:{svg:d};var p=null===(t=null===(e=Object(m.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.theme;return Object(m.jsx)("div",{className:"d-flex "+(u?"active":""),css:this.getStyle()},Object(m.jsx)("div",{className:"d-flex w-100 h-100",onDoubleClick:this.handleDoubleClickItem,onClick:this.handleClick},Object(m.jsx)("div",{className:"d-flex justify-content-between w-100 toc-item"},Object(m.jsx)("div",{className:"d-flex toc-item-content w-100",onMouseEnter:function(e){return setTimeout((function(){i.setState({renderRightContentTool:!0})}),100)}},Object(m.jsx)(h.Button,{className:"toc-arrow",icon:!0,type:"tertiary",onClick:this.handleArrowClick},Object(m.jsx)(h.Icon,{className:"toc-arrow-icon",icon:n(18),size:8})),Object(m.jsx)("div",{className:"left-and-right d-flex justify-content-between w-100"},Object(m.jsx)("div",{className:"d-flex left-content "+(l?"pr-0":"pr-2")},d&&Object(m.jsx)(h.Icon,{autoFlip:r.needFlip,className:"header-icon",color:o.properties&&m.themeUtils.color(o.properties.color,p)||c.colors.palette.dark[600],size:12,icon:o.svg}),Object(m.jsx)("div",{title:r.label,className:"item-label editor",ref:this.editor,onBlur:this.onRenameBlur,contentEditable:r.allowEditable&&s,suppressContentEditableWarning:!0},r.label)),this.state.renderRightContentTool&&l&&l(r))))))},t}(O),ie=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ae=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},re=function(e){function t(t){var n=e.call(this,t)||this;return n.handleChange=function(e){n.setState({searchText:e},(function(){var t=n.props.onSearchTextChange;t&&t(e)}))},n.handleSubmit=function(e){var t=n.props.onSubmit;t&&t(e)},n.onKeyUp=function(e){e&&e.target&&13===e.keyCode&&n.handleSubmit(e.target.value)},n.handleClear=function(e){n.setState({searchText:""}),e.stopPropagation()},n.getStyle=function(){var e=n.props.hideSearchIcon;return Object(m.css)(ne||(ne=ae(["\n      position: relative;\n      .toc-search-input {\n        cursor: pointer;\n        padding-left: ",";\n      }\n    "],["\n      position: relative;\n      .toc-search-input {\n        cursor: pointer;\n        padding-left: ",";\n      }\n    "])),e?"3px":"24px")},n.state={searchText:t.searchText||""},n}return ie(t,e),t.prototype.componentDidUpdate=function(e){if(this.props.searchText!==e.searchText&&this.props.searchText!==this.state.searchText){var t=this.props.searchText;this.setState({searchText:t})}},t.prototype.render=function(){var e=this,t=this.props,o=t.placeholder,i=t.className,a=t.showClear,r=t.hideSearchIcon,l=t.inputRef,s=t.onFocus,c=t.onBlur,d=this.state.searchText;return Object(m.jsx)("div",{css:this.getStyle(),className:i},!r&&Object(m.jsx)(h.Button,{type:"tertiary",icon:!0,size:"sm",onClick:function(t){return e.handleSubmit(e.state.searchText)}},Object(m.jsx)(h.Icon,{size:12,icon:n(17)})),Object(m.jsx)(h.TextInput,{className:"toc-search-input",ref:l,placeholder:o,onChange:function(t){return e.handleChange(t.target.value)},onBlur:c,onFocus:s,value:d,onKeyDown:function(t){return e.onKeyUp(t)}}),a&&Object(m.jsx)(h.Button,{color:"tertiary",icon:!0,size:"sm",onClick:this.handleSubmit},Object(m.jsx)(h.Icon,{size:12,icon:n(16)})))},t}(m.React.PureComponent);function le(e,t){var n=e.id;return t===f.Widget||t===f.Section||t===f.ScreenGroup?n=e.layoutId+wt+e.layoutItemId+wt+e.id:t!==f.View&&t!==f.Screen&&t!==f.ScreenMainStage&&t!==f.ScreenSrollingPanel||(n=e.layoutId+wt+e.layoutItemId+wt+(e.sectionId||e.screenGroupId)+wt+e.id,t!==f.ScreenMainStage&&t!==f.ScreenSrollingPanel||(n=n+wt+t)),n}function se(e){var t,n=null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.split(wt);return!n||n.length<2?null:{layoutId:n[0],layoutItemId:n[1]}}function ce(e){var t=se(e);t&&b.fixedLayoutActions.alignFullSize(t)}function de(e,t){var n=Object.assign({},w,m.defaultMessages,I.defaultMessages,h.defaultMessages);return e.formatMessage({id:t,defaultMessage:n[t]})}var ue,pe,ge,fe,me=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function ve(e,t){var n=e.theme,o=t.showSearch;return Object(m.css)(fe||(fe=me(["\n    height: 100%;\n    padding-bottom: 10px;\n    position: relative;\n    .toc-dropzone {\n      position: absolute;\n      pointer-events: none;\n    }\n    .outline-list-top {\n      height: ","px;\n      padding: 10px ","px;\n      padding-top: 0;\n      .outline-title {\n        user-select: none;\n        color: ",";\n        font-weight: ",";\n      }\n      .outline-top-btns {\n        margin-right: -",";\n        // .btn:hover {\n        //   svg {\n        //     color: ",";\n        //   }\n        // }\n      }\n      .toc-search-input {\n        margin-top: calc(12px - ",");\n      }\n    }\n    .outline-tree-container {\n      color: ",";\n      height: calc(100% - ","px);\n      overflow-y: auto;\n      .outline-tree {\n        >div {\n          overflow: hidden;\n          >div {\n            overflow-x: auto;\n            >.collapse {\n              min-width: fit-content;\n            }\n          }\n        }\n        .tree-item-common {\n          padding-left: ","px;\n          .tree-arrow {\n            display: none;\n          }\n        }\n        .outline-title-item {\n          margin-top: ",";\n          .tree-item-common {\n            .left-content {\n              font-weight: ",";\n              color: ",";\n            }\n          }\n          .tree-item-common:hover {\n            background-color:",";\n          }\n        }\n        .toc-item-dropzone {\n          .toc-item {\n            padding-left: ",";\n          }\n        }\n      }\n    }\n\n  "],["\n    height: 100%;\n    padding-bottom: 10px;\n    position: relative;\n    .toc-dropzone {\n      position: absolute;\n      pointer-events: none;\n    }\n    .outline-list-top {\n      height: ","px;\n      padding: 10px ","px;\n      padding-top: 0;\n      .outline-title {\n        user-select: none;\n        color: ",";\n        font-weight: ",";\n      }\n      .outline-top-btns {\n        margin-right: -",";\n        // .btn:hover {\n        //   svg {\n        //     color: ",";\n        //   }\n        // }\n      }\n      .toc-search-input {\n        margin-top: calc(12px - ",");\n      }\n    }\n    .outline-tree-container {\n      color: ",";\n      height: calc(100% - ","px);\n      overflow-y: auto;\n      .outline-tree {\n        >div {\n          overflow: hidden;\n          >div {\n            overflow-x: auto;\n            >.collapse {\n              min-width: fit-content;\n            }\n          }\n        }\n        .tree-item-common {\n          padding-left: ","px;\n          .tree-arrow {\n            display: none;\n          }\n        }\n        .outline-title-item {\n          margin-top: ",";\n          .tree-item-common {\n            .left-content {\n              font-weight: ",";\n              color: ",";\n            }\n          }\n          .tree-item-common:hover {\n            background-color:",";\n          }\n        }\n        .toc-item-dropzone {\n          .toc-item {\n            padding-left: ",";\n          }\n        }\n      }\n    }\n\n  "])),o?82:44,16,n.colors.palette.dark[600],n.typography.weights.extraBold,n.components.button.sizes.sm.paddingX,n.colors.black,n.components.button.sizes.sm.paddingY,n.colors.palette.dark[600],o?82:44,16,m.polished.rem(6),n.typography.weights.extraBold,n.colors.palette.dark[600],m.polished.rgba(n.colors.palette.light[400],.6),m.polished.rem(4))}var he=n(44),be=function(){return(be=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ye(e,t,n){var o,i=null===(o=null==t?void 0:t.layouts)||void 0===o?void 0:o[e];he(i,"rootLayout must exist");for(var a={},r={},l={},s=[{layoutId:e}],c=function(e){var o,i,c,d,u,p=null!==(c=null===(i=null===(o=null==t?void 0:t.layouts)||void 0===o?void 0:o[e.layoutId])||void 0===i?void 0:i.content)&&void 0!==c?c:{},g=be(be({},e),{embedLayouts:[]}),f=function(o){var i=p[o];if(i.type===m.LayoutItemType.Widget&&i.widgetId){var a=null===(d=null==t?void 0:t.widgets)||void 0===d?void 0:d[i.widgetId];if(a){var c={id:i.widgetId,type:m.LayoutItemType.Widget,itemIdInParent:o,containerLayoutId:e.layoutId};if(a.layouts)for(var f in c.embedLayouts=[],a.layouts){var v=a.layouts[f][n];c.embedLayouts.push(v),g.embedLayouts.push(v),s.push({layoutId:v,parentLayoutId:e.layoutId,itemIdInParent:o,parentType:m.LayoutItemType.Widget,containerWidgetId:i.widgetId})}r[i.widgetId]=c}}else if(i.type===m.LayoutItemType.Section&&i.sectionId){var h=null===(u=null==t?void 0:t.sections)||void 0===u?void 0:u[i.sectionId];if(h){var b={id:i.sectionId,type:m.LayoutItemType.Section,itemIdInParent:o,containerLayoutId:e.layoutId,embedLayouts:[]};h.views.forEach((function(a){var r,l,c=null===(r=null==t?void 0:t.views)||void 0===r?void 0:r[a],d=null===(l=null==c?void 0:c.layout)||void 0===l?void 0:l[n];b.embedLayouts.push(d),g.embedLayouts.push(d),s.push({layoutId:d,parentLayoutId:e.layoutId,parentType:m.LayoutItemType.Section,itemIdInParent:o,containerViewId:a,containerSectionId:i.sectionId})})),l[i.sectionId]=b}}};for(var v in p)f(v);a[e.layoutId]=g};s.length>0;){c(s.pop())}return{layouts:a,widgets:r,sections:l}}function Ie(e,t,n){for(var o=t,i=e.layouts[o.parentLayoutId];null==i?void 0:i.parentLayoutId;){if(i.layoutId===n||i.embedLayouts.indexOf(n)>=0)return o;o=i,i=e.layouts[o.parentLayoutId]}return o}function we(e,t,n,o){var i=e.layoutId,a=ye(n,t,o).layouts[i];return(null==a?void 0:a.parentLayoutId)?{layoutId:a.parentLayoutId,layoutItemId:a.itemIdInParent}:null}function xe(e,t){var n,o,i;if(!t)return null;var a=t.layoutId,r=t.layoutItemId;return null===(i=null===(o=null===(n=e.layouts)||void 0===n?void 0:n[a])||void 0===o?void 0:o.content)||void 0===i?void 0:i[r]}function je(e,t){if(e.sections)for(var n in e.sections){if(e.sections[n].views.indexOf(t)>=0)return n}return null}function Oe(e,t){if(e.views)for(var n in e.views){var o=e.views[n];for(var i in o.layout)if(o.layout[i]==t)return n}return null}function Se(e){switch(e.type){case m.LayoutItemType.Widget:return"string"==typeof e.widgetId?e.widgetId:null;case m.LayoutItemType.Section:return"string"==typeof e.sectionId?e.sectionId:null;case m.LayoutItemType.ScreenGroup:return"string"==typeof e.screenGroupId?e.screenGroupId:null;default:return null}}function Ce(e,t,n){return void 0===n&&(n=!1),(null==e?void 0:e.content)?Object.keys(e.content).filter((function(o){return e.content[o].type===t&&!!Se(e.content[o])&&(n||!e.content[o].isPending)})).map((function(t){return Se(e.content[t])})):[]}function Pe(e,t,n,o,i){void 0===i&&(i=!1);var a=[],r=Ce(e.layouts[t],m.LayoutItemType.Widget,i),l=Ce(e.layouts[t],m.LayoutItemType.Section,i),s=Ce(e.layouts[t],m.LayoutItemType.ScreenGroup,i);return n===m.LayoutItemType.Widget?a=a.concat(r):n===m.LayoutItemType.Section?a=a.concat(l):n===m.LayoutItemType.ScreenGroup&&(a=a.concat(s)),r.filter((function(t){var n,o,i,a,r;return(null===(o=null===(n=e.widgets[t])||void 0===n?void 0:n.manifest)||void 0===o?void 0:o.widgetType)===m.WidgetType.Layout||(null===(r=null===(a=null===(i=e.widgets[t])||void 0===i?void 0:i.manifest)||void 0===a?void 0:a.properties)||void 0===r?void 0:r.hasEmbeddedLayout)})).forEach((function(t){var r;Object.keys(null!==(r=e.widgets[t].layouts)&&void 0!==r?r:{}).forEach((function(r){var l=e.widgets[t].layouts[r][o];a=a.concat(Pe(e,l,n,o,i))}))})),l.forEach((function(t){var r,l;null===(l=null===(r=e.sections)||void 0===r?void 0:r[t])||void 0===l||l.views.forEach((function(t){e.views[t]&&e.views[t].layout[o]&&(a=a.concat(Pe(e,e.views[t].layout[o],n,o,i)))}))})),s.forEach((function(t){var r,l;null===(l=null===(r=e.screenGroups)||void 0===r?void 0:r[t])||void 0===l||l.screens.forEach((function(t){var r,l,s,c,d,u,p;(null===(s=null===(l=null===(r=e.screens)||void 0===r?void 0:r[t])||void 0===l?void 0:l.main.layout)||void 0===s?void 0:s[o])&&(a=a.concat(Pe(e,e.screens[t].main.layout[o],n,o,i))),(null===(p=null===(u=null===(d=null===(c=e.screens)||void 0===c?void 0:c[t])||void 0===d?void 0:d.panel)||void 0===u?void 0:u.layout)||void 0===p?void 0:p[o])&&(a=a.concat(Pe(e,e.screens[t].panel.layout[o],n,o,i)))}))})),a}function Te(e,t,n,o,i){void 0===i&&(i=!1);var a=[],r=Ce(e.layouts[t],m.LayoutItemType.Widget,i),l=Ce(e.layouts[t],m.LayoutItemType.Section,i),s=Ce(e.layouts[t],m.LayoutItemType.ScreenGroup,i);return a=n===m.LayoutItemType.Widget?a.concat(r):n===m.LayoutItemType.ScreenGroup?a.concat(s):a.concat(l),r.filter((function(t){return e.widgets&&e.widgets[t]&&e.widgets[t].manifest.widgetType===m.WidgetType.Layout})).forEach((function(t){Object.keys(e.widgets[t].layouts).forEach((function(r){var l=Fe(e.widgets[t].layouts[r],o,e.mainSizeMode);a=a.concat(Te(e,l,n,o,i))}))})),a}function De(e,t,n){if(!(null==e?void 0:e.content))return null;var o=Object.keys(e.content).find((function(o){return e.content[o].type===n&&(e.content[o].widgetId===t||e.content[o].sectionId===t||e.content[o].screenGroupId===t)&&!e.content[o].isPending}));return e.content[o]}function ke(e,t,n){void 0===n&&(n=!1);var o=e.layouts[t];return(null==o?void 0:o.content)?n?Object.keys(o.content):Object.keys(o.content).filter((function(e){return!o.content[e].isPending})):[]}function Ae(e,t,n){return void 0===n&&(n=!1),(null==e?void 0:e.content)?Object.keys(e.content).filter((function(o){return e.content[o].type===t&&!!Se(e.content[o])&&(n||!e.content[o].isPending)})).map((function(t){return{layoutId:e.id,layoutItemId:t}})):[]}function Me(e,t){return Object.keys(e.widgets).find((function(n){var o=e.widgets[n];if(o.layouts)return Object.keys(o.layouts).some((function(e){return void 0!==Object.keys(o.layouts[e]).find((function(n){return o.layouts[e][n]===t}))}))}))}function ze(e,t,n,o){var i=e.pages&&Object.keys(e.pages).find((function(i){var a=Fe(e.pages[i].layout,o,e.mainSizeMode);return Te(e,a,n,o).indexOf(t)>-1}));if(i)return{type:m.ContainerType.Page,id:i};var a=e.dialogs&&Object.keys(e.dialogs).find((function(i){var a=Fe(e.dialogs[i].layout,o,e.mainSizeMode);return Te(e,a,n,o).indexOf(t)>-1}));if(a)return{type:m.ContainerType.Dialog,id:a};if(e.header){var r=Fe(e.header.layout,o,e.mainSizeMode);if(Te(e,r,n,o).indexOf(t)>-1)return{type:m.ContainerType.Header,id:"header"}}if(e.footer){r=Fe(e.footer.layout,o,e.mainSizeMode);if(Te(e,r,n,o).indexOf(t)>-1)return{type:m.ContainerType.Footer,id:"footer"}}var l=e.views&&Object.keys(e.views).find((function(i){var a=Fe(e.views[i].layout,o,e.mainSizeMode);return Te(e,a,n,o).indexOf(t)>-1}));if(l)return{type:m.ContainerType.View,id:l};if(e.screens){var s=Object.keys(e.screens).find((function(i){var a=Fe(e.screens[i].main.layout,o,e.mainSizeMode);return Te(e,a,n,o).indexOf(t)>-1}));if(s)return{type:m.ContainerType.ScreenMain,id:s};var c=Object.keys(e.screens).find((function(i){var a,r=Fe(null===(a=e.screens[i].panel)||void 0===a?void 0:a.layout,o,e.mainSizeMode);return Te(e,r,n,o).indexOf(t)>-1}));if(c)return{type:m.ContainerType.ScreenPanel,id:c}}}function Le(e,t,n,o){return Te(e,Fe(e.pages[t].layout,o,e.mainSizeMode),n,o)}function Be(e,t,n,o){var i,a=Te(e,Fe(e.screens[t].main.layout,o,e.mainSizeMode),n,o);if(e.screens[t].panel){var r=Te(e,Fe(null===(i=e.screens[t].panel)||void 0===i?void 0:i.layout,o,e.mainSizeMode),n,o);return a.concat(r)}return a}function Re(e,t,n,o){var i;return Te(e,Fe(null===(i=e.views[t])||void 0===i?void 0:i.layout,o,e.mainSizeMode),n,o)}function Ee(e,t,n){return Te(e,Fe(e.header.layout,n,e.mainSizeMode),t,n)}function Ne(e,t,n){return Te(e,Fe(e.footer.layout,n,e.mainSizeMode),t,n)}function Fe(e,t,n){return e?e[t]||e[n]:null}function Je(e,t,n,o){if(o){var i=He(e,n,t,o);if(i)return qe(e,n,t,i,o);var a=ze(e,n,t,o);if(!a)return[];var r=function(e,t,n){var o;return t.type===m.ContainerType.Footer?e.footer.layout[n]:t.type===m.ContainerType.Header?e.header.layout[n]:t.type===m.ContainerType.ScreenMain?e.screens[t.id].main.layout[n]:t.type===m.ContainerType.ScreenPanel?null===(o=e.screens[t.id].panel)||void 0===o?void 0:o.layout[n]:e[t.type][t.id].layout[n]}(e,a,o);return[{layoutId:r,layoutItemId:De(e.layouts[r],n,t).id}]}var l=[];return Object.keys(e.layouts).forEach((function(o){ke(e,o,!0).forEach((function(i){var a=e.layouts[o].content[i];t!==a.type||a.widgetId!==n&&a.sectionId!==n&&a.screenGroupId!==n||l.push({layoutId:o,layoutItemId:i})}))})),l}function He(e,t,n,o){return Object.keys(e.widgets).find((function(i){var a=e.widgets[i];if(a.layouts)return Object.keys(a.layouts).some((function(i){var r=a.layouts[i][o],l=e.layouts[r];return l&&l.content&&void 0!==Object.keys(l.content).find((function(e){return l.content[e].type===n&&(l.content[e].widgetId===t||l.content[e].sectionId===t)}))}))}))}function _e(e,t,n,o){var i=e.widgets[t];if(!i.layouts)return[];var a=[];return Object.keys(i.layouts).forEach((function(t){Object.keys(i.layouts[t]).forEach((function(r){var l=e.layouts[i.layouts[t][r]];a=a.concat(Ce(l,n,o))}))})),Array.from(new Set(a))}function Ve(e,t,n,o){var i=[],a=!1,r=function(e,t,n,r){var l=Fe(n,o,void 0),s=De(e.layouts[l],t,r),c=void 0;return s&&(c={layoutId:l,layoutItemId:s.id},i.push(c),a=!0),c};return e.pages&&Object.keys(e.pages).find((function(o){var i=e.pages[o];return!(!i.layout||!r(e,t,i.layout,n))})),a?i:(e.views&&Object.keys(e.views).find((function(o){var i=e.views[o];return!!r(e,t,i.layout,n)})),a?i:(e.dialogs&&Object.keys(e.dialogs).find((function(o){var i=e.dialogs[o];return!!r(e,t,i.layout,n)})),a?i:(e.header&&r(e,t,e.header.layout,n),a?i:(e.footer&&r(e,t,e.footer.layout,n),a||e.widgets&&Object.keys(e.widgets).find((function(o){var i=e.widgets[o];return i.layouts&&Object.keys(i.layouts).forEach((function(o){r(e,t,i.layouts[o],n)})),!!a})),i))))}function Ue(e,t,n){var o=e.widgets[n];if(o){var i=void 0;return Object.keys(o.layouts).find((function(e){if(Object.keys(o.layouts[e]).find((function(n){if(o.layouts[e][n]===t)return i=n,!0})))return!0})),i}}function We(e,t){var n,o,i=null,a=function(e){return e?Object.keys(e).find((function(n){return e[n]===t})):null};return Object.keys(e.widgets||{}).some((function(t){return Object.keys(e.widgets[t].layouts||{}).some((function(n){if(i)return!0;i=a(e.widgets[t].layouts[n])}))})),i||(Object.keys(e.views||{}).some((function(t){if(i)return!0;i=a(e.views[t].layout)})),i||(Object.keys(e.pages||{}).some((function(t){if(i)return!0;i=a(e.pages[t].layout)})),i||(Object.keys(e.dialogs||{}).some((function(t){if(i)return!0;i=a(e.dialogs[t].layout)})),i||(Object.keys(e.screens||{}).some((function(t){var n,o;return!!i||(!!(i=a(null===(n=e.screens[t].main)||void 0===n?void 0:n.layout))||void(i=a(null===(o=e.screens[t].panel)||void 0===o?void 0:o.layout)))})),i||((i=a(null===(n=e.header)||void 0===n?void 0:n.layout))?i:(i=a(null===(o=e.footer)||void 0===o?void 0:o.layout))||null)))))}function Ge(e,t,n,o){if(!e.widgets[n])return[];var i=e.layouts[t.layoutId]&&e.layouts[t.layoutId].content&&e.layouts[t.layoutId].content[t.layoutItemId];if(!i)return[];var a=i.type,r=void 0;return a===m.LayoutItemType.Section?r=i.sectionId:a===m.LayoutItemType.Widget&&(r=i.widgetId),r?qe(e,r,a,n,o):function(e,t,n){var o=e.widgets[t];if(!o)return!1;var i=!1;return o.layouts&&Object.keys(o.layouts).forEach((function(t){i||Object.keys(o.layouts[t]).forEach((function(a){if(!i){var r=o.layouts[t][a];ke(e,r,!0).forEach((function(e){i||n.layoutId===r&&n.layoutItemId===e&&(i=!0)}))}}))})),i}(e,n,t)?[t]:[]}function Ze(e,t,n,o){return Ge(e,t,n,o).map((function(t){return e.layouts[t.layoutId][t.layoutItemId]}))}function qe(e,t,n,o,i){var a=e.widgets[o];if(!a||!t)return[];var r=[];return a.layouts&&Object.keys(a.layouts).forEach((function(o){var l=a.layouts[o][i],s=e.layouts[l];s&&s.content&&Object.keys(s.content).forEach((function(o){var a=s.content[o];if(a.type!==n||a.widgetId!==t&&a.sectionId!==t&&a.screenGroupId!==t){if(a.type===m.LayoutItemType.Widget){var l=e.widgets[a.widgetId];l&&l.manifest.widgetType===m.WidgetType.Layout&&r.push.apply(r,qe(e,t,n,l.id,i))}}else r.push({layoutId:s.id,layoutItemId:a.id})}))})),r}function Xe(e,t,n,o,i){var a=ze(e,t,n,i);if(!a)return[];switch(a.type){case m.ContainerType.Page:return Le(e,a.id,o,i);case m.ContainerType.Header:return Ee(e,o,i);case m.ContainerType.Footer:return Ne(e,o,i);case m.ContainerType.View:return Re(e,a.id,o,i);case m.ContainerType.Dialog:return function(e,t,n,o){return Te(e,Fe(e.dialogs[t].layout,o,e.mainSizeMode),n,o)}(e,a.id,o,i);case m.ContainerType.ScreenMain:case m.ContainerType.ScreenPanel:return Be(e,a.id,o,i)}}function Ye(e,t){var n,o=e.appConfig.sections[t];if(!o||!o.views)return null;var i,a=null===(n=e.appRuntimeInfo.sectionNavInfos)||void 0===n?void 0:n[o.id];if(!a){var r=o.views[0];i=e.appConfig.views[r]}return{sectionId:t,navInfo:a,activeView:i,views:o.views,sectionStyle:o.style,transition:o.transition,autoPlay:o.autoPlay,interval:o.interval,loop:o.loop}}function Ke(e,t,n,o){var i=e.pages[t];return i?o===m.PagePart.Header?i.header&&e.header?tt(e,e.header.layout[n],n):[]:o===m.PagePart.Footer?i.footer&&e.footer?tt(e,e.footer.layout[n],n):[]:o===m.PagePart.Body?tt(e,i.layout[n],n):[]:[]}function Qe(e,t,n,o){var i=e.pages[t];return i?o===m.PagePart.Header?i.header&&e.header?nt(e,e.header.layout,n):[]:o===m.PagePart.Footer?i.footer&&e.footer?nt(e,e.footer.layout,n):[]:o===m.PagePart.Body?nt(e,i.layout,n):[]:[]}function $e(e,t,n){var o=e.dialogs[t];return o?tt(e,o.layout[n],n):[]}function et(e,t,n){var o=e.dialogs[t];return o?nt(e,o.layout,n):[]}function tt(e,t,n){var o=[];return Ae(e.layouts[t],m.LayoutItemType.Widget,!0).forEach((function(t){var i=e.layouts[t.layoutId].content[t.layoutItemId];i.isPending?o.push(t):e.widgets[i.widgetId].layouts&&Object.keys(e.widgets[i.widgetId].layouts).forEach((function(t){o=o.concat(tt(e,e.widgets[i.widgetId].layouts[t][n],n))}))})),Ae(e.layouts[t],m.LayoutItemType.Section,!0).forEach((function(t){var i=e.layouts[t.layoutId].content[t.layoutItemId];i.isPending?o.push(t):e.sections[i.sectionId].views&&e.sections[i.sectionId].views.forEach((function(t){o=o.concat(tt(e,e.views[t].layout[n],n))}))})),Ae(e.layouts[t],m.LayoutItemType.ScreenGroup,!0).forEach((function(t){var i,a,r=e.layouts[t.layoutId].content[t.layoutItemId].screenGroupId;null===(a=null===(i=e.screenGroups)||void 0===i?void 0:i[r].screens)||void 0===a||a.forEach((function(t){var i=null==e?void 0:e.screens[t];i.main&&(o=o.concat(tt(e,i.main.layout[n],n))),i.panel&&(o=o.concat(tt(e,i.panel.layout[n],n)))}))})),o}function nt(e,t,n,o,i){void 0===o&&(o=null),void 0===i&&(i=null);var a=[];return o||(o=Pe(e,t[n],m.LayoutItemType.Widget,n,!0)),i||(i=Pe(e,t[n],m.LayoutItemType.Section,n,!0)),Object.keys(m.BrowserSizeMode).filter((function(e){return m.BrowserSizeMode[e]!==n})).map((function(e){return m.BrowserSizeMode[e]})).forEach((function(r){Ae(e.layouts[t[r]],m.LayoutItemType.Widget,!0).forEach((function(t){var r=e.layouts[t.layoutId].content[t.layoutItemId];e.widgets[r.widgetId].manifest.widgetType!==m.WidgetType.Layout&&o.indexOf(r.widgetId)<0?!ot(e,a,t)&&a.push(t):e.widgets[r.widgetId].layouts&&Object.keys(e.widgets[r.widgetId].layouts).forEach((function(t){nt(e,e.widgets[r.widgetId].layouts[t],n,o,i).forEach((function(t){!ot(e,a,t)&&a.push(t)}))}))})),Ae(e.layouts[t[r]],m.LayoutItemType.Section,!0).forEach((function(t){var r=e.layouts[t.layoutId].content[t.layoutItemId];i.indexOf(r.sectionId)<0?!ot(e,a,t)&&a.push(t):e.sections[r.sectionId].views&&e.sections[r.sectionId].views.forEach((function(t){nt(e,e.views[t].layout,n,o,i).forEach((function(t){!ot(e,a,t)&&a.push(t)}))}))})),Ae(e.layouts[t[r]],m.LayoutItemType.ScreenGroup,!0).forEach((function(t){var r,l,s=e.layouts[t.layoutId].content[t.layoutItemId];(null===(l=null===(r=e.screenGroups)||void 0===r?void 0:r[s.screenGroupId])||void 0===l?void 0:l.screens)&&e.screenGroups[s.screenGroupId].screens.forEach((function(t){var r,l=null===(r=e.screens)||void 0===r?void 0:r[t];(null==l?void 0:l.main)&&nt(e,l.main.layout,n,o,i).forEach((function(t){!ot(e,a,t)&&a.push(t)})),(null==l?void 0:l.panel)&&nt(e,l.panel.layout,n,o,i).forEach((function(t){!ot(e,a,t)&&a.push(t)}))}))}))})),a}function ot(e,t,n){var o=e.layouts[n.layoutId].content[n.layoutItemId];return!!t.find((function(t){var n=e.layouts[t.layoutId].content[t.layoutItemId];return n.type===o.type&&(n.type===m.LayoutItemType.Widget&&n.widgetId===o.widgetId||n.type===m.LayoutItemType.Section&&n.sectionId===o.sectionId)}))}var it,at=function(){return(at=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},rt=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},lt=n(31);function st(e,t,o,i){var a,r,l=void 0,s=t.appConfig,c=e.id,d=e.layoutId,u=e.layoutItemId,p=e.type,g=e.sectionId,v=e.screenGroupId,h=rt(e,["id","layoutId","layoutItemId","type","sectionId","screenGroupId"]);p===f.Widget?l=s.widgets[c]:p===f.Section?l=s.sections[c]:p===f.View?l=s.views[c]:p===f.ScreenGroup?l=s.screenGroups[c]:p!==f.Screen&&p!==f.ScreenMainStage&&p!==f.ScreenSrollingPanel||(l=s.screens[c]);var b=o.currentSelectedItemId,y={layoutId:d,layoutItemId:u,id:c};p===f.View&&(y.sectionId=g),p!==f.Screen&&p!==f.ScreenMainStage&&p!==f.ScreenSrollingPanel||(y.screenGroupId=v);var I=le(y,p),w=it.expandIds,x=it.renderOutlineContent,j=w.indexOf(I)>-1,O=function(e,t){var n;n=e===m.PagePart.Header?t.allowEditableForHeader:e===m.PagePart.Footer?t.allowEditableForFooter:e!==m.PagePart.Body||t.allowEditable;return n}(e.pagePart,t),S=at({id:I,data:l,label:null!=i?i:l.label,type:p,allowEditable:O,isExpand:j,isActive:b===I,renderItem:x},h);if(S.icon=l.icon,"string"==typeof l.icon){var C=null===(a=null==s?void 0:s.layouts)||void 0===a?void 0:a[e.layoutId];if((null==C?void 0:C.type)===m.LayoutType.FlowLayout){var P=null===(r=null==C?void 0:C.content)||void 0===r?void 0:r[e.layoutItemId];(null==P?void 0:P.widgetId)&&(S.icon=lt)}}return S.icon||(p===f.Widget?S.icon={svg:n(100)}:p===f.Section?S.icon={svg:n(101)}:p===f.View?S.icon={svg:n(102)}:p===f.ScreenGroup?S.icon={svg:n(32)}:p===f.Screen&&(S.icon={svg:n(103)})),S}function ct(e,t,n){var o=t.appConfig,i=e.level,a=e.pagePart,r=e.layoutId,l=e.layoutItemId,s=e.id,c=st(e,t,n),d=o.sections[e.id];return d.views&&(c.children=d.views.asMutable().map((function(e,o){return function(e,t,n){var o=st(e,t,n),i=ft(m.ContainerType.View,e.id,t),a=i.widgets,r=i.sections;return o.children=mt(r,a,o.level+1,o.pagePart,t,n),o}({id:e,sectionId:s,layoutId:r,layoutItemId:l,index:o,level:i+1,pagePart:a,type:f.View},t,n)}))),c}function dt(e,t,n){var o=t.appConfig,i=e.level,a=e.pagePart,r=e.layoutId,l=e.layoutItemId,s=e.id,c=st(e,t,n),d=o.screenGroups[e.id];return d.screens&&(c.children=d.screens.asMutable().map((function(e,o){return function(e,t,n){var o=st(e,t,n);e.level=o.level+1,e.type=f.ScreenMainStage;var i=st(e,t,n,de(t.intl,"mainStage"));e.type=f.ScreenSrollingPanel;var a=st(e,t,n,de(t.intl,"scrollingPanel")),r=ft("screens",e.id,t,["main","layout"]),l=r.widgets,s=r.sections,c=ft("screens",e.id,t,["panel","layout"]),d=c.widgets,u=c.sections;return i.children=mt(s,l,o.level+2,o.pagePart,t,n),a.children=mt(u,d,o.level+2,o.pagePart,t,n),i.allowEditable=!1,a.allowEditable=!1,o.children=[i,a],o}({id:e,screenGroupId:s,layoutId:r,layoutItemId:l,index:o,level:i+1,pagePart:a,type:f.Screen},t,n)}))),c}function ut(e,t,i,a,r,l){var s,c=r.appConfig,d=r.browserSizeMode,u=o.findLayoutId(e,d,c.mainSizeMode);if(u){var p=null===(s=null==c?void 0:c.layouts)||void 0===s?void 0:s[u],g=l.currentSelectedItemId,v=it.expandIds,h=it.renderOutlineContent,b=v.indexOf(u)>-1,y={id:u,label:p.label,index:t,level:i,pagePart:a,icon:n(104),type:f.Layout,isExpand:b,isActive:g===u,renderItem:h},I=gt(m.LayoutItemType.Widget,c.layouts[u])||[],w=gt(m.LayoutItemType.Section,c.layouts[u])||[];return y.children=mt(w,I,y.level+1,a,r,l),y}}function pt(e,t,n){var o,i,a,r,l=t.appConfig,s=st(e,t,n);s.needFlip=null===(a=null===(i=null===(o=null==s?void 0:s.data)||void 0===o?void 0:o.manifest)||void 0===i?void 0:i.properties)||void 0===a?void 0:a.flipIcon;var c=l.widgets[e.id];if(c.layouts){var d=Object.keys(c.layouts).filter((function(e){return 0!==e.indexOf("_")}));if(1===d.length){var u=c.layouts[Object.keys(c.layouts)[0]];s.children=null===(r=ut(u,0,s.level,s.pagePart,t,n))||void 0===r?void 0:r.children}else s.children=[],d.forEach((function(e,o){var i=ut(c.layouts[e],o,s.level+1,s.pagePart,t,n);i&&s.children.push(i)}))}return s}function gt(e,t){var n;return e===m.LayoutItemType.Widget?n="widgetId":e===m.LayoutItemType.Section?n="sectionId":e===m.LayoutItemType.ScreenGroup&&(n="screenGroupId"),t&&t.content&&t.order?t.order.asMutable().filter((function(o){return t.content[o].type===e&&t.content[o][n]&&!t.content[o].isPending})).map((function(e){return{id:t.content[e][n],layoutId:t.id,layoutItemId:e}})):[]}function ft(e,t,n,i){var a,r=[],l=[],s=[],c=n.appConfig,d=n.browserSizeMode;if(e===m.ContainerType.Header||e===m.ContainerType.Footer){if(c[e]){var u=o.findLayoutId(c[e].layout,d,c.mainSizeMode);r=gt(m.LayoutItemType.Widget,c.layouts[u])||[],l=gt(m.LayoutItemType.Section,c.layouts[u])||[]}}else if(c[e]&&c[e][t]){var p=c[e][t];u=o.findLayoutId(i?null===(a=p[i[0]])||void 0===a?void 0:a[i[1]]:p.layout,d,c.mainSizeMode);r=gt(m.LayoutItemType.Widget,c.layouts[u])||[],l=gt(m.LayoutItemType.Section,c.layouts[u])||[],s=gt(m.LayoutItemType.ScreenGroup,c.layouts[u])||[]}return{widgets:r,sections:l,screens:s}}function mt(e,t,n,o,i,a){var r=[];return r.push.apply(r,e.map((function(e,t){return e.index=t,e.level=n,e.pagePart=o,e.type=f.Section,ct(e,i,a)}))),r.push.apply(r,t.map((function(e,t){return e.index=t,e.level=n,e.pagePart=o,e.type=f.Widget,pt(e,i,a)}))),r}function vt(e,t,n,o,i,a,r){var l,s=[];if(e.length){var c=[];if(n.length){var d=null===(l=n[0]||e[0])||void 0===l?void 0:l.layoutId,u=a.appConfig.layouts[d].order.asMutable(),p={};n.map((function(e){e.type=f.Widget,p[e.layoutItemId]=e})),e.map((function(e){p[e.layoutItemId]=e})),u.map((function(e){p[e]&&c.push(p[e])}))}else c=e;s.push.apply(s,c.map((function(e,t){return e.index=t,e.level=o,e.pagePart=i,e.type===f.Widget?pt(e,a,r):(e.type=f.ScreenGroup,dt(e,a,r))})))}else s=mt(t,n,o,i,a,r);return s}var ht,bt,yt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),It=function(){return(It=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},wt="-toc-",xt=[{name:"offset",options:{offset:[0,10]}}],jt=function(e){function t(t){var o=e.call(this,t)||this;return o.singleAndDoubleClickTimeout=void 0,o.handleOnTocDoubleClick=function(e,t){o.singleAndDoubleClickTimeout&&(clearTimeout(o.singleAndDoubleClickTimeout),o.singleAndDoubleClickTimeout=void 0),o.checkIfReadOnly(e)||o.setState({editableItemId:e.id})},o.handleRename=function(e,t){return o.setState({editableItemId:""}),function(e,t){return!(!t||""===t||""===t.replace(/(\r\n|\n|\r)/g,""))&&(e.type===f.Widget?Object(v.getAppConfigAction)().editWidgetProperty(e.data.id,"label",t).exec():e.type===f.Section?Object(v.getAppConfigAction)().editSectionProperty(e.data.id,"label",t).exec():e.type===f.View?Object(v.getAppConfigAction)().editView(e.data.set("label",t)).exec():e.type===f.ScreenGroup?Object(v.getAppConfigAction)().editScreenGroupProperty(e.data.id,"label",t).exec():e.type===f.Screen&&Object(v.getAppConfigAction)().editScreen(e.data.set("label",t)).exec(),!0)}(e,t)},o.checkIfReadOnly=function(e){var t,n,i=e.id.split(wt);return!((e.type===f.ScreenGroup||e.type===f.Section?i[0]===(null===(t=o.props.selection)||void 0===t?void 0:t.layoutId)&&i[1]===(null===(n=o.props.selection)||void 0===n?void 0:n.layoutItemId):o.state.currentSelectedItemId===e.id)&&e.allowEditable&&e.pagePart===o.props.activePagePart)},o.handleClickItem=function(e,t){o.singleAndDoubleClickTimeout&&(clearTimeout(o.singleAndDoubleClickTimeout),o.singleAndDoubleClickTimeout=void 0),e.allowEditable&&(o.singleAndDoubleClickTimeout=setTimeout((function(){if(e.type!==f.Label&&e.type!==f.Layout){var t=o.state,n=t.currentSelectedItemId,i=t.itemJson;n!==e.id?e.type===f.Label||e.type===f.Layout?(o.setState({itemJson:Object.assign({},i)}),o.props.onClickItem(e)):(o.setState({currentSelectedItemId:e.id,itemJson:h.TreeUtils.activeNodesByActiveIds(i,[e.id])}),o.props.onClickItem(e)):o.handleExpand(e)}else o.handleExpand(e)}),200))},o.handleExpand=function(e){var t=o.expandIds;e.isExpand?t.indexOf(e.id)>-1&&t.splice(t.indexOf(e.id),1):t.indexOf(e.id)<0&&t.push(e.id),o.setState({itemJson:h.TreeUtils.expandNodesByExpandIds(o.state.itemJson,t)})},o.handleArrowClick=function(e){o.handleExpand(e)},o.handleSearchTextChange=function(e){o.setState({filterText:e},(function(){o.setState({itemJson:o.getItemJsonByAppConfig()})}))},o.handleSearchSubmit=function(e){o.setState({filterText:e},(function(){o.setState({itemJson:o.getItemJsonByAppConfig()})}))},o.handleSearchBtnClick=function(e){e.stopPropagation(),o.state.showSearch&&o.handleSearchTextChange(""),o.setState({showSearch:!o.state.showSearch})},o.handleSearchOpened=function(){o.searchInput&&(o.searchInput.select(),o.searchInput.focus())},o.formatMessage=function(e){return de(o.props.intl,e)},o.getItemJsonByAppConfig=function(e){return function(e,t,n){var o=[],i=e.intl,a=e.appConfig,r=e.currentPageId,l=e.currentDialogId,s=t.filterText,c=t.currentSelectedItemId,d=de,u=[d(i,"header"),d(i,"footer"),d(i,"body")],p=[m.PagePart.Header,m.PagePart.Footer,m.PagePart.Body],g=(it=n).expandIds,b=it.renderTitleRightContent,y=it.lastPageId,I={id:"ROOT",type:f.Label,children:o,label:""};if(!a)return Object(m.Immutable)(I);if(l){var w=ft(m.ContainerType.Dialog,l,e),x=w.widgets,j=w.sections;I.children=mt(j,x,0,null,e,t)}else for(var O=0;O<3;O++)if((0!==O||e.enableHeader)&&(1!==O||e.enableFooter)){var S=O+"-"+u[O],C=c===S;C&&g.indexOf(S)<0&&g.push(S);var P=g.indexOf(S)>-1,T={label:u[O],pagePart:p[O],id:S,index:O,level:0,mustShowArrow:!0,isActive:C,isExpand:P,type:f.Label,className:"outline-title-item",allowEditable:!0,renderRightContent:b,arrowIcon:function(e){return m.React.createElement("div",null)}},D=void 0,k=void 0,A=!0;if(T.label===d(i,"header")?(D=m.ContainerType.Header,k="header",e.enableHeader||(A=!1)):T.label===d(i,"body")?(D=m.ContainerType.Page,k=r,v.appConfigUtils.isRealPage(a,r)?it.lastPageId=r:k=y):(D=m.ContainerType.Footer,k="footer",e.enableFooter||(A=!1)),A){var M=ft(D,k,e),z=(x=M.widgets,j=M.sections,M.screens);T.children=vt(z,j,x,T.level,T.pagePart,e,t),T.children&&T.children.length>0&&(T.isExpand=!0,g.indexOf(T.id)<0&&g.push(T.id))}o.push(T)}var L=Object(m.Immutable)(I);if(s&&""!==s){var B=h.TreeUtils.filterTree(L,s.trim());L=h.TreeUtils.expandFilteredNodes(B,s.trim()),it.expandIds=h.TreeUtils.fetchAllExpandIds(L),v.builderAppSync.publishChangeSelectionToApp(null)}return L}(null!=e?e:o.props,o.state,o)},o.getAlignmentsDropDownItems=function(e){return[{label:o.formatMessage("snapToLeft"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.alignTo(t,"left")}(e),t.stopPropagation()}},{label:o.formatMessage("alignHCenter"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.alignHorizontalCenter(t)}(e),t.stopPropagation()}},{label:o.formatMessage("snapToRight"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.alignTo(t,"right")}(e),t.stopPropagation()}},{label:o.formatMessage("snapToTop"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.alignTo(t,"top")}(e),t.stopPropagation()}},{label:o.formatMessage("alignVCenter"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.alignVerticalCenter(t)}(e),t.stopPropagation()}},{label:o.formatMessage("snapToBottom"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.alignTo(t,"bottom")}(e),t.stopPropagation()}},{label:o.formatMessage("fullWidth"),event:function(t){ce(e),t.stopPropagation()}},{label:o.formatMessage("fullHeight"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.alignFullHeight(t)}(e),t.stopPropagation()}},{label:o.formatMessage("fullSize"),event:function(t){ce(e),t.stopPropagation()}}]},o.getPinDropDownItems=function(e){var t=[];return["TL","TC","TR","ML","MC","MR","BL","BC","BR"].map((function(n){t.push({label:o.formatMessage(n),event:function(t){!function(e,t){var n=se(e);if(n){var o=document.querySelector('iframe[name="'+m.APP_FRAME_NAME_IN_BUILDER+'"]'),i=(o.contentDocument||o.contentWindow.document).querySelector('div.exb-rnd[data-layoutid="'+n.layoutId+'"][data-layoutitemid="'+n.layoutItemId+'"]');if(i){Object(b.floatingLayoutItem)(n,i.getBoundingClientRect(),{TL:1,TC:2,TR:3,ML:4,MC:5,MR:6,BL:7,BC:8,BR:9}[t])}}}(e,n),t.stopPropagation()}})})),t},o.getArrangementsDropDownItems=function(e){return[{label:o.formatMessage("sendBackward"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.sendBackward(t)}(e),t.stopPropagation()}},{label:o.formatMessage("bringForward"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.bringForward(t)}(e),t.stopPropagation()}},{label:o.formatMessage("sendToBack"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.sendToBack(t)}(e),t.stopPropagation()}},{label:o.formatMessage("bringToFront"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.bringToFront(t)}(e),t.stopPropagation()}}]},o.isOnlyOneViewOrScreen=function(e){var t=o.props.appConfig,n=e.id.split(wt)[2];return e.type===f.View&&1===t.sections[n].views.length||e.type===f.Screen&&1===t.screenGroups[n].screens.length},o.getDropdwnItemsForSpecialCases=function(e,t){var n=o.props,i=n.browserSizeMode,a=n.lockLayout;if(n.runMode||a){if(e.type===f.Section||e.type===f.View||e.type===f.ScreenGroup||e.type===f.Screen||e.type===f.Widget&&e.data.manifest.widgetType===m.WidgetType.Layout)return t.slice(0,1)}else if(e.type===f.View||e.type===f.Screen||e.type===f.ScreenGroup)return e.type!==f.ScreenGroup&&e.type!==f.Screen||i===m.BrowserSizeMode.Large?o.isOnlyOneViewOrScreen(e)?t.slice(0,2):t:t.slice(0,1);return null},o.isSupportDropDown=function(e){return e===f.Section||e===f.View||e===f.ScreenGroup||e===f.Screen||e===f.Widget},o.getDropDownItems=function(e){var t;if(!o.isSupportDropDown(e.type))return[];var n=o.props,i=n.theme,a=n.appConfig,r=n.currentPageId,l=n.lockLayout,s=n.runMode,c=[{label:o.formatMessage("rename"),event:function(t){o.handleOnTocDoubleClick(e,t)}},{label:o.formatMessage("duplicate"),event:function(t){!function(e){var t=e.id.split(wt),n=t[0],o=t[1],i=Object(v.getAppConfigAction)();e.type===f.Widget||e.type===f.Section||e.type===f.ScreenGroup?Object(b.duplicateLayoutItem)({layoutId:n,layoutItemId:o}):e.type===f.View?(i.duplicateView(t[3],t[2],!0),i.exec()):e.type===f.Screen&&(i.duplicateScreen(t[3],t[2],!0),i.exec())}(e),t.stopPropagation()}},{label:o.formatMessage("delete"),event:function(t){!function(e){var t=e.id.split(wt),n=t[0],o=t[1];if(e.type===f.View){if(e.id.indexOf(wt)<0)return;Object(v.getAppConfigAction)().removeView(e.data.id,e.id.split(wt)[2]).exec()}else if(e.type===f.Screen){if(e.id.indexOf(wt)<0)return;Object(v.getAppConfigAction)().removeScreen(e.data.id,e.id.split(wt)[2]).exec()}else Object(m.getAppStore)().dispatch(v.builderActions.confirmDeleteContentChanged({layoutId:n,layoutItemId:o}))}(e),t.stopPropagation()}}],d=o.getDropdwnItemsForSpecialCases(e,c);if(d)return d;if(s)return c.slice(0,1);if(l)return c.splice(1,1),c;var u=se(e),p=a.layouts[u.layoutId],g=p.content[u.layoutItemId];if(((null==p?void 0:p.type)!==m.LayoutType.FlowLayout||Object(b.supportFloating)(u)||Object(b.supportSinking)(u))&&c.push({label:o.formatMessage("pendingTip"),event:function(t){!function(e){var t=se(e);Object(b.pendLayoutItem)(t)}(e),t.stopPropagation()}}),(null==p?void 0:p.type)===m.LayoutType.FixedLayout){var h=[{label:(null===(t=null==g?void 0:g.setting)||void 0===t?void 0:t.lockLayout)?o.formatMessage("unlockLayout"):o.formatMessage("lockLayout"),event:function(t){!function(e){var t=se(e);t&&b.fixedLayoutActions.toggleLockLayout(t)}(e),t.stopPropagation()}},{label:Object(m.jsx)(T.b,{toggleContent:o.formatMessage("arrange"),modifiers:xt,direction:"right",theme:i,items:o.getArrangementsDropDownItems(e),icon:!1}),isBtn:!0},{label:Object(m.jsx)(T.b,{toggleContent:o.formatMessage("align"),modifiers:xt,direction:"right",theme:i,items:o.getAlignmentsDropDownItems(e),icon:!1}),isBtn:!0}];c.push.apply(c,h)}else null==p||p.type,m.LayoutType.FlowLayout;return o.props.lockLayout||(null==a?void 0:a.pages[r].mode)!==m.PageMode.AutoScroll||e.pagePart!==m.PagePart.Body||(Object(b.supportFloating)(u)?c.push({label:Object(m.jsx)(T.b,{toggleContent:o.formatMessage("floating"),modifiers:xt,direction:"right",theme:i,items:o.getPinDropDownItems(e),icon:!1}),isBtn:!0}):Object(b.supportSinking)(u)&&c.push({label:o.formatMessage("sinking"),event:function(e){!function(e){if(e){var t=document.querySelector('iframe[name="'+m.APP_FRAME_NAME_IN_BUILDER+'"]'),n=(t.contentDocument||t.contentWindow.document).querySelector('div.exb-rnd[data-layoutid="'+e.layoutId+'"][data-layoutitemid="'+e.layoutItemId+'"]');n&&Object(b.sinkingLayoutItem)(e,n.getBoundingClientRect())}}(u),e.stopPropagation()}})),c},o.renderTitleRightContent=function(e){var t=function(e,t){var n=t.theme;return Object(m.css)(ue||(ue=me(["\n    margin-right:calc(14px - ",");\n    .title-arrow {\n      transform-origin: center;\n      transform: ",";\n      transition: transform .5s;\n    }\n\n  "],["\n    margin-right:calc(14px - ",");\n    .title-arrow {\n      transform-origin: center;\n      transform: ",";\n      transition: transform .5s;\n    }\n\n  "])),n.components.button.sizes.sm.paddingX,"rotate("+(e.isExpand?180:0)+"deg)")}(e,o.props);return Object(m.jsx)("div",{css:t},Object(m.jsx)(h.Button,{icon:!0,type:"tertiary",size:"sm"},Object(m.jsx)(h.Icon,{className:"title-arrow",icon:n(34),size:12})))},o.renderCommonRightContent=function(e){var t=o.props.theme,n=o.getDropDownItems(e);if(n.length<1)return Object(m.jsx)("div",null);var i=function(e){var t=e.theme;return Object(m.css)(pe||(pe=me(["\n    margin-right:calc(16px - ",");\n    .dropDown {\n      visibility: visible;\n      .btn {\n        visibility: hidden;\n        color: ",";\n      }\n      .btn:hover {\n        color: ",";\n      }\n    }\n  "],["\n    margin-right:calc(16px - ",");\n    .dropDown {\n      visibility: visible;\n      .btn {\n        visibility: hidden;\n        color: ",";\n      }\n      .btn:hover {\n        color: ",";\n      }\n    }\n  "])),t.components.button.sizes.sm.paddingX,t.colors.palette.dark[600],t.colors.black)}(o.props);return Object(m.jsx)("div",{className:"d-flex",css:i},Object(m.jsx)("div",{title:o.formatMessage("more"),className:"dropDown"},Object(m.jsx)(T.a,{modifiers:xt,direction:"down",theme:t,items:n})))},o.renderOutlineContent=function(e){var t=o.props,n=t.intl,i=t.theme,a=!o.checkIfReadOnly(e),r=o.state.editableItemId,l=e.type,s=[f.Section,f.View,f.ScreenGroup,f.Screen,f.Widget];return Object(m.jsx)(oe,{intl:n,itemJson:e,onArrowClick:o.handleArrowClick,editable:r===e.id,onDoubleClick:a&&o.handleOnTocDoubleClick,renderRightContent:a&&s.indexOf(l)>-1&&o.renderCommonRightContent,renameItem:o.handleRename,theme:i})},o.state={editableItemId:t.editableItemId,currentSelectedItemId:t.currentSelectedItemId,filterText:"",itemJson:void 0,showSearch:!1,showAlign:!1,showArrange:!1},o.expandIds=[],o.alignRef=m.React.createRef(),o.arrangeRef=m.React.createRef(),o.tocItemCss=function(e){var t=e.theme;return Object(m.css)(ge||(ge=me(["\n    :hover {\n      .dropDown {\n        z-index: 2;\n        .btn {\n          display: inline-flex;\n        }\n      }\n      .editor {\n        color: ",";\n      }\n    }\n    &.active {\n      .editor {\n        color: ",";\n      }\n    }\n  "],["\n    :hover {\n      .dropDown {\n        z-index: 2;\n        .btn {\n          display: inline-flex;\n        }\n      }\n      .editor {\n        color: ",";\n      }\n    }\n    &.active {\n      .editor {\n        color: ",";\n      }\n    }\n  "])),t.colors.black,t.colors.black)}(t),o}return yt(t,e),t.prototype.componentDidMount=function(){this.setState({itemJson:this.getItemJsonByAppConfig()})},t.prototype.shouldComponentUpdate=function(e,t){var n,o,i,a,r,l,s=this,c=this.props.appConfig,d=!1;if(e&&Object.keys(e).some((function(t){return s.props?"appConfig"!==t&&e[t]!==s.props[t]?(d=!0,!0):void 0:(d=!0,!0)})),d)return!0;if(t&&Object.keys(t).some((function(e){return s.state?t[e]!==s.state[e]?(d=!0,!0):void 0:(d=!0,!0)})),d)return!0;if(e.appConfig&&c&&e.appConfig!==c){var u=null==c?void 0:c.layouts,p=null===(n=e.appConfig)||void 0===n?void 0:n.layouts;if(u&&p&&u!==p&&function(e,t){var n=!1;return Object.keys(e).length!==Object.keys(t).length?n=!0:e&&Object.keys(e).some((function(o){var i=e[o],a=t[o];if(i!==a){if(i&&!a||!i&&a)return n=!0,!0;var r=i.content,l=a.content,s=i.order,c=a.order;if((r!==l||s!==c)&&(s!==c||r&&!l||Object.keys(r||{}).length!==Object.keys(l||{}).length))return n=!0,!0;if(r&&Object.keys(r).some((function(e){var t,o,i=r[e],a=l[e];if(i&&!a||(null===(t=null==i?void 0:i.setting)||void 0===t?void 0:t.lockLayout)!==(null===(o=null==a?void 0:a.setting)||void 0===o?void 0:o.lockLayout)||(null==i?void 0:i.isPending)!==(null==a?void 0:a.isPending))return n=!0,!0})),n)return!0}})),n}(u,p))return!0;var g=null==c?void 0:c.widgets,f=null===(o=e.appConfig)||void 0===o?void 0:o.widgets;if(g&&f&&g!==f&&function(e,t){var n=!1;return Object.keys(e).length!==Object.keys(t).length?n=!0:Object.keys(e).some((function(o){var i=e[o],a=t[o];return a?i.label!==a.label||i.icon!==a.icon?(n=!0,!0):void 0:(n=!0,!0)})),n}(g,f))return!0;var m=null==c?void 0:c.sections,v=null===(i=e.appConfig)||void 0===i?void 0:i.sections;if(m&&v&&m!==v&&function(e,t){var n=!1;return Object.keys(e).length!==Object.keys(t).length?n=!0:Object.keys(e).some((function(o){var i=e[o],a=t[o];return a?i.label!==a.label||i.icon!==a.icon||a.views!==i.views?(n=!0,!0):void 0:(n=!0,!0)})),n}(m,v))return!0;var h=null==c?void 0:c.views,b=null===(a=e.appConfig)||void 0===a?void 0:a.views;if(h&&b&&h!==b&&function(e,t){var n=!1;return Object.keys(e).length!==Object.keys(t).length?n=!0:Object.keys(e).some((function(o){var i=e[o],a=t[o];return a?i.label!==a.label?(n=!0,!0):void 0:(n=!0,!0)})),n}(h,b))return!0;var y=null==c?void 0:c.screenGroups,I=null===(r=e.appConfig)||void 0===r?void 0:r.screenGroups;if(y&&I&&y!==I&&function(e,t){var n=!1;return Object.keys(e).length!==Object.keys(t).length?n=!0:Object.keys(e).some((function(o){var i=e[o],a=t[o];return a?i.label!==a.label||i.icon!==a.icon||a.screens!==i.screens?(n=!0,!0):void 0:(n=!0,!0)})),n}(y,I))return!0;var w=null==c?void 0:c.screens,x=null===(l=e.appConfig)||void 0===l?void 0:l.screens;if(w&&x&&w!==x&&function(e,t){var n=!1;return Object.keys(e).length!==Object.keys(t).length?n=!0:Object.keys(e).some((function(o){var i=e[o],a=t[o];return a?i.label!==a.label?(n=!0,!0):void 0:(n=!0,!0)})),n}(w,x))return!0}return!1},t.prototype.componentDidUpdate=function(e,t){var n=this.props,o=this.state,i=o.itemJson,a=o.currentSelectedItemId,r=o.editableItemId,l=!1,s=void 0;if(n.currentSelectedItemId!==this.state.currentSelectedItemId||r!==t.editableItemId||n.enableFooter!==e.enableFooter||n.enableHeader!==e.enableHeader||n.appConfig!==e.appConfig||n.currentPageId!==e.currentPageId||n.currentDialogId!==e.currentDialogId||n.browserSizeMode!==e.browserSizeMode){if(l=!0,n.appConfig===e.appConfig&&n.currentPageId===e.currentPageId&&n.currentDialogId===e.currentDialogId&&n.browserSizeMode===e.browserSizeMode||n.currentSelectedItemId===this.state.currentSelectedItemId)if(n.currentSelectedItemId!==a){c=h.TreeUtils.activeAndExpandNodesByActiveIds(i,[n.currentSelectedItemId]);s={currentSelectedItemId:n.currentSelectedItemId,itemJson:c},this.expandIds=h.TreeUtils.fetchAllExpandIds(c)}else{if(void 0!==e.lockLayout&&this.props.lockLayout!==e.lockLayout)return;s={itemJson:this.getItemJsonByAppConfig(n)}}else{var c=h.TreeUtils.activeAndExpandNodesByActiveIds(this.getItemJsonByAppConfig(n),[n.currentSelectedItemId]);s={currentSelectedItemId:n.currentSelectedItemId,itemJson:c},this.expandIds=h.TreeUtils.fetchAllExpandIds(c)}l&&this.setState(s)}},t.prototype.render=function(){var e=this,t=this.state,o=t.itemJson,i=t.showSearch,a=this.props.theme;return Object(m.jsx)("div",{css:ve(this.props,this.state)},Object(m.jsx)("div",{className:"outline-list-top"},Object(m.jsx)("div",{className:"w-100 d-flex justify-content-center mt-1 mb-2"},Object(m.jsx)(h.Icon,{color:a.colors.palette.dark[400],icon:n(105),width:16,height:4})),Object(m.jsx)("div",{className:"d-flex justify-content-between align-items-end"},Object(m.jsx)("div",{className:"outline-title h5 mb-0 text-truncate"},this.formatMessage("outline")),Object(m.jsx)("div",{className:"d-flex outline-top-btns"},Object(m.jsx)(h.Button,{title:this.formatMessage("search"),size:"sm",type:"tertiary",icon:!0,className:"search-btn",onClick:this.handleSearchBtnClick},Object(m.jsx)(h.Icon,{className:"search-icon",size:16,icon:n(14)})))),Object(m.jsx)(h.Collapse,{isOpen:i,onEntered:this.handleSearchOpened},Object(m.jsx)(re,{theme:a,placeholder:this.formatMessage("search"),searchText:this.state.filterText,onSearchTextChange:this.handleSearchTextChange,onSubmit:this.handleSearchSubmit,hideSearchIcon:!0,inputRef:function(t){return e.searchInput=t}}))),Object(m.jsx)("div",{className:"w-100 outline-tree-container"},Object(m.jsx)(h.Tree,{hideRoot:!0,className:"outline-tree",itemJson:o,onClickItem:this.handleClickItem,handleExpand:this.handleExpand})))},t}(m.React.Component),Ot=m.ReactRedux.connect((function(e,t){var n,o,i,a,r,l,s,c,d,u,p,g,v,h,b,y,I,w,x,j,O,S,C,P,T,D,k,A,M,z,L,B,R,E=t.currentPageId,N=e.appStateInBuilder&&e.appStateInBuilder.appRuntimeInfo&&e.appStateInBuilder.appRuntimeInfo.selection,F=e.appStateInBuilder&&e.appStateInBuilder.appConfig,J=N&&F.layouts[N.layoutId]&&F.layouts[N.layoutId].content&&F.layouts[N.layoutId].content[N.layoutItemId],H=void 0;if(J)if(J.type===m.LayoutItemType.Section){var _=null===(i=null===(o=null===(n=e.appStateInBuilder)||void 0===n?void 0:n.appRuntimeInfo)||void 0===o?void 0:o.sectionNavInfos)||void 0===i?void 0:i[J.sectionId],V=null===(a=e.appStateInBuilder)||void 0===a?void 0:a.appConfig.sections[J.sectionId];H=(B=null!==(r=null==_?void 0:_.currentViewId)&&void 0!==r?r:null==V?void 0:V.views[0])?le(It(It({},N),{id:B,sectionId:J.sectionId}),f.View):le(It({id:J.sectionId},N),f.Section)}else if(J.type===m.LayoutItemType.ScreenGroup){_=null===(c=null===(s=null===(l=e.appStateInBuilder)||void 0===l?void 0:l.appRuntimeInfo)||void 0===s?void 0:s.screenGroupNavInfos)||void 0===c?void 0:c[J.screenGroupId];var U=e.appStateInBuilder.appConfig.screenGroups[J.screenGroupId].screens[null!==(d=null==_?void 0:_.activeIndex)&&void 0!==d?d:0],W=null===(u=e.appStateInBuilder)||void 0===u?void 0:u.appConfig.screens[U];H=(R=null==W?void 0:W.id)?le(It(It({},N),{id:R,screenGroupId:J.screenGroupId}),f.Screen):le(It({id:J.screenGroupId},N),f.ScreenGroup)}else J.type===m.LayoutItemType.Widget&&(H=le(It({id:J.widgetId},N),f.Widget));var G=!!(null===(g=null===(p=null==F?void 0:F.pages)||void 0===p?void 0:p[E])||void 0===g?void 0:g.header),Z=!!(null===(h=null===(v=null==F?void 0:F.pages)||void 0===v?void 0:v[E])||void 0===h?void 0:h.footer);return{currentSelectedItemId:H,selection:N,activePagePart:null===(y=null===(b=null==e?void 0:e.appStateInBuilder)||void 0===b?void 0:b.appRuntimeInfo)||void 0===y?void 0:y.activePagePart,allowEditableForHeader:!(!G||!(null===(x=null===(w=null===(I=null==e?void 0:e.appStateInBuilder)||void 0===I?void 0:I.appConfig)||void 0===w?void 0:w.header)||void 0===x?void 0:x.layout[t.browserSizeMode])),allowEditableForFooter:!(!Z||!(null===(S=null===(O=null===(j=null==e?void 0:e.appStateInBuilder)||void 0===j?void 0:j.appConfig)||void 0===O?void 0:O.footer)||void 0===S?void 0:S.layout[t.browserSizeMode])),allowEditable:!!(null===(D=null===(T=null===(P=null===(C=null==e?void 0:e.appStateInBuilder)||void 0===C?void 0:C.appConfig)||void 0===P?void 0:P.pages)||void 0===T?void 0:T[E])||void 0===D?void 0:D.layout[t.browserSizeMode]),appConfig:F,lockLayout:null===(M=null===(A=null===(k=null==e?void 0:e.appStateInBuilder)||void 0===k?void 0:k.appConfig)||void 0===A?void 0:A.forBuilderAttributes)||void 0===M?void 0:M.lockLayout,enableHeader:G,enableFooter:Z,runMode:(null===(L=null===(z=null==e?void 0:e.appStateInBuilder)||void 0===z?void 0:z.appRuntimeInfo)||void 0===L?void 0:L.appMode)===m.AppMode.Run}}))(jt),St=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ct=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Pt=function(e){function t(t){var n=e.call(this,t)||this;return n.lastResizeCall=null,n.emptyLayout={},n.getUniqueIds=function(e,t,n){for(var o=[],i=0;i<n;i++){var a=m.appConfigUtils.getUniqueId(e,t);o.push(a),e=e.setIn([t+"s",a],{id:a})}return o},n.getUniqueLabels=function(e,t,n){for(var o=[],i=0;i<n;i++){var a=m.appConfigUtils.getUniqueId(e,t),r=m.appConfigUtils.getUniqueLabel(e,t,t);o.push(r),e=e.setIn([t+"s",a],{id:a,label:r})}return o},n.changeSelection=function(e){v.builderAppSync.publishChangeSelectionToApp(e)},n.changeContent=function(e){var t=e.id.split(wt);n.changeSelection({layoutId:t[0],layoutItemId:t[1],autoScroll:!0})},n.changeView=function(e){var t=e.id.split(wt);n.changeSelection({layoutId:t[0],layoutItemId:t[1],autoScroll:!0}),v.builderAppSync.publishSectionNavInfoToApp(t[2],{currentViewId:t[3],useProgress:!1})},n.changeScreen=function(e){var t=e.id.split(wt);n.changeSelection({layoutId:t[0],layoutItemId:t[1],autoScroll:!0}),v.builderAppSync.publishScreenGroupNavInfoToApp(t[2],e.index)},n.changeLayout=function(e){},n.getCurrentPageId=function(){var e,t=Object(v.getAppConfigAction)().appConfig;return t.pageStructure.some((function(n,o){var i=Object.keys(n)[0];if(v.appConfigUtils.isRealPage(t,i))return e=i,!0})),e||t.pageStructure.some((function(n,o){return n[Object.keys(n)[0]].some((function(n){if(v.appConfigUtils.isRealPage(t,n))return e=n,!0}))})),v.builderAppSync.publishPageChangeToApp(e),e},n.renderActionBtn=function(e,t,n){return Object(m.jsx)(h.Button,{title:e,size:"sm",color:"link",className:" rounded icon page-action-btn",onClick:n},Object(m.jsx)(h.Icon,{size:12,icon:t}))},n.PageListWrapper=function(){return Object(m.jsx)(_,{onDefaultClick:n.setHomePage,addPageWithType:n.addPageWithType,isPageTemplateLoading:n.state.isPageTemplateLoading,editablePageItemId:n.state.editablePageItemId,theme:n.props.theme,changeEditablePageItemId:n.changeEditablePageId,currentPageItemId:n.props.currentDialogId?null:n.props.currentPageId,removePage:n.removePage,intl:n.props.intl,duplicatePage:n.duplicatePage,renamePage:n.renamePage,reOrderPage:n.orderPageBelowPage,onClickPage:n.changeCurrentPage,movePageIntoPage:n.movePageIntoPage,browserSizeMode:n.props.browserSizeMode})},n.DialogListWrapper=function(){return Object(m.jsx)(Q,{forceRefresh:"dialog"===n.state.selectedTabId,onSplashClick:n.setSplashDialog,theme:n.props.theme,intl:n.props.intl,currentDialogItemId:n.props.currentDialogId,addDialog:n.addDialog,removeDialog:n.removeDialog,duplicateDialog:n.duplicateDialog,renameDialog:n.renameDialog,editableDialogItemId:n.state.editableDialogItemId,changeEditableDialogItemId:n.changeEditableDialogId,reOrderDialog:n.orderDialogBelowDialog,onClickDialog:n.changeCurrentDialog})},n.getStyle=function(e){var t=n.state.pageTocH;return Object(m.css)(ht||(ht=Ct(["\n      overflow: hidden;\n\n      .page-toc {\n        background-color: ",";\n        height: ",";\n\n        .page-list,\n        .dialog-list{\n          height: calc(100% - 10px);\n        }\n      }\n\n      .outline-toc {\n        background-color: ",";\n        border: 0;\n        border-top: 2px solid ",";\n        height: calc(100% - ",");\n      }\n\n    "],["\n      overflow: hidden;\n\n      .page-toc {\n        background-color: ",";\n        height: ",";\n\n        .page-list,\n        .dialog-list{\n          height: calc(100% - 10px);\n        }\n      }\n\n      .outline-toc {\n        background-color: ",";\n        border: 0;\n        border-top: 2px solid ",";\n        height: calc(100% - ",");\n      }\n\n    "])),e.colors.palette.light[300],t>0?t+"px":"33%",e.colors.palette.light[300],e.colors.palette.light[800],t>0?t+"px":"33%")},n.onTabSelect=function(e){"page"===e&&Object(y.changeCurrentPage)(n.props.currentPageId),n.setState({selectedTabId:e})},n.state={editablePageItemId:"",editableDialogItemId:"",editableOutlineItemId:"",isTemplatePopoverOpen:!1,pageTocH:-1,selectedTabId:null,isPageTemplateLoading:!1},n.resizeRef=m.React.createRef(),n.pageTocRef=m.React.createRef(),n.popoverRef=m.React.createRef(),n.changeEditablePageId=n.changeEditablePageId.bind(n),n.addPageWithType=n.addPageWithType.bind(n),n.handleOutlineItemClick=n.handleOutlineItemClick.bind(n),n.changeCurrentPage=n.changeCurrentPage.bind(n),n.movePageIntoPage=n.movePageIntoPage.bind(n),n.removePage=n.removePage.bind(n),n.setHomePage=n.setHomePage.bind(n),n.formatMessage=n.formatMessage.bind(n),n.loadPageTemplate=n.loadPageTemplate.bind(n),n.parsePageTemplate=n.parsePageTemplate.bind(n),n.duplicatePage=n.duplicatePage.bind(n),n.renamePage=n.renamePage.bind(n),n.orderPageBelowPage=n.orderPageBelowPage.bind(n),n.changeEditableDialogId=n.changeEditableDialogId.bind(n),n.addDialog=n.addDialog.bind(n),n.removeDialog=n.removeDialog.bind(n),n.renameDialog=n.renameDialog.bind(n),n.duplicateDialog=n.duplicateDialog.bind(n),n.setSplashDialog=n.setSplashDialog.bind(n),n.changeCurrentDialog=n.changeCurrentDialog.bind(n),n.loadDialogTemplate=n.loadDialogTemplate.bind(n),n.parseDialogTemplate=n.parseDialogTemplate.bind(n),n.orderDialogBelowDialog=n.orderDialogBelowDialog.bind(n),n}return St(t,e),t.prototype.componentDidMount=function(){var e=this;this.resizeRef&&this.resizeRef.current&&(this.interactable=Object(x.interact)(this.resizeRef.current).resizable({edges:{top:!0,left:!1,bottom:!1,right:!1},modifiers:[x.interact.modifiers.restrictEdges({outer:"parent",endOnly:!0}),x.interact.modifiers.restrictSize({min:{width:20,height:100}})],inertia:!1,onstart:function(e){e.stopPropagation()},onmove:function(t){t.stopPropagation(),e.lastResizeCall&&cancelAnimationFrame(e.lastResizeCall);var n=t.rect,o=0;e.pageTocRef.current&&(o=e.pageTocRef.current.getBoundingClientRect().top);var i=n.top-o;i<100||(e.lastResizeCall=requestAnimationFrame((function(){e.setState({pageTocH:i})})))},onend:function(t){t.stopPropagation(),e.lastResizeCall&&cancelAnimationFrame(e.lastResizeCall),e.lastResizeCall=requestAnimationFrame((function(){var n=t.rect,o=0;e.pageTocRef.current&&(o=e.pageTocRef.current.getBoundingClientRect().top),e.lastResizeCall=requestAnimationFrame((function(){e.setState({pageTocH:n.top-o})}))}))}}))},t.prototype.componentWillUnmount=function(){this.lastResizeCall&&cancelAnimationFrame(this.lastResizeCall),this.interactable&&(this.interactable.unset(),this.interactable=null)},t.prototype.handleOutlineItemClick=function(e){e.type!==f.Label&&(e.type===f.ScreenGroup||e.type===f.Section||e.type===f.Widget?this.changeContent(e):e.type===f.View?this.changeView(e):[f.Screen,f.ScreenMainStage,f.ScreenSrollingPanel].includes(e.type)?this.changeScreen(e):e.type===f.Layout&&this.changeLayout(e),e.pagePart&&v.builderAppSync.publichActivePagePartChangeToApp(e.pagePart))},t.prototype.changeCurrentPage=function(e){Object(y.changeCurrentPage)(e)},t.prototype.changeEditablePageId=function(e){e!==this.state.editablePageItemId&&this.setState({editablePageItemId:e})},t.prototype.movePageIntoPage=function(e,t){if(e!==t){var n=Object(v.getAppConfigAction)().appConfig;Object(v.getAppConfigAction)().movePageIntoPage(e,t).exec(),n.pages[e].type===m.PageType.Normal&&this.changeCurrentPage(e)}},t.prototype.removePage=function(e){var t,n=Object(v.getAppConfigAction)().appConfig,o=n.pages[e];n.pageStructure.some((function(o,i){var a=Object.keys(o)[0];return a!==e&&(v.appConfigUtils.isRealPage(n,a)?(t=a,!0):void 0)})),t||n.pageStructure.some((function(o,i){var a=Object.keys(o)[0];return a!==e&&!!o[a].some((function(o){return o!==e&&(v.appConfigUtils.isRealPage(n,o)?(t=o,!0):void 0)}))})),t&&(v.builderAppSync.publishPageChangeToApp(t),Object(v.getAppConfigAction)().removePage(e).exec(),o.isDefault&&Object(v.getAppConfigAction)().setHomePage(t).exec())},t.prototype.setHomePage=function(e){Object(v.getAppConfigAction)().replaceHomePage(e).exec()},t.prototype.duplicatePage=function(e){var t=Object(v.getAppConfigAction)().appConfig,n=Object(v.getAppConfigAction)(),o=n.duplicatePage(e);n.exec();var i=t.pages[e];i.type!==m.PageType.Folder&&i.type!==m.PageType.Link&&this.changeCurrentPage(o.id)},t.prototype.duplicateDialog=function(e){var t=Object(v.getAppConfigAction)(),n=t.duplicateDialog(e);t.exec(),this.changeCurrentDialog(n.id)},t.prototype.renamePage=function(e,t){return!(!t||""===t)&&(Object(v.getAppConfigAction)().editPageProperty(e,"label",t).exec(),this.changeEditablePageId(""),!0)},t.prototype.orderPageBelowPage=function(e,t,n){Object(v.getAppConfigAction)().orderPageToPage(e,t,n).exec()},t.prototype.formatMessage=function(e){var t=this.props.intl,n=Object.assign({},w,h.defaultMessages);return t.formatMessage({id:e,defaultMessage:n[e]})},t.prototype.addPageWithType=function(e,t){var n,o=this,i=Object(v.getAppConfigAction)().appConfig;switch(e){case"page":this.setState({isPageTemplateLoading:!0}),this.loadPageTemplate(t).then((function(e){o.setState({isPageTemplateLoading:!1}),(n=e)&&(v.builderAppSync.publishChangeBrowserSizeModeToApp(Object(v.getAppConfigAction)().appConfig.mainSizeMode),o.changeEditablePageId(n.id))}));break;case"link":n=Object(m.Immutable)({}).merge({id:m.appConfigUtils.getUniqueId(i,"page"),type:m.PageType.Link,label:m.appConfigUtils.getUniqueLabel(i,"page",this.formatMessage("link")),linkUrl:"#",isVisible:!0}),Object(v.getAppConfigAction)().addPage(n).exec();break;case"folder":n=Object(m.Immutable)({}).merge({id:m.appConfigUtils.getUniqueId(i,"page"),type:m.PageType.Folder,label:m.appConfigUtils.getUniqueLabel(i,"page",this.formatMessage("folder")),isVisible:!0}),Object(v.getAppConfigAction)().addPage(n).exec()}return n&&this.changeEditablePageId(n.id),n},t.prototype.loadPageTemplate=function(e){var t=Object(v.getAppConfigAction)().appConfig;return this.parsePageTemplate(e,t)},t.prototype.parsePageTemplate=function(e,t){var n=this;return e?(Object(m.getAppStore)().dispatch(m.appActions.setIsBusy(!0,m.LoadingType.Primary)),Object(b.createPageFromTemplate)(t,e,{}).then((function(e){var t,o=e.appConfig,i=e.newPageId,a=o.pages[i];if(a){var r=o.set("pageStructure",o.pageStructure.concat([(t={},t[a.id]=[],t)]));return Object(v.getAppConfigAction)(r).exec(),n.changeCurrentPage(a.id),n.changeEditablePageId(a.id),Object(m.getAppStore)().dispatch(m.appActions.setIsBusy(!1)),a}})).catch((function(){return Object(m.getAppStore)().dispatch(m.appActions.setIsBusy(!0,m.LoadingType.Secondary))}))):Promise.resolve()},t.prototype.changeCurrentDialog=function(e){Object(y.changeCurrentDialog)(e)},t.prototype.changeEditableDialogId=function(e){e!==this.state.editableDialogItemId&&this.setState({editableDialogItemId:e})},t.prototype.removeDialog=function(e){var t=null,n=Object(v.getAppConfigAction)().appConfig,o=n.dialogs,i=o[e],a=this.props.currentDialogId;if(e===a){var r=null;Object.keys(o).some((function(e,n){var a=o[e];if(a.mode===i.mode){if(a.index===i.index-1)return t=a.id,!0;a.index===i.index+1&&(r=a.id)}})),t||(t=r||Object.keys(o).filter((function(t){return o[t].mode===i.mode&&0===o[t].index&&o[t].id!==e}))[0]||Object.keys(o).filter((function(e){return o[e].mode!==i.mode&&0===o[e].index}))[0]);var l=Object(y.handelDialogInfos)(t);v.builderAppSync.publishDialogInfosChangeToApp(l),v.builderAppSync.publishDialogChangeToApp(t)}(Object(v.getAppConfigAction)().removeDialog(e).exec(),i.isSplash||i.mode!==m.DialogMode.Fixed)||v.utils.getPageListByDialogId(n.pages,e).map((function(e){Object(v.getAppConfigAction)().editPageProperty(e.id,"autoOpenDialogId","").exec()}))},t.prototype.setSplashDialog=function(e){Object(v.getAppConfigAction)().replaceSplashDialog(e).exec()},t.prototype.renameDialog=function(e,t){return!(!t||""===t)&&(Object(v.getAppConfigAction)().editDialogProperty(e,"label",t).exec(),this.changeEditableDialogId(""),!0)},t.prototype.orderDialogBelowDialog=function(e,t,n){Object(v.getAppConfigAction)().orderDialogToDialog(e,t,n).exec()},t.prototype.addDialog=function(e){var t=this.loadDialogTemplate(e);return v.builderAppSync.publishChangeBrowserSizeModeToApp(Object(v.getAppConfigAction)().appConfig.mainSizeMode),t},t.prototype.loadDialogTemplate=function(e){var t=Object(v.getAppConfigAction)().appConfig;this.parseDialogTemplate(e,t)},t.prototype.parseDialogTemplate=function(e,t){var n=this;e&&(Object(m.getAppStore)().dispatch(m.appActions.setIsBusy(!0,m.LoadingType.Secondary)),Object(b.createDialogFromTemplate)(t,e,{}).then((function(e){var t=e.appConfig,o=e.newDialogId,i=t.dialogs[o];return Object(v.getAppConfigAction)(t).exec(),n.changeCurrentDialog(i.id),n.changeEditableDialogId(i.id),Object(m.getAppStore)().dispatch(m.appActions.setIsBusy(!1)),i})).catch((function(){return Object(m.getAppStore)().dispatch(m.appActions.setIsBusy(!0))})))},t.prototype.render=function(){var e,t=this.PageListWrapper,n=this.DialogListWrapper,o=this.props,i=o.currentPageId,a=o.currentDialogId,r=o.browserSizeMode;return e=a||"dialog"===this.state.selectedTabId?"dialog":"page",Object(m.jsx)("div",{css:this.getStyle(this.props.theme),className:"jimu-widget widget-builder-toc bg-white w-100 h-100"},Object(m.jsx)("div",{className:"page-toc",ref:this.pageTocRef},Object(m.jsx)(h.Tabs,{underline:!0,css:Object(m.css)(bt||(bt=Ct(["\n          height: 100%;\n          .jimu-nav {\n            border-bottom: none;\n            padding: 5px 1px;\n            width: calc(100% - 60px);\n            overflow: hidden;\n          }\n          .tab-content{\n            height: calc(100% - 50px);\n            .tab-pane{\n              width: 100%;\n            }\n          }\n          .nav-item {\n            margin: 0 1rem;\n            &:last-of-type{\n              margin-right: 0;\n            }\n            .nav-link{\n              padding: 9px 0;\n            }\n          }\n        "],["\n          height: 100%;\n          .jimu-nav {\n            border-bottom: none;\n            padding: 5px 1px;\n            width: calc(100% - 60px);\n            overflow: hidden;\n          }\n          .tab-content{\n            height: calc(100% - 50px);\n            .tab-pane{\n              width: 100%;\n            }\n          }\n          .nav-item {\n            margin: 0 1rem;\n            &:last-of-type{\n              margin-right: 0;\n            }\n            .nav-link{\n              padding: 9px 0;\n            }\n          }\n        "]))),onTabSelect:this.onTabSelect},Object(m.jsx)(h.Tab,{id:"page",title:this.formatMessage("page"),active:"page"===e},Object(m.jsx)("div",{className:"page-list"},Object(m.jsx)(t,null))),Object(m.jsx)(h.Tab,{id:"dialog",title:this.formatMessage("dialog"),active:"dialog"===e},Object(m.jsx)("div",{className:"dialog-list"},Object(m.jsx)(n,null))))),Object(m.jsx)("div",{className:"outline-toc",ref:this.resizeRef},Object(m.jsx)(Ot,{currentPageId:i,currentDialogId:a,browserSizeMode:r,onClickItem:this.handleOutlineItemClick,editableOutlineItemId:this.state.editableOutlineItemId,theme:this.props.theme,intl:this.props.intl})))},t.mapExtraStateProps=function(e){var t,n,o,i,a,r,l;return{currentPageId:null===(n=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo)||void 0===n?void 0:n.currentPageId,currentDialogId:null===(i=null===(o=null==e?void 0:e.appStateInBuilder)||void 0===o?void 0:o.appRuntimeInfo)||void 0===i?void 0:i.currentDialogId,browserSizeMode:null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.browserSizeMode,dialogInfos:null===(l=null===(r=null==e?void 0:e.appStateInBuilder)||void 0===r?void 0:r.appRuntimeInfo)||void 0===l?void 0:l.dialogInfos}},t}(m.React.PureComponent);t.default=Pt}]))}}}));