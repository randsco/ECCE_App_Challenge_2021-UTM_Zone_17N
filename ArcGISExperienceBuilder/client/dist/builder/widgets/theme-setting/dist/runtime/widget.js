System.register(["jimu-core","jimu-ui","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/advanced/theme-components"],(function(e){var t,n,o,i,r;return{setters:[function(e){t=e},function(e){n=e},function(e){o=e},function(e){i=e},function(e){r=e}],execute:function(){e(function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=116)}({0:function(e,n){e.exports=t},1:function(e,t){e.exports=n},116:function(e,t,n){"use strict";n.r(t);var o,i,r=n(0),s=n(2),a=n(1),c=n(26),l=n(3),p={chooseTheme:"Theme",customTheme:"Customize",resetTheme:"Reset",backToMainThemePanel:"Back",customPaletteTitle:"Customize palette colors",customFontsetTitle:"Customize font set",customAppElementsTitle:"App elements"},u=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),f=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},h=function(){return(h=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},d=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={currentStep:1},n}return u(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=d(e,["className"]),o=Object(r.classNames)("jimu-builder-stepper",t);return Object(r.jsx)("div",h({css:g},n,{className:o}))},t}(r.React.PureComponent),b=function(e){function t(t){return e.call(this,t)||this}return u(t,e),t.prototype.render=function(){var e=this.props,t=e.active,n=e.className,o=e.children,i=d(e,["active","className","children"]),s=Object(r.classNames)("jimu-builder-stepper-pane",n,{active:t});return Object(r.jsx)("div",h({},i,{className:s}),t&&o)},t}(r.React.PureComponent);function g(){return Object(r.css)(i||(i=f(["\n\n  "],["\n\n  "])))}var j,y,O,v,x,S,T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),C=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},w=function(){return(w=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},P=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},I=function(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},M=function(e){function t(t){var n=e.call(this,t)||this;return n.loadThemeListInfo=function(){return P(n,void 0,Promise,(function(){var e,t,n,o;return I(this,(function(i){switch(i.label){case 0:return[4,fetch(r.urlUtils.getAbsoluteRootUrl()+"themes/themes-info.json")];case 1:return e=i.sent(),n=(t=Promise).resolve,o=r.Immutable,[4,e.json()];case 2:return[2,n.apply(t,[o.apply(void 0,[i.sent()])])]}}))}))},n.handleOnChange=function(e){e&&Object(s.getAppConfigAction)(n.props.appConfig).editTheme(e).exec()},n.handleOnUpdate=function(e){if(e){var t=r.ThemeManager.getInAppInstance().addThemeCustomVariables(n.state.selectedTheme,e);t&&Object(s.getAppConfigAction)(n.props.appConfig).editCustomTheme(t).exec()}},n.handleOnCustomize=function(){n.setState({currentStep:2})},n.handleOnReset=function(){var e=w({},r.themeUtils.getMappedShareThemeVariables());r.ThemeManager.getInAppInstance().updateThemeCustomVariables(n.state.selectedTheme,e),Object(s.getAppConfigAction)(n.props.appConfig).editCustomTheme(e).exec()},n.i18n=function(e){var t=n.props.intl;return t?t.formatMessage({id:e,defaultMessage:p[e]}):e},n.getStyle=function(e){return Object(r.css)(j||(j=C(["\n      .jimu-builder-stepper-pane {\n        display: none;\n        height: 100%;\n        &.active {\n          display: flex;\n          flex-direction: column;\n        }\n      }\n      .widget-builder-themes--pane {\n        height: 100%;\n        flex: 1;\n        overflow: auto;\n        padding-top: 18px;\n        .jimu-widget-setting--section-header h6 {\n          color: ",";\n          font-weight: ",";\n          font-size: 1rem;\n        }\n        .split-line {\n          display: none;\n        }\n      }\n    "],["\n      .jimu-builder-stepper-pane {\n        display: none;\n        height: 100%;\n        &.active {\n          display: flex;\n          flex-direction: column;\n        }\n      }\n      .widget-builder-themes--pane {\n        height: 100%;\n        flex: 1;\n        overflow: auto;\n        padding-top: 18px;\n        .jimu-widget-setting--section-header h6 {\n          color: ",";\n          font-weight: ",";\n          font-size: 1rem;\n        }\n        .split-line {\n          display: none;\n        }\n      }\n    "])),e.colors.palette.dark[600],e.typography.weights.bold)},n.state={selectedTheme:null,currentStep:1,loadStatus:"init"},n.loadingStr=n.props.intl.formatMessage({id:"loading",defaultMessage:r.defaultMessages.loading}),n.titleStr=n.props.intl.formatMessage({id:"chooseTheme",defaultMessage:p.chooseTheme}),n}return T(t,e),t.prototype.componentDidUpdate=function(e){var t,n,o,i,a=null===(n=null===(t=this.props)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.theme,c=null===(o=null==e?void 0:e.appConfig)||void 0===o?void 0:o.theme;if(a!==c){if(this.setState({loadStatus:"loading",selectedTheme:a}),c)if(a===r.CONSTANTS.SHARED_THEME){var l=w({sharedTheme:!0},r.themeUtils.getMappedShareThemeVariables(!0));r.ThemeManager.getInAppInstance().updateThemeCustomVariables(a,l),this.props.appConfig&&Object(s.getAppConfigAction)(this.props.appConfig).editCustomTheme(Object(r.Immutable)(l)).exec()}else this.props.appConfig&&Object(s.getAppConfigAction)(this.props.appConfig).editCustomTheme(Object(r.Immutable)({})).exec()}else a===c&&this.props.appTheme&&"loaded"!==this.state.loadStatus&&this.setState({loadStatus:"loaded"});(null===(i=this.props)||void 0===i?void 0:i.appId)!==(null==e?void 0:e.appId)&&e.appId&&(r.ThemeManager.getInAppInstance().clearAllThemeCustomVariables(),this.setState({loadStatus:"init"}))},t.prototype.componentDidMount=function(){var e=this;this.loadThemeListInfo().then((function(t){e.themeInfos=t}))},t.prototype.render=function(){var e=this,t=this.props,o=t.appConfig,i=t.appTheme,s=t.theme,p=t.intl,u=t.isRTL,f=(null==o?void 0:o.theme)&&i;return Object(r.jsx)(m,{className:"jimu-widget widget-builder-themes d-flex flex-column bg-light-300 w-100 h-100",css:this.getStyle(s)},"init"!==this.state.loadStatus&&Object(r.jsx)(r.React.Fragment,null,Object(r.jsx)(b,{active:1===this.state.currentStep},Object(r.jsx)(l.SettingSection,{title:this.titleStr,className:"widget-builder-themes--pane border-bottom-0"},Object(r.jsx)(c.ThemeSelector,{theme:s,themeListInfo:this.themeInfos,selectedTheme:o?o.theme:void 0,onChange:this.handleOnChange,intl:p})),Object(r.jsx)(l.SettingSection,{className:"d-flex"},Object(r.jsx)(a.Button,{type:"primary",css:Object(r.css)(y||(y=C(["flex: 1; font-size: 1rem;"],["flex: 1; font-size: 1rem;"]))),className:"theme-setting--customize-btn text-truncate",onClick:this.handleOnCustomize,disabled:(null==o?void 0:o.theme)===r.CONSTANTS.SHARED_THEME},this.i18n("customTheme")))),f&&Object(r.jsx)(b,{active:2===this.state.currentStep},Object(r.jsx)("div",{className:"jimu-widget-setting--header px-1 pb-0"},Object(r.jsx)(a.Button,{css:{fontSize:"1rem",fontWeight:500},type:"tertiary",onClick:function(){return e.setState({currentStep:1})}},Object(r.jsx)(a.Icon,{css:Object(r.css)(O||(O=C([""," position: relative; top: -2px;"],[""," position: relative; top: -2px;"])),u&&"transform: scaleX(-1);"),icon:n(23),autoFlip:!0}),this.i18n("backToMainThemePanel"))),Object(r.jsx)(c.ThemeQuickStyler,{className:"widget-builder-themes--pane",themeVariables:f,onChange:this.handleOnUpdate,onMoreColorConfigButtonClick:function(){return e.setState({currentStep:3})},rtl:u}),Object(r.jsx)(l.SettingSection,{className:"d-flex"},Object(r.jsx)(a.Button,{type:"secondary",css:Object(r.css)(v||(v=C(["flex: 1;"],["flex: 1;"]))),onClick:this.handleOnReset},this.i18n("resetTheme")))),f&&Object(r.jsx)(b,{active:3===this.state.currentStep},Object(r.jsx)("div",{className:"jimu-widget-setting--header px-1 pb-0"},Object(r.jsx)(a.Button,{css:{fontSize:"1rem",fontWeight:500},type:"tertiary",onClick:function(){return e.setState({currentStep:2})}},Object(r.jsx)(a.Icon,{css:Object(r.css)(x||(x=C([""," position: relative; top: -2px;"],[""," position: relative; top: -2px;"])),u&&"transform: scaleX(-1);"),icon:n(23),autoFlip:!0}),this.i18n("backToMainThemePanel"))),Object(r.jsx)(l.SettingSection,{title:this.i18n("themeSettingThemeColors"),className:"widget-builder-themes--pane"},Object(r.jsx)("p",{className:"text-dark-400 text-break"},this.i18n("themeSettingThemeColorsDescription")),Object(r.jsx)(c.ThemeColorConfigurator,{className:"w-100 d-flex justify-content-between",themeVariables:f,onChange:this.handleOnUpdate,intl:p})),Object(r.jsx)(l.SettingSection,{className:"d-flex"},Object(r.jsx)(a.Button,{type:"secondary",css:Object(r.css)(S||(S=C(["flex: 1;"],["flex: 1;"]))),onClick:this.handleOnReset},this.i18n("resetTheme"))))))},t.mapExtraStateProps=function(e){var t;return{appConfig:e.appStateInBuilder&&e.appStateInBuilder.appConfig||null,sharedTheme:e.portalSelf&&e.portalSelf.portalProperties&&e.portalSelf.portalProperties.sharedTheme,queryObject:e.queryObject,isRTL:e.appContext.isRTL,appId:null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appId,appTheme:e.appStateInBuilder&&e.appStateInBuilder.theme}},t}(r.React.PureComponent);t.default=M},2:function(e,t){e.exports=o},23:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.305 7.294L10.693.215a.79.79 0 011.083 0c.299.287.299.751 0 1.038L4.736 8l7.04 6.747c.299.287.299.751 0 1.038a.79.79 0 01-1.083 0l-7.388-7.08a.968.968 0 010-1.41z" fill="#000"></path><path d="M0 0h16v16H0z"></path></g></svg>'},26:function(e,t){e.exports=r},3:function(e,t){e.exports=i}}))}}}));